{"version":3,"sources":["components/Header/Header.tsx","modules/editor.ts","modules/course.ts","modules/puppy.ts","modules/input.ts","vm/render.ts","vm/shape.ts","vm/color.ts","vm/vm.ts","modules/version.ts","store.ts","puppy-transpiler/puppy-parser.ts","puppy-transpiler/puppy.ts","modules/operations.ts","containers/Header.ts","components/Editor/Editor.tsx","containers/Editor.ts","components/PuppyScreen/PuppyScreen.tsx","containers/PuppyScreen.ts","components/Course/Course.tsx","containers/Course.ts","components/Input/Input.tsx","containers/Input.ts","components/Version/Version.tsx","containers/Version.ts","App.tsx","index.tsx"],"names":["Header","EditorActionTypes","props","useEffect","fetchCourses","react_default","a","createElement","className","id","__source","fileName","_jsxFileName","lineNumber","__self","undefined","Navbar","bg","variant","expand","Brand","onClick","setShow","src","width","height","Nav","NavDropdown","title","course","Object","keys","courses","map","course_path","concat","drop","key","list","page","i","Item","href","setCode","code","type","SET_CODE","payload","setDecoration","decoration","SET_DECORATION","type2severity","monacoEditor","Error","Info","Warning","Hint","setTheme","theme","SET_THEME","initialState","codeEditor","fontSize","markers","diffStartLineNumber","editorReducer","CourseActionTypes","state","action","SET_SIZE","_objectSpread","SET_CODEEDITOR","SET_FONTSIZE","value","SET_MARKER","setModelMarkers","getModel","SET_DIFFSTARTLINENUMBER","startLineNumber","setContent","content","SET_CONTENT","setCourse","SET_COURSE","setVisible","visible","SET_VISIBLE","coursePath","courseReducer","PuppyActionTypes","course_objectSpread","SET_COURSES","puppy","isLive","puppyReducer","InputActionTypes","resize","puppy_objectSpread","SET_PUPPY","SET_ISLIVE","show","SET_SHOW","placeholder","InputReducer","SET_VALUE","input_objectSpread","SET_PLACEHOLDER","Bodies","Matter","Composite","Common","PropertyMap","radius","options","base","fillStyle","color","Array","isArray","choose","world","colorScheme","length","convColor","setShapeProperty","checkShapeProperty","circle","assign","position","x","y","rectangle","isStatic","polygon","sides","label","isSensor","collisionFilter","category","mask","group","created","getTimeStamp","pendulum","column","viewWidth","size","xx","yy","newtonsCradle","create","_options","inertia","interia","Infinity","restitution","friction","frictionAir","slop","constraint","pointA","bodyB","render","lineWidth","strokeStyle","console","log","initVars","vars","Circle","Rectangle","Polygon","Label","Drop","Pendulum","PuppyColorScheme","pop","cute","dynamic","gorgeous","casual","psychedelic","bright","fairytale","heavy","impact","street","cool","elegant","fresh","warm","soft","man","woman","boy","girl","smart","light","stylish","natural","spring","summer","fall","winter","japan","euro","nordic","asian","chooseColorScheme","cs","targets","document","getElementsByClassName","style","backgroundColor","borderColor","Engine","Runner","Render","_getTexture","imagePath","image","textures","Image","startsWith","bodies","context","c","showInternalEdges","wireframes","defaultFont","font","defaultFontColor","fontColor","body","k","parts","part","opacity","globalAlpha","texture","translate","rotate","angle","drawImage","circleRadius","beginPath","arc","Math","PI","moveTo","vertices","j","isInternal","lineTo","closePath","stroke","fill","ref","save","textAlign","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","fillText","restore","myRender","Constraint","MouseConstraint","Mouse","World","Bounds","Vertices","Detector","Puppy","constructor","settings","waitStart","this","interval","waitRestart","isExecuting","runner","engine","canvas","new_","cons","add","viewHeight","pos","view","min","max","initCode","vwidth","vheight","background","gravity","density","airFriction","frictionStatic","motion","startCode","window","addEventListener","event","orientation","clamp","gamma","beta","on","time","timing","timestamp","eachUpdate","allBodies","pairs","pair","bodyA","isFixed","getElementById","render_width","clientWidth","render_height","clientHeight","element","mouse","constraintOptions","pointB","stiffness","mouseConstraint","sourcebody","contains","bounds","canCollide","run","dispose","clear","stop","remove","getCode","getCanvas","w","h","setAttribute","toString","[object Object]","msec","Promise","resolve","setTimeout","wait","enabled","getDiffStartLineNumber","main","getIsLive","delta","update","setCodeHighlight","waitForRun","resetCodeHighlight","isRunning","runCode","execute_main","pause","start","ln","n","lines","msg","getInputValue","text","display","async","target","querySelector","Text","onclick","listener","once","awaitForClick","f","print","extend","shape","move","px","setPosition","random","trace","listAdd","anyMul","s","anyIn","indexOf","int","Number","parseInt","float","parseFloat","str","join","range","z","end","step","xs","push","getindex","index","charAt","slice","substr","find","sub","append","len","func","lst","from","applyForce","fx","fy","_x","_y","scale","sx","sy","setAngle","setVelocity","setAngularVelocity","velocity","setDensity","setMass","mass","setStatic","flag","puppy_settings","ftrace","_log","VersionActionTypes","SET_VERSION_SHOW","VersionReducer","version_objectSpread","allReducers","combineReducers","editor","input","version","store","createStore","ParseTree","tag","spos","epos","child","urn","inputs","nodes","empties","setup","entry","edge","prev","reverse","is","isError","subs","get","tokenize","defstr","substring","row","col","charCodeAt","begin","sb","strOut","node","Merge","ParserContext","head_pos","ast","memos","Memo","ANY","pAny","pChar","text_length","set_bitmap","bitmap","pRange","chars","ranges","codemax","find_codemax","Uint8Array","pMany","match","pMany1","pAnd","pNot","pOption","pSeq","matches","pSeq2","match2","pSeq3","match3","pOre","pOre2","pRef","peg","name","pNode","shift","pEdge","pFold","State","sid","getstate","pMatch","generate","grammar","res","pScope","pSymbol","INDENT","Type","isOptional","rtype","psize","ptype","accept","ty","realType","isPattern","hasAlpha","toVarType","BaseType","super","v","VarType","must","env","t","VoidType","FuncType","types","ss","ListType","param","p","tAny","UnionType","ty0","ts","union","tVoid","tBool","tInt","tInt_","tFloat","tString","tString_","tA","tListA","tListInt","tListAny","tMatter","tVec","EmptyNumberSet","unionSet","b","A","varMap","varid","getroot","v1","u","OptionType","JSON","stringify","equals","Symbol","isMatter","isMutable","isGlobal","tColor","tOption","tFuncFloatFloat","tFuncFloatFloatFloat","tFuncShape","import_math","pi","sin","cos","tan","sqrt","log10","pow","hypot","gcd","import_python",".append","modules","math","matterjs",".setPosition",".applyForce",".rotate",".scale",".setAngle",".setAngularVelocity",".setDensity",".setMass",".setStatic",".setVelocity","symbolPackageMap","pkgname","checkSymbolNames","KEYTYPES","area","torque","damping","in","out","over","clicked","message","tCompr","opset","and","or","not","+=","-=","*=","//=","/=","<<=",">>=","|=","&=","^=","operator","op","op2","tleftMap","+","-","**","*","/","//","%","==","!=","<","<=",">",">=","^","|","&","<<",">>","tleft","tright","ty2","setpos","elog","r","Env","root","parent","e","has","set","setroot","from_import","pkg","setModule","isModule","getModule","perror","logs","setInLoop","inLoop","setFunc","data","inFunc","foundFunc","symbol","isUtf8Name","local","vname","declVar","emitAutoYield","yieldparam","PuppyError","FIXME_subs","Transpiler","conv","subject","skip","check","req","request","given","checkBinary","ty1","left","right","err","FromDecl","ImportDecl","alias","Source","subtree","out2","Block","penv","indent","nested","IfExpr","IfStmt","stmt","ElifStmt","ForStmt","lenv","FuncDecl","names","funcData","return","hasReturn","pname","funcType","defun","FuncExpr","Return","Continue","Break","Pass","VarDecl","out1","qual","Name","SetName","And","Or","Not","Infix","Unary","ApplyExpr","ApplySymbolExpr","recv","args","unshift","MethodExpr","methodname","SelfAssign","GetExpr","SetGetExpr","IndexExpr","SetIndexExpr","Data","KeyValue","Tuple","List","Format","TrueExpr","FalseExpr","Int","Float","Double","String","Char","MultiString","parse","parser","transpile","compile","source","jscode","Function","checkError","dispatch","error_count","annos","errors","marker","severity","startColumn","endLineNumber","endColumn","setMarker","new_puppy","trancepile","alwaysRun","_isLive","newpuppy","runPuppy","setPuppy","loadFile","path","fetch","method","then","ok","statusText","sample","fetchSetting","catch","fetchContent","fetchSample","sessionStorage","getItem","setPlaceholder","getState","num","startLineNum","endLineNum","deltaDecorations","Range","isWholeLine","get_course","forEach","all","setCources","HeaderContainer","connect","dispathch","defineTheme","inherit","rules","colors","editor.background","EditorFooter","Editor_jsxFileName","Button","setIsLive","Spinner","animation","index_es","icon","faPlay","setFontSize","faPlus","faMinus","resizeTimer","trancepileTimer","startTimer","Editor","editorOptions","selectOnLineNumbers","wordWrap","clearTimeout","setSize","lib_default","language","onChange","new_code","startNumber","changes","change","setDiffStartLineNumber","decos","findMatches","inlineClassName","checkZenkaku","setItem","editorDidMount","setCodeEditor","EditorContainer","ownProps","LineNumber","PuppyFooter","PuppyScreen_jsxFileName","faExpand","setIsCourseVisible","isCourseVisible","faBook","faBookOpen","timer","PuppyScreen","Fragment","PuppyScreenContainer","Course","visibility","Course_jsxFileName","Card","Row","faTimes","Col","faChevronLeft","faChevronRight","Body","dangerouslySetInnerHTML","__html","marked","CourseContainer","Input","Modal","centered","Input_jsxFileName","Form","onSubmit","InputGroup","FormControl","setValue","Append","InputContainer","Version","onHide","Version_jsxFileName","closeButton","Title","Footer","VersionContainer","App","qs","hash","App_jsxFileName","Container","containers_Header","containers_Input","containers_Version","containers_Course","containers_PuppyScreen","containers_Editor","queryParser","query","split","reduce","obj","ReactDOM","es","src_jsxFileName","react_router_dom","react_router","src_App","location","search"],"mappings":"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C5BC,YAAa1C,EAAQ0C,aAAe,EACpCC,SAAU3C,EAAQ2C,UAAY,EAC9BC,YAAa5C,EAAQ4C,aAAe,KACpCC,KAAM7C,EAAQ6C,MAAQ,GAElBhC,EAASlB,SAAckB,OAC3BqB,EAAK3G,GA/BU,IA+BL0G,GACVE,EAAK3H,EACLyH,EACAK,GAEIQ,EAAanD,aAAkB0C,OAAO,CAC1CU,OAAQ,CACN/B,EAAGkB,EAAK3G,GAtCK,IAsCA0G,GACbhB,EAAGkB,GAELa,MAAOnC,EACPoC,OAAQ,CACN7E,SAAS,EACT8E,UAAgC,EAArBlD,EAAQkD,UACnBC,YAAanD,EAAQmD,aAAe,UAGxCvD,EAAS,QAAYwC,EAAevB,GACpCjB,EAAS,cAAkBwC,EAAeU,GAI5C,OAFAM,QAAQC,IAAIjB,GACZgB,QAAQC,IAAIjB,EAAa,OAClBA,GAGIkB,GAAYC,IACvB1I,OAAOiG,OAAOyC,EAAM,CAClBC,OAAQ3C,EACR4C,UAAWvC,GACXwC,QAAStC,GACTuC,MAAOrC,GACPsC,KAAMzI,GACN0I,SAAU/B,KAELyB,GAgHF,MClbD1D,GAASF,SAETmE,GAAmB,CACvBC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,SAAU,CACR,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,YAAa,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,UAAW,CACT,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAISC,GAAqB3K,IAChC,MAAM4K,EACJ5K,KAAO0I,GACHA,GAAiB1I,GACjB0I,GACEjE,GAAOS,OAAO,CACZ,MACA,OACA,UACA,WACA,SACA,cACA,SACA,YACA,QACA,SACA,SACA,OACA,UACA,QACA,OACA,OACA,MACA,QACA,MACA,OACA,QACA,QACA,UACA,UACA,SACA,SACA,OACA,SACA,QACA,OACA,SACA,WAGJ2F,EACJC,SAASC,uBAAuB,OAElC,IAAK,IAAI5K,EAAI,EAAGA,EAAI0K,EAAQxF,OAAQlF,GAAK,EACvC0K,EAAQ1K,GAAG6K,MAAMC,gBAAkBL,EAAGzK,EAAIyK,EAAGvF,QAC7CwF,EAAQ1K,GAAG6K,MAAME,YAAcN,EAAGzK,EAAIyK,EAAGvF,QAE3C,OAAOuF,GCzeHO,GAAS5G,SACT6G,GAAS7G,SACT8G,GHVkBxD,KACtB,MAAMyD,EAAc,CAACzD,EAAQ0D,KAC3B,IAAIC,EAAQ3D,EAAO4D,SAASF,GAC5B,OAAIC,IAGJA,EAAQ3D,EAAO4D,SAASF,GAAa,IAAIG,MAEvCH,EAAUI,WAAW,YACrBJ,EAAUI,WAAW,aACrBJ,EAAUI,WAAW,UACrBJ,EAAUI,WAAW,KAErBH,EAAMtM,IAAMqM,EAEZC,EAAMtM,IAAN,UAAAY,OAAsByL,GAEjBC,IA8GT,OA3GA3D,EAAM,OAAa,SAASA,EAAQ+D,EAAQC,GAC1C,MAAMC,EAAID,EACJjH,EAAUiD,EAAOjD,QAEjBmH,EAAoBnH,EAAQmH,oBAAsBnH,EAAQoH,WAC1DC,EAAcrH,EAAQsH,MAAQ,oBAC9BC,EAAmBvH,EAAQwH,WAAa,OAE9C,IAAK,IAAIjM,EAAI,EAAGA,EAAIyL,EAAOvG,OAAQlF,GAAK,EAAG,CACzC,MAAMkM,EAAOT,EAAOzL,GACpB,GAAKkM,EAAKrJ,QAIV,IACE,IAAIsJ,EAAID,EAAKE,MAAMlH,OAAS,EAAI,EAAI,EACpCiH,EAAID,EAAKE,MAAMlH,OACfiH,GAAK,EACL,CACA,MAAME,EAAOH,EAAKE,MAAMD,GACxB,GAAKE,EAAKxJ,QAAV,CAOA,GAJqB,IAAjBwJ,EAAKC,UACPX,EAAEY,YAAcF,EAAKC,SAGnBD,EAAKhB,MAAO,CACd,MAAMmB,EAAUrB,EAAYzD,EAAQ2E,EAAKhB,OACzCM,EAAEc,UAAUJ,EAAK7G,SAASC,EAAG4G,EAAK7G,SAASE,GAC3CiG,EAAEe,OAAOL,EAAKM,OACdhB,EAAEiB,UACAJ,GACc,GAAdH,EAAKrN,OACU,GAAfqN,EAAKpN,OACLoN,EAAKrN,MACLqN,EAAKpN,QAEP0M,EAAEe,QAAQL,EAAKM,OACfhB,EAAEc,WAAWJ,EAAK7G,SAASC,GAAI4G,EAAK7G,SAASE,OACxC,CAEL,GAAI2G,EAAKQ,aACPlB,EAAEmB,YACFnB,EAAEoB,IACAV,EAAK7G,SAASC,EACd4G,EAAK7G,SAASE,EACd2G,EAAKQ,aACL,EACA,EAAIG,KAAKC,QAEN,CACLtB,EAAEmB,YACFnB,EAAEuB,OAAOb,EAAKc,SAAS,GAAG1H,EAAG4G,EAAKc,SAAS,GAAGzH,GAC9C,IAAK,IAAI0H,EAAI,EAAGA,EAAIf,EAAKc,SAASjI,OAAQkI,GAAK,GACxCf,EAAKc,SAASC,EAAI,GAAGC,YAAczB,EACtCD,EAAE2B,OAAOjB,EAAKc,SAASC,GAAG3H,EAAG4G,EAAKc,SAASC,GAAG1H,GAE9CiG,EAAEuB,OAAOb,EAAKc,SAASC,GAAG3H,EAAG4G,EAAKc,SAASC,GAAG1H,GAE5C2G,EAAKc,SAASC,GAAGC,aAAezB,GAClCD,EAAEuB,OACAb,EAAKc,UAAUC,EAAI,GAAKf,EAAKc,SAASjI,QAAQO,EAC9C4G,EAAKc,UAAUC,EAAI,GAAKf,EAAKc,SAASjI,QAAQQ,GAIpDiG,EAAE2B,OAAOjB,EAAKc,SAAS,GAAG1H,EAAG4G,EAAKc,SAAS,GAAGzH,GAC9CiG,EAAE4B,YAEC9I,EAAQoH,YASXF,EAAEhE,UAAY,EACdgE,EAAE/D,YAAc,OAChB+D,EAAE6B,WAVF7B,EAAEhH,UAAY0H,EAAK1H,UACf0H,EAAK1E,YACPgE,EAAEhE,UAAY0E,EAAK1E,UACnBgE,EAAE/D,YAAcyE,EAAKzE,YACrB+D,EAAE6B,UAEJ7B,EAAE8B,aAQalP,IAAf8N,EAAKpK,QAEHoK,EAAKqB,MACPrB,EAAKpK,MAAQoK,EAAKqB,OAEpB/B,EAAEgC,OACFhC,EAAEI,KAAOM,EAAKN,MAAQD,EACtBH,EAAEhH,UAAY0H,EAAKJ,WAAaD,EAChCL,EAAEiC,UAAYvB,EAAKuB,WAAa,SAC5BvB,EAAKwB,cACPlC,EAAEkC,YAAcxB,EAAKwB,YACrBlC,EAAEmC,WAAanC,EAAEmC,YAAc,EAC/BnC,EAAEoC,cAAgBpC,EAAEoC,eAAiB,EACrCpC,EAAEqC,cAAgBrC,EAAEqC,eAAiB,GAEvCrC,EAAEsC,SAAF,GAAAtO,OAAc0M,EAAKpK,OAASoK,EAAK7G,SAASC,EAAG4G,EAAK7G,SAASE,EAAI,IAC/DiG,EAAEuC,WAEJvC,EAAEY,YAAc,MAIf7E,GGrHMyG,CAAS/J,UAClBgK,GAAahK,aACbiK,GAAkBjK,kBAClBkK,GAAQlK,QACRmK,GAAQnK,QACRoK,GAASpK,SACTqK,GAAWrK,WACXsK,GAAWtK,WACXE,GAASF,SAuGR,MAAMuK,GAmBJC,YAAYC,EAAyBzO,EAAW0O,GAAY,GAAOC,KAlBlEF,cAkBkE,EAAAE,KAjBnE3O,UAiBmE,EAAA2O,KAhBnE/J,WAgBmE,EAAA+J,KAdnEC,cAcmE,EAAAD,KAbnEE,iBAamE,EAAAF,KAZnEG,iBAYmE,EAAAH,KAVlEI,YAUkE,EAAAJ,KATlEK,YASkE,EAAAL,KARlErH,YAQkE,EAAAqH,KAPlEM,YAOkE,EAAAN,KAHlE/G,UAGkE,EAAA+G,KAqXnEO,KAAO,EACZC,EACA9J,EACAC,EACAjB,KAEKA,EAAQe,WACXf,EAAQe,SAAW,CAAEC,IAAGC,MAE1B,MAAMwG,EAAoBqD,EAAKR,KAAMtK,GAErC,OADA8J,GAAMiB,IAAIT,KAAKK,OAAQpK,MAAO,CAACkH,IACxBA,IAhYiE6C,KAmYnE9G,OAAS,EAACxC,EAAWC,EAAWjB,IAC9BsK,KAAKO,KAAKP,KAAK/G,KAAL,OAAqBvC,EAAGC,EAAGjB,IApY4BsK,KAuYnE7G,UAAY,EAACzC,EAAWC,EAAWjB,IACjCsK,KAAKO,KAAKP,KAAK/G,KAAL,UAAwBvC,EAAGC,EAAGjB,IAxYyBsK,KA2YnE5G,QAAU,EAAC1C,EAAWC,EAAWjB,IAC/BsK,KAAKO,KAAKP,KAAK/G,KAAL,QAAsBvC,EAAGC,EAAGjB,IA5Y2BsK,KA+YnE3G,MAAQ,EAAC3C,EAAWC,EAAWjB,IAC7BsK,KAAKO,KAAKP,KAAK/G,KAAL,MAAoBvC,EAAGC,EAAGjB,IAhZ6BsK,KAmZnER,MAAQ,EAAC9I,EAAWC,EAAWjB,KACpC,GAAIsK,KAAKK,QAAUL,KAAK/J,MAAO,CAC7B+J,KAAK/J,MAAMyB,UAAYhB,EACvBsJ,KAAK/J,MAAMyK,WAAa/J,EACxB,MAAMgK,EAAMX,KAAK/J,MAAM2K,KAAKC,IAC5Bb,KAAK/J,MAAM2K,KAAO,CAChBC,IAAKF,EACLG,IAAK,CAAEpK,EAAGiK,EAAIjK,EAAIA,EAAGC,EAAGgK,EAAIhK,EAAIA,IAElCqJ,KAAKvL,OAAOuL,KAAKrH,OAAQjD,QAAQzF,MAAQ+P,KAAKrH,OAAQjD,QAAQxF,QAC9DiM,GAAM,OAAW6D,KAAKrH,OAAQqH,KAAK/J,MAAO2K,MACtClL,GACFnF,OAAOC,KAAKkF,GAAShF,IAAKI,IACpBkP,KAAK/J,OAASnF,KAAOkP,KAAK/J,QACjB,cAAPnF,IACFkP,KAAKrH,OAAQjD,QAAb,WAAqCA,EAAO,YAE9CsK,KAAK/J,MAAMnF,GAAO4E,EAAQ5E,IAExBkP,KAAKK,QAAUvP,KAAOkP,KAAKK,OAAOpK,QACpC+J,KAAKK,OAAOpK,MAAMnF,GAAO4E,EAAQ5E,SAtazCkP,KAAKF,SAAWA,EAChBE,KAAK3O,KAAOA,EACZ2O,KAAK/J,MAAQ,KACb+J,KAAKC,SAAW,IAChBD,KAAKE,YAAcH,EACnBC,KAAKG,aAAc,EACnBH,KAAKI,OAAS,KACdJ,KAAKK,OAAS,KACdL,KAAKrH,OAAS,KACdqH,KAAKM,OAAS,KACdN,KAAK/G,KAAO,GAGN8H,WACN,MAAM1P,EAAO2O,KAAK3O,KACZpB,EAAQoB,EAAK4E,MAAL,OAAuB,IAC/B/F,EAASmB,EAAK4E,MAAL,QAAwB,IACjC+K,EAAS3P,EAAK4E,MAAL,WAA2BhG,EACpCgR,EAAU5P,EAAK4E,MAAL,YAA4B/F,EACtCyQ,EAAqBtP,EAAK4E,MAAL,UAA0B,CAAES,EAAG,EAAGC,EAAG,GAChEqJ,KAAK3O,KAAOA,EACZ2O,KAAK/J,MAAQ,CACXhG,QACAC,SACAwH,UAAWsJ,EACXN,WAAYO,EACZC,WAAY7P,EAAK4E,MAAL,YAA4B,QACxCkL,QAAS9P,EAAK4E,MAAL,UAA0B,CAAES,EAAG,EAAKC,EAAG,GAChDT,YAAauF,GAAkBpK,EAAK4E,MAAL,aAA6B,IAC5DsH,QAASlM,EAAK4E,MAAL,SAAyB,EAClC+G,KAAM3L,EAAK4E,MAAL,MAAsB,oBAC5B2K,KAAMvP,EAAK4E,MAAL,MAAsB,CAC1B4K,IAAKF,EACLG,IAAK,CAAEpK,EAAGiK,EAAIjK,EAAIsK,EAAQrK,EAAGgK,EAAIhK,EAAIsK,IAEvCG,QAAS/P,EAAK4E,MAAL,SAAyB,KAClCoC,SAAUhH,EAAK4E,MAAL,UAA0B,GACpCoL,YAAahQ,EAAK4E,MAAL,aAA6B,IAC1CqL,eAAgBjQ,EAAK4E,MAAL,gBAAgC,GAChDsL,OAAQlQ,EAAK4E,MAAL,QAAwB,EAChCmC,YAAa/G,EAAK4E,MAAL,aAA6B,GAItCuL,YAGN,GAFAxB,KAAKK,OAASpE,GAAOlE,SAEjBiI,KAAK/J,MAAOkL,QAAS,CACvB,MAAMd,EAASL,KAAKK,OACpBoB,OAAOC,iBAAiB,oBAAqBC,IAC3C,MAAMC,EAAcH,OAAOG,aAAe,EACpCT,EAAUd,EAAOpK,MAAMkL,QACT,IAAhBS,GACFT,EAAQzK,EAAInB,GAAOsM,MAAMF,EAAMG,OAAS,GAAI,IAAM,GAClDX,EAAQxK,EAAIpB,GAAOsM,MAAMF,EAAMI,MAAQ,GAAI,IAAM,IACxB,MAAhBH,GACTT,EAAQzK,EAAInB,GAAOsM,MAAMF,EAAMG,OAAS,GAAI,IAAM,GAClDX,EAAQxK,EAAIpB,GAAOsM,OAAOF,EAAMI,MAAQ,GAAI,IAAM,IACzB,KAAhBH,GACTT,EAAQzK,EAAInB,GAAOsM,MAAMF,EAAMI,MAAQ,GAAI,IAAM,GACjDZ,EAAQxK,EAAIpB,GAAOsM,OAAOF,EAAMG,OAAS,GAAI,IAAM,KACzB,KAAjBF,IACTT,EAAQzK,EAAInB,GAAOsM,OAAOF,EAAMI,MAAQ,GAAI,IAAM,GAClDZ,EAAQxK,EAAIpB,GAAOsM,MAAMF,EAAMG,OAAS,GAAI,IAAM,MAIxDzM,SAAc2M,GAAGhC,KAAKK,OAAQ,eAAgB,KAC5C,MAAM4B,EAAOjC,KAAKK,OAAQ6B,OAAOC,UAC7BnC,KAAKF,SAASsC,YAChBpC,KAAKF,SAASsC,WAAWH,GAE3B,MAAMvF,EAASrH,YAAiBgN,UAAUrC,KAAKK,OAAQpK,OACvD,IAAK,IAAIhF,EAAI,EAAGA,EAAIyL,EAAOvG,OAAQlF,GAAK,EAAG,CACzC,MAAMkM,EAAoBT,EAAOzL,GAC7BkM,EAAI,MACNA,EAAI,KAASA,EAAM8E,MAIzB5M,SAAc2M,GAAGhC,KAAKK,OAAQ,kBAAmBsB,IAC/C,MAAMW,EAAQX,EAAMW,MACpB,IAAK,IAAIrR,EAAI,EAAGA,EAAIqR,EAAMnM,OAAQlF,GAAK,EAAG,CACxC,MAAMsR,EAAOD,EAAMrR,GACfsR,EAAKC,MAAL,iBACFD,EAAKC,MAAL,gBAA8BD,EAAKC,MAAOD,EAAK7J,OAE7C6J,EAAK7J,MAAL,iBACF6J,EAAK7J,MAAL,gBAA8B6J,EAAK7J,MAAO6J,EAAKC,UAIrDnN,SAAc2M,GAAGhC,KAAKK,OAAQ,iBAAkBsB,IAC9C,MAAMW,EAAQX,EAAMW,MACpB,IAAK,IAAIrR,EAAI,EAAGA,EAAIqR,EAAMnM,OAAQlF,GAAK,EAAG,CACxC,MAAMsR,EAAOD,EAAMrR,GACfsR,EAAKC,MAAL,gBACFD,EAAKC,MAAL,eAA6BD,EAAKC,MAAOD,EAAK7J,OAE5C6J,EAAK7J,MAAL,gBACF6J,EAAK7J,MAAL,eAA6B6J,EAAK7J,MAAO6J,EAAKC,UAIpDnN,SAAc2M,GAAGhC,KAAKK,OAAQ,eAAgBsB,IAC5C,MAAMW,EAAQX,EAAMW,MACpB,IAAK,IAAIrR,EAAI,EAAGA,EAAIqR,EAAMnM,OAAQlF,GAAK,EAAG,CACxC,MAAMsR,EAAOD,EAAMrR,GACfsR,EAAKC,MAAL,cACFD,EAAKC,MAAL,aAA2BD,EAAKC,MAAOD,EAAK7J,OAE1C6J,EAAK7J,MAAL,cACF6J,EAAK7J,MAAL,aAA2B6J,EAAK7J,MAAO6J,EAAKC,UAIlDxC,KAAKI,OAASlE,GAAOnE,OAAO,CAAE0K,SAAS,IAEvC,MAAMnC,EAAS1E,SAAS8G,eAAe1C,KAAKF,SAASQ,QACrD,IAAIqC,EAAerC,EAAQsC,YACvBC,EACDvC,EAAQsC,YAAc5C,KAAK/J,MAAO/F,OAAU8P,KAAK/J,MAAOhG,MACvD4S,EAAgBvC,EAAQwC,eAC1BD,EAAgBvC,EAAQwC,aACxBH,EACGrC,EAAQwC,aAAe9C,KAAK/J,MAAOhG,MAAS+P,KAAK/J,MAAO/F,QAE7D,MAAMyI,EAAS,CAGboK,QAASzC,EACTD,OAAQL,KAAKK,OACb3K,QAAS,CAEPzF,MAAO0S,EACPzS,OAAQ2S,EACR3B,WAAYlB,KAAK/J,MAAOiL,WACxBlE,KAAMgD,KAAK/J,MAAO+G,KAClBF,YAAY,IAGhBkD,KAAKrH,OAASwD,GAAOpE,OAAOY,GAC5BqH,KAAKM,OAASN,KAAKrH,OAAQ2H,OAE3BnE,GAAM,OAAW6D,KAAKrH,OAAQqH,KAAK/J,MAAO2K,MAE1C,MAAMoC,EAAQzD,GAAMxH,OAAOiI,KAAKrH,OAAQ2H,QAClC2C,EAAoB,CACxBxK,OAAQ,CAAE/B,EAAG,EAAGC,EAAG,GACnBuM,OAAQ,CAAExM,EAAG,EAAGC,EAAG,GACnBwM,UAAWnD,KAAK/J,MAAL,gBAAiC,GAE9CgN,OAA8B,CAC5BnP,SAAS,IAELsP,EAAkB9D,GAAgBvH,OAAOiI,KAAKK,OAAQ,CAC1D2C,QACAxK,WAAY6G,GAAWtH,OAAOkL,KAEhCzD,GAAMiB,IAAIT,KAAKK,OAAOpK,MAAOmN,GAC7BpD,KAAKrH,OAAL,MAAwBqK,EASxB3N,SAAc2M,GAAGoB,EAAiB,YAAazB,IAC7C,MAAMqB,EAAQrB,EAAMqB,MACpB,IAAI7F,EAAOwE,EAAM0B,WACjB,MAAM3G,EAASrH,YAAiBgN,UAAUrC,KAAKK,OAAQpK,OACvD,IAAK,IAAIhF,EAAI,EAAGA,EAAIyL,EAAOvG,OAAQlF,GAAK,EAEtC,GADAkM,EAAOT,EAAOzL,GAEZwO,GAAO6D,SAASnG,EAAKoG,OAAQP,EAAMvM,WACnCkJ,GAAS6D,WACPrG,EAAKjG,gBACLkM,EAAgBlM,iBAGlB,IACE,IAAImH,EAAIlB,EAAKE,MAAMlH,OAAS,EAAI,EAAI,EACpCkI,EAAIlB,EAAKE,MAAMlH,OACfkI,GAAK,EACL,CACA,MAAMf,EAAOH,EAAKE,MAAMgB,GACxB,GACEf,EAAI,SACJoC,GAAS4D,SAAShG,EAAKc,SAAU4E,EAAMvM,UACvC,CACA6G,EAAI,QAAYA,GAChB,UAOV0C,KAAK/G,KAAOD,GAAS,IAGrBkD,GAAOuH,IAAIzD,KAAKI,OAAQJ,KAAKK,QAC7BlE,GAAOsH,IAAIzD,KAAKrH,QAIX+K,UACD1D,KAAKK,SACPb,GAAMmE,MAAM3D,KAAKK,OAAOpK,OAAO,GAC/BgG,GAAO0H,MAAM3D,KAAKK,SAGhBL,KAAKI,QACPlE,GAAO0H,KAAK5D,KAAKI,QAEfJ,KAAKrH,SACPwD,GAAOyH,KAAK5D,KAAKrH,QACjBqH,KAAKrH,OAAO2H,OAAOuD,SAGnB7D,KAAKrH,OAAO4D,SAAW,IAMpBuH,UACL,OAAO9D,KAAK3O,KAGP0S,YACL,OAAO/D,KAAKM,OAGP7L,OAAOxE,EAAeC,GAE3B,IAAI8T,EAAI/T,EACJgU,EAAKhU,EAAQ+P,KAAK/J,MAAOyK,WAAcV,KAAK/J,MAAOyB,UACnDuM,EAAI/T,IACN+T,EAAI/T,EACJ8T,EAAK9T,EAAS8P,KAAK/J,MAAOyB,UAAasI,KAAK/J,MAAOyK,YAErDV,KAAKM,OAAQ4D,aAAa,QAASF,EAAEG,YACrCnE,KAAKM,OAAQ4D,aAAa,SAAUD,EAAEE,YAEtCnE,KAAKrH,OAAQjD,QAAQzF,MAAQ+T,EAC7BhE,KAAKrH,OAAQjD,QAAQxF,OAAS+T,EAGhCG,WAAkBC,SACV,IAAIC,QAAQC,GAAWC,WAAWD,EAASF,IAGnDD,iBAAwBnE,GACtB,KAAOD,KAAKE,mBACJF,KAAKyE,KAAKxE,GAElBD,KAAKI,OAAQsE,SAAU,EAGzBN,qBACE,MAAM3R,EAAsBkS,KAC5B3E,KAAKG,aAAc,EACnB,UAAW,MAAM7Q,KAAc0Q,KAAK3O,KAAKuT,KAAK5E,MAC5C,GAAI1Q,EAAamD,GAAuBoS,KACtC,IAAK,IAAI5T,EAAI,EAAGA,EAAI+O,KAAKC,SAAWD,KAAKI,OAAQ0E,MAAO7T,GAAK,EAC3D+O,KAAKK,OAASpE,GAAO8I,OAAO/E,KAAKK,YAAS7Q,OAAWA,QAGvDwV,GAAiB1V,EAAYA,SACvB0Q,KAAKiF,WAAW,WAChBjF,KAAKyE,KAAKzE,KAAKC,UAGzBD,KAAKG,aAAc,EACnB+E,KA2BKC,YACL,OAAOnF,KAAKI,QAAUJ,KAAKI,OAAOsE,QAG7BU,UACLpF,KAAKe,WACLf,KAAK0D,UACL1D,KAAKwB,YACLxB,KAAKI,OAAQsE,SAAW1E,KAAKE,YAC7BF,KAAKqF,eAkCAC,QACLtF,KAAKE,aAAc,EACnBF,KAAKI,OAAQsE,SAAU,EAGlBa,QACDvF,KAAKG,YACPH,KAAKE,aAAc,EAEnBF,KAAKI,OAAQsE,SAAU,EAIpBnN,eACL,OAAOyI,KAAKK,OAAQ6B,OAAOC,UAKtBqD,GAAGC,GACR,OAAOzF,KAAK3O,KAAKqU,MAAMD,GA8DzBrB,YAAmBuB,GACjB3F,KAAKI,OAAQsE,SAAU,EACvB,MAAMhO,QAAUkP,GAAcD,GAAY,IAI1C,OAHA3F,KAAKI,OAAQsE,SAAU,EACvB1E,KAAKiF,WAAW,KAChBnM,QAAQC,IAAR,SAAAnI,OAAqB8F,IACdA,EAGT0N,aAAoBtL,GAClBkH,KAAKI,OAAQsE,SAAU,EACvB,MAOMmB,EAAOjK,SAAS8G,eAAe,aAarCmD,EAAK9Q,YAAc+D,GAAoB,aACvC8C,SAAS8G,eAAe,aAAc5G,MAAMgK,QAAU,QACtD,MAAMpP,OAdIqP,WACR,MAAMC,EAASpK,SAASqK,cAAc,gBACtC,IAAIC,EAAO,GAOX,OANAtK,SAAS8G,eAAe,eAAgByD,QAAU,MAChDvK,SAAS8G,eAAe,aAAc5G,MAAMgK,QAAU,OACtDI,EAAOL,EAAK3S,MACZ2S,EAAK3S,MAAQ,UAdK8S,IACb,IAAI1B,QAAQC,IAEjB,MAAM6B,EAAW7B,EACjByB,EAAOtE,iBAAiB,QAAS0E,EAAU,CAAEC,MAAM,MAY/CC,CAAcN,GACbE,GAKOK,GAGhB,OAFAvG,KAAKI,OAAQsE,SAAU,EACvB1E,KAAKiF,WAAW,KACTvO,EAGF8P,MAAMX,EAAcnQ,EAAU,IACnC,MAAMzF,EAAQ+P,KAAK/J,MAAOhG,MACpB+H,EAAkBzC,GAAOkR,OAC7B,CACEC,MAAO,QACPxT,MAAK,GAAAtC,OAAKiV,GACVvO,QAAS0I,KAAKzI,eACdoP,KAAM,CAACxJ,EAAM8E,KACX,MAAM2E,EAAK3W,EAAQ,KAAOgS,EAAO9E,EAAI,SAAe,KACpD9H,OAAYwR,YAAY1J,EAAM,CAAEzG,EAAGkQ,EAAIjQ,EAAGwG,EAAK1G,SAASE,IACpDiQ,GAAM,GACRpH,GAAMqE,OAAO7D,KAAKK,OAAQpK,MAAOkH,KAIvCzH,GAEIgB,EAAIsJ,KAAK/J,MAAOhG,MAChB0G,EAAIqJ,KAAK/J,MAAO/F,QAA0B,GAAhB+N,KAAK6I,SAAiB,KACtD9G,KAAKO,KAAKP,KAAK/G,KAAL,MAAoBvC,EAAGC,EAAGqB,GAG/B+O,MAAMhO,GACXD,QAAQC,IAAIA,GAMPiO,QAAQtQ,EAAOC,GACpB,OAAOD,EAAE9F,OAAO+F,GAGXsQ,OAAOvQ,EAAGC,GACf,GAAiB,kBAAND,EAAgB,CACzB,IAAIwQ,EAAI,GACR,IAAK,IAAIjW,EAAI,EAAGA,EAAI0F,EAAG1F,GAAK,EAC1BiW,GAAKxQ,EAEP,OAAOwQ,EAET,GAAIpR,MAAMC,QAAQW,GAAI,CACpB,IAAI3H,EAAW,GACf,IAAK,IAAIkC,EAAI,EAAGA,EAAI0F,EAAG1F,GAAK,EAC1BlC,EAAIA,EAAE6B,OAAO8F,GAEf,OAAO3H,EAET,OAAO2H,EAAIC,EAGNwQ,MAAMzQ,EAAQ3H,GACnB,OAAOA,EAAEqY,QAAQ1Q,IAAM,EAKlB2Q,IAAI3Q,GACT,MAAiB,kBAANA,EACE,EAAJA,EAEQ,kBAANA,EACF4Q,OAAOC,SAAS7Q,GAER,mBAANA,EACFA,EAAI,EAAI,EAEN,EAAJA,EAGF8Q,MAAM9Q,GACX,MAAiB,kBAANA,EACFA,EAEQ,kBAANA,EACF4Q,OAAOG,WAAW/Q,GAEV,mBAANA,EACFA,EAAI,EAAM,EAEZA,EAGFgR,IAAIhR,GACT,MAAiB,mBAANA,EACFA,EAAI,OAAS,QAElBZ,MAAMC,QAAQW,GACT,IAAMA,EAAEhG,IAAIgG,GAAKsJ,KAAK0H,IAAIhR,IAAIiR,KAAK,MAAQ,IAEpD,GAAA/W,OAAU8F,GAGLkR,MAAMlR,EAAWC,EAAYkR,GAClC,IAAItC,EAAQ,EACRuC,EAAM,EACNC,EAAO,OACDvY,IAANmH,EACFmR,EAAMpR,OACSlH,IAANqY,GACTtC,EAAQ7O,EACRoR,EAAMnR,EACNoR,EAAa,IAANF,EAAU,EAAIA,IAErBtC,EAAQ7O,EACRoR,EAAMnR,GAER,MAAMqR,EAAe,GACrB,GAAIzC,GAASuC,EAAK,CACZC,EAAO,IACTA,GAAQA,GAEV,IAAK,IAAI9W,EAAIsU,EAAOtU,EAAI6W,IACtBE,EAAGC,KAAKhX,KACJ+W,EAAG7R,OAAS,MAFWlF,GAAK8W,QAO7B,CACDA,EAAO,IACTA,GAAQA,GAEV,IAAK,IAAI9W,EAAIsU,EAAOtU,EAAI6W,IACtBE,EAAGC,KAAKhX,KACJ+W,EAAG7R,OAAS,MAFWlF,GAAK8W,IAQpC,OAAOC,EAKFE,SAASnZ,EAAQoZ,GACtB,MAAiB,kBAANpZ,EACFA,EAAEqZ,QAAQD,EAAQpZ,EAAEoH,QAAUpH,EAAEoH,QAErCL,MAAMC,QAAQhH,GACTA,GAAGoZ,EAAQpZ,EAAEoH,QAAUpH,EAAEoH,aADlC,EAMKkS,MAAMtZ,EAAQ2H,EAAWC,GAC9B,MAAiB,kBAAN5H,QACAS,GAALmH,IACFA,EAAI5H,EAAEoH,QAEDpH,EAAEuZ,OAAO5R,EAAGC,EAAID,IAErBZ,MAAMC,QAAQhH,SACPS,GAALmH,IACFA,EAAI5H,EAAEoH,QAEDpH,EAAEsZ,MAAM3R,EAAGC,SAJpB,EAQK4R,KAAKrB,EAAWsB,GACrB,OAAOtB,EAAEE,QAAQoB,GAGZb,KAAKT,EAAWnW,GACrB,OAAOA,EAAK4W,KAAKT,GAIZuB,OAAOT,EAAWtR,GACvBsR,EAAGC,KAAKvR,GAGHgS,IAAIhS,GACT,OAAOA,EAAEP,OAGJzF,IAAIiY,EAAWC,GACpB,OAAO9S,MAAM+S,KAAKD,EAAKD,GAKlB9B,YAAY1J,EAAmBzG,EAAWC,GAC/CtB,OAAYwR,YAAY1J,EAAM,CAAEzG,IAAGC,MAG9BmS,WACL3L,EACAzG,EACAC,EACAoS,EACAC,GAEA3T,OAAYyT,WAAW3L,EAAM,CAAEzG,IAAGC,KAAK,CAAED,EAAGqS,EAAIpS,EAAGqS,IAG9CrL,OAAOR,EAAmBS,EAAeqL,EAAaC,GAC3D7T,OAAYsI,OAAOR,EAAMS,GAGpBuL,MACLhM,EACAiM,EACAC,EACAJ,EACAC,GAEA7T,OAAY8T,MAAMhM,EAAMiM,EAAIC,GAGvBC,SAASnM,EAAmBS,GACjCvI,OAAYiU,SAASnM,EAAMS,GAGtB2L,YAAYpM,EAAmBzG,EAAWC,GAC/CtB,OAAYkU,YAAYpM,EAAM,CAAEzG,IAAGC,MAG9B6S,mBAAmBrM,EAAmBsM,GAC3CpU,OAAYmU,mBAAmBrM,EAAMsM,GAGhCC,WAAWvM,EAAmBiE,GACnC/L,OAAYqU,WAAWvM,EAAMiE,GAGxBuI,QAAQxM,EAAmByM,GAChCvU,OAAYsU,QAAQxM,EAAMyM,GAGrBC,UAAU1M,EAAmB2M,GAClCzU,OAAYwU,UAAU1M,EAAM2M,IAMhC,IAAIC,GAAiB,CACnBzJ,OAAQ,eACR0J,OAASC,WCr1BNC,2SAWE,MAAMna,GAAW8E,IAAD,CACrBvD,KAAM4Y,GAAmBC,iBACzB3Y,QAAS,CACPqD,UAUExC,GAA6B,CACjCwC,MAAM,GAYOuV,OATQ,CAACxX,EAAQP,GAAcQ,KAC5C,OAAQA,EAAOvB,MACb,KAAK4Y,GAAmBC,iBACtB,8VAAOE,CAAA,GAAKzX,EAAZ,CAAmBiC,KAAMhC,EAAOrB,QAAQqD,OAC1C,QACE,OAAOjC,IC5Bb,MAAM0X,GAAcC,aAAgB,CAClCC,SACAla,SACA+D,QACAoW,QACAC,aAGWC,GAAQC,aAAYN,IAkBlBK,UCjCR,MAAME,GAQJhL,YAAYiL,EAAaC,EAAcC,EAAcC,GAAYjL,KAPjE8K,SAOiE,EAAA9K,KANjEkL,SAMiE,EAAAlL,KALjEmL,YAKiE,EAAAnL,KAJjE+K,UAIiE,EAAA/K,KAHjEgL,UAGiE,EAAAhL,KAFjEoL,WAEiE,EACtEpL,KAAK8K,IAAMA,EACX9K,KAAKkL,IAAMD,EACXjL,KAAKmL,OAAS,GACdnL,KAAK+K,KAAOA,EACZ/K,KAAKgL,KAAOA,EACZhL,KAAKoL,MAAQP,GAAUQ,QAKfC,MAAMJ,EAAaC,GAC3B,GAAiB,OAAbnL,KAAKkL,IAAc,CACrB,MAAME,EAA+B,GAErC,IADA,IAAIG,EAAevL,KAAKkL,IACP,OAAVK,GACLH,EAAMnD,KAAK,CAACsD,EAAMC,KAAMD,EAAMN,MAAMK,MAAMJ,EAAKC,KAC/CI,EAAQA,EAAME,KAEhBzL,KAAKoL,MAAQA,EAAMM,UAErB1L,KAAKkL,IAAMA,EACXlL,KAAKmL,OAASA,EAEd,IADA,IACSla,EAAI,EAAGA,EAAI+O,KAAKoL,MAAMjV,OAAQlF,GAAK,EAD/B+O,KAET/O,GAAK+O,KAAKoL,MAAMna,GAAG,GACI,KAArB+O,KAAKoL,MAAMna,GAAG,KAHP+O,KAIPA,KAAKoL,MAAMna,GAAG,IAAM+O,KAAKoL,MAAMna,GAAG,IAGxC,OAAO+O,KAGF2L,GAAGb,GACR,OAAO9K,KAAK8K,MAAQA,EAGfc,UACL,MAAoB,QAAb5L,KAAK8K,IAGPe,OACL,MAAMA,EAAoB,GAC1B,IAAK,IAAI5a,EAAI,EAAGA,EAAI+O,KAAKoL,MAAMjV,OAAQlF,GAAK,EAC1C4a,EAAK5D,KAAKjI,KAAKoL,MAAMna,GAAG,IAE1B,OAAO4a,EAGFlU,OACL,OAAOqI,KAAKoL,MAAMjV,OAGbmN,SAASkI,GACd,IAAK,IAAIva,EAAI,EAAGA,EAAI+O,KAAKoL,MAAMjV,OAAQlF,GAAK,EAC1C,GAAI+O,KAAKoL,MAAMna,GAAG,KAAOua,EAAM,OAAO,EAExC,OAAO,EAGFM,IAAI3D,GACT,OAAQnI,KAAamI,GAGhB4D,SAAS5D,EAAa6D,GAC3B,QAAcxc,IAAV2Y,EACF,OAAOnI,KAAKmL,OAAOc,UAAUjM,KAAK+K,KAAM/K,KAAKgL,MAE/C,MAAMC,EAASjL,KAAamI,GAC5B,YAAc3Y,IAAVyb,EACKe,GAAU,GAEZf,EAAMc,WAGPpL,IAAIA,GACV,MAAMuG,EAAIlH,KAAKmL,OACfxK,EAAM1C,KAAK4C,IAAIF,EAAKuG,EAAE/Q,QAGtB,IAFA,IAAI+V,EAAM,EACNC,EAAM,EACDlb,EAAI,EAAGA,GAAK0P,EAAK1P,GAAK,EACN,IAAnBiW,EAAEkF,WAAWnb,IACfib,GAAO,EACPC,EAAM,GAENA,GAAO,EAGX,MAAO,CAACxL,EAAKuL,EAAKC,GAGbE,QACL,OAAOrM,KAAKW,IAAIX,KAAK+K,MAGhBjD,MACL,OAAO9H,KAAKW,IAAIX,KAAK+K,MAGhB5U,SACL,OAAO6J,KAAKgL,KAAOhL,KAAK+K,KAGnB5G,WACL,MAAMmI,EAAe,GAErB,OADAtM,KAAKuM,OAAOD,GACLA,EAAG3E,KAAK,IAGP4E,OAAOD,GACfA,EAAGrE,KAAK,MACRqE,EAAGrE,KAAKjI,KAAK8K,KACb,IAAK,MAAM0B,KAAQxM,KAAKoL,MACtBkB,EAAGrE,KAAiB,KAAZuE,EAAK,GAAY,IAAjB,IAAA5b,OAA2B4b,EAAK,GAAhC,MACRA,EAAK,GAAGD,OAAOD,GAEjB,GAAyB,GAArBtM,KAAKoL,MAAMjV,OAAa,CAC1B,MAAM+Q,EAAIlH,KAAKmL,OAAOc,UAAUjM,KAAK+K,KAAM/K,KAAKgL,MAChDsB,EAAGrE,KAAK,MACRqE,EAAGrE,KAAKf,GACRoF,EAAGrE,KAAK,KAEVqE,EAAGrE,KAAK,MAlIC4C,GAiBJQ,QAAiC,GAqH1C,MAAMoB,GAKG5M,YAAY4L,EAAWD,EAAcP,GAAkBjL,KAJvDyL,UAIuD,EAAAzL,KAHvDwL,UAGuD,EAAAxL,KAFvDiL,WAEuD,EAC5DjL,KAAKyL,KAAOA,EACZzL,KAAKwL,KAAOA,EACZxL,KAAKiL,MAAQA,GAIjB,MAAMyB,GASG7M,YAAYqL,EAAaC,EAAgBxK,EAAaqK,GAAchL,KARpEkL,SAQoE,EAAAlL,KAPpEmL,YAOoE,EAAAnL,KANpEW,SAMoE,EAAAX,KALpEgL,UAKoE,EAAAhL,KAJpE2M,cAIoE,EAAA3M,KAHpE4M,SAGoE,EAAA5M,KAFpEpN,WAEoE,EAAAoN,KADpE6M,WACoE,EACzE7M,KAAKkL,IAAMA,EACXlL,KAAKmL,OAASA,EACdnL,KAAKW,IAAMA,EACXX,KAAKgL,KAAOA,EACZhL,KAAK2M,SAAWhM,EAChBX,KAAK4M,IAAM,KACX5M,KAAKpN,MAAQ,KACboN,KAAK6M,MAAQ,GACb,IAAK,IAAI5b,EAAI,EAAGA,EAAI,KAAMA,IACxB+O,KAAK6M,MAAM5E,KAAK,IAAI6E,KAK1B,MAQMC,GAAOnG,GACPA,EAAGjG,IAAMiG,EAAGoE,OACdpE,EAAGjG,KAAO,GACH,GAKLqM,GAAO,IACJD,GAGHE,GAASpH,IACb,MAAMqH,EAAcrH,EAAK1P,OAEzB,OAAQyQ,KACFA,EAAGuE,OAAO1O,WAAWoJ,EAAMe,EAAGjG,OAChCiG,EAAGjG,KAAOuM,GACH,IAkBPC,GAAa,CAACC,EAAoBxQ,KACtC,MACMxF,EAAO,IAAMwF,EAAI,EAAI,GAG3BwQ,EAJWxQ,EAAI,EAAK,IAIPxF,GAITiW,GAAS,CAACC,EAAeC,KAC7B,MAAMC,EAtBa,EAACF,EAAeC,KAEnC,IADA,IAAIlc,EAAO,EACFJ,EAAI,EAAGA,EAAIqc,EAAMnX,OAAQlF,GAAK,EACrCI,EAAO4M,KAAK6C,IAAIwM,EAAMlB,WAAWnb,GAAII,GAEvC,IAAK,MAAMuW,KAAS2F,EAClBlc,EAAO4M,KAAK6C,IAAI8G,EAAMwE,WAAW,GAAI/a,GACrCA,EAAO4M,KAAK6C,IAAI8G,EAAMwE,WAAW,GAAI/a,GAEvC,OAAOA,GAaSoc,CAAaH,EAAOC,GAAU,EACxCH,EAAS,IAAIM,WAAiC,GAApBF,EAAU,EAAK,IAC/CJ,EAAO,GAAK,EACZ,IAAK,IAAInc,EAAI,EAAGA,EAAIqc,EAAMnX,OAAQlF,GAAK,EACrCkc,GAAWC,EAAQE,EAAMlB,WAAWnb,IAEtC,IAAK,MAAM2W,KAAS2F,EAClB,IAAK,IAAI3Q,EAAIgL,EAAMwE,WAAW,GAAIxP,GAAKgL,EAAMwE,WAAW,GAAIxP,GAAK,EAC/DuQ,GAAWC,EAAQxQ,GAIvB,OAAQgK,IACN,GAAIA,EAAGjG,IAAMiG,EAAGoE,KAAM,CACpB,MAAMpO,EAAIgK,EAAGuE,OAAOiB,WAAWxF,EAAGjG,KAC5B8E,EAAK7I,EAAI,EAAK,EACdxF,EAAO,IAAMwF,EAAI,EAAI,GAC3B,GAAI6I,EAAI2H,EAAOjX,SAAWiX,EAAO3H,GAAKrO,KAAUA,EAE9C,OADAwP,EAAGjG,KAAO,GACH,EAGX,OAAO,IAILgN,GAASC,GACLhH,IAGN,IAFA,IAAIjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IACNgB,EAAMhH,IAAOA,EAAGjG,IAAMA,GAC3BA,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IAKX,OAHAhG,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,GACF,GAILiB,GAAUD,GACNhH,IACN,GAAIgH,EAAMhH,GAAK,CAGb,IAFA,IAAIjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IACNgB,EAAMhH,IAAOA,EAAGjG,IAAMA,GAC3BA,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IAKX,OAHAhG,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,GACF,EAET,OAAO,GAILkB,GAAQF,GACJhH,IACN,MAAMjG,EAAMiG,EAAGjG,IACf,QAAIiN,EAAMhH,KACRA,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,GACF,IAMPoN,GAAQH,GACJhH,IACN,MAAMjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IACf,OAAIgB,EAAMhH,KACRA,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,GACF,IAMPoB,GAAWJ,GACPhH,IACN,MAAMjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IAMf,OALKgB,EAAMhH,KACTA,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,IAEJ,GAILqB,GAAO,IAAIC,IACPtH,IACN,IAAK,MAAMgH,KAASM,EAClB,IAAKN,EAAMhH,GACT,OAAO,EAGX,OAAO,GAILuH,GAAQ,CACZP,EACAQ,IAEQxH,GACCgH,EAAMhH,IAAOwH,EAAOxH,GAIzByH,GAAQ,CACZT,EACAQ,EACAE,IAEQ1H,GACCgH,EAAMhH,IAAOwH,EAAOxH,IAAO0H,EAAO1H,GAIvC2H,GAAO,IAAIL,IACPtH,IACN,MAAMjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IACf,IAAK,MAAMgB,KAASM,EAAS,CAC3B,GAAIN,EAAMhH,GACR,OAAO,EAETA,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,EAEX,OAAO,GAIL4B,GAAQ,CACZZ,EACAQ,IAEQxH,IACN,MAAMjG,EAAMiG,EAAGjG,IACTiM,EAAMhG,EAAGgG,IACf,QAAIgB,EAAMhH,KAGVA,EAAG+F,SAAW1O,KAAK6C,IAAI8F,EAAGjG,IAAKiG,EAAG+F,UAClC/F,EAAGjG,IAAMA,EACTiG,EAAGgG,IAAMA,EACFwB,EAAOxH,KAIZ6H,GAAO,CAACC,EAAUC,IAClBD,EAAIC,GACCD,EAAIC,GAEL/H,GACC8H,EAAIC,GAAM/H,GAIrB,MAAMkG,GAEGjN,cAAcG,KADdlP,SACc,EACnBkP,KAAKlP,KAAO,GAIhB,MAAM8d,GAAQ,CACZhB,EACA9C,EACA+D,IAEQjI,IACN,MAAMjG,EAAMiG,EAAGjG,IAEf,OADAiG,EAAGgG,IAAM,OACLgB,EAAMhH,KACRA,EAAGgG,IAAM,IAAI/B,GAAUC,EAAKnK,EAAMkO,EAAOjI,EAAGjG,IAAKiG,EAAGgG,MAC7C,IASPkC,GAAQ,CAACtD,EAAcoC,IACnBhH,IACN,MAAMgG,EAAMhG,EAAGgG,IACf,QAAIgB,EAAMhH,KACRA,EAAGgG,IAAM,IAAIH,GAAMG,EAAKpB,EAAM5E,EAAGgG,MAC1B,IAMPmC,GAAQ,CACZvD,EACAoC,EACA9C,EACA+D,IAEQjI,IACN,MAAMjG,EAAMiG,EAAGjG,IAEf,OADAiG,EAAGgG,IAAM,IAAIH,GAAM,KAAMjB,EAAM5E,EAAGgG,OAC9BgB,EAAMhH,KACRA,EAAGgG,IAAM,IAAI/B,GAAUC,EAAKnK,EAAMkO,EAAOjI,EAAGjG,IAAKiG,EAAGgG,MAC7C,IAwBb,MAAMoC,GAIGnP,YAAYoP,EAAa/b,EAAYuY,GAAoBzL,KAHzDiP,SAGyD,EAAAjP,KAFzD9M,WAEyD,EAAA8M,KADzDyL,UACyD,EAC9DzL,KAAKiP,IAAMA,EACXjP,KAAK9M,MAAQA,EACb8M,KAAKyL,KAAOA,GAIhB,MAAMyD,GAAW,CAACtc,EAAqBqc,KACrC,KAAiB,OAAVrc,GAAgB,CACrB,GAAIA,EAAMqc,MAAQA,EAChB,OAAOrc,EAETA,EAAQA,EAAM6Y,KAEhB,OAAO,MAoBH0D,GAAUF,GACNrI,IACN,MAAMhU,EAAQsc,GAAStI,EAAGhU,MAAOqc,GACjC,QAAc,OAAVrc,IACEgU,EAAGuE,OAAO1O,WAAW7J,EAAMM,MAAO0T,EAAGjG,QACvCiG,EAAGjG,KAAQ/N,EAAMM,MAAiBiD,QAC3B,IAgBFiZ,GAAY7J,IACvB,MAAMqI,EAAQyB,GAAQ9J,GAKtB,YAJc/V,IAAVoe,IACF9U,QAAQC,IAAR,aAAAnI,OAAyB2U,IACzBzM,QAAQC,IAAI2V,KAEP,CAACvD,EAAgBzV,KACtB,MAEMkR,EAAK,IAAI8F,SAFQld,IAAZkG,EAAwB,GAAKA,GAGpC,KAAW,mBACbyV,EACA,EACAA,EAAOhV,QAST,OAPIyX,EAAMhH,GACO,OAAXA,EAAGgG,MACLhG,EAAGgG,IAAM,IAAI/B,GAAU,GATf,EASwBjE,EAAGjG,IAAK,OAG1CiG,EAAGgG,IAAM,IAAI/B,GAAU,MAAOjE,EAAG+F,SAAU/F,EAAG+F,SAAW,EAAG,MAEvD/F,EAAGgG,IAAItB,MAAM1E,EAAGsE,IAAKC,KAIhC,IAAIuD,GAAW,KAEf,MAAMW,GAAW9J,IACH,OAARmJ,MACFA,GAAM,IACH,OAAaL,GACdL,GAAQS,GAAKC,GAAK,QAClBE,GACEjB,GAAMQ,GAAMW,GAAM,GAAIL,GAAKC,GAAK,cAAeD,GAAKC,GAAK,SACzD,SACA,GAEFD,GAAKC,GAAK,QAEZA,GAAG,MAAYE,GAjDHhB,IACNhH,IACN,MAAMhU,EAAQgU,EAAGhU,MACX0c,EAAM1B,EAAMhH,GAElB,OADAA,EAAGhU,MAAQA,EACJ0c,GA6CLC,CACElB,GAjFQ,EAACY,EAAarB,IACpBhH,IACN,MAAMjG,EAAMiG,EAAGjG,IACf,QAAIiN,EAAMhH,KACRA,EAAGhU,MAAQ,IAAIoc,GAAMC,EAAKrI,EAAGuE,OAAOc,UAAUtL,EAAKiG,EAAGjG,KAAMiG,EAAGhU,QACxD,IA6EH4c,CAAQ,EAAGf,GAAKC,GAAK,WACrBF,GACEH,GACES,GAAM,GAAIL,GAAKC,GAAK,cACpBf,GAAMQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,gBAClDV,GAAQS,GAAKC,GAAK,SAEpBP,GAAMM,GAAKC,GAAK,KAAMZ,GAAKW,GAAKC,GAAK,UAEvCf,GACEQ,GACEgB,GAAO,GACPX,GACEH,GACES,GAAM,GAAIL,GAAKC,GAAK,cACpBf,GACEQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,gBAE9CV,GAAQS,GAAKC,GAAK,SAEpBP,GAAMM,GAAKC,GAAK,KAAMZ,GAAKW,GAAKC,GAAK,cAM/C,QACA,GAEFA,GAAG,UAAgBH,GACjBE,GAAKC,GAAK,aACVD,GAAKC,GAAK,cACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,UACVD,GAAKC,GAAK,WACVD,GAAKC,GAAK,aACVD,GAAKC,GAAK,UACVD,GAAKC,GAAK,SACVD,GAAKC,GAAK,SACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,WACVD,GAAKC,GAAK,eAEZA,GAAG,WAAiBF,GAClBI,GACEP,GACEF,GAAMlB,GAAM,UAAWwB,GAAKC,GAAK,MACjCI,GAAM,OAAQL,GAAKC,GAAK,SACxBV,GACEG,GACEA,GAAMlB,GAAM,MAAOwB,GAAKC,GAAK,MAC7BI,GAAM,QAASL,GAAKC,GAAK,YAI/B,aACA,GAEFE,GACEX,GACEE,GAAMlB,GAAM,QAASwB,GAAKC,GAAK,MAC/BI,GAAM,OAAQL,GAAKC,GAAK,SACxBP,GAAMlB,GAAM,UAAWwB,GAAKC,GAAK,MACjCI,GACE,QACAN,GACEI,GACET,GACEW,GAAM,GAAIL,GAAKC,GAAK,SACpBf,GACEU,GACEpB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,GAAIL,GAAKC,GAAK,YAI1B,GACA,GAEFE,GAAMT,GAAMlB,GAAM,KAAMwB,GAAKC,GAAK,MAAO,GAAI,MAInD,WACA,IAGJA,GAAG,UAAgBE,GACjBX,GACEhB,GAAM,SACNwB,GAAKC,GAAK,KACVD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,SACxBV,GACEC,GACEhB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,UAAWL,GAAKC,GAAK,SAC3BzB,GAAM,KACNwB,GAAKC,GAAK,OAGdzB,GAAM,KACNwB,GAAKC,GAAK,KACVF,GAAMM,GAAM,GAAIL,GAAKC,GAAK,UAAWI,GAAM,GAAIL,GAAKC,GAAK,gBAE3D,YACA,GAEFA,GAAG,SAAeE,GAChBX,GACEhB,GAAM,OACNwB,GAAKC,GAAK,KACVD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,SACxBI,GAAM,SAAUL,GAAKC,GAAK,eAC1BzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,gBAEpD,WACA,GAEFA,GAAG,WAAiBE,GAClBX,GACEQ,GAAKC,GAAK,OACVV,GAAQc,GAAM,GAAIL,GAAKC,GAAK,eAC5Bf,GAAMQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,gBAClDD,GAAKC,GAAK,QAEZ,YACA,GAEFA,GAAG,UAAgBE,GACjBT,GACEW,GAAM,OAAQL,GAAKC,GAAK,SACxBV,GACEK,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,KAAMI,GAAM,OAAQL,GAAKC,GAAK,YAG9D,QACA,GAEFA,GAAG,OAAaE,GACdX,GACEhB,GAAM,UACNe,GACEK,GACEI,GAAKC,GAAK,KACVD,GAAKC,GAAK,KACVI,GAAM,SAAUL,GAAKC,GAAK,mBAG9BzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,gBAEpD,WACA,GAEFA,GAAG,aAAmBE,GACpBT,GACEH,GAAQc,GAAM,GAAIL,GAAKC,GAAK,UAC5Bf,GAAMQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,YAEpD,QACA,GAEFA,GAAG,OAAaE,GACdT,GACElB,GAAM,UACNe,GACEK,GACEI,GAAKC,GAAK,KACVD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,kBAI9B,SACA,GAEFA,GAAG,MAAYE,GAAMT,GAAMlB,GAAM,SAAUwB,GAAKC,GAAK,MAAO,QAAS,GACrEA,GAAG,KAAWE,GAAMT,GAAMlB,GAAM,QAASwB,GAAKC,GAAK,MAAO,OAAQ,GAClEA,GAAG,MAAYE,GAAMT,GAAMlB,GAAM,SAAUwB,GAAKC,GAAK,MAAO,QAAS,GACrEA,GAAG,SAAeE,GAChBT,GAAMlB,GAAM,YAAawB,GAAKC,GAAK,MACnC,WACA,GAEFA,GAAG,OAAaE,GACdX,GACEE,GAAMlB,GAAM,MAAOwB,GAAKC,GAAK,MAC7BD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,eAClDV,GAAQc,GAAM,OAAQL,GAAKC,GAAK,eAChCV,GACEC,GACEO,GAAMW,GAAO,GAAIV,GAAKC,GAAK,OAC3BzB,GAAM,QACNwB,GAAKC,GAAK,KACVzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,kBAIxD,SACA,GAEFA,GAAG,UAAgBE,GAAMf,GAAOiB,GAAM,GAAIL,GAAKC,GAAK,cAAe,GAAI,GACvEA,GAAG,SAAeE,GAChBX,GACEO,GAAMW,GAAO,GAAIV,GAAKC,GAAK,OAC3BP,GAAMlB,GAAM,QAASwB,GAAKC,GAAK,MAC/BD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,gBAEpD,WACA,GAEFA,GAAG,QAAcE,GACfX,GACEE,GAAMlB,GAAM,OAAQwB,GAAKC,GAAK,MAC9BD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,SACxBP,GAAMlB,GAAM,MAAOwB,GAAKC,GAAK,MAC7BD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,gBAEpD,UACA,GAEFA,GAAG,UAAgBE,GACjBX,GACEE,GAAMlB,GAAM,SAAUwB,GAAKC,GAAK,MAChCD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQN,GAAMC,GAAKC,GAAK,SAAUD,GAAKC,GAAK,gBAEpD,YACA,GAEFA,GAAG,QAAcF,GACfI,GACEX,GACEa,GAAM,OAAQL,GAAKC,GAAK,aACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,gBAE3B,UACA,GAEFD,GAAKC,GAAK,eAEZA,GAAG,SAAeP,GAChBM,GAAKC,GAAK,QACVf,GACEa,GACEO,GACE,OACAV,GACEhB,GAAO,IAAK,IACZoB,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,UAE1B,UACA,GAEFK,GACE,OACAV,GACEI,GAAKC,GAAK,OACVI,GAAM,QAASL,GAAKC,GAAK,eACzBD,GAAKC,GAAK,QAEZ,YACA,MAKRA,GAAG,WAAiBE,GAClBP,GACES,GAAM,OAAQL,GAAKC,GAAK,aACxBI,GAAM,OAAQL,GAAKC,GAAK,iBACxBI,GAAM,QAASL,GAAKC,GAAK,gBAE3B,aACA,GAEFA,GAAG,aAAmBP,GACpBS,GACET,GACEI,GACEtB,GAAM,MACNA,GAAM,MACNA,GAAM,MACNA,GAAM,MACNI,GAAO,YAAa,KAEtBJ,GAAM,MAER,GACA,GAEFwB,GAAKC,GAAK,MAEZA,GAAG,WAAiBP,GAClBM,GAAKC,GAAK,YACVV,GACEe,GACE,OACAd,GACEhB,GAAM,MACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eACxBzB,GAAM,QACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,gBAE1B,SACA,KAINA,GAAG,SAAeP,GAChBM,GAAKC,GAAK,WACVf,GACEoB,GACE,OACAV,GACEI,GAAKC,GAAK,MACVD,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,aAE3B,KACA,KAINA,GAAG,GAASF,GAAMvB,GAAM,MAAOA,GAAM,OACrCyB,GAAG,QAAcP,GACfM,GAAKC,GAAK,WACVf,GACEoB,GACE,OACAV,GACEI,GAAKC,GAAK,OACVD,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,aAE3B,MACA,KAINA,GAAG,IAAUF,GAAMvB,GAAM,OAAQA,GAAM,OACvCyB,GAAG,QAAcF,GACfI,GACEP,GACEI,GAAKC,GAAK,OACVD,GAAKC,GAAK,KACVI,GAAM,GAAIL,GAAKC,GAAK,aAEtB,MACA,GAEFD,GAAKC,GAAK,WAEZA,GAAG,IAAUF,GAAML,GAAMlB,GAAM,OAAQwB,GAAKC,GAAK,MAAOzB,GAAM,MAC9DyB,GAAG,OAAaP,GACdM,GAAKC,GAAK,WACVf,GACEoB,GACE,OACAV,GACES,GAAM,OAAQF,GAAMH,GAAKC,GAAK,MAAO,OAAQ,IAC7CD,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,aAE3B,QACA,KAINA,GAAG,GAASH,GACVJ,GAAMlB,GAAM,MAAOc,GAAKd,GAAM,OAC9BkB,GAAMlB,GAAM,MAAOc,GAAKd,GAAM,OAC9BkB,GAAMlB,GAAM,MAAOc,GAAKd,GAAM,OAC9BkB,GAAMlB,GAAM,MAAOc,GAAKd,GAAM,OAC9BkB,GAAMlB,GAAM,KAAMc,GAAKd,GAAM,OAC7BkB,GAAMlB,GAAM,KAAMc,GAAKd,GAAM,OAC7BkB,GAAMlB,GAAM,MAAOwB,GAAKC,GAAK,MAC7BP,GAAMlB,GAAM,MAAOwB,GAAKC,GAAK,MAC7BP,GAAMlB,GAAM,UAAWwB,GAAKC,GAAK,OAEnCA,GAAG,QAAcP,GACfM,GAAKC,GAAK,YACVf,GACEoB,GACE,OACAV,GACES,GAAM,OAAQF,GAAMH,GAAKC,GAAK,OAAQ,OAAQ,IAC9CD,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,cAE3B,QACA,KAINA,GAAG,IAAUrB,GAAO,kBAAS,IAC7BqB,GAAG,SAAeP,GAChBM,GAAKC,GAAK,WACVf,GACEoB,GACE,OACAV,GACES,GAAM,OAAQF,GAAMH,GAAKC,GAAK,QAAS,OAAQ,IAC/CD,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,aAE3B,QACA,KAINA,GAAG,KAAWH,GACZtB,GAAM,MACNA,GAAM,MACNA,GAAM,MACNI,GAAO,gBAAW,KAEpBqB,GAAG,QAAcP,GACfM,GAAKC,GAAK,aACVf,GACEoB,GACE,OACAV,GACES,GAAM,OAAQF,GAAM3B,GAAM,MAAO,OAAQ,IACzCwB,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,eAE3B,QACA,KAINA,GAAG,UAAgBF,GACjBI,GACEP,GACES,GAAM,OAAQF,GAAMH,GAAKC,GAAK,OAAQ,OAAQ,IAC9CD,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,eAE1B,QACA,GAEFD,GAAKC,GAAK,eAEZA,GAAG,IAAUrB,GAAO,MAAO,IAC3BqB,GAAG,WAAiBP,GAClBM,GAAKC,GAAK,WACVf,GACEY,GACEQ,GACE,OACAd,GACEhB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,SACxBD,GAAKC,GAAK,OACVI,GAAM,SAAUL,GAAKC,GAAK,cAC1BD,GAAKC,GAAK,MACVD,GAAKC,GAAK,QAEZ,aACA,GAEFK,GACE,OACAV,GACEhB,GAAO,IAAK,IACZoB,GAAKC,GAAK,KACVI,GAAM,OAAQL,GAAKC,GAAK,UAE1B,UACA,GAEFK,GACE,OACAd,GACEQ,GAAKC,GAAK,OACVI,GAAM,SAAUL,GAAKC,GAAK,cAC1BD,GAAKC,GAAK,MACVD,GAAKC,GAAK,QAEZ,YACA,GAEFK,GACE,OACAd,GACEQ,GAAKC,GAAK,OACVV,GAAQc,GAAM,OAAQL,GAAKC,GAAK,gBAChCzB,GAAM,KACNwB,GAAKC,GAAK,KACVV,GAAQc,GAAM,QAASL,GAAKC,GAAK,gBACjCD,GAAKC,GAAK,QAEZ,QACA,GAEFK,GACE,OACAV,GACEI,GAAKC,GAAK,OACVI,GAAM,QAASL,GAAKC,GAAK,eACzBD,GAAKC,GAAK,QAEZ,YACA,MAKRA,GAAG,UAAgBE,GACjBP,GACEL,GAAQG,GAAMW,GAAM,GAAIL,GAAKC,GAAK,eAAgBX,GAAKd,GAAM,QAC7DU,GACEM,GACEhB,GAAM,KACNwB,GAAKC,GAAK,MACVI,GAAM,GAAIL,GAAKC,GAAK,eACpBX,GAAKd,GAAM,QAGfe,GAAQc,GAAM,GAAIL,GAAKC,GAAK,sBAE9B,YACA,GAEFA,GAAG,gBAAsBE,GACvBP,GACEL,GAAQG,GAAMlB,GAAM,KAAMwB,GAAKC,GAAK,QACpCI,GAAM,GAAIL,GAAKC,GAAK,aACpBf,GACEU,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,MAAOI,GAAM,GAAIL,GAAKC,GAAK,gBAG3D,OACA,GAEFA,GAAG,SAAeE,GAChBX,GACEa,GAAM,OAAQL,GAAKC,GAAK,SACxBzB,GAAM,KACNwB,GAAKC,GAAK,KACVI,GAAM,QAASL,GAAKC,GAAK,gBAE3B,WACA,GAEFA,GAAG,QAAcH,GACfE,GAAKC,GAAK,aACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,UACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,SAEZA,GAAG,UAAgBE,GACjBX,GACEQ,GAAKC,GAAK,OACVI,GAAM,GAAIL,GAAKC,GAAK,eACpBf,GAAMQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,iBAClDD,GAAKC,GAAK,MACVD,GAAKC,GAAK,QAEZ,QACA,GAEFA,GAAG,SAAeE,GAChBX,GACEQ,GAAKC,GAAK,OACVV,GACEG,GACEW,GAAM,GAAIL,GAAKC,GAAK,eACpBf,GAAMQ,GAAMM,GAAKC,GAAK,OAAQI,GAAM,GAAIL,GAAKC,GAAK,mBAGtDf,GAAMc,GAAKC,GAAK,QAChBD,GAAKC,GAAK,MACVD,GAAKC,GAAK,QAEZ,OACA,GAEFA,GAAG,SAAeE,GAChBX,GACEQ,GAAKC,GAAK,OACVI,GAAM,GAAIL,GAAKC,GAAK,aACpBf,GAAMQ,GAAMR,GAAMc,GAAKC,GAAK,QAASI,GAAM,GAAIL,GAAKC,GAAK,eACzDf,GAAMc,GAAKC,GAAK,QAChBD,GAAKC,GAAK,MACVD,GAAKC,GAAK,QAEZ,OACA,GAEFA,GAAG,SAAeE,GAChBP,GACES,GACE,OACAP,GACEE,GAAKC,GAAK,QACVD,GAAKC,GAAK,cACVD,GAAKC,GAAK,cAGdD,GAAKC,GAAK,OACVI,GAAM,QAASL,GAAKC,GAAK,gBAE3B,WACA,GAEFA,GAAG,KAAWF,GAAMC,GAAKC,GAAK,cAAeD,GAAKC,GAAK,cACvDA,GAAG,WAAiBP,GAClBS,GACET,GAAMd,GAAO,GAAI,CAAC,KAAM,OAAQM,GAAMN,GAAO,IAAK,CAAC,KAAM,KAAM,SAC/D,OACA,GAEFoB,GAAKC,GAAK,MAEZA,GAAG,UAAgBP,GACjBS,GACEf,GAAOU,GAAKE,GAAKC,GAAK,QAASD,GAAKC,GAAK,QAASD,GAAKC,GAAK,WAC5D,YACA,GAEFD,GAAKC,GAAK,MAEZA,GAAG,SAAeH,GAChBE,GAAKC,GAAK,gBACVD,GAAKC,GAAK,cACVD,GAAKC,GAAK,cACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,UACVD,GAAKC,GAAK,YACVD,GAAKC,GAAK,aACVD,GAAKC,GAAK,aAEZA,GAAG,aAAmBL,GACpBhB,GAAO,KAAM,IACbkB,GACEF,GACEpB,GAAM,OACN2B,GAAMjB,GAAMmB,GAAM,GAAIL,GAAKC,GAAK,oBAAqB,SAAU,GAC/DzB,GAAM,QAERoB,GACEpB,GAAM,KACN2B,GAAMjB,GAAMmB,GAAM,GAAIL,GAAKC,GAAK,oBAAqB,SAAU,GAC/DzB,GAAM,MAERoB,GACEpB,GAAM,OACN2B,GAAMjB,GAAMmB,GAAM,GAAIL,GAAKC,GAAK,qBAAsB,SAAU,GAChEzB,GAAM,QAERoB,GACEpB,GAAM,KACN2B,GAAMjB,GAAMmB,GAAM,GAAIL,GAAKC,GAAK,qBAAsB,SAAU,GAChEzB,GAAM,OAGVwB,GAAKC,GAAK,MAEZA,GAAG,eAAqBF,GACtBH,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,cAAezB,GAAM,MACjD2B,GACEjB,GAAMU,GAAMN,GAAKd,GAAM,QAASc,GAAKd,GAAM,MAAOD,OAClD,aACA,IAGJ0B,GAAG,eAAqBF,GACtBH,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,cAAezB,GAAM,MACjD2B,GACEjB,GAAMU,GAAMN,GAAKd,GAAM,MAAOc,GAAKd,GAAM,MAAOD,OAChD,aACA,IAGJ0B,GAAG,gBAAsBF,GACvBH,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,cAAezB,GAAM,MACjD2B,GACEjB,GAAMU,GAAMN,GAAKd,GAAM,QAASc,GAAKd,GAAM,MAAOD,OAClD,aACA,IAGJ0B,GAAG,gBAAsBF,GACvBH,GAAMpB,GAAM,KAAMwB,GAAKC,GAAK,cAAezB,GAAM,MACjD2B,GACEjB,GAAMU,GAAMN,GAAKd,GAAM,MAAOc,GAAKd,GAAM,MAAOD,OAChD,aACA,IAGJ0B,GAAG,WAAiBF,GAClBP,GACEhB,GAAM,MACN2B,GACEP,GACEpB,GAAM,KACNU,GACEY,GACEE,GAAKC,GAAK,UACVP,GAAMJ,GAAKV,GAAO,MAAO,KAAML,MAC/BmB,GAAMJ,GAAKd,GAAM,QAASA,GAAM,QAGpCA,GAAM,MAER,cACA,GAEFA,GAAM,MACNwB,GAAKC,GAAK,MAEZT,GACEhB,GAAM,MACN2B,GACEP,GACEpB,GAAM,KACNU,GACEY,GACEE,GAAKC,GAAK,UACVP,GAAMJ,GAAKV,GAAO,MAAO,KAAML,MAC/BmB,GAAMJ,GAAKd,GAAM,QAASA,GAAM,QAGpCA,GAAM,MAER,cACA,GAEFA,GAAM,MACNwB,GAAKC,GAAK,OAGdA,GAAG,WAAiBP,GAClBS,GACEP,GAAMpB,GAAM,KAAMU,GAAMc,GAAKC,GAAK,mBAAoBzB,GAAM,MAC5D,SACA,GAEFwB,GAAKC,GAAK,MAEZA,GAAG,SAAeP,GAChBS,GACEP,GAAMpB,GAAM,KAAMU,GAAMc,GAAKC,GAAK,iBAAkBzB,GAAM,MAC1D,OACA,GAEFwB,GAAKC,GAAK,MAEZA,GAAG,eAAqBF,GACtBC,GAAKC,GAAK,UACVP,GAAMJ,GAAKV,GAAO,QAAS,KAAML,OAEnC0B,GAAG,aAAmBF,GACpBC,GAAKC,GAAK,UACVP,GAAMJ,GAAKV,GAAO,QAAS,KAAML,OAEnC0B,GAAG,OAAaH,GACdJ,GAAMlB,GAAM,MAAOI,GAAO,aAAc,KACxCY,GACEhB,GAAM,MACNI,GAAO,GAAI,CAAC,OACZA,GAAO,GAAI,CAAC,OACZA,GAAO,GAAI,CAAC,QAEdgB,GAAMpB,GAAM,MAAOI,GAAO,GAAI,CAAC,OAAQA,GAAO,GAAI,CAAC,QACnDc,GAAMlB,GAAM,MAAOI,GAAO,GAAI,CAAC,QAC/BY,GACEhB,GAAM,MACNI,GAAO,KAAM,IACboB,GAAKC,GAAK,OACVD,GAAKC,GAAK,OACVD,GAAKC,GAAK,OACVD,GAAKC,GAAK,SAGdA,GAAG,QAAcP,GACfS,GACEL,GACEE,GAAKC,GAAK,WACVD,GAAKC,GAAK,eACVD,GAAKC,GAAK,UACVD,GAAKC,GAAK,UAEZ,MACA,GAEFD,GAAKC,GAAK,MAEZA,GAAG,QAAcF,GACfL,GAAMlB,GAAM,KAAMc,GAAKV,GAAO,QAAS,CAAC,SACxCc,GACEd,GAAO,GAAI,CAAC,OACZM,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,aAG7CA,GAAG,YAAkBT,GACnBhB,GAAM,KACNI,GAAO,KAAM,IACboB,GAAKC,GAAK,OACVf,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,UAE3CA,GAAG,OAAaT,GACdhB,GAAM,KACNI,GAAO,KAAM,IACbA,GAAO,KAAM,IACbM,GAAMQ,GAAMR,GAAMV,GAAM,MAAOI,GAAO,KAAM,OAE9CqB,GAAG,MAAYP,GACblB,GAAM,KACNU,GAAMQ,GAAMR,GAAMV,GAAM,MAAOI,GAAO,GAAI,CAAC,UAE7CqB,GAAG,MAAYrB,GAAO,GAAI,CAAC,OAC3BqB,GAAG,IAAUrB,GAAO,GAAI,CAAC,KAAM,KAAM,OACrCqB,GAAG,YAAkBrB,GAAO,KAAM,IAClCqB,GAAG,UAAgBP,GACjBS,GAAMH,GAAKC,GAAK,SAAU,SAAU,GACpCD,GAAKC,GAAK,MAEZA,GAAG,MAAYF,GACbL,GAAMM,GAAKC,GAAK,YAAaV,GAAQS,GAAKC,GAAK,cAC/CP,GAAMN,GAAOY,GAAKC,GAAK,UAAWD,GAAKC,GAAK,cAE9CA,GAAG,SAAeF,GAChBP,GACEF,GAAKd,GAAM,MACXU,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,WACzCzB,GAAM,KACNwB,GAAKC,GAAK,SACVf,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,YAE3CT,GACEQ,GAAKC,GAAK,SACVf,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,WACzCzB,GAAM,KACNc,GAAKd,GAAM,QAGfyB,GAAG,SAAeT,GAChBZ,GAAO,KAAM,IACbW,GAAQX,GAAO,KAAM,KACrBoB,GAAKC,GAAK,SACVf,GAAMQ,GAAMR,GAAMV,GAAM,MAAOwB,GAAKC,GAAK,YAE3CA,GAAG,OAAaF,GAAMC,GAAKC,GAAK,aAAcD,GAAKC,GAAK,YACxDA,GAAG,SAAeP,GAChBS,GAAMT,GAAMd,GAAO,KAAM,IAAKJ,GAAM,QAAS,WAAY,GACzDwB,GAAKC,GAAK,MAEZA,GAAG,UAAgBP,GACjBS,GAAMT,GAAMd,GAAO,KAAM,IAAKJ,GAAM,SAAU,YAAa,GAC3DwB,GAAKC,GAAK,MAEZA,GAAG,SAAeP,GAChBS,GAAMJ,GAAMvB,GAAM,QAASA,GAAM,SAAU,OAAQ,GACnDwB,GAAKC,GAAK,MAEZA,GAAG,IAAUX,GAAKf,MAClB0B,GAAG,GAASF,GAAMvB,GAAM,MAAOwB,GAAKC,GAAK,QACzCA,GAAG,EAAQrB,GAAO,0BAAiB,IACnCqB,GAAG,EAAQf,GACTY,GAAKE,GAAKC,GAAK,KAAMD,GAAKC,GAAK,gBAAiBD,GAAKC,GAAK,iBAE5DA,GAAG,GAASf,GACVY,GACEE,GAAKC,GAAK,KACVzB,GAAM,MACNwB,GAAKC,GAAK,gBACVD,GAAKC,GAAK,iBAGdA,GAAG,IAAUb,GACXU,GAAKE,GAAKC,GAAK,KAAMD,GAAKC,GAAK,gBAAiBD,GAAKC,GAAK,iBAE5DA,GAAG,aAAmBF,GACpBH,GAAMpB,GAAM,MAAOU,GAAMQ,GAAMJ,GAAKd,GAAM,OAAQD,OAAUC,GAAM,OAClEoB,GAAMpB,GAAM,MAAOU,GAAMQ,GAAMJ,GAAKd,GAAM,OAAQD,OAAUC,GAAM,QAEpEyB,GAAG,YAAkBP,GACnBlB,GAAM,KACNU,GAAMQ,GAAMJ,GAAKU,GAAKC,GAAK,OAAQ1B,QAErC0B,GAAG,IAAUL,GACXI,GAAKC,GAAK,KACVD,GAAKC,GAAK,MACVf,GAAMQ,GAAMM,GAAKC,GAAK,KAAMD,GAAKC,GAAK,SAExCA,GAAG,OAAaP,GAAMlB,GAAM,MAAOY,GAAOR,GAAO,MAAO,MACxDqB,GAAG,EAAQH,GACTE,GAAKC,GAAK,QACVD,GAAKC,GAAK,QACVD,GAAKC,GAAK,SACVD,GAAKC,GAAK,QACVrB,GAAO,GAAI,CAAC,eAAM,eAAM,kBAE1BqB,GAAG,KAAWrB,GAAO,GAAI,CAAC,iBAC1BqB,GAAG,KAAWrB,GAAO,GAAI,CAAC,iBAC1BqB,GAAG,MAAYrB,GAAO,2BAAQ,CAAC,eAAM,iBACrCqB,GAAG,KAAWrB,GAAO,SAAK,IAC1BqB,GAAG,EAAQrB,GAAO,2BAAQ,CAAC,eAAM,eAAM,eAAM,iBAC7CqB,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,OAC/CA,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,MAC/CA,GAAI,OAASP,GAAMd,GAAO,gBAAO,IAAKoB,GAAKC,GAAK,OAChDA,GAAI,OAASP,GAAMd,GAAO,gBAAO,IAAKoB,GAAKC,GAAK,MAChDA,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,OAC/CA,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,MAC/CA,GAAI,OAASL,GACXhB,GAAO,UAAM,IACbU,GAAKV,GAAO,UAAM,KAClBoB,GAAKC,GAAK,MAEZA,GAAI,OAASP,GAAMd,GAAO,gBAAO,IAAKoB,GAAKC,GAAK,MAChDA,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,MAC/CA,GAAI,OAASb,GAAOM,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,OACtDA,GAAI,OAASP,GAAMd,GAAO,UAAM,IAAKoB,GAAKC,GAAK,OAE1CA,GAAInJ,IC7+CPkK,GAAS,KAIf,MAAMC,GAEG7P,YAAY8P,GAAqB3P,KADjC2P,gBACiC,EACtC3P,KAAK2P,WAAaA,EAGbxL,WACL,MAAO,IAGFyL,QACL,OAAO5P,KAEF6P,QACL,OAAO,EAEFC,MAAM3H,GACX,OAAOnI,KAOF+P,OAAOC,EAAUjL,GACtB,OAAO,EAGFkL,WACL,OAAOjQ,KAGFkQ,YACL,OAAO,EAGFC,WACL,OAAO,EAGFC,UAAU1f,GACf,OAAOsP,MAIX,MAAMqQ,WAAiBX,GAGrB7P,YAAY8O,EAAcgB,GACxBW,WAAqB9gB,IAAfmgB,GADoC3P,KAFpC2O,UAEoC,EAE1C3O,KAAK2O,KAAOA,EAGPxK,WACL,OAAOnE,KAAK2O,KAGPoB,OAAOC,EAAUjL,GACtB,MAAMwL,EAAIP,EAAGC,WACb,OAAIM,aAAaF,GACRrQ,KAAK2O,OAAS4B,EAAE5B,KAErB4B,aAAaC,IACRD,EAAEE,KAAKzQ,KAAM+E,GAKjBmL,YACL,MAAqB,MAAdlQ,KAAK2O,MAA8B,MAAd3O,KAAK2O,KAG5BwB,WACL,MAAqB,MAAdnQ,KAAK2O,MAA8B,MAAd3O,KAAK2O,KAG5ByB,UAAU1f,GACf,GAAIsP,KAAKmQ,WAAY,CAKnB,YAHW3gB,IADAkB,EAAIsP,KAAK2O,QAElBje,EAAIsP,KAAK2O,MAAQ,IAAI6B,GAAQ9f,EAAIggB,IAAKhgB,EAAIigB,IAErCjgB,EAAIsP,KAAK2O,MAElB,OAAO3O,MAIX,MAAM4Q,WAAiBP,GACrBxQ,cACEyQ,MAAM,QAAQ,GAGTP,OAAOC,EAAUjL,GACtB,MAAMwL,EAAIP,EAAGC,WAIb,OAHIM,aAAaC,IACfD,EAAEE,KAAKzQ,KAAM+E,IAER,GA8BX,MAAM8L,WAAiBnB,GAErB7P,eAAeiR,GACbR,OAAM,GADsBtQ,KADtB8Q,WACsB,EAE5B9Q,KAAK8Q,MAAQA,EAGR3M,WACL,MAAM4M,EAAK,CAAC,KACZ,IAAK,IAAI9f,EAAI,EAAGA,EAAI+O,KAAK8Q,MAAM3a,OAAQlF,GAAK,EACtCA,EAAI,GACN8f,EAAG9I,KAAK,KAEV8I,EAAG9I,KAAKjI,KAAK8Q,MAAM7f,GAAGkT,YAIxB,OAFA4M,EAAG9I,KAAK,OACR8I,EAAG9I,KAAKjI,KAAK8Q,MAAM,GAAG3M,YACf4M,EAAGpJ,KAAK,IAGViI,QACL,OAAO5P,KAAK8Q,MAAM,GAEbjB,QACL,OAAO7P,KAAK8Q,MAAM3a,OAAS,EAEtB2Z,MAAM3H,GACX,OAAOnI,KAAK8Q,MAAM3I,EAAQ,GAGrB4H,OAAOC,EAAUjL,GACtB,MAAMwL,EAAIP,EAAGC,WACb,GAAIM,aAAaM,IAAY7Q,KAAK6P,SAAWU,EAAEV,QAC7C,IAAK,IAAI5e,EAAI,EAAGA,EAAI+O,KAAK8Q,MAAM3a,OAAQlF,GAAK,EAC1C,QAAK+O,KAAK8Q,MAAM7f,GAAG8e,OAAOQ,EAAEO,MAAM7f,GAAI8T,GAM1C,OAAIwL,aAAaC,IACRD,EAAEE,KAAKzQ,KAAM+E,GAKjBmL,YACL,IAAK,MAAMF,KAAMhQ,KAAK8Q,MACpB,GAAId,EAAGE,YAAa,OAAO,EAE7B,OAAO,EAGFC,WACL,IAAK,MAAMH,KAAMhQ,KAAK8Q,MACpB,GAAId,EAAGG,WAAY,OAAO,EAE5B,OAAO,EAGFC,UAAU1f,GACf,GAAIsP,KAAKmQ,WAAY,CACnB,MAAMI,EAAY,GAClB,IAAK,MAAMP,KAAMhQ,KAAK8Q,MACpBP,EAAEtI,KAAK+H,EAAGI,UAAU1f,IAEtB,OAAO,IAAImgB,MAAYN,GAEzB,OAAOvQ,MAIX,MAAMgR,WAAiBtB,GAErB7P,YAAYoR,EAAatB,GACvBW,WAAqB9gB,IAAfmgB,GADmC3P,KADnCiR,WACmC,EAEzCjR,KAAKiR,MAAQA,EAGR9M,WACL,cAAAvT,OAAeoP,KAAKiR,MAAM9M,WAA1B,KAGK0L,QACL,OAAO,EAEFC,MAAM3H,GACX,OAAOnI,KAAKiR,MAGPhB,WACL,MAAMiB,EAAIlR,KAAKiR,MAAMhB,WACrB,OAAIiB,IAAMlR,KAAKiR,MACN,IAAID,GAASE,GAEflR,KAGF+P,OAAOC,EAAUjL,GACtB,MAAMwL,EAAIP,EAAGC,WACb,OAAIM,aAAaS,GACXhR,KAAKiR,OAASE,IAGXnR,KAAKiR,MAAMlB,OAAOQ,EAAEU,MAAOlM,GAEhCwL,aAAaC,IACRD,EAAEE,KAAKzQ,KAAM+E,GAKjBmL,YACL,OAAOlQ,KAAKiR,MAAMf,YAGbC,WACL,OAAOnQ,KAAKiR,MAAMd,WAGbC,UAAU1f,GACf,OAAIsP,KAAKmQ,WACA,IAAIa,GAAShR,KAAKiR,MAAMb,UAAU1f,IAEpCsP,MAIX,MAAMoR,WAAkB1B,GAEtB7P,eAAeiR,GACbR,OAAM,GADsBtQ,KADtB8Q,WACsB,EAE5B9Q,KAAK8Q,MAAQA,EAGR3M,WACL,MAAM4M,EAAe,GACrB,IAAK,IAAI9f,EAAI,EAAGA,EAAI+O,KAAK8Q,MAAM3a,OAAQlF,GAAK,EACtCA,EAAI,GACN8f,EAAG9I,KAAK,KAEV8I,EAAG9I,KAAKjI,KAAK8Q,MAAM7f,GAAGkT,YAExB,OAAO4M,EAAGpJ,KAAK,IAEVkI,QACL,OAAO7P,KAAK8Q,MAAM3a,OAGb2Z,MAAM3H,GACX,OAAOnI,KAAK8Q,MAAM3I,GAGb4H,OAAOC,EAAUjL,GACtB,IAAK,MAAMsM,KAAOrR,KAAK8Q,MACrB,GAAIO,EAAItB,OAAOC,GAAI,GACjB,OAAO,EAIX,OADAlX,QAAQC,IAAR,QAAAnI,OAAoBof,EAApB,KAAApf,OAA0BoP,KAAKmE,cACxB,EAGF+L,YACL,OAAO,EAGFC,WACL,IAAK,MAAMH,KAAMhQ,KAAK8Q,MACpB,GAAId,EAAGG,WACL,OAAO,EAGX,OAAO,EAGFC,UAAU1f,GACf,GAAIsP,KAAKmQ,WAAY,CACnB,MAAMmB,EAAa,GACnB,IAAK,MAAMtB,KAAMhQ,KAAK8Q,MACpBQ,EAAGrJ,KAAK+H,EAAGI,UAAU1f,IAEvB,OAAO,IAAI0gB,MAAaE,GAE1B,OAAOtR,MAIX,MAAMuR,GAAQ,IAAIT,IACK,IAAjBA,EAAM3a,OACD2a,EAAM,GAER,IAAIM,MAAaN,GAGpBK,GAAO,IA7Nb,cAAsBd,GACpBxQ,YAAY8P,GACVW,MAAM,MAAOX,GAGRI,OAAOC,EAAUjL,GAEtB,QADUiL,EAAGC,qBACIW,IAMZV,YACL,OAAO,EAGFC,WACL,OAAO,EAGFC,UAAU1f,GACf,OAAO,IAAI8f,GAAQ9f,EAAIggB,IAAKhgB,EAAIigB,KAwM9Ba,GAAQ,IAAIZ,GACZa,GAAQ,IAAIpB,GAAS,QACrBqB,GAAO,IAAIrB,GAAS,UACpBsB,GAAQ,IAAItB,GAAS,UAAU,GAC/BuB,GAASF,GAETG,GAAU,IAAIxB,GAAS,UACvByB,GAAW,IAAIzB,GAAS,UAAU,GAClC0B,GAAK,IAAI1B,GAAS,KAClB2B,GAAS,IAAIhB,GAASe,IACtBE,GAAW,IAAIjB,GAASU,IACxBQ,GAAW,IAAIlB,GAASG,IACxBgB,GAAU,IAAI9B,GAAS,UAEvB+B,GAAO,IAAI/B,GAAS,OAIpBgC,GAA2B,GAE3BC,GAAW,CAACvjB,EAAawjB,EAAa3V,KAC1C,MAAM4V,EAAc,GACpB,IAAK,MAAMtjB,KAAMH,GACQ,IAAnByjB,EAAEpL,QAAQlY,IACZsjB,EAAEvK,KAAK/Y,GAGX,IAAK,MAAMA,KAAMqjB,GACQ,IAAnBC,EAAEpL,QAAQlY,IACZsjB,EAAEvK,KAAK/Y,GAGX,QAAUM,IAANoN,EACF,IAAK,MAAM1N,KAAMqjB,GACQ,IAAnBC,EAAEpL,QAAQlY,IACZsjB,EAAEvK,KAAK/Y,GAIb,OAAOsjB,GAGT,MAAMhC,WAAgBd,GAKpB7P,YAAY6Q,EAAU/R,GACpB2R,OAAM,GAD8BtQ,KAJ9ByS,YAI8B,EAAAzS,KAH9B0S,WAG8B,EAAA1S,KAF9BrB,SAE8B,EAEpCqB,KAAKyS,OAAS/B,EAAIiC,QAAQ,WAC1B3S,KAAK0S,MAAQ1S,KAAKyS,OAAOtc,OACzB6J,KAAKyS,OAAOxK,KAAKoK,IACjBrS,KAAKrB,IAAMA,EAGNwF,WACL,MAAMoM,EAAIvQ,KAAKyS,OAAOzS,KAAK0S,OAC3B,OAAInC,aAAab,GACRa,EAAEpM,WAEJ,MAGF8L,WACL,MAAMM,EAAIvQ,KAAKyS,OAAOzS,KAAK0S,OAC3B,OAAOnC,aAAab,GAAOa,EAAIvQ,KAG1B+P,OAAOC,EAAUjL,GACtB,IAAIwL,EAAIvQ,KAAKyS,OAAOzS,KAAK0S,OACzB,OAAInC,aAAab,IAAQa,IAAMvQ,KACtBuQ,EAAER,OAAOC,EAAIjL,GAEf/E,KAAKyQ,KAAKT,EAAGC,WAAYlL,GAG3B0L,KAAKT,EAAUjL,GACpB,MAAM6N,EAAK5C,EAAGC,WACd,GAAIlL,EAAQ,CACV,GAAI6N,aAAcpC,GAAS,CACzB,GAAIoC,EAAGF,QAAU1S,KAAK0S,MACpB,OAAO,EAET,MAAMG,EAAIP,GACRtS,KAAKyS,OAAOzS,KAAK0S,OACjB1S,KAAKyS,OAAOG,EAAGF,OACf,CAACE,EAAGF,MAAO1S,KAAK0S,QAElB,IAAK,MAAMxjB,KAAM2jB,EACf7S,KAAKyS,OAAOvjB,GAAM2jB,EAEpB,OAAO,EAET,IAAKD,EAAG1C,YAAa,CACnB,MAAM2C,EAAI7S,KAAKyS,OAAOzS,KAAK0S,OAC3B,IAAK,MAAMxjB,KAAM2jB,EACf7S,KAAKyS,OAAOvjB,GAAM0jB,EAEpB5S,KAAKyS,OAAOzS,KAAK0S,OAASE,GAG9B,OAAO,EAGFzC,WACL,OAAO,GAIX,MAAM2C,WAAmBpD,GAEvB7P,YAAYnK,GACV4a,OAAM,GADkBtQ,KADnBtK,aACmB,EAExBsK,KAAKtK,QAAUA,EAGVyO,WACL,OAAO4O,KAAKC,UAAUhT,KAAKtK,SAGtBqa,OAAOC,GAEZ,OADUA,EAAGC,qBACI6C,GAMZG,OAAOjD,EAAUjL,GACtB,OAAO/E,KAAK+P,OAAOC,GAGdE,YACL,OAAO,EAGFC,WACL,OAAO,EAGFC,UAAU1f,GACf,OAAOsP,MAIX,MAAMkT,GAKGrT,YAAYxO,EAAc2e,EAAUta,GAAesK,KAJnD3O,UAImD,EAAA2O,KAHnDgQ,QAGmD,EAAAhQ,KAFnDmT,UAAoB,EAE+BnT,KADnDoT,WAAqB,EAE1BpT,KAAK3O,KAAOA,EACZ2O,KAAKgQ,GAAKA,EAAGC,gBACGzgB,IAAZkG,IACFsK,KAAKmT,cAAgC3jB,IAArBkG,EAAQyd,UAAiCzd,EAAQyd,SACjEnT,KAAKoT,eACkB5jB,GAArBkG,EAAQ0d,WAAiC1d,EAAQ0d,WAGhDC,WACL,OAAqC,GAA9BrT,KAAK3O,KAAK+V,QAAQ,UAI7B,MAAMkM,GAAS,IAAIlC,GAAUS,GAASH,IAChC6B,GAAU,IAAIT,GAAW,IACzBU,GAAkB,IAAI3C,GAASe,GAAQA,IACvC6B,GAAuB,IAAI5C,GAASe,GAAQA,GAAQA,IACpD8B,GAAa,IAAI7C,GAASsB,GAAST,GAAMA,GAAM6B,IAE/CI,GAAc,CAClBC,GAAI,IAAIV,GAAO,UAAWtB,IAC1BiC,IAAK,IAAIX,GAAO,WAAYM,IAC5BM,IAAK,IAAIZ,GAAO,WAAYM,IAC5BO,IAAK,IAAIb,GAAO,WAAYM,IAC5BQ,KAAM,IAAId,GAAO,YAAaM,IAC9Bza,IAAK,IAAIma,GAAO,WAAYM,IAC5BS,MAAO,IAAIf,GAAO,aAAcM,IAEhCU,IAAK,IAAIhB,GAAO,WAAYO,IAC5BU,MAAO,IAAIjB,GAAO,aAAcO,IAChCW,IAAK,IAAIlB,GAAO,YAAaO,KAGzBY,GAAgB,CAGpB5J,MAAO,IAAIyI,GAAO,oBAAqB,IAAIrC,GAASgB,GAASC,KAC7DtL,MAAO,IAAI0M,GAAO,cAAe,IAAIrC,GAASW,GAAOL,GAAMoC,IAAU,CACnEJ,UAAU,IAIZzK,IAAK,IAAIwK,GAAO,UAAW,IAAIrC,GAASa,GAAMH,GAAMM,GAASG,MAE7DpK,MAAO,IAAIsL,GAAO,YAAa,IAAIrC,GAASoB,GAAUP,GAAMC,GAAOA,KAEnE2C,UAAW,IAAIpB,GAAO,aAAc,IAAIrC,GAASW,GAAOQ,GAAQD,KAGhE1K,IAAK,IAAI6L,GAAO,UAAW,IAAIrC,GAASa,GAAMH,GAAME,GAAOI,GAASH,MACpElK,MAAO,IAAI0L,GACT,YACA,IAAIrC,GAASe,GAAQL,GAAME,GAAOI,GAASH,MAE7ChK,IAAK,IAAIwL,GAAO,UAAW,IAAIrC,GAASgB,GAASV,MAuD7CoD,GAAe,CACnBC,KAAMb,GACN7M,OArDoB,CACpBA,OAAQ,IAAIoM,GAAO,cAAe,IAAIrC,GAASa,MAqD/C+C,SAlDsB,CAEtBjV,MAAO,IAAI0T,GAAO,cAAeQ,GAAY,CAAEP,UAAU,IACzDja,OAAQ,IAAIga,GAAO,eAAgBQ,GAAY,CAAEP,UAAU,IAC3Dha,UAAW,IAAI+Z,GAAO,kBAAmBQ,GAAY,CAAEP,UAAU,IACjE/Z,QAAS,IAAI8Z,GAAO,gBAAiBQ,GAAY,CAAEP,UAAU,IAC7D9Z,MAAO,IAAI6Z,GAAO,cAAeQ,GAAY,CAAEP,UAAU,IAKzDuB,eAAgB,IAAIxB,GAClB,kBACA,IAAIrC,GAASW,GAAOW,GAAST,GAAMA,KAErCiD,cAAe,IAAIzB,GACjB,iBACA,IAAIrC,GAASW,GAAOW,GAAST,GAAMA,GAAMA,GAAMA,KAEjDkD,UAAW,IAAI1B,GACb,aACA,IAAIrC,GAASW,GAAOW,GAAST,GAAMC,GAAOA,KAE5CkD,SAAU,IAAI3B,GACZ,YACA,IAAIrC,GAASW,GAAOW,GAAST,GAAMA,GAAMC,GAAOA,KAElDmD,YAAa,IAAI5B,GAAO,eAAgB,IAAIrC,GAASW,GAAOW,GAAST,KACrEqD,sBAAuB,IAAI7B,GACzB,yBACA,IAAIrC,GAASW,GAAOW,GAAST,KAE/BsD,cAAe,IAAI9B,GACjB,iBACA,IAAIrC,GAASW,GAAOW,GAAST,KAE/BuD,WAAY,IAAI/B,GAAO,cAAe,IAAIrC,GAASW,GAAOW,GAAST,KACnEwD,aAAc,IAAIhC,GAChB,gBACA,IAAIrC,GAASW,GAAOW,GAASV,KAE/B0D,eAAgB,IAAIjC,GAClB,kBACA,IAAIrC,GAASW,GAAOW,GAAST,OAU3B0D,GAAwB,GAEL,MACvB,IAAK,MAAMC,KAAW9kB,OAAOC,KAAK+jB,IAChC,IAAK,MAAM5F,KAAQpe,OAAOC,KAAK+jB,GAAQc,IACrCD,GAAiBzG,GAAQ0G,GAI/BC,GAEA,MAAMC,GAAW,CACftlB,MAAOyhB,GACPxhB,OAAQwhB,GACRhb,EAAGgb,GACH/a,EAAG+a,GACHpV,MAAOuV,GACPhZ,YAAaya,GACb1a,UAAW8Y,GACX9b,UAAW0d,GACXlb,YAAawZ,GACbhU,MAAOgU,GACPnb,SAAU2b,GACVxI,KAAM8H,GACNtQ,QAASsQ,GACT8D,KAAM9D,GACNrZ,SAAUuZ,GACVtQ,eAAgBsQ,GAChBvQ,YAAauQ,GACb6D,OAAQ7D,GACRzO,UAAWyO,GACX3a,SAAUwa,GACV5a,SAAU4a,GACViE,QAAS9D,GACT+D,GAAI,IAAI9E,GAASW,GAAOW,GAASA,IACjCyD,IAAK,IAAI/E,GAASW,GAAOW,GAASA,IAClC0D,KAAM,IAAIhF,GAASW,GAAOW,GAASA,IACnC2D,QAAS,IAAIjF,GAASW,GAAOW,IAC7BnV,KAAM6U,GACN3U,UAAWoW,GACXzU,UAAWgT,GACX3e,MAAOwe,GACPqE,QAASlE,IAMLmE,GAASzE,GAAMG,GAAMG,IAErBoE,GAAa,CACjBC,IAAK,KACLC,GAAI,KACJC,IAAK,IACLC,KAAM,IACNC,KAAM,IACNC,KAAM,IACNC,MAAO,KACPC,KAAM,IACNC,MAAO,KACPC,MAAO,KACPC,KAAM,IACNC,KAAM,IACNC,KAAM,KAGFC,GAAYC,IAChB,MAAMC,EAAMhB,GAAMe,GAClB,YAAYxnB,IAARynB,EACKA,EAEFD,GAGHE,GAAW,CACfC,IAAK5F,GAAMG,GAAMG,GAASK,IAC1BkF,IAAK1F,GACL2F,KAAM3F,GACN4F,IAAK/F,GAAMG,GAAMG,GAASK,IAC1BqF,IAAK7F,GACL8F,KAAM9F,GACN+F,IAAK/F,GACLgG,KAAMvG,GACNwG,KAAMxG,GACNwE,GAAIxE,GACJyG,IAAK5B,GACL6B,KAAM7B,GACN8B,IAAK9B,GACL+B,KAAM/B,GACNgC,IAAKtG,GACLuG,IAAKvG,GACLwG,IAAKxG,GACLyG,KAAMzG,GACN0G,KAAM1G,IAGF2G,GAASrB,IACb,MAAMhH,EAAMkH,GAAiBF,GAC7B,YAAWxnB,IAAPwgB,GACFlX,QAAQC,IAAR,oBAAAnI,OAAgComB,EAAhC,MACO7F,IAEFnB,GAGHsI,GAAS,CAACtB,EAAYhH,KAC1B,GAAU,MAANgH,EACF,OAAOzF,GAAM,IAAIP,GAAShB,GAAK6B,IAEjC,MAAM0G,EAAOrB,GAAiBF,GAC9B,OAAIuB,IAAQpH,IAAQoH,IAAQ7G,IAAe,MAAPsF,EAC3BuB,EAEFvI,GAgBHwI,GAAS,CAACtR,EAAWvG,EAAa8X,KACtC,MAAM3X,EAAM7C,KAAK4C,IAAIF,EAAM,EAAGuG,EAAE/Q,QAGhC,IAFA,IAAIuiB,EAAI,EACJ9b,EAAI,EACC3L,EAAI,EAAGA,EAAI6P,EAAK7P,GAAK,EACL,IAAnBiW,EAAEkF,WAAWnb,KACfynB,GAAK,EACL9b,EAAI,GAENA,GAAK,EAKP,OAHA6b,EAAK9X,IAAMA,EACX8X,EAAKvM,IAAMwM,EACXD,EAAKtM,IAAMvP,EACJ6b,GAGT,MAAME,GAKG9Y,YAAY6Q,GAAW1Q,KAJtB4Y,UAIsB,EAAA5Y,KAHtB6Y,YAGsB,EAAA7Y,KAFtB/G,UAEsB,EAC5B+G,KAAK/G,KAAO,QACAzJ,IAARkhB,GACF1Q,KAAK4Y,KAAO5Y,KACZA,KAAK6Y,OAAS,KACd7Y,KAAK/G,KAAK,WAAa,GACvB+G,KAAK/G,KAAK,SAAW,GACrB+G,KAAK/G,KAAK,UAAY,GACtB+G,KAAK/G,KAAK,WAAawW,KAEvBzP,KAAK4Y,KAAOlI,EAAIkI,KAChB5Y,KAAK6Y,OAASnI,GAIX5E,IAAIhb,EAAaoC,GAEtB,IADA,IAAI4lB,EAAgB9Y,KACP,OAAN8Y,GAAY,CACjB,MAAMvI,EAAIuI,EAAE7f,KAAKnI,GACjB,QAAUtB,IAAN+gB,EACF,OAAOA,EAETuI,EAAIA,EAAED,OAER,OAAO3lB,EAGF6lB,IAAIjoB,GACT,YAAyBtB,IAAlBwQ,KAAK8L,IAAIhb,GAGXkoB,IAAIloB,EAAaoC,GAEtB,OADA8M,KAAK/G,KAAKnI,GAAOoC,EACVA,EAGFyf,QAAQ7hB,EAAaoC,GAC1B,OAAO8M,KAAK4Y,KAAK3f,KAAKnI,IAAQoC,EAGzB+lB,QAAQnoB,EAAaoC,GAE1B,OADA8M,KAAK4Y,KAAK3f,KAAKnI,GAAOoC,EACfA,EAGFgmB,YAAYC,EAAUpoB,GAC3B,IAAK,MAAM4d,KAAQpe,OAAOC,KAAK2oB,QAEhB3pB,IAATuB,IAA8C,IAAxBA,EAAKqW,QAAQuH,KACrC3O,KAAK/G,KAAK0V,GAAQwK,EAAIxK,IAKrByK,UAAUzK,EAAcjZ,GAC7BsK,KAAKgZ,IAAIrK,EAAM,IAAIuE,GAAO,YAAa,IAAIJ,GAAWpd,KAGjD2jB,SAAS1K,GACd,MAAMzH,EAAIlH,KAAK8L,IAAI6C,GACnB,YACQnf,IAAN0X,GACW,cAAXA,EAAE7V,MACF6V,EAAE8I,cAAc8C,GAObwG,UAAUjE,EAAiB1G,GAChC,MAAMzH,EAAIlH,KAAK8L,IAAIuJ,GACnB,QACQ7lB,IAAN0X,GACW,cAAXA,EAAE7V,MACF6V,EAAE8I,cAAc8C,GAChB,CAEA,OADiB5L,EAAE8I,GAAkBta,QACtBiZ,IAKZ4K,OAAO5I,EAAc8H,GAC1B,MAAMe,EAAOxZ,KAAK4Y,KAAK3f,KAAK,SAI5B,QAHkBzJ,IAAdipB,EAAKnnB,OACPmnB,EAAKnnB,KAAO,cAEG9B,IAAbipB,EAAK9X,IAAmB,CAC1B,MAAMA,EAAMgQ,EAAEtE,QACdoM,EAAK9X,IAAMA,EAAI,GACf8X,EAAKvM,IAAMvL,EAAI,GACf8X,EAAKtM,IAAMxL,EAAI,QAEAnR,IAAbipB,EAAK/P,MACP+P,EAAK/P,IAAMiI,EAAE3F,KAAO2F,EAAE5F,MAExByO,EAAKvR,KAAKwQ,GAGL1R,MAAM4J,GACX,MAAM5J,EAAoB/G,KAAK2S,QAAQ,UACjCzjB,EAAK6X,EAAM5Q,OACXwK,EAAMgQ,EAAEtE,QAEd,OADAtF,EAAMkB,KAAK,CAACtH,EAAI,GAAIA,EAAI,GAAIA,EAAI,GAAIgQ,EAAE3F,KAAO2F,EAAE5F,OAC/C,UAAAna,OAAiB1B,GAGZuqB,YAEL,OADAzZ,KAAKgZ,IAAI,WAAW,IACb,EAGFU,SACL,OAA+B,IAAxB1Z,KAAK8L,IAAI,WAGX6N,QAAQC,GAEb,OADA5Z,KAAKgZ,IAAI,QAASY,GACXA,EAGFC,SACL,YAA6BrqB,IAAtBwQ,KAAK8L,IAAI,SAGXgO,UAAUnJ,EAAcoJ,GAC7B,GAAIA,EAAO5G,SAAU,CACnB,MAAMyG,EAAO5Z,KAAK8L,IAAI,SACtB,QAAatc,IAAToqB,EACFA,EAAI,UAAe,MACd,CACL,MAAMjZ,EAAM6X,GAAO7H,EAAExF,OAAQwF,EAAE5F,KAAM,CAAEzZ,KAAM,GAAIR,IAAK,KACtDkP,KAAKiZ,QAAQ,SAAUtY,EAAIuL,OAKzB8N,WAAW9S,GACjB,IAAK,IAAIjW,EAAI,EAAGA,EAAIiW,EAAE/Q,OAAQlF,GAAK,EACjC,GAAIiW,EAAEkF,WAAWnb,GAAK,IACpB,OAAO,EAGX,OAAO,EAGDgpB,MAAM/S,GACZ,GAAIlH,KAAKga,WAAW9S,GAAI,CACtB,MAAMxW,EAAMsP,KAAK2S,QAAQ,YACzB,QAAYnjB,IAARkB,EAEF,OADAsP,KAAKiZ,QAAQ,WAAY,IAClBjZ,KAAKia,MAAM/S,GAEpB,IAAIgT,EAAQxpB,EAAIie,MAChB,QAAcnf,IAAV0qB,EAAqB,CACvB,MAAMhrB,EAAKqB,OAAOC,KAAKE,GAAKyF,OAC5B+jB,EAAK,KAAAtpB,OAAQ1B,GACbwB,EAAIie,MAAQuL,EAEd,OAAOA,EAET,OAAOhT,EAGFiT,QAAQxL,EAAcqB,GAC3B,IAAI3e,EACF2O,KAAK6Z,UAAY7Z,KAAK0Z,SAAW1Z,KAAKia,MAAMtL,GAA5C,SAAA/d,OAA6D+d,EAA7D,MACF,MAAMoL,EAAS,IAAI7G,GAAO7hB,EAAM2e,GAEhC,OADA+J,EAAO3G,WAAY,EACZpT,KAAKgZ,IAAIrK,EAAMoL,GAGjBK,cAAcxE,GACnB,MAAMyE,EAAara,KAAK2S,QAAQ,eACbnjB,IAAf6qB,GAA6Bra,KAAK6Z,SAIpCjE,EAAI3N,KAAK,OAHT2N,EAAI3N,KAAJ,WAAArX,OAAoBypB,EAApB,QACAra,KAAKiZ,QAAQ,cAAUzpB,KAO7B,MAAM8qB,GACGza,gBAGT,MAAM0a,GAAc5J,GACXA,aAAa9F,GAAY8F,EAAE9E,OAAU,GAG9C,MAAM2O,GACG3a,eAEA4a,KAAK/J,EAAUC,EAAciF,GAClC9c,QAAQC,IAAI4X,EAAExM,YACdrL,QAAQC,IAAKiH,KAAa2Q,EAAE7F,MAC5B,IACE,OAAQ9K,KAAa2Q,EAAE7F,KAAK4F,EAAKC,EAAGiF,GACpC,MAAOkD,GACP,GAAIA,aAAawB,GACf,MAAMxB,EAER,QAA6BtpB,IAAxBwQ,KAAa2Q,EAAE7F,KAOlB,OALA4F,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,qBACL4pB,QAAS/J,EAAExM,aAENnE,KAAK2a,KAAKjK,EAAKC,EAAGiF,GAE3B,MAAMkD,GAIH6B,KAAKjK,EAAUC,EAAciF,GAClC,MAAM,IAAI0E,GAKLM,MACLC,EACAnK,EACAC,EACAiF,EACA6C,GAEA,MAAMzI,EAAKhQ,KAAKya,KAAK/J,EAAKC,EAAGiF,GAC7B,OAAIiF,EAAI9K,OAAOC,GAAI,GACVA,QAEIxgB,IAATipB,IACFA,EAAO,CACLnnB,KAAM,QACNR,IAAK,cAGT2nB,EAAKqC,QAAUD,EACfpC,EAAKsC,MAAQ/K,EACbU,EAAI6I,OAAO5I,EAAG8H,GACPzY,KAAK2a,KAAKjK,EAAKC,EAAGiF,IAGnBoF,YACNtK,EACAC,EACAqG,EACAiE,EACAC,EACA3C,EACA4C,EACAvF,GAEA,MAAW,OAAPoB,GAAsB,OAAPA,GACjBpB,EAAI3N,KAAJ,GAAArX,OAAYsqB,EAAZ,KAAAtqB,OAAoBomB,EAApB,MAAApmB,OAA2BuqB,IACpB1J,KAETwJ,EAAMA,EAAIhL,WACVsI,EAAMA,EAAItI,WACC,MAAP+G,EACEiE,IAAQvJ,IAAQ6G,IAAQ7G,IAC1BkE,EAAI3N,KAAJ,IAAArX,OAAasqB,EAAb,OAAAtqB,OAAuBuqB,EAAvB,MACOzJ,IAELuJ,EAAIlL,OAAOwI,GAAK,IAClB3C,EAAI3N,KAAJ,cAAArX,OAAuBsqB,EAAvB,KAAAtqB,OAA+BuqB,EAA/B,MACOF,IAETvK,EAAI6I,OAAO5I,EAAG,CACZ7f,IAAK,kBACL4pB,QAAS1D,EACT8D,QAASG,EACTF,MAAOxC,IAEFvY,KAAK2a,KAAKjK,EAAKC,EAAGiF,IAEhB,MAAPoB,EACEiE,IAAQvJ,IAAQ6G,IAAQ7G,IAC1BkE,EAAI3N,KAAJ,IAAArX,OAAasqB,EAAb,OAAAtqB,OAAuBuqB,EAAvB,MACOzJ,KAETkE,EAAI3N,KAAJ,cAAArX,OAAuBsqB,EAAvB,KAAAtqB,OAA+BuqB,EAA/B,MACIF,IAAQvJ,IAAQQ,GAASnC,OAAOwI,GAAK,GAAeA,GACpDA,IAAQ7G,IAAQQ,GAASnC,OAAOkL,GAAK,GAAeA,IAG/C,OAAPjE,GACFpB,EAAI3N,KAAJ,KAAArX,OAAcsqB,EAAd,KAAAtqB,OAAsBuqB,EAAtB,SACOzJ,IAEE,OAAPsF,GACFpB,EAAI3N,KAAJ,YAAArX,OAAqBsqB,EAArB,KAAAtqB,OAA6BuqB,EAA7B,MACOzJ,IAELuJ,EAAIlL,OAAOwI,GAAK,IAClB3C,EAAI3N,KAAJ,IAAArX,OAAasqB,EAAb,KAAAtqB,OAAqBomB,EAArB,KAAApmB,OAA2BuqB,EAA3B,MACKjE,GAAiBF,KAAQhB,GACrBvE,GAEFwJ,IAETvK,EAAI6I,OAAO5I,EAAG,CACZ7f,IAAK,kBACL4pB,QAAS1D,EACT8D,QAASG,EACTF,MAAOxC,IAEFvY,KAAK2a,KAAKjK,EAAKC,EAAGiF,KAGpBwF,IAAI1K,EAAUC,EAAciF,GAKjC,OAJAlF,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,gBAEA0gB,GAGF6J,SAAS3K,EAAUC,EAAciF,GACtC,MAAMjH,EAAOgC,EAAE5E,SAAS,QAClBoN,EAAM5E,GAAQ5F,GACpB,YAAYnf,IAAR2pB,GACFzI,EAAI6I,OAAO5I,EAAE7E,IAAI,QAAS,CACxBxa,KAAM,QACNR,IAAK,uBAEAkP,KAAK2a,KAAKjK,EAAKC,EAAGiF,KAE3BlF,EAAIwI,YAAYC,GACT3H,IAGF8J,WAAW5K,EAAUC,EAAciF,GACxC,MAAMjH,EAAOgC,EAAE5E,SAAS,QAClBwP,EAAQ5K,EAAE5E,SAAS,QAAS4C,GAC5BwK,EAAM5E,GAAQ5F,GACpB,YAAYnf,IAAR2pB,GACFzI,EAAI6I,OAAO5I,EAAE7E,IAAI,QAAS,CACxBxa,KAAM,QACNR,IAAK,uBAEAkP,KAAK2a,KAAKjK,EAAKC,EAAGiF,KAE3BlF,EAAI0I,UAAUmC,EAAOpC,GACd3H,IAGFgK,OAAO9K,EAAUC,EAAciF,GACpC,IAAK,MAAM6F,KAAWlB,GAAW5J,GAC/B,IACE,MAAM+K,EAAiB,GACvBA,EAAKzT,KAAKyI,EAAI5E,IAAI,YAClB9L,KAAKya,KAAK/J,EAAK+K,EAASC,GACxBhL,EAAI0J,cAAcsB,GAClB9F,EAAI3N,KAAKyT,EAAK/T,KAAK,KACnB,MAAOmR,GACP,KAAMA,aAAawB,IACjB,MAAMxB,EAIZ,OAAOtH,GAGFmK,MAAMC,EAAWjL,EAAciF,GACpC,MAAMiG,EAASD,EAAK9P,IAAI,WAClBgQ,EAASrM,GAASoM,EAClBnL,EAAM,IAAIiI,GAAIiD,GACpBlL,EAAIsI,IAAI,UAAW8C,GACnBlG,EAAI3N,KAAK,OACT,IAAK,MAAMwT,KAAWlB,GAAW5J,GAC/BiF,EAAI3N,KAAKyI,EAAI5E,IAAI,YACjB9L,KAAKya,KAAK/J,EAAK+K,EAAS7F,GACxBlF,EAAI0J,cAAcxE,GAGpB,OADAA,EAAI3N,KAAK4T,EAAS,KACXrK,GAGFuK,OAAOrL,EAAUC,EAAQiF,GAC9BA,EAAI3N,KAAK,MACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,SACT,MAAM+H,EAAKhQ,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,GAIrC,OAHAA,EAAI3N,KAAK,SACTjI,KAAK4a,MAAM5K,EAAIU,EAAKC,EAAC,KAAUiF,GAC/BA,EAAI3N,KAAK,MACF+H,EAGFgM,OAAOtL,EAAUC,EAAQiF,GAK9B,GAJAA,EAAI3N,KAAK,QACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,MACTjI,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,QACRpmB,IAAdmhB,EAAC,KACH,IAAK,MAAMsL,KAAQtL,EAAC,KAAS9E,OAC3B7L,KAAKya,KAAK/J,EAAKuL,EAAMrG,GAOzB,YAJkBpmB,IAAdmhB,EAAC,OACHiF,EAAI3N,KAAK,SACTjI,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,IAErBpE,GAGF0K,SAASxL,EAAUC,EAAQiF,GAKhC,OAJAA,EAAI3N,KAAK,aACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,MACTjI,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,GACnBpE,GAGF2K,QAAQzL,EAAUC,EAAQiF,GAO/B,MAAMjH,EAAOgC,EAAC,KAAS5E,WACjBiE,EAAK,IAAIQ,GAAQE,EAAKC,EAAC,MAC7BiF,EAAI3N,KAAJ,YAAArX,OAAqB+d,EAArB,SACA3O,KAAK4a,MAAM,IAAI5J,GAAShB,GAAKU,EAAKC,EAAC,KAAUiF,GAC7CA,EAAI3N,KAAK,KACT,MAAMmU,EAAO,IAAIzD,GAAIjI,GAIrB,OAHA0L,EAAK3C,YACL2C,EAAKjC,QAAQxL,EAAMqB,GACnBhQ,KAAKya,KAAK2B,EAAMzL,EAAC,KAAUiF,GACpBpE,GAGF6K,SAAS3L,EAAUC,EAAQiF,GAChC,MAAMjH,EAAOgC,EAAE5E,SAAS,QAClB+E,EAAQ,CAAC,IAAIN,GAAQE,EAAKC,EAAC,OAC3B2L,EAAkB,GAClBF,EAAO,IAAIzD,GAAIjI,GACf6L,EAAWH,EAAKzC,QAAQ,CAC5BhL,KAAMA,EACN6N,OAAQ1L,EAAM,GACd2L,WAAW,EACXtJ,UAAU,IAEZ,IAAK,MAAMjC,KAAKP,EAAC,OAAW9E,OAAQ,CAClC,MAAM6Q,EAAQxL,EAAEnF,SAAS,QACnB+D,EAAQ,IAAIU,GAAQE,EAAKQ,EAAC,MAC1B6I,EAASqC,EAAKjC,QAAQuC,EAAO5M,GACnCwM,EAAMrU,KAAK8R,EAAO1oB,MAClByf,EAAM7I,KAAK6H,GAEb,MAAM6M,EAAW,IAAI9L,MAAYC,GAC3BiJ,EAASrJ,EAAIyJ,QAAQxL,EAAMgO,GAC3BC,EAAQ7C,EAAO1G,WAAa,GAAK,OAQvC,OAPAuC,EAAI3N,KAAJ,GAAArX,OAAYgsB,GAAZhsB,OAAoBmpB,EAAO1oB,KAA3B,QAAAT,OAAsC0rB,EAAM3U,KAAK,MAAjD,UACA3H,KAAKya,KAAK2B,EAAMzL,EAAC,KAAUiF,GAC3BmE,EAAO5G,SAAWoJ,EAAQ,SACrBA,EAAQ,WACXzL,EAAM,GAAGf,OAAOyB,IAAO,GAEzB1Y,QAAQC,IAAR,WAAAnI,OAAuB+d,EAAvB,QAAA/d,OAAkC+rB,IAC3BnL,GAGFqL,SAASnM,EAAUC,EAAQiF,GAChC,MAAM9E,EAAQ,CAAC,IAAIN,GAAQE,EAAKC,IAC1B2L,EAAkB,GAClBF,EAAO,IAAIzD,GAAIjI,GACf6L,EAAWH,EAAKzC,QAAQ,CAC5B6C,OAAQ1L,EAAM,GACd2L,WAAW,IAEb,IAAK,MAAMvL,KAAKP,EAAC,OAAW9E,OAAQ,CAClC,MAAM6Q,EAAQxL,EAAEnF,SAAS,QACnB+D,EAAQ,IAAIU,GAAQE,EAAKQ,EAAC,MAC1B6I,EAASqC,EAAKjC,QAAQuC,EAAO5M,GACnCwM,EAAMrU,KAAK8R,EAAO1oB,MAClByf,EAAM7I,KAAK6H,GAEb,MAAM6M,EAAW,IAAI9L,MAAYC,GAMjC,OALA8E,EAAI3N,KAAJ,IAAArX,OAAa0rB,EAAM3U,KAAK,MAAxB,UACA3H,KAAKya,KAAK2B,EAAMzL,EAAC,KAAUiF,GACtB2G,EAAQ,WACXzL,EAAM,GAAGf,OAAOyB,IAAO,GAElBmL,EAGFG,OAAOpM,EAAUC,EAAQiF,GAC9B,IAAKlF,EAAImJ,SAMP,OALAnJ,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,UACNR,IAAK,iBACL4pB,QAAS,WAEJlJ,GAET,MAAM+K,EAAW7L,EAAI5E,IAAI,SAQzB,OAPAyQ,EAAQ,WAAgB,OACN/sB,IAAdmhB,EAAC,MACHiF,EAAI3N,KAAK,WACTjI,KAAK4a,MAAM2B,EAAQ,OAAY7L,EAAKC,EAAC,KAAUiF,IAE/CA,EAAI3N,KAAK,UAEJuJ,GAGFuL,SAASrM,EAAUC,EAAQiF,GAChC,OAAKlF,EAAIgJ,UAQT9D,EAAI3N,KAAK,YACFuJ,KARLd,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,UACNR,IAAK,aACL4pB,QAAS,aAEJlJ,IAMJwL,MAAMtM,EAAUC,EAAQiF,GAC7B,OAAKlF,EAAIgJ,UAQT9D,EAAI3N,KAAK,SACFuJ,KARLd,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,UACNR,IAAK,aACL4pB,QAAS,UAEJlJ,IAMJyL,KAAKvM,EAAUC,EAAQiF,GAC5B,OAAOpE,GAGF0L,QAAQxM,EAAUC,EAAQiF,GAC/B,MAAMsF,EAAOvK,EAAC,KACd,GAAiB,SAAbuK,EAAKpQ,IAAgB,CACvB,MAAM6D,EAAOuM,EAAKnP,WAClB,IAAIgO,EAASrJ,EAAI5E,IAAI6C,GACrB,QAAenf,IAAXuqB,GAAyBrJ,EAAImJ,UAAYE,EAAO1G,WAAa,CAC/D,MAAMrD,EAAK,IAAIQ,GAAQE,EAAKwK,GACtBiC,EAAiB,GACvBnd,KAAK4a,MAAM5K,EAAIU,EAAKC,EAAC,MAAWwM,GAEhC,MAAMC,GADNrD,EAASrJ,EAAIyJ,QAAQxL,EAAMqB,IACPqD,WAAa,GAAK,OAEtC,OADAuC,EAAI3N,KAAJ,GAAArX,OAAYwsB,GAAZxsB,OAAmBmpB,EAAO1oB,KAA1B,OAAAT,OAAoCusB,EAAKxV,KAAK,MACvC6J,IAGXb,EAAC,KAAS7F,IAAV,MAAAla,OAAsB+f,EAAC,KAAS7F,KAChC,MAAMkF,EAAKhQ,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,GAGrC,OAFAA,EAAI3N,KAAK,OACTjI,KAAK4a,MAAM5K,EAAIU,EAAKC,EAAC,MAAWiF,GACzBpE,GAGF6L,KAAK3M,EAAUC,EAAQiF,GAC5B,MAAMjH,EAAOgC,EAAE5E,WACTgO,EAASrJ,EAAI5E,IAAI6C,GACvB,YAAenf,IAAXuqB,GACFrJ,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,gBACL4pB,QAAS/L,IAEJ3O,KAAK2a,KAAKjK,EAAKC,EAAGiF,KAE3BA,EAAI3N,KAAK8R,EAAO1oB,MACT0oB,EAAO/J,IAGTsN,QAAQ5M,EAAUC,EAAQiF,GAC/B,MAAMjH,EAAOgC,EAAE5E,WACTgO,EAASrJ,EAAI5E,IAAI6C,GACvB,YAAenf,IAAXuqB,GACFrJ,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,gBACL4pB,QAAS/L,IAEJ3O,KAAK2a,KAAKjK,EAAKC,EAAGiF,IAEtBmE,EAAO3G,WAQZwC,EAAI3N,KAAK8R,EAAO1oB,MACT0oB,EAAO/J,KARZU,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,YACL4pB,QAAS/L,IAEJ3O,KAAK2a,KAAKjK,EAAKC,EAAGiF,IAMtB2H,IAAI7M,EAAUC,EAAQiF,GAI3B,OAHA5V,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,QACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,MAAWiF,GAC5BnE,GAGF+L,GAAG9M,EAAUC,EAAQiF,GAI1B,OAHA5V,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,QACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,MAAWiF,GAC5BnE,GAGFgM,IAAI/M,EAAUC,EAAQiF,GAI3B,OAHAA,EAAI3N,KAAK,MACTjI,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAE,GAAIiF,GAC7BA,EAAI3N,KAAK,KACFwJ,GAGFiM,MAAMhN,EAAUC,EAAQiF,GAC7B,MAAMoB,EAAKD,GAASpG,EAAE5E,SAAS,SACzBoR,EAAiB,GACjBzB,EAAiB,GACjBT,EAAMjb,KAAK4a,MAAMvC,GAAMrB,GAAKtG,EAAKC,EAAC,KAAUwM,GAC5C5E,EAAMvY,KAAK4a,MAAMtC,GAAOtB,EAAIiE,GAAMvK,EAAKC,EAAC,MAAW+K,GACzD,OAAO1b,KAAKgb,YACVtK,EACAC,EACAqG,EACAiE,EACAkC,EAAKxV,KAAK,IACV4Q,EACAmD,EAAK/T,KAAK,IACViO,GAIG+H,MAAMjN,EAAUC,EAAQiF,GAC7B,MAAMoB,EAAKrG,EAAE5E,SAAS,QACtB,MAAW,MAAPiL,GAAqB,QAAPA,GAChBpB,EAAI3N,KAAJ,GAAArX,OAAYomB,EAAZ,MACAhX,KAAK4a,MAAMnJ,GAAOf,EAAKC,EAAC,KAAUiF,GAClCA,EAAI3N,KAAK,KACFwJ,KAEPmE,EAAI3N,KAAJ,GAAArX,OAAYomB,EAAZ,MACAhX,KAAK4a,MAAMlJ,GAAMhB,EAAKC,EAAC,KAAUiF,GACjCA,EAAI3N,KAAK,KACFyJ,IAIJkM,UAAUlN,EAAUC,EAAQiF,GACjC,MAAMjH,EAAOgC,EAAE5E,SAAS,QAClBgO,EAASrJ,EAAI5E,IAAI6C,GACvB,QAAenf,IAAXuqB,EAAsB,CACxB,MAAM1E,EAAUD,GAAiBzG,GACjC,QAAgBnf,IAAZ6lB,EASF,OARAvc,QAAQC,IAAR,aAAAnI,OAAyBykB,EAAzB,SACA3E,EAAIwI,YAAY3E,GAAQc,IACxB3E,EAAI6I,OAAO5I,EAAC,KAAU,CACpBrf,KAAM,OACNR,IAAK,kBACL4pB,QAASrF,EACThkB,KAAI,QAAAT,OAAUykB,EAAV,eAECrV,KAAK6d,gBACVnN,EACAC,EACAD,EAAI5E,IAAI6C,QACRnf,EACAomB,GAIN,OAAO5V,KAAK6d,gBAAgBnN,EAAKC,EAAGoJ,OAAQvqB,EAAWomB,GAGjDiI,gBACNnN,EACAC,EACAoJ,EACA+D,EACAlI,GAEA,QAAepmB,IAAXuqB,EAMF,OALArJ,EAAI6I,OAAO5I,EAAC,KAAU,CACpBrf,KAAM,QACNR,IAAK,cACL4pB,QAAS/J,EAAC,KAAS5E,aAEd/L,KAAK2a,KAAKjK,EAAKC,EAAGiF,GAE3BA,EAAI3N,KAAK8R,EAAO1oB,MAChBukB,EAAI3N,KAAK,KACT,MAAM8V,EAAOpN,EAAC,OAAW9E,YACZrc,IAATsuB,GACFC,EAAKC,QAAQF,GAEf,IAAInB,EAAW5C,EAAO/J,GACtB,KAAM2M,aAAoB9L,IAMxB,OALAH,EAAI6I,OAAO5I,EAAC,KAAU,CACpBrf,KAAM,QACNR,IAAK,cACL4pB,QAAS/J,EAAC,KAAS5E,aAEd/L,KAAK2a,KAAKjK,EAAKC,EAAGiF,GAEvB+G,EAASxM,aACXwM,EAAWA,EAASvM,UAAU,CAAEM,MAAK/R,IAAKgS,KAI5C,IAAK,IAAI1f,EAAI,EAAGA,EAAI8sB,EAAK5nB,OAAQlF,GAAK,EAAG,CACvC,KAAMA,EAAI0rB,EAAS9M,SAAU,CAC3Ba,EAAI6I,OAAOwE,EAAK9sB,GAAI,CAClBK,KAAM,UACNR,IAAK,mBACL4pB,QAASqD,EAAK9sB,KAEhB,MAEEA,EAAI,GACN2kB,EAAI3N,KAAK,KAEX,MAAM+H,EAAK2M,EAAS7M,MAAM7e,GAC1B+O,KAAK4a,MAAM5K,EAAIU,EAAKqN,EAAK9sB,GAAI2kB,GAe/B,OAbImI,EAAK5nB,OAASwmB,EAAS9M,UACpB8M,EAAS7M,MAAMiO,EAAK5nB,SACvBua,EAAI6I,OACF5I,EAAC,KACD6H,GAAO7H,EAAExF,OAAQwF,EAAC,OAAW3F,KAAM,CACjC1Z,KAAM,QACNR,IAAK,wBAKb8kB,EAAI3N,KAAK,KACTyI,EAAIoJ,UAAUnJ,EAAGoJ,GACV4C,EAAS/M,QAGXqO,WAAWvN,EAAUC,EAAQiF,GAClC,MAAMkI,EAAOnN,EAAE5E,SAAS,QACxB,GAAI2E,EAAI2I,SAASyE,GAAO,CACtB,MAAM/D,EAASrJ,EAAI4I,UAAUwE,EAAMnN,EAAE5E,SAAS,SAC9C,OAAO/L,KAAK6d,gBAAgBnN,EAAKC,EAAGoJ,OAAQvqB,EAAWomB,GAEzD,MAAMsI,EAAU,IAAAttB,OAAO+f,EAAE5E,SAAS,SAC5BgO,EAASrJ,EAAI5E,IAAIoS,GACvB,OAAOle,KAAK6d,gBAAgBnN,EAAKC,EAAGoJ,EAAQpJ,EAAC,KAAUiF,GAIlDuI,WAAWzN,EAAUC,EAAQiF,GAClC,MAAM9K,EAAM6F,EAAC,KAAS7F,IAMtB,OALA6F,EAAC,KAAS7F,IAAV,MAAAla,OAAsBka,GACtB9K,KAAKya,KAAK/J,EAAKC,EAAC,KAAUiF,GAC1BA,EAAI3N,KAAK,OACT0I,EAAC,KAAS7F,IAAMA,EAChB9K,KAAK0d,MAAMhN,EAAKC,EAAGiF,GACZpE,GAGF4M,QAAQ1N,EAAUC,EAAQiF,GAC/B,MAAMkI,EAAOnN,EAAE5E,SAAS,QACxB,GAAI2E,EAAI2I,SAASyE,GAAO,CACtB,MAAM/D,EAASrJ,EAAI4I,UAAUwE,EAAMnN,EAAE5E,SAAS,SAE9C,OADA6J,EAAI3N,KAAK8R,EAAO1oB,MACT0oB,EAAO/J,GAEhB4F,EAAI3N,KAAK,YACTjI,KAAK4a,MAAMzI,GAASzB,EAAKC,EAAC,KAAUiF,GACpC,MAAMjH,EAAOgC,EAAE5E,SAAS,QAClBiE,EAAMuF,GAAiB5G,IAAS,IAAI6B,GAAQE,EAAKC,EAAC,MAExD,OADAiF,EAAI3N,KAAJ,KAAArX,OAAc+d,EAAd,KAAA/d,OAAsB8f,EAAI3J,MAAM4J,EAAC,MAAjC,MACOX,EAGFqO,WAAW3N,EAAUC,EAAQiF,GAClC,MAAMkI,EAAOnN,EAAE5E,SAAS,QACxB,GAAI2E,EAAI2I,SAASyE,GAMf,OALApN,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,YACL4pB,QAAS/J,EAAE5E,aAEN/L,KAAK2a,KAAKjK,EAAKC,EAAGiF,GAE3B,MAAMjH,EAAOgC,EAAE5E,SAAS,QACxB/L,KAAK4a,MAAMzI,GAASzB,EAAKC,EAAC,KAAUiF,GACpCA,EAAI3N,KAAJ,IAAArX,OAAa+d,IACb,MAAMqB,EAAMuF,GAAiB5G,IAAS,IAAI6B,GAAQE,EAAKC,EAAC,MACxD,OAAOX,aAAcoB,GAAYpB,EAAGF,MAAM,GAAKE,EAG1CsO,UAAU5N,EAAUC,EAAQiF,GACjCA,EAAI3N,KAAK,cACT,MAAM+H,EAAKhQ,KAAK4a,MACdrJ,GAAM,IAAIP,GAAS,IAAIR,GAAQE,EAAKC,IAAKkB,IACzCnB,EACAC,EAAC,KACDiF,GAKF,OAHAA,EAAI3N,KAAK,KACTjI,KAAK4a,MAAMlJ,GAAMhB,EAAKC,EAAC,MAAWiF,GAClCA,EAAI3N,KAAJ,GAAArX,OAAY8f,EAAI3J,MAAM4J,EAAC,OAAvB,MACOX,aAAcgB,GAAWhB,EAAGF,MAAM,GAAKE,EAGzCuO,aAAa7N,EAAUC,EAAQiF,GACpC,MAAM5F,EAAKhQ,KAAK4a,MAAM1I,GAAUxB,EAAKC,EAAC,KAAUiF,GAIhD,OAHAA,EAAI3N,KAAK,KACTjI,KAAK4a,MAAMlJ,GAAMhB,EAAKC,EAAC,MAAWiF,GAClCA,EAAI3N,KAAK,KACF+H,aAAcgB,GAAWhB,EAAGF,MAAM,GAAKE,EAGzCwO,KAAK9N,EAAUC,EAAciF,GAClCA,EAAI3N,KAAK,KACT,IAAK,MAAMO,KAAO+R,GAAW5J,GAC3B3Q,KAAKya,KAAK/J,EAAKlI,EAAKoN,GACpBA,EAAI3N,KAAK,KAGX,OADA2N,EAAI3N,KAAK,KACFsL,GAGFkL,SAAS/N,EAAUC,EAAQiF,GAChC,MAAMjH,EAAOgC,EAAE5E,SAAS,QACxB6J,EAAI3N,KAAJ,IAAArX,OAAa+d,EAAb,QACA,MAAMqB,EAAMuF,GAAiB5G,GAW7B,YAVWnf,IAAPwgB,GACFU,EAAI6I,OAAO5I,EAAC,KAAU,CACpBrf,KAAM,UACNR,IAAK,cACL4pB,QAAS/L,IAEX3O,KAAKya,KAAK/J,EAAKC,EAAC,MAAWiF,IAE3B5V,KAAK4a,MAAM5K,EAAIU,EAAKC,EAAC,MAAWiF,GAE3BpE,GAGFkN,MAAMhO,EAAUC,EAAciF,GACnC,MAAM/J,EAAO0O,GAAW5J,GACxB,GAAI9E,EAAK1V,OAAS,EAKhB,OAJAua,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,UACNR,IAAK,oBAEAkP,KAAK2e,KAAKjO,EAAKC,EAAGiF,GAE3B,GAAmB,GAAf/J,EAAK1V,OAAa,CACpByf,EAAI3N,KAAK,KACT,MAAM+H,EAAKhQ,KAAKya,KAAK/J,EAAK7E,EAAK,GAAI+J,GAEnC,OADAA,EAAI3N,KAAK,KACF+H,EAOT,OALA4F,EAAI3N,KAAK,SACTjI,KAAK4a,MAAMlJ,GAAMhB,EAAK7E,EAAK,GAAI+J,GAC/BA,EAAI3N,KAAK,SACTjI,KAAK4a,MAAMlJ,GAAMhB,EAAK7E,EAAK,GAAI+J,GAC/BA,EAAI3N,KAAK,KACFmK,GAGFuM,KAAKjO,EAAUC,EAAciF,GAClC,IAAI5F,EAAK,IAAIQ,GAAQE,EAAKC,GAC1BiF,EAAI3N,KAAK,KACT,IAAK,MAAMO,KAAO+R,GAAW5J,GAC3BX,EAAKhQ,KAAK4a,MAAM5K,EAAIU,EAAKlI,EAAKoN,EAAK,CACjCtkB,KAAM,QACNR,IAAK,kBAEP8kB,EAAI3N,KAAK,KAGX,OADA2N,EAAI3N,KAAK,KACF,IAAI+I,GAAShB,GAGf4O,OAAOlO,EAAUC,EAAciF,GACpC,IAAIhZ,EAAI,EACRgZ,EAAI3N,KAAK,KACT,IAAK,MAAM6Q,KAAKyB,GAAW5J,GAAI,CAI7B,GAHI/T,EAAI,GACNgZ,EAAI3N,KAAK,KAEG,eAAV6Q,EAAEhO,IACJ8K,EAAI3N,KAAJ,IAAArX,OAAakoB,EAAE/M,WAAf,UACK,CACL,MAAM2P,EAAiB,GACZ1b,KAAKya,KAAK/J,EAAKoI,EAAG4C,KAClB7J,GACT+D,EAAI3N,KAAKyT,EAAK/T,KAAK,KAEnBiO,EAAI3N,KAAJ,WAAArX,OAAoB8qB,EAAK/T,KAAK,IAA9B,MAGJ/K,IAGF,OADAgZ,EAAI3N,KAAK,KACF4J,GAGFgN,SAASnO,EAAUC,EAAciF,GAEtC,OADAA,EAAI3N,KAAK,QACFwJ,GAGFqN,UAAUpO,EAAUC,EAAciF,GAEvC,OADAA,EAAI3N,KAAK,SACFwJ,GAGFsN,IAAIrO,EAAUC,EAAciF,GAEjC,OADAA,EAAI3N,KAAK0I,EAAE5E,YACJ2F,GAGFsN,MAAMtO,EAAUC,EAAciF,GAEnC,OADAA,EAAI3N,KAAK0I,EAAE5E,YACJ6F,GAGFqN,OAAOvO,EAAUC,EAAciF,GAEpC,OADAA,EAAI3N,KAAK0I,EAAE5E,YACJ6F,GAGFsN,OAAOxO,EAAUC,EAAciF,GAEpC,OADAA,EAAI3N,KAAK0I,EAAE5E,YACJ8F,GAGFsN,KAAKzO,EAAUC,EAAciF,GAElC,OADAA,EAAI3N,KAAK0I,EAAE5E,YACJ8F,GAGFuN,YAAY1O,EAAUC,EAAciF,GAEzC,OADAA,EAAI3N,KAAK8K,KAAKC,UAAUD,KAAKsM,MAAM1O,EAAE5E,cAC9B8F,IAIX,MAAMyN,GAASlQ,GAAS,UAElBmQ,GAAarY,IACjB,MAAMyJ,EAAI2O,GAAOpY,GACXwJ,EAAM,IAAIiI,GAChBjI,EAAIwI,YAAY7E,IAChB,MACMuB,EAAgB,GAKtB,OANW,IAAI4E,IAEZC,KAAK/J,EAAKC,EAAGiF,GAGhB9c,QAAQC,IAAI2X,EAAI5E,IAAI,UACb8J,EAAIjO,KAAK,KAeL6X,GAAWtY,IAEtB,MAAMyJ,EAAI2O,GAAOpY,EAAEuY,QACb/O,EAAM,IAAIiI,GAChBjI,EAAIwI,YAAY7E,IAChB,MACMuB,EAAgB,IADX,IAAI4E,IAEZC,KAAK/J,EAAKC,EAAGiF,GAChB,MAAM8J,EAAS9J,EAAIjO,KAAK,IAClB/C,EAAI,uGAAAhU,OAKV8uB,EALU,aAQV,IAAIruB,EAAY,GAChB,IACEA,EAAO,IAAIsuB,SAAS/a,EAAb,GACP,MAAOkU,GACPpI,EAAI6I,OAAO5I,EAAG,CACZrf,KAAM,QACNR,IAAK,eACL4pB,QAAS5B,EAAE3U,aASf,OALA9S,EAAI,MAAY,GAChBA,EAAI,KAAWsf,EACftf,EAAI,KAAWquB,EACfruB,EAAI,OAAaqf,EAAI5E,IAAI,SAElBza,GAwBTyH,QAAQC,IACNwmB,GAAS,wEAYXzmB,QAAQC,IACNwmB,GAAS,8DC5vDX,MAAMK,GAAa,CACjBC,EACAxuB,KAEA,IAAIyuB,EAAc,EAClB,MAAMC,EAAoB,GAE1B,IAAK,MAAMjH,KAAKznB,EAAK2uB,OACJ,UAAXlH,EAAExnB,OACJwuB,GAAe,GAEjBC,EAAM9X,KAAK6Q,GAIb,OADA+G,EZsFwBrtB,KAAD,CACvBlB,KAAM5C,EAAkByE,WACxB3B,QAAS,CACPgB,QAASA,EAAQ9B,IAAIuvB,IAAM,CACzBC,SAAUtuB,EAAcquB,EAAO3uB,MAK/BiC,gBAAiB0sB,EAAO/T,IAAO,EAC/BiU,YAAaF,EAAO9T,IACpBiU,cAAeH,EAAO/T,IAAO,EAC7BmU,UAAWJ,EAAO9T,IAAO8T,EAAOvX,IAChCqN,QAASkK,EAAOnvB,UYnGXwvB,CAAUP,IACC,IAAhBD,GACFD,EAAS3tB,EAAS,QACX,IAET2tB,EAAS3tB,EAAS,WAEX,IAGT,IAAIquB,GAA0B,KAEvB,MAAMC,GAAcX,GAA6C,CACtExrB,EACAorB,EACAgB,EACA1gB,GAAY,EACZ2gB,GAAU,KAEV,MAAMrvB,EAAOmuB,GAAQ,CAAEC,WAYvB,OAXA3mB,QAAQC,IAAI1H,GACPuuB,GAAWC,EAAUxuB,KAIpBkvB,IACFA,GAAU7c,UAEZ6c,GL4yBoB,EACtBlsB,EACAhD,EACAovB,EACA1gB,GAAY,KAgBZ,GAda,MAAT1L,IACGosB,GAAapvB,GAIZgD,EAAM8Q,YASV9T,EAAM,CACK,MAATgD,GACFA,EAAMqP,UAER,MAAMid,EAAW,IAAI/gB,GAAMmK,GAAgB1Y,EAAM0O,GAEjD,OADA4gB,EAASvb,UACFub,EAET,OAAO,MKx0BOC,CAASvsB,EAAQhD,EAAMovB,EAAW1gB,GAC9C8f,EVrBqBxrB,KAAD,CACtB/C,KAAM4C,EAAiBS,UACvBnD,QAAS,CACP6C,WUkBSwsB,CAASN,MAEbA,IAmDHO,GAA8CC,GAC3CC,MAAMD,EAAM,CACjBE,OAAQ,QAEPC,KAAM5R,IACL,GAAIA,EAAI6R,GACN,OAAO7R,EAAIzJ,OAEb,MAAM,IAAI/T,MAAMwd,EAAI8R,cAErBF,KAAMG,GACEA,GAIAC,GAAgBzB,GAC3BkB,GAEAD,GAAQ,oBAAAlwB,OAAqBmwB,EAArB,kBACLG,KAAMha,GACE6L,KAAKsM,MAAMnY,IAEnBga,KAAM5wB,IACLuvB,EAASlsB,EAAUrD,MAEpBixB,MAAO5b,IACN7M,QAAQC,IAAR,OAAAnI,OAAmB+U,MAGZ6b,GAAgB3B,GAA6C,CACxE7rB,EACA+sB,IAEAD,GAAQ,oBAAAlwB,OAAqBoD,EAArB,KAAApD,OAAmCmwB,EAAnC,cAAoDG,KACzDztB,GAAoBosB,EAASrsB,EAAWC,KAGhCguB,GAAe5B,GAA6C,CACvExrB,EACAL,EACAhD,EACA+vB,KAEA,MAAMM,EAAS5f,OAAOigB,eAAeC,QAAtB,oBAAA/wB,OACOoD,EADP,KAAApD,OACqBmwB,EADrB,eAGXM,GACFxB,EAASzuB,EAAQiwB,IACjBb,GAAWX,EAAXW,CAAqBnsB,EAAOgtB,GAAQ,IAEpCP,GAAQ,oBAAAlwB,OAAqBoD,EAArB,KAAApD,OAAmCmwB,EAAnC,eAAqDG,KAC1DG,IACCxB,EAASzuB,EAAQiwB,IACjBb,GAAWX,EAAXW,CAAqBnsB,EAAOgtB,GAAQ,MAM/Bzb,GAAgBG,UAS3B,OAHA4E,GAAMkV,SAAS9vB,GAAQ,IACvB4a,GAAMkV,STjIuB9qB,KAAD,CAC5BzD,KAAMkD,EAAiBW,gBACvB3D,QAAS,CACPuD,iBS8Ha6sB,CAAejc,SANRK,IACb,IAAI1B,QAAQC,IACjByB,EAAOtE,iBAAiB,SAAU6C,EAAS,CAAE8B,MAAM,MAKjDC,CAAc1K,SAAS8G,eAAe,qBACrCiI,GAAMkX,WAAWpX,MAAMvX,OAGnB2R,GAAY,IAAM8F,GAAMkX,WAAWxtB,MAAMC,OAEzCqQ,GAAyB,KACpC,MAAMmd,EAAMnX,GAAMkX,WAAWrX,OAAO/X,oBACpC,OAAe,OAARqvB,EAAe,EAAIA,GAGf9c,GAAmB,CAAC+c,EAAsBC,KACrD,MAAM1vB,EAAaqY,GAAMkX,WAAWrX,OAAOlY,WACrCZ,EAAaiZ,GAAMkX,WAAWrX,OAAO9Y,WAC3CiZ,GAAMkV,SACJpuB,EACEa,EAAW2vB,iBAAiBvwB,EAAY,CACtC,CACEkW,MAAO,IAAIsa,QAAMH,EAAc,EAAGC,EAAY,GAC9CtsB,QAAS,CAAEysB,aAAa,EAAMlzB,UAAW,wBAOtCiW,GAAqB,KAChC,MAAM5S,EAAaqY,GAAMkX,WAAWrX,OAAOlY,WACrCZ,EAAaiZ,GAAMkX,WAAWrX,OAAO9Y,WAC3CiZ,GAAMkV,SAASpuB,EAAca,EAAW2vB,iBAAiBvwB,EAAY,OAG1D7C,GACXgxB,GACG,KACH,MAAMpvB,EAA2C,GAC3C2xB,EAA8B,GACpC,CAAC,QAAS,cAAe,YAAYC,QAAQtB,IAC3CqB,EAAWna,KACT6Y,GAAQ,oBAAAlwB,OAAqBmwB,EAArB,kBACLG,KAAMha,GACE6L,KAAKsM,MAAMnY,IAEnBga,KAAM5wB,IACLG,EAAQswB,GAAQzwB,OAIxBgU,QAAQge,IAAIF,GAAYlB,KAAK,IAAMrB,EXvLVpvB,KAAD,CAGxBa,KAAMqB,EAAkByB,YACxB5C,QAAS,CACPf,aWkL0C8xB,CAAW9xB,MCxM1C+xB,OALSC,YAVC7vB,IAAD,CACtBtC,OAAQsC,EAAMtC,OAAOA,OACrBG,QAASmC,EAAMtC,OAAOG,UAGIiyB,IAAD,CACzB7zB,aAAcA,GAAa6zB,GAC3B3yB,QAAU8E,GAAkB6tB,EAAU3yB,GAAQ8E,MAGxB4tB,CAGtBh0B,sJCPFoD,SAAoB8wB,YAAY,QAAS,CACvChtB,KAAM,KACNitB,SAAS,EACTC,MAAO,GACPC,OAAQ,CACNC,oBAAqB,aAIzB,MAcMC,GACJr0B,IAQA,OACEG,EAAAC,EAAAC,cAAA,OAAKE,GAAG,gBAARC,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QAAS,IAAMnB,EAAMw0B,WAAWx0B,EAAM2F,QAA9CnF,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,GACGb,EAAM2F,OACLxF,EAAAC,EAAAC,cAACo0B,GAAA,EAAD,CAASC,UAAU,OAAO1zB,QAAQ,QAAQgI,KAAK,KAA/CxI,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,IAEAV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMC,KAAvBr0B,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,IAED,SAEHV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QAhBK,KACfnB,EAAM80B,YAAY90B,EAAM4D,SAAW,IAejCpD,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMG,KAAvBv0B,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,KAEFV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QAhBM,KAChBnB,EAAM80B,YAAYxlB,KAAK6C,IAAI,GAAInS,EAAM4D,SAAW,KAe9CpD,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMI,KAAvBx0B,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,IAAAC,YAAAC,OAmCR,IAAIo0B,GACAC,GACAC,GAuHWC,OArHwBp1B,IACrC,MAAMq1B,EAAgB,CACpBC,qBAAqB,EACrB1xB,SAAU5D,EAAM4D,SAChB2xB,SAAU,MAGZxiB,iBAAiB,SAAU,KACzByiB,aAAaP,IACbA,GAAcpf,WAAW,WACvB7V,EAAMy1B,QACJxoB,SAAS8G,eAAe,aAAcE,YACtChH,SAAS8G,eAAe,aAAcI,eAEvC,OAGLlU,oBAAU,KACRD,EAAMy1B,QACJxoB,SAAS8G,eAAe,aAAcE,YACtChH,SAAS8G,eAAe,aAAcI,eAEvC,IAiEkB,OAEhBrG,WAAW,QAMhB,OACE3N,EAAAC,EAAAC,cAAA,OAAKE,GAAG,eAARC,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,KAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACq1B,GAAAt1B,EAAD,CACEkB,MAAOtB,EAAMsB,MACbC,OAAQvB,EAAMuB,OACdo0B,SAAS,SACTnyB,MAAOxD,EAAMwD,MACbe,MAAOvE,EAAM0C,KACbqE,QAASsuB,EACTO,SAnEe,CACnBC,EACA7iB,KAEA,IAAI8iB,EAAc91B,EAAM8D,oBACxBkP,EAAM+iB,QAAQh0B,IAAIi0B,IAChBF,EACkB,OAAhBA,EACIE,EAAO/c,MAAMrU,gBACb0K,KAAK4C,IAAI4jB,EAAaE,EAAO/c,MAAMrU,mBAEvB,OAAhBkxB,GACF91B,EAAMi2B,uBAAuBH,GAE/B91B,EAAMyC,QAAQozB,GACV71B,EAAM2D,YA5BUA,KACpB,MAGMuyB,EAHgBvyB,EACnBe,WACAyxB,YAtGL,g8BAsG0B,GAAM,GAAM,EAAO,MAAM,GACwBp0B,IACtEkd,IAAD,CACEhG,MAAOgG,EAAMhG,MACblS,QAAS,CAAEqvB,gBAAiB,mBAGhCp2B,EAAM8C,cAAca,EAAW2vB,iBAAiBtzB,EAAM+C,WAAYmzB,KAmBhEG,CAAar2B,EAAM2D,YAEjB3D,EAAM2F,SACJuvB,KACFM,aAAaN,IACbA,GAAkB,MASpBA,GAAkBrf,WAAW,KAC3B,CAACnQ,IACKyvB,KACFK,aAAaL,IACbA,GAAa,MAEfA,GAAatf,WAAW,KAClBnQ,GACFA,EAAMkR,QAER5W,EAAMi2B,uBAAuB,OAC5B,OAVL,CAWGj2B,EAAM6xB,WAAW7xB,EAAM0F,MAAOmwB,GAAU,GAAO,GAAM,IACxD/iB,OAAOigB,eAAeuD,QAAtB,eAAAr0B,OACiBjC,EAAMqF,WADvB,KAAApD,OACqCjC,EAAMqC,MACzCwzB,IAED,OAqBDU,eAdkB1a,IACtB7b,EAAMw2B,cAAc3a,IAKlBrb,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,KAAAC,YAAAC,IAUAV,EAAAC,EAAAC,cAACg0B,GAAD,CACES,YAAa90B,EAAM80B,YACnBlxB,SAAU5D,EAAM4D,SAChB4wB,UAAWx0B,EAAMw0B,UACjB7uB,OAAQ3F,EAAM2F,OAJhBnF,SAAA,CAAAC,SAAA6zB,GAAA3zB,WAAA,KAAAC,YAAAC,MCzJS41B,OALgB3C,YA/BP,CACtB7vB,EACAyyB,KAFsB,CAItBp1B,MAAO2C,EAAM4X,OAAOva,MACpBC,OAAQ0C,EAAM4X,OAAOta,OACrBoC,WAAYM,EAAM4X,OAAOlY,WACzBZ,WAAYkB,EAAM4X,OAAO9Y,WACzBS,MAAOS,EAAM4X,OAAOrY,MACpBI,SAAUK,EAAM4X,OAAOjY,SACvBlB,KAAMuB,EAAM4X,OAAOnZ,KACnBoB,oBAAqBG,EAAM4X,OAAO/X,oBAClC4B,MAAOzB,EAAMyB,MAAMA,MACnBC,OAAQ1B,EAAMyB,MAAMC,OACpBN,WAAYqxB,EAASrxB,WACrBhD,KAAMq0B,EAASr0B,OAGW6uB,IAAD,CACzBzuB,QAAUC,GAAiBwuB,EAASzuB,EAAQC,IAC5C+yB,QAAS,CAACn0B,EAAeC,IAAmB2vB,EfXvB,EAAC5vB,EAAeC,KAAhB,CACrBoB,KAAM5C,EAAkBoE,SACxBtB,QAAS,CACPvB,QACAC,YeOmDk0B,CAAQn0B,EAAOC,IACpEi1B,cAAgB7yB,GACdutB,EfiBFvtB,KAD2B,CAG3BhB,KAAM5C,EAAkBsE,eACxBxB,QAAS,CACPc,gBerBS6yB,CAAc7yB,IACzBb,cAAgBC,GAAyBmuB,EAASpuB,EAAcC,IAChE+xB,YAAclxB,GAAqBstB,Ef8BT3sB,KAAD,CACzB5B,KAAM5C,EAAkBuE,aACxBzB,QAAS,CACP0B,WejC0CuwB,CAAYlxB,IACxDqyB,uBAAyBU,GACvBzF,Ef4GmCtsB,KAAD,CACpCjC,KAAM5C,EAAkB4E,wBACxB9B,QAAS,CACP+B,qBe/GSqxB,CAAuBU,IAClCnC,UAAY7uB,GAAoBurB,EbIRvrB,KAAD,CACvBhD,KAAM4C,EAAiBU,WACvBpD,QAAS,CACP8C,YaPuC6uB,CAAU7uB,IACnDksB,WAAYA,GAAWX,KAGM4C,CAG7BsB,oGC7BF,MAAMwB,GAA2C52B,IAqB/C,OACEG,EAAAC,EAAAC,cAAA,OAAKE,GAAG,eAARC,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QAAS,IAAMnB,EAAM6xB,WAAW7xB,EAAM0F,MAAO1F,EAAM0C,MAAM,GAAjElC,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMC,KAAvBr0B,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,IACC,SAEHV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QA1BO,KACjB,GAAmB,MAAfnB,EAAM0F,MAAe,CACvB,MAAMiM,EAAS3R,EAAM0F,MAAM0P,YAC3B,GAAIzD,EAEF,GAAIA,EAAM,wBACRA,EAAM,+BACD,GAAIA,EAAM,qBACfA,EAAM,4BACD,GAAIA,EAAM,oBACfA,EAAM,0BACD,KAAIA,EAAM,kBAIf,OAHAA,EAAM,uBAcVnR,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMkC,KAAvBt2B,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,KAEFV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQpzB,QAAS,IAAMnB,EAAM+2B,oBAAoB/2B,EAAMg3B,iBAAvDx2B,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAM50B,EAAMg3B,gBAAkBC,KAASC,KAAxD12B,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,OAUR,IAAIs2B,GAA+B,KA6BpBC,OA3BkCp3B,IAC/C+S,iBAAiB,SAAU,KACrBokB,KACF3B,aAAa2B,IACbA,GAAQ,MAEVA,GAAQthB,WAAW,WACjB,MAAMR,EAAIpI,SAAS8G,eAAe,gBAAiBE,YAC7CqB,EAAIrI,SAAS8G,eAAe,gBAAiBI,aACnDnU,EAAMy1B,QAAQpgB,EAAGC,IAChB,OAIHnV,EAAAC,EAAAC,cAAAF,EAAAC,EAAAi3B,SAAA,KACEl3B,EAAAC,EAAAC,cAAA,OAAKE,GAAG,eAARC,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,IACAV,EAAAC,EAAAC,cAACu2B,GAAD,CACEI,gBAAiBh3B,EAAMg3B,gBACvBD,mBAAoB/2B,EAAM+2B,mBAC1Br0B,KAAM1C,EAAM0C,KACZgD,MAAO1F,EAAM0F,MACbmsB,WAAY7xB,EAAM6xB,WALpBrxB,SAAA,CAAAC,SAAAo2B,GAAAl2B,WAAA,IAAAC,YAAAC,MCvDSy2B,OALcxD,YAZJ7vB,IAAD,CACtB+yB,gBAAiB/yB,EAAMtC,OAAOwD,QAC9BzC,KAAMuB,EAAM4X,OAAOnZ,KACnBgD,MAAOzB,EAAMyB,MAAMA,QAGOwrB,IAAD,CACzB6F,mBAAqB5xB,GAAqB+rB,EAAShsB,EAAWC,IAC9DswB,QAAS,CAACn0B,EAAeC,IAAmB2vB,EfEvB,EAAC5vB,EAAeC,KAAhB,CACrBoB,KAAM4C,EAAiBpB,SACvBtB,QAAS,CACPvB,QACAC,YeNmDk0B,CAAQn0B,EAAOC,IACpEswB,WAAYA,GAAWX,KAGI4C,CAG3BsD,qHCoFaG,OApEwBv3B,IACrCC,oBAAU,KACyB,IAA7BD,EAAM2B,OAAOS,KAAKoF,SACpBxH,EAAM6yB,aAAa7yB,EAAMqF,WAAYrF,EAAM2B,OAAOS,KAAKpC,EAAMqC,MAAM+vB,MACnEpyB,EAAM8yB,YACJ9yB,EAAM0F,MACN1F,EAAMqF,WACNrF,EAAMqC,KACNrC,EAAM2B,OAAOS,KAAKpC,EAAMqC,MAAM+vB,QAGjC,CAACpyB,EAAMqC,KAAMrC,EAAMqF,WAAYrF,EAAM2B,SAExC1B,oBAAU,KACRD,EAAM2yB,aAAa3yB,EAAMqF,aACxB,CAACrF,EAAMqF,aAGRlF,EAAAC,EAAAC,cAAA,OACEE,GAAG,eACH4M,MAAO,CAAEqqB,WAAYx3B,EAAMmF,QAAU,UAAY,UAFnD3E,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GAIEV,EAAAC,EAAAC,cAACq3B,GAAA,EAAD,CAAMp3B,UAAU,aAAhBE,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACq3B,GAAA,EAAK53B,OAAN,CAAaQ,UAAU,gBAAvBE,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs3B,EAAA,EAAD,CAAAn3B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAAA,UACEC,UAAU,eACVa,QAAS,IAAMnB,EAAMkF,YAAW,GAFlC1E,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GAIEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMgD,KAAvBp3B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,MAGJV,EAAAC,EAAAC,cAACs3B,EAAA,EAAD,CAAAn3B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACw3B,EAAA,EAAD,CAAKv3B,UAAU,mBAAmB+Y,GAAI,EAAtC7Y,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACGb,EAAM2B,OAAOS,MACe,IAA7BpC,EAAM2B,OAAOS,KAAKoF,QACH,IAAfxH,EAAMqC,KACJlC,EAAAC,EAAAC,cAAA,KAAGmC,KAAI,IAAAP,OAAMjC,EAAMqC,KAAO,GAA1B7B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMkD,KAAvBt3B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,IADF,IAAAoB,OAEOjC,EAAM2B,OAAOS,KAAKpC,EAAMqC,KAAO,GAAGX,QAEvC,MAENvB,EAAAC,EAAAC,cAACw3B,EAAA,EAAD,CAAKv3B,UAAU,oBAAoB+Y,GAAI,EAAvC7Y,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACGb,EAAM2B,OAAOS,MACe,IAA7BpC,EAAM2B,OAAOS,KAAKoF,QAClBxH,EAAMqC,OAASrC,EAAM2B,OAAOS,KAAKoF,OAAS,EACxCrH,EAAAC,EAAAC,cAAA,KAAGmC,KAAI,IAAAP,OAAMjC,EAAMqC,KAAO,GAA1B7B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GAAA,GAAAoB,OACMjC,EAAM2B,OAAOS,KAAKpC,EAAMqC,KAAO,GAAGX,MADxC,KAEEvB,EAAAC,EAAAC,cAACs0B,GAAA,EAAD,CAAiBC,KAAMmD,KAAvBv3B,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,KAEA,QAIVV,EAAAC,EAAAC,cAACq3B,GAAA,EAAKM,KAAN,CAAW13B,UAAU,cAArBE,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAAA,OACEC,UAAU,gBACV23B,wBAAyB,CACvBC,OAAQC,GAAOn4B,EAAM8E,UAHzBtE,SAAA,CAAAC,SAAAg3B,GAAA92B,WAAA,IAAAC,YAAAC,QCvDKu3B,OALStE,YAtBA,CACtB7vB,EACAyyB,KAFsB,CAItB/0B,OAAQsC,EAAMtC,OAAOA,OACrB+D,MAAOzB,EAAMyB,MAAMA,MACnBL,WAAYqxB,EAASrxB,WACrBhD,KAAMq0B,EAASr0B,KACfyC,QAASb,EAAMtC,OAAOmD,QACtBK,QAASlB,EAAMtC,OAAOwD,UAGG+rB,IAAD,CACxBrsB,WAAaC,GAAoBosB,EAASrsB,EAAWC,IACrDE,UAAYrD,GAAwBuvB,EAASlsB,EAAUrD,IACvDc,QAAUC,GAAiBwuB,EAASzuB,EAAQC,IAC5CwC,WAAaC,GAAqB+rB,EAAShsB,EAAWC,IACtD0tB,aAAcA,GAAa3B,GAC3B4B,YAAaA,GAAY5B,GACzByB,aAAcA,GAAazB,KAGL4C,CAGtByD,uHCAac,OArBsBr4B,GAEjCG,EAAAC,EAAAC,cAACi4B,GAAA,EAAD,CAAOtvB,KAAK,KAAK9C,KAAMlG,EAAMkG,KAAMqyB,UAAQ,EAA3C/3B,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACi4B,GAAA,EAAMN,KAAP,CAAAx3B,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACo4B,GAAA,EAAD,CAAMl4B,GAAG,mBAAmBm4B,SAAU,IAAM14B,EAAMoB,SAAQ,GAA1DZ,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs4B,GAAA,EAAD,CAAYr4B,UAAU,OAAtBE,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACu4B,GAAA,EAAD,CACExyB,YAAapG,EAAMoG,YACnB7B,MAAOvE,EAAMuE,MACbqxB,SAAUzL,GAAKnqB,EAAM64B,SAAS1O,EAAE9S,OAAO9S,OAHzC/D,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,IAKAV,EAAAC,EAAAC,cAACs4B,GAAA,EAAWG,OAAZ,CAAAt4B,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQ5xB,KAAK,SAAbnC,SAAA,CAAAC,SAAA+3B,GAAA73B,WAAA,IAAAC,YAAAC,GAAA,iCCLCk4B,OALQjF,YAbE7vB,IAAD,CACtBiC,KAAMjC,EAAM6X,MAAM5V,KAClB3B,MAAON,EAAM6X,MAAMvX,MACnB6B,YAAanC,EAAM6X,MAAM1V,cAIzB8qB,IADyB,CAGzB9vB,QAAU8E,GAAkBgrB,EAAS9vB,EAAQ8E,IAC7C2yB,SAAWt0B,GAAkB2sB,ElBAN3sB,KAAD,CACtB5B,KAAMkD,EAAiBS,UACvBzD,QAAS,CACP0B,WkBHoCs0B,CAASt0B,MAG1BuvB,CAGrBuE,mFCYaW,OAzB0Bh5B,GAErCG,EAAAC,EAAAC,cAAAF,EAAAC,EAAAi3B,SAAA,KACEl3B,EAAAC,EAAAC,cAACi4B,GAAA,EAAD,CAAOpyB,KAAMlG,EAAMkG,KAAM+yB,OAAQ,IAAMj5B,EAAMoB,SAAQ,GAArDZ,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACi4B,GAAA,EAAMx4B,OAAP,CAAcq5B,aAAW,EAAzB34B,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACi4B,GAAA,EAAMc,MAAP,CAAA54B,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GAAA,kBAEFV,EAAAC,EAAAC,cAACi4B,GAAA,EAAMN,KAAP,CAAAx3B,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GACG,gDAEHV,EAAAC,EAAAC,cAACi4B,GAAA,EAAMe,OAAP,CAAA74B,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQvzB,QAAQ,YAAYG,QAAS,IAAMnB,EAAMoB,SAAQ,GAAzDZ,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GAAA,SAGAV,EAAAC,EAAAC,cAACk0B,GAAA,EAAD,CAAQvzB,QAAQ,UAAUG,QAAS,IAAMnB,EAAMoB,SAAQ,GAAvDZ,SAAA,CAAAC,SAAAy4B,GAAAv4B,WAAA,IAAAC,YAAAC,GAAA,mBCJKy4B,OALUxF,YARA7vB,IAAD,CACtBiC,KAAMjC,EAAM8X,QAAQ7V,OAGMgrB,IAAD,CACzB9vB,QAAU8E,GAAkBgrB,EAAS9vB,GAAQ8E,MAGtB4tB,CAGvBkF,4DCoBaO,OAvBkBv5B,IAC/B,MAAMqF,EAAarF,EAAMw5B,GAAG73B,OAAS3B,EAAMw5B,GAAG73B,OAAS,WACjDU,EAAsB,KAAfrC,EAAMy5B,KAAc7gB,SAAS5Y,EAAMy5B,KAAK9f,OAAO,IAAM,EAClE,OACExZ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,MAAfE,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs5B,EAAA,EAAD,CAAWr5B,UAAU,YAArBE,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACu5B,GAAD,CAAAp5B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,IACAV,EAAAC,EAAAC,cAACw5B,GAAD,CAAAr5B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,IACAV,EAAAC,EAAAC,cAACy5B,GAAD,CAAAt5B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,IACAV,EAAAC,EAAAC,cAACs3B,EAAA,EAAD,CAAKp3B,GAAG,WAARC,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACw3B,EAAA,EAAD,CAAKt3B,GAAG,WAAW8Y,GAAI,EAAvB7Y,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAAC05B,GAAD,CAAQ10B,WAAYA,EAAYhD,KAAMA,EAAtC7B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,IACAV,EAAAC,EAAAC,cAAC25B,GAAD,CAAAx5B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,KAEFV,EAAAC,EAAAC,cAACw3B,EAAA,EAAD,CAAKt3B,GAAG,YAAY8Y,GAAI,EAAxB7Y,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAAC45B,GAAD,CAAQ50B,WAAYA,EAAYhD,KAAMA,EAAtC7B,SAAA,CAAAC,SAAAi5B,GAAA/4B,WAAA,IAAAC,YAAAC,uFChBZ,MAAMq5B,GAAeC,GACnBA,EACGxgB,OAAO,GACPygB,MAAM,KACNC,OAAO,CAACC,EAAK1Y,KACZ,MAAMhO,EAAOgO,EAAEwY,MAAM,KAErB,OADAE,EAAI1mB,EAAK,IAAMA,EAAK,GACb0mB,GACN,IAEPC,IAASvwB,OACP7J,EAAAC,EAAAC,cAACm6B,EAAA,EAAD,CAAUxe,MAAOA,GAAjBxb,SAAA,CAAAC,SAAAg6B,GAAA95B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACq6B,GAAA,EAAD,CAAAl6B,SAAA,CAAAC,SAAAg6B,GAAA95B,WAAA,IAAAC,YAAAC,GACEV,EAAAC,EAAAC,cAACs6B,GAAA,EAAD,CACE3wB,OAAQhK,GACNG,EAAAC,EAAAC,cAACu6B,GAAD,CACEpB,GAAIU,GAAYl6B,EAAM66B,SAASC,QAC/BrB,KAAMz5B,EAAM66B,SAASpB,KAFvBj5B,SAAA,CAAAC,SAAAg6B,GAAA95B,WAAA,IAAAC,YAAAC,IAFJL,SAAA,CAAAC,SAAAg6B,GAAA95B,WAAA,IAAAC,YAAAC,MAUJoM,SAAS8G,eAAe","file":"static/js/main.c6afc238.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\nimport { CourseShape } from '../../modules/course';\nimport './Header.css';\n\nexport type HeaderProps = {\n  course: CourseShape;\n  courses: { [path: string]: CourseShape };\n  fetchCourses: () => void;\n  setShow: (show: boolean) => void;\n};\n\nconst Header: React.FC<HeaderProps> = (props: HeaderProps) => {\n  useEffect(() => {\n    props.fetchCourses();\n  }, []);\n  return (\n    <div className=\"Header\" id=\"puppy-header\">\n      <Navbar bg=\"white\" variant=\"light\" expand=\"lg\">\n        <Navbar.Brand onClick={() => props.setShow(true)}>\n          <img\n            src=\"./image/logo.png\"\n            width=\"25\"\n            height=\"25\"\n            className=\"d-inline-block align-top\"\n          />\n          {' Puppy'}\n        </Navbar.Brand>\n        <Nav className=\"mr-auto\">\n          <NavDropdown title={props.course.title} id=\"nav-dropdown-courses\">\n            {Object.keys(props.courses).map(course_path => {\n              const course = props.courses[course_path];\n              return (\n                <NavDropdown\n                  title={course.title}\n                  id={`nav-dropdown-pages-${course.title}`}\n                  drop=\"right\"\n                  key={course.title}\n                >\n                  {course.list.map(\n                    (page: { path: string; title: string }, i: number) => (\n                      <NavDropdown.Item\n                        href={`?course=${course_path}#${i}`}\n                        key={i}\n                      >\n                        {page.title}\n                      </NavDropdown.Item>\n                    )\n                  )}\n                </NavDropdown>\n              );\n            })}\n          </NavDropdown>\n        </Nav>\n      </Navbar>\n    </div>\n  );\n};\n\nexport default Header;\n","import { Action } from 'redux';\nimport * as monacoEditor from 'monaco-editor';\nexport type CodeEditor = monacoEditor.editor.IStandaloneCodeEditor;\nimport { ErrorLog } from '../vm/vm';\n\nenum EditorActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_CODE = 'SET_CODE',\n  SET_CODEEDITOR = 'SET_CODEEDITOR',\n  SET_FONTSIZE = 'SET_FONTSIZE',\n  SET_DECORATION = 'SET_DECORATION',\n  SET_MARKER = 'SET_MARKER',\n  SET_THEME = 'SETTHEME',\n  SET_DIFFSTARTLINENUMBER = 'SET_DIFFSTARTLINENUMBER',\n}\n\ninterface SetSizeAction extends Action {\n  type: EditorActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number): SetSizeAction => ({\n  type: EditorActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetCodeAction extends Action {\n  type: EditorActionTypes.SET_CODE;\n  payload: {\n    code: string;\n  };\n}\n\nexport const setCode = (code: string): SetCodeAction => ({\n  type: EditorActionTypes.SET_CODE,\n  payload: {\n    code,\n  },\n});\n\ninterface SetCodeEditorAction extends Action {\n  type: EditorActionTypes.SET_CODEEDITOR;\n  payload: {\n    codeEditor: CodeEditor | null;\n  };\n}\n\nexport const setCodeEditor = (\n  codeEditor: CodeEditor | null\n): SetCodeEditorAction => ({\n  type: EditorActionTypes.SET_CODEEDITOR,\n  payload: {\n    codeEditor,\n  },\n});\n\ninterface SetFontSizeAction extends Action {\n  type: EditorActionTypes.SET_FONTSIZE;\n  payload: {\n    value: number;\n  };\n}\n\nexport const setFontSize = (value: number): SetFontSizeAction => ({\n  type: EditorActionTypes.SET_FONTSIZE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetDecorationAction extends Action {\n  type: EditorActionTypes.SET_DECORATION;\n  payload: {\n    decoration: string[];\n  };\n}\n\nexport const setDecoration = (decoration: string[]): SetDecorationAction => ({\n  type: EditorActionTypes.SET_DECORATION,\n  payload: {\n    decoration,\n  },\n});\n\ninterface SetMarkerAction extends Action {\n  type: EditorActionTypes.SET_MARKER;\n  payload: {\n    markers: monacoEditor.editor.IMarkerData[];\n  };\n}\n\nconst type2severity = (type: 'error' | 'info' | 'warning' | 'hint') => {\n  switch (type) {\n    case 'error':\n      return monacoEditor.MarkerSeverity.Error;\n    case 'info':\n      return monacoEditor.MarkerSeverity.Info;\n    case 'warning':\n      return monacoEditor.MarkerSeverity.Warning;\n    case 'hint':\n      return monacoEditor.MarkerSeverity.Hint;\n  }\n};\n\nexport const setMarker = (markers: ErrorLog[]): SetMarkerAction => ({\n  type: EditorActionTypes.SET_MARKER,\n  payload: {\n    markers: markers.map(marker => ({\n      severity: type2severity(marker.type as\n        | 'error'\n        | 'info'\n        | 'warning'\n        | 'hint'),\n      startLineNumber: marker.row! + 1,\n      startColumn: marker.col!,\n      endLineNumber: marker.row! + 1,\n      endColumn: marker.col! + marker.len!,\n      message: marker.key,\n    })),\n  },\n});\n\ninterface SetThemeAction extends Action {\n  type: EditorActionTypes.SET_THEME;\n  payload: {\n    theme: string;\n  };\n}\n\nexport const setTheme = (theme: string): SetThemeAction => ({\n  type: EditorActionTypes.SET_THEME,\n  payload: {\n    theme,\n  },\n});\n\ninterface SetDiffStartLineNumber extends Action {\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER;\n  payload: {\n    startLineNumber: number | null;\n  };\n}\n\nexport const setDiffStartLineNumber = (startLineNumber: number | null) => ({\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER,\n  payload: {\n    startLineNumber,\n  },\n});\n\nexport type EditorActions =\n  | SetCodeAction\n  | SetSizeAction\n  | SetCodeEditorAction\n  | SetFontSizeAction\n  | SetDecorationAction\n  | SetMarkerAction\n  | SetThemeAction\n  | SetDiffStartLineNumber;\n\nexport type EditorState = {\n  width: number;\n  height: number;\n  code: string;\n  codeEditor: CodeEditor | null;\n  theme: string;\n  fontSize: number;\n  decoration: string[];\n  markers: monacoEditor.editor.IMarkerData[];\n  diffStartLineNumber: number | null;\n};\n\nconst initialState: EditorState = {\n  width: 500,\n  height: 500,\n  code: '',\n  codeEditor: null,\n  theme: 'vs',\n  fontSize: 30,\n  decoration: [],\n  markers: [],\n  diffStartLineNumber: null,\n};\n\nexport const editorReducer = (state = initialState, action: EditorActions) => {\n  switch (action.type) {\n    case EditorActionTypes.SET_SIZE:\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case EditorActionTypes.SET_CODE:\n      return { ...state, code: action.payload.code };\n    case EditorActionTypes.SET_CODEEDITOR:\n      return { ...state, codeEditor: action.payload.codeEditor };\n    case EditorActionTypes.SET_FONTSIZE:\n      return { ...state, fontSize: action.payload.value };\n    case EditorActionTypes.SET_DECORATION:\n      return { ...state, decoration: action.payload.decoration };\n    case EditorActionTypes.SET_MARKER:\n      monacoEditor.editor.setModelMarkers(\n        state.codeEditor!.getModel()!,\n        'puppy',\n        action.payload.markers\n      );\n      return {\n        ...state,\n        codeEditor: state.codeEditor,\n        markers: action.payload.markers,\n      };\n    case EditorActionTypes.SET_THEME:\n      return { ...state, theme: action.payload.theme };\n    case EditorActionTypes.SET_DIFFSTARTLINENUMBER:\n      return { ...state, diffStartLineNumber: action.payload.startLineNumber };\n    default:\n      return state;\n  }\n};\n\nexport default editorReducer;\n","import { Action } from 'redux';\n\nexport type CourseShape = {\n  title: string;\n  list: {\n    path: string;\n    title: string;\n  }[];\n};\n\nenum CourseActionTypes {\n  SET_CONTENT = 'SET_CONTENT',\n  SET_COURSES = 'SET_COURCES',\n  SET_COURSE = 'SET_COURSE',\n  SET_VISIBLE = 'SET_VISIBLE',\n}\n\ninterface SetContentAction extends Action {\n  type: CourseActionTypes.SET_CONTENT;\n  payload: {\n    content: string;\n  };\n}\n\nexport const setContent = (content: string): SetContentAction => ({\n  type: CourseActionTypes.SET_CONTENT,\n  payload: {\n    content,\n  },\n});\n\ninterface SetCoursesAction extends Action {\n  type: CourseActionTypes.SET_COURSES;\n  payload: {\n    courses: { [path: string]: CourseShape };\n  };\n}\n\nexport const setCources = (courses: {\n  [path: string]: CourseShape;\n}): SetCoursesAction => ({\n  type: CourseActionTypes.SET_COURSES,\n  payload: {\n    courses,\n  },\n});\n\ninterface SetCourseAction extends Action {\n  type: CourseActionTypes.SET_COURSE;\n  payload: {\n    course: CourseShape;\n  };\n}\n\nexport const setCourse = (course: CourseShape): SetCourseAction => ({\n  type: CourseActionTypes.SET_COURSE,\n  payload: {\n    course,\n  },\n});\n\ninterface SetVisibleAction extends Action {\n  type: CourseActionTypes.SET_VISIBLE;\n  payload: {\n    visible: boolean;\n  };\n}\n\nexport const setVisible = (visible: boolean): SetVisibleAction => ({\n  type: CourseActionTypes.SET_VISIBLE,\n  payload: {\n    visible,\n  },\n});\n\nexport type CourseActions =\n  | SetContentAction\n  | SetCoursesAction\n  | SetCourseAction\n  | SetVisibleAction;\n\nexport type CourseState = {\n  content: string;\n  courses: { [path: string]: CourseShape };\n  course: CourseShape;\n  coursePath: string;\n  page: number;\n  visible: boolean;\n};\n\nconst initialState: CourseState = {\n  content: '# Hello World \\n\\n Rendered by **marked**',\n  courses: {},\n  course: { title: '', list: [] },\n  coursePath: '',\n  page: 0,\n  visible: true,\n};\n\nconst courseReducer = (state = initialState, action: CourseActions) => {\n  switch (action.type) {\n    case CourseActionTypes.SET_CONTENT:\n      return { ...state, content: action.payload.content };\n    case CourseActionTypes.SET_COURSES:\n      return { ...state, courses: action.payload.courses };\n    case CourseActionTypes.SET_COURSE:\n      return { ...state, course: action.payload.course };\n    case CourseActionTypes.SET_VISIBLE:\n      return { ...state, visible: action.payload.visible };\n    default:\n      return state;\n  }\n};\n\nexport default courseReducer;\n","import { Action } from 'redux';\nimport { Puppy } from '../vm/vm';\n\nenum PuppyActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_PUPPY = 'SET_PUPPY',\n  SET_ISLIVE = 'SET_ISLIVE',\n}\n\ninterface SetSizeAction extends Action {\n  type: PuppyActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number) => ({\n  type: PuppyActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetPuppyAction extends Action {\n  type: PuppyActionTypes.SET_PUPPY;\n  payload: {\n    puppy: Puppy | null;\n  };\n}\n\nexport const setPuppy = (puppy: Puppy | null) => ({\n  type: PuppyActionTypes.SET_PUPPY,\n  payload: {\n    puppy,\n  },\n});\n\ninterface SetIsLiveAction extends Action {\n  type: PuppyActionTypes.SET_ISLIVE;\n  payload: {\n    isLive: boolean;\n  };\n}\n\nexport const setIsLive = (isLive: boolean) => ({\n  type: PuppyActionTypes.SET_ISLIVE,\n  payload: {\n    isLive,\n  },\n});\n\nexport type PuppyActions = SetSizeAction | SetPuppyAction | SetIsLiveAction;\n\nexport type PuppyState = {\n  width: number;\n  height: number;\n  puppy: Puppy | null;\n  isLive: boolean;\n};\n\nconst initialState: PuppyState = {\n  width: 500,\n  height: 500,\n  puppy: null,\n  isLive: true,\n};\n\nexport const puppyReducer = (state = initialState, action: PuppyActions) => {\n  switch (action.type) {\n    case PuppyActionTypes.SET_SIZE:\n      if (state.puppy) {\n        state.puppy.resize(action.payload.width, action.payload.height);\n      }\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case PuppyActionTypes.SET_PUPPY:\n      return { ...state, puppy: action.payload.puppy };\n    case PuppyActionTypes.SET_ISLIVE:\n      return { ...state, isLive: action.payload.isLive };\n    default:\n      return state;\n  }\n};\n\nexport default puppyReducer;\n","import { Action } from 'redux';\n\nenum InputActionTypes {\n  SET_VALUE = 'SET_VALUE',\n  SET_SHOW = 'SET_SHOW',\n  SET_PLACEHOLDER = 'SET_PLACEHOLDER',\n}\n\ninterface SetValueAction extends Action {\n  type: InputActionTypes.SET_VALUE;\n  payload: {\n    value: string;\n  };\n}\n\nexport const setValue = (value: string): SetValueAction => ({\n  type: InputActionTypes.SET_VALUE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetShowAction extends Action {\n  type: InputActionTypes.SET_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: InputActionTypes.SET_SHOW,\n  payload: {\n    show,\n  },\n});\n\ninterface SetPlaceholderAction extends Action {\n  type: InputActionTypes.SET_PLACEHOLDER;\n  payload: {\n    placeholder: string;\n  };\n}\n\nexport const setPlaceholder = (placeholder: string): SetPlaceholderAction => ({\n  type: InputActionTypes.SET_PLACEHOLDER,\n  payload: {\n    placeholder,\n  },\n});\n\nexport type InputActions =\n  | SetValueAction\n  | SetShowAction\n  | SetPlaceholderAction;\n\nexport type InputState = {\n  value: string;\n  show: boolean;\n  placeholder: string;\n};\n\nconst initialState: InputState = {\n  value: '',\n  show: false,\n  placeholder: '',\n};\n\nconst InputReducer = (state = initialState, action: InputActions) => {\n  switch (action.type) {\n    case InputActionTypes.SET_VALUE:\n      return { ...state, value: action.payload.value };\n    case InputActionTypes.SET_SHOW:\n      if (action.payload.show) {\n        return { value: '', show: action.payload.show, placeholder: '' };\n      } else {\n        return { ...state, show: action.payload.show };\n      }\n    case InputActionTypes.SET_PLACEHOLDER:\n      return { ...state, placeholder: action.payload.placeholder };\n    default:\n      return state;\n  }\n};\n\nexport default InputReducer;\n","// \n// punk\n\n// https://ja.stackoverflow.com/questions/4445/matter-js\n\nexport const myRender = render => {\n  const _getTexture = (render, imagePath: string) => {\n    let image = render.textures[imagePath];\n    if (image) {\n      return image;\n    }\n    image = render.textures[imagePath] = new Image();\n    if (\n      imagePath.startsWith('http://') ||\n      imagePath.startsWith('https://') ||\n      imagePath.startsWith('data:') ||\n      imagePath.startsWith('/')\n    ) {\n      image.src = imagePath;\n    } else {\n      image.src = `/image/${imagePath}`;\n    }\n    return image;\n  };\n\n  render['bodies'] = function(render, bodies, context) {\n    const c = context;\n    const options = render.options;\n    // const wireframes = options.wireframes;\n    const showInternalEdges = options.showInternalEdges || !options.wireframes;\n    const defaultFont = options.font || \"bold 60px 'Arial'\";\n    const defaultFontColor = options.fontColor || 'gray';\n\n    for (let i = 0; i < bodies.length; i += 1) {\n      const body = bodies[i];\n      if (!body.visible) {\n        continue;\n      }\n      // handle compound parts\n      for (\n        let k = body.parts.length > 1 ? 1 : 0;\n        k < body.parts.length;\n        k += 1\n      ) {\n        const part = body.parts[k];\n        if (!part.visible) {\n          continue;\n        }\n        if (part.opacity !== 1) {\n          c.globalAlpha = part.opacity;\n        }\n\n        if (part.image) {\n          const texture = _getTexture(render, part.image);\n          c.translate(part.position.x, part.position.y);\n          c.rotate(part.angle);\n          c.drawImage(\n            texture,\n            part.width * -0.5,\n            part.height * -0.5,\n            part.width,\n            part.height\n          );\n          c.rotate(-part.angle);\n          c.translate(-part.position.x, -part.position.y);\n        } else {\n          // part polygon\n          if (part.circleRadius) {\n            c.beginPath();\n            c.arc(\n              part.position.x,\n              part.position.y,\n              part.circleRadius,\n              0,\n              2 * Math.PI\n            );\n          } else {\n            c.beginPath();\n            c.moveTo(part.vertices[0].x, part.vertices[0].y);\n            for (let j = 1; j < part.vertices.length; j += 1) {\n              if (!part.vertices[j - 1].isInternal || showInternalEdges) {\n                c.lineTo(part.vertices[j].x, part.vertices[j].y);\n              } else {\n                c.moveTo(part.vertices[j].x, part.vertices[j].y);\n              }\n              if (part.vertices[j].isInternal && !showInternalEdges) {\n                c.moveTo(\n                  part.vertices[(j + 1) % part.vertices.length].x,\n                  part.vertices[(j + 1) % part.vertices.length].y\n                );\n              }\n            }\n            c.lineTo(part.vertices[0].x, part.vertices[0].y);\n            c.closePath();\n          }\n          if (!options.wireframes) {\n            c.fillStyle = part.fillStyle;\n            if (part.lineWidth) {\n              c.lineWidth = part.lineWidth;\n              c.strokeStyle = part.strokeStyle;\n              c.stroke();\n            }\n            c.fill();\n          } else {\n            c.lineWidth = 1;\n            c.strokeStyle = '#bbb';\n            c.stroke();\n          }\n        }\n\n        if (part.value !== undefined) {\n          // Make to show null and 0.\n          if (part.ref) {\n            part.value = part.ref();\n          }\n          c.save();\n          c.font = part.font || defaultFont;\n          c.fillStyle = part.fontColor || defaultFontColor;\n          c.textAlign = part.textAlign || 'center';\n          if (part.shadowColor) {\n            c.shadowColor = part.shadowColor; // \n            c.shadowBlur = c.shadowBlur || 0; // \n            c.shadowOffsetX = c.shadowOffsetX || 2; // 3px\n            c.shadowOffsetY = c.shadowOffsetY || 2; // 1px\n          }\n          c.fillText(`${part.value}`, part.position.x, part.position.y + 10);\n          c.restore();\n        }\n        c.globalAlpha = 1;\n      }\n    }\n  };\n  return render;\n};\n","import * as Matter from 'matter-js';\n\nconst Bodies = Matter.Bodies;\nconst Composite = Matter.Composite;\nconst Common = Matter['Common'];\n\nimport { Puppy } from './vm'; // eslint-disable-line no-unused-vars\n\nexport type PuppyShape =\n  | 'circle'\n  | 'rectangle'\n  | 'trapezoid'\n  | 'polygon'\n  | 'label';\nexport type CollisionFunc = (obj1: {}, obj2: {}) => void;\nexport type ClickedFunc = (obj: {}) => void;\n\nexport type PuppyConstructor = (puppy: Puppy, options: Shape) => Matter.Body;\n\nexport type Shape = {\n  position?: {\n    x: number;\n    y: number;\n  };\n  isSensor?: boolean;\n  isStatic?: boolean;\n  width?: number;\n  height?: number;\n\n  angle?: number;\n  interia?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n};\n\n// const flatten = part => {\n//   console.log(part);\n//   Object.keys(part.render).forEach(key => {\n//     if (!(key in part)) {\n//       console.log(`key ${key}`);\n//       part[key] = part.render[key];\n//     }\n//   });\n// };\n\nconst convColor = (puppy: Puppy, color: any) => {\n  if (Array.isArray(color)) {\n    color = Common.choose(color);\n  }\n  if (typeof color === 'number') {\n    const list: [string] = puppy.world!.colorScheme;\n    return list[color % list.length];\n  }\n  return color;\n};\n\nexport const PropertyMap: {} = {\n  radius: (puppy: Puppy, options: Shape, value: any) => {\n    options.radius = value;\n    if (options.base === 'circle') {\n      options.width = value * 2;\n      options.height = value * 2;\n    }\n  },\n  width: (puppy: Puppy, options: Shape, value: any) => {\n    options.width = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.height = value;\n    }\n  },\n  height: (puppy: Puppy, options: Shape, value: any) => {\n    options.height = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.width = value;\n    }\n  },\n  fillStyle: (puppy: Puppy, options: Shape, value: any) => {\n    options.fillStyle = convColor(puppy, value);\n  },\n};\n\nexport const setShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value: any\n) => {\n  if (key in PropertyMap) {\n    PropertyMap[key](puppy, options, value);\n  } else {\n    options[key] = value;\n  }\n  return value;\n};\n\nconst checkShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value?: any\n) => {\n  if (options[key]) {\n    return setShapeProperty(puppy, options, key, options[key]);\n  }\n  if (value) {\n    return setShapeProperty(puppy, options, key, value);\n  }\n  return undefined;\n};\n\n/* constructor functions */\n\nconst circle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst rectangle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'width', 100);\n  checkShapeProperty(puppy, options, 'height', 100);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    options.isStatic ? 'black' : Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst polygon = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'polygon',\n    visible: true,\n  });\n  const sides = checkShapeProperty(puppy, options, 'sides', 5);\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  return Bodies.polygon(\n    options.position!.x,\n    options.position!.y,\n    sides,\n    options.radius!,\n    options\n  );\n};\n\nconst label = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n  });\n  checkShapeProperty(puppy, options, 'width', 10);\n  checkShapeProperty(puppy, options, 'height', 10);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fontColor',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  checkShapeProperty(puppy, options, 'fillStyle', 'rgba(255, 255, 255, 0)');\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst drop = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n    created: puppy.getTimeStamp(),\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 10);\n  checkShapeProperty(puppy, options, 'fillStyle', 0);\n  checkShapeProperty(puppy, options, 'opacity', 0.8);\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst pendulum = (puppy: Puppy, options: Shape) => {\n  const separation = 1.9;\n  const column = checkShapeProperty(puppy, options, 'column', 5);\n  const width = checkShapeProperty(\n    puppy,\n    options,\n    'width',\n    puppy.world!.viewWidth / 2\n  );\n  const height = checkShapeProperty(\n    puppy,\n    options,\n    'height',\n    puppy.world!.viewWidth / 2\n  );\n  const size = width / (column * 2);\n  const xx = options.position!.x - width / 2;\n  const yy = options.position!.y - height / 2;\n  const newtonsCradle = Matter.Composite.create({\n    label: 'Newtons Cradle',\n  });\n  for (let i = 0; i < column; i += 1) {\n    const _options = {\n      visible: true,\n      fillStyle: Common.choose(puppy.world!.colorScheme),\n      inertia: options.interia || Infinity,\n      restitution: options.restitution || 1,\n      friction: options.friction || 0,\n      frictionAir: options.frictionAir || 0.0001,\n      slop: options.slop || 1,\n    };\n    const circle = Matter.Bodies.circle(\n      xx + i * (size * separation),\n      yy + height,\n      size,\n      _options\n    );\n    const constraint = Matter.Constraint.create({\n      pointA: {\n        x: xx + i * (size * separation),\n        y: yy,\n      },\n      bodyB: circle,\n      render: {\n        visible: true,\n        lineWidth: options.lineWidth! | 1,\n        strokeStyle: options.strokeStyle || 'gray',\n      },\n    });\n    Composite['addBody'](newtonsCradle, circle);\n    Composite['addConstraint'](newtonsCradle, constraint);\n  }\n  console.log(newtonsCradle);\n  console.log(newtonsCradle['parts']);\n  return newtonsCradle;\n};\n\nexport const initVars = (vars: {}) => {\n  Object.assign(vars, {\n    Circle: circle,\n    Rectangle: rectangle,\n    Polygon: polygon,\n    Label: label,\n    Drop: drop,\n    Pendulum: pendulum,\n  });\n  return vars;\n};\n\n/* shapeFunc  */\n\nexport type ShapeOptions = {\n  // Matter Options\n  id?: number;\n  type?: string;\n  label?: string;\n  parts?: [];\n  plugin?: {};\n  angle?: number;\n  interia?: number;\n  position: {\n    x: number;\n    y: number;\n  };\n  width?: number;\n  height?: number;\n  force?: {\n    x: number;\n    y: number;\n  };\n  torque?: number;\n  positionImpulse?: { x?: number; y?: number };\n  constraintImpulse?: { x?: number; y?: number; angle?: number };\n  totalContacts?: number;\n  speed?: number;\n  angularSpeed?: number;\n  velocity?: { x: number; y: number };\n  angularVelocity?: number;\n  isSensor?: boolean;\n  isStatic?: boolean;\n  isSleeping?: boolean;\n  motion?: number;\n  sleepThreshold?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  sprite?: {\n    xScale?: number;\n    yScale?: number;\n    xOffset?: number;\n    yOffset?: number;\n  };\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n  collisionStart?: CollisionFunc;\n  collisionEnd?: CollisionFunc;\n  collisionActive?: CollisionFunc;\n  clicked?: ClickedFunc;\n};\n\n// export const isShapeOptions = (obj: {}) => ('shape' in obj) && ('position' in obj) && ('x' in obj['position']) && ('y' in obj['position']);\n\nexport class PuppyShapeBase implements ShapeOptions {\n  shape: PuppyShape = 'circle';\n  position: {\n    x: number;\n    y: number;\n  };\n\n  constructor(x: number, y: number, options = {}) {\n    Object.assign(this, options);\n    this.position = { x, y };\n  }\n}\n\nexport class Circle extends PuppyShapeBase {\n  shape: PuppyShape = 'circle';\n}\n\nexport class Rectangle extends PuppyShapeBase {\n  shape: PuppyShape = 'rectangle';\n}\n\nexport class Polygon extends PuppyShapeBase {\n  shape: PuppyShape = 'polygon';\n}\n\nexport class Trapezoid extends PuppyShapeBase {\n  shape: PuppyShape = 'trapezoid';\n}\n\nexport class Label extends PuppyShapeBase {\n  shape: PuppyShape = 'label';\n}\n\nexport const shapeFuncMap: {\n  [key in PuppyShape]: (world: {}, options: ShapeOptions) => Matter.Body;\n} = {\n  circle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      radius: _options.width\n        ? _options.width / 2\n        : _options.height\n        ? _options.height / 2\n        : 25,\n      fillStyle: Common.choose(world['colorScheme']),\n      visible: true,\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    // width, height texture \n    if (!options.width) {\n      options.width = options.radius * 2;\n    }\n    if (!options.height) {\n      options.height = options.radius * 2;\n    }\n    return Bodies.circle(\n      options.position.x,\n      options.position.y,\n      options.radius,\n      options\n    );\n  },\n  rectangle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'black'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n  polygon(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      sides: 5,\n      radius: 25,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend(\n      {},\n      defaultOptions,\n      { radius: _options.width ? _options.width / 2 : defaultOptions.radius },\n      _options\n    );\n    return Bodies.polygon(\n      options.position.x,\n      options.position.y,\n      options.sides,\n      options.radius,\n      options\n    );\n  },\n  trapezoid(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      slope: 0.5,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.trapezoid(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options.slope,\n      options\n    );\n  },\n  label(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      isSensor: true,\n      isStatic: true,\n      fillStyle: 'rgba(255, 255, 255, 0)',\n      fontColor: Common.choose(world['colorScheme']),\n      visible: true,\n      collisionFilter: {\n        category: 0x0001,\n        mask: 0x00000000,\n        group: 3,\n      },\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n};\n","import * as Matter from 'matter-js';\n\nconst Common = Matter['Common'];\n\nconst PuppyColorScheme = {\n  pop: [\n    '#de9610',\n    '#c93a40',\n    '#fff001',\n    '#d06d8c',\n    '#65ace4',\n    '#a0c238',\n    '#56a764',\n    '#d16b16',\n    '#cc528b',\n    '#9460a0',\n    '#f2cf01',\n    '#0074bf',\n  ],\n  cute: [\n    '#e2b2c0',\n    '#fff353',\n    '#a5d1f4',\n    '#e4ad6d',\n    '#d685b0',\n    '#dbe159',\n    '#7fc2ef',\n    '#c4a6ca',\n    '#eabf4c',\n    '#f9e697',\n    '#b3d3ac',\n    '#eac7cd',\n  ],\n  dynamic: [\n    '#b80117',\n    '#222584',\n    '#00904a',\n    '#edc600',\n    '#261e1c',\n    '#6d1782',\n    '#8f253b',\n    '#a0c238',\n    '#d16b16',\n    '#0168b3',\n    '#b88b26',\n    '#c30068',\n  ],\n  gorgeous: [\n    '#7d0f80',\n    '#b08829',\n    '#a03c44',\n    '#018a9a',\n    '#ab045c',\n    '#391d2b',\n    '#d5a417',\n    '#546474',\n    '#0f5ca0',\n    '#d0b98d',\n    '#d4c91f',\n    '#c1541c',\n  ],\n  casual: [\n    '#7b9ad0',\n    '#f8e352',\n    '#c8d627',\n    '#d5848b',\n    '#e5ab47',\n    '#e1cea3',\n    '#51a1a2',\n    '#b1d7e4',\n    '#66b7ec',\n    '#c08e47',\n    '#ae8dbc',\n    '#c3cfa9',\n  ],\n  psychedelic: [\n    '#b7007c',\n    '#009b85',\n    '#382284',\n    '#e2c80f',\n    '#009dc6',\n    '#c4c829',\n    '#95007e',\n    '#d685b0',\n    '#eee800',\n    '#bf5116',\n    '#b80e3b',\n    '#0178bc',\n  ],\n  bright: [\n    '#fff001',\n    '#cb5393',\n    '#a0c238',\n    '#d78114',\n    '#00a5e7',\n    '#cd5638',\n    '#0168b3',\n    '#d685b0',\n    '#00984b',\n    '#f2cf01',\n    '#6bb6bb',\n    '#a563a0',\n  ],\n  fairytale: [\n    '#cca9ca',\n    '#9bcad0',\n    '#dd9dbf',\n    '#edef9c',\n    '#aabade',\n    '#f2dae8',\n    '#c7ddae',\n    '#a199c8',\n    '#faede5',\n    '#d5a87f',\n    '#f7f06e',\n    '#95bfe7',\n  ],\n  heavy: [\n    '#000000',\n    '#998c69',\n    '#5c002f',\n    '#244765',\n    '#814523',\n    '#5e2a58',\n    '#1a653c',\n    '#6a6a68',\n    '#bf7220',\n    '#5f556e',\n    '#84762f',\n    '#872226',\n  ],\n  impact: [\n    '#c60019',\n    '#fff001',\n    '#1d4293',\n    '#00984b',\n    '#019fe6',\n    '#c2007b',\n    '#261e1c',\n    '#7d0f80',\n    '#dc9610',\n    '#dbdf19',\n    '#d685b0',\n    '#a0c238',\n  ],\n  street: [\n    '#33476a',\n    '#211917',\n    '#6c7822',\n    '#c2007b',\n    '#44aeea',\n    '#5e3032',\n    '#d16b16',\n    '#c8d627',\n    '#9193a0',\n    '#816945',\n    '#c50030',\n    '#0080c9',\n  ],\n  cool: [\n    '#b0d7f4',\n    '#c0cbe9',\n    '#eef0b1',\n    '#44aeea',\n    '#85beab',\n    '#c4a6ca',\n    '#f7f06e',\n    '#c8d627',\n    '#bcccd9',\n    '#e4f0fc',\n    '#f2dae8',\n    '#6490cd',\n  ],\n  elegant: [\n    '#ae8dbc',\n    '#e3b3cd',\n    '#d6ddf0',\n    '#e5d57d',\n    '#82c0cd',\n    '#afc7a7',\n    '#834e62',\n    '#6a9176',\n    '#7f7eb8',\n    '#a04e90',\n    '#dbbc86',\n    '#c4c829',\n  ],\n  fresh: [\n    '#70b062',\n    '#c8d85b',\n    '#f8e133',\n    '#dbdf19',\n    '#e3ab30',\n    '#dd9dbf',\n    '#a979ad',\n    '#cd5638',\n    '#399548',\n    '#6bb6bb',\n    '#f7f39c',\n    '#9acce3',\n  ],\n  warm: [\n    '#c59f22',\n    '#dd9b9d',\n    '#ebcc00',\n    '#d6d11d',\n    '#8d4f42',\n    '#d8836e',\n    '#f8e469',\n    '#cbb586',\n    '#e4aa01',\n    '#eac287',\n    '#f2d8bf',\n    '#a6658d',\n  ],\n  soft: [\n    '#f8e469',\n    '#e7e0aa',\n    '#d9de84',\n    '#e4bd60',\n    '#9ac29f',\n    '#e3be87',\n    '#edef9c',\n    '#dd9b9d',\n    '#b2d6d4',\n    '#f5dfa6',\n    '#ebeddf',\n    '#e1d4e6',\n  ],\n  man: [\n    '#23466e',\n    '#4d639f',\n    '#dfe0d8',\n    '#1d695f',\n    '#9aadbe',\n    '#844f30',\n    '#934e61',\n    '#7e9895',\n    '#77aad7',\n    '#848a96',\n    '#a76535',\n    '#7e8639',\n  ],\n  woman: [\n    '#7b0050',\n    '#a8006d',\n    '#bea620',\n    '#a26c54',\n    '#949b34',\n    '#614983',\n    '#cba777',\n    '#de9610',\n    '#bd8683',\n    '#be87a6',\n    '#bf5346',\n    '#e1d0b4',\n  ],\n  boy: [\n    '#0168b3',\n    '#66b7ec',\n    '#afd0ef',\n    '#88b83e',\n    '#b8b2d6',\n    '#6bb6bb',\n    '#5e4694',\n    '#f2cf01',\n    '#c6e2f8',\n    '#d5dbcf',\n    '#7a8bc3',\n    '#e8e6f3',\n  ],\n  girl: [\n    '#d06da3',\n    '#c2d3ed',\n    '#be91bc',\n    '#c73576',\n    '#f8e352',\n    '#c8d627',\n    '#e3b3cd',\n    '#c6e0d5',\n    '#e4ab5a',\n    '#cb6c58',\n    '#845d9e',\n    '#82c0cd',\n  ],\n  smart: [\n    '#4d639f',\n    '#356c92',\n    '#c9ced1',\n    '#dfd4be',\n    '#92a1a6',\n    '#a67b2d',\n    '#bda5bb',\n    '#2c4b79',\n    '#d6d680',\n    '#babea5',\n    '#ebc175',\n    '#3a614f',\n  ],\n  light: [\n    '#44aeea',\n    '#b4cb32',\n    '#b2b6db',\n    '#b2d6d4',\n    '#ebe9ae',\n    '#0080c9',\n    '#71b174',\n    '#e4c4db',\n    '#7da8db',\n    '#eac39a',\n    '#dbe585',\n    '#6db5a9',\n  ],\n  stylish: [\n    '#58656e',\n    '#bac1c7',\n    '#487ca3',\n    '#dfd4be',\n    '#004679',\n    '#c0542d',\n    '#a44682',\n    '#9599b2',\n    '#d6d680',\n    '#8eb4d9',\n    '#6c5776',\n    '#499475',\n  ],\n  natural: [\n    '#ba9648',\n    '#87643e',\n    '#c2b5d1',\n    '#ba7d8c',\n    '#b8ac60',\n    '#797c85',\n    '#f9ebd1',\n    '#9cb1c2',\n    '#81a47a',\n    '#acb130',\n    '#8b342a',\n    '#acae98',\n  ],\n  spring: [\n    '#dd9cb4',\n    '#eeea55',\n    '#ebc061',\n    '#b2d6d4',\n    '#f2dae8',\n    '#c9d744',\n    '#b8b2d6',\n    '#afd0ef',\n    '#d7847e',\n    '#f8e352',\n    '#b3ce5b',\n    '#cbacbe',\n  ],\n  summer: [\n    '#174e9e',\n    '#68b8dd',\n    '#d16b16',\n    '#88b83e',\n    '#f2cf01',\n    '#019fe6',\n    '#c60019',\n    '#019c96',\n    '#b0d7f4',\n    '#fff001',\n    '#0074bf',\n    '#c83955',\n  ],\n  fall: [\n    '#ae3c22',\n    '#902342',\n    '#c59f22',\n    '#7e8639',\n    '#eabd00',\n    '#a49e2e',\n    '#ac5238',\n    '#9f832f',\n    '#ba7c6f',\n    '#875f3b',\n    '#bba929',\n    '#786b4b',\n  ],\n  winter: [\n    '#a5aad4',\n    '#6591b6',\n    '#623d82',\n    '#5f897b',\n    '#858aa0',\n    '#eff3f6',\n    '#c2d3dd',\n    '#4f616f',\n    '#7f7073',\n    '#42629f',\n    '#674c51',\n    '#b38da4',\n  ],\n  japan: [\n    '#c3003a',\n    '#3a546b',\n    '#d5a02e',\n    '#918d43',\n    '#787cac',\n    '#604439',\n    '#6f2757',\n    '#c1541c',\n    '#565d63',\n    '#afc9ca',\n    '#baaa52',\n    '#e2b2c0',\n  ],\n  euro: [\n    '#bf541c',\n    '#25a4b7',\n    '#e4aa01',\n    '#b2bfe1',\n    '#ad438e',\n    '#1d4293',\n    '#b71232',\n    '#e8e2be',\n    '#b0bf30',\n    '#6aa43e',\n    '#6276b5',\n    '#d7832d',\n  ],\n  nordic: [\n    '#149bdf',\n    '#dbdf19',\n    '#c97a2b',\n    '#945141',\n    '#9abca4',\n    '#a5a79a',\n    '#e6d9b9',\n    '#eabd00',\n    '#bf545e',\n    '#86b070',\n    '#665e51',\n    '#b59a4d',\n  ],\n  asian: [\n    '#946761',\n    '#b80040',\n    '#4eacb8',\n    '#7f1f69',\n    '#c8b568',\n    '#147472',\n    '#1d518b',\n    '#b1623b',\n    '#95a578',\n    '#b9b327',\n    '#af508a',\n    '#dab100',\n  ],\n};\n\nexport const chooseColorScheme = (key: string) => {\n  const cs =\n    key in PuppyColorScheme\n      ? PuppyColorScheme[key]\n      : PuppyColorScheme[\n          Common.choose([\n            'pop',\n            'cute',\n            'dynamic',\n            'gorgeous',\n            'casual',\n            'psychedelic',\n            'bright',\n            'fairytale',\n            'heavy',\n            'impact',\n            'street',\n            'cool',\n            'elegant',\n            'fresh',\n            'warm',\n            'soft',\n            'man',\n            'woman',\n            'boy',\n            'girl',\n            'smart',\n            'light',\n            'stylish',\n            'natural',\n            'spring',\n            'summer',\n            'fall',\n            'winter',\n            'japan',\n            'euro',\n            'nordic',\n            'asian',\n          ])\n        ];\n  const targets = <HTMLCollectionOf<HTMLElement>>(\n    document.getElementsByClassName('btn')\n  );\n  for (let i = 0; i < targets.length; i += 1) {\n    targets[i].style.backgroundColor = cs[i % cs.length];\n    targets[i].style.borderColor = cs[i % cs.length];\n  }\n  return cs;\n};\n","import * as Matter from 'matter-js';\nimport { myRender } from './render';\nimport { initVars, Shape, PuppyConstructor } from './shape';\nimport {\n  getInputValue,\n  getDiffStartLineNumber,\n  setCodeHighlight,\n  resetCodeHighlight,\n  getIsLive,\n} from '../modules/operations';\nimport { chooseColorScheme } from './color';\n\n// const Bodies = Matter.Bodies;\nconst Engine = Matter.Engine;\nconst Runner = Matter.Runner;\nconst Render = myRender(Matter.Render);\nconst Constraint = Matter.Constraint;\nconst MouseConstraint = Matter.MouseConstraint;\nconst Mouse = Matter.Mouse;\nconst World = Matter.World;\nconst Bounds = Matter.Bounds;\nconst Vertices = Matter.Vertices;\nconst Detector = Matter['Detector'];\nconst Common = Matter['Common'];\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\n// export type ErrorShape = {\n//   type: 'error' | 'info' | 'warning' | 'hint';\n//   row: number;\n//   col: number;\n//   len: number;\n//   text: string;\n// };\n\nexport type ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(_index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(_ty: Type, _update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(_map: any): Type {\n    return this;\n  }\n}\n\nexport type PuppySettings = {\n  canvas: string;\n  ftrace: (log: {}) => void;\n  eachUpdate?: (time: number) => void;\n};\n\ntype PuppyWorld = {\n  background: string;\n  width: number;\n  height: number;\n  viewWidth: number;\n  viewHeight: number;\n  view: { min: Matter.Vector; max: Matter.Vector };\n  colorScheme: [string];\n\n  opacity: number /* Default 1.0 */;\n\n  font: string;\n  gravity: Matter.Vector;\n  density: number /* Default: 0.001 */;\n  friction: number /* Default: 0.1 */;\n  airFriction: number /* Default: 0.01 */;\n  frictionStatic: number /* Default: 0.5 */;\n  motion: number /* Default: 0 */;\n  restitution: number /* 0 */;\n};\n\n// (Puppy, {}) -> (number, number, number) -> any\nexport class Puppy {\n  private settings: PuppySettings;\n  public code: any;\n  public world: PuppyWorld | null;\n\n  public interval: number;\n  public waitRestart: boolean;\n  public isExecuting: boolean;\n\n  private runner: Matter.Runner | null;\n  private engine: Matter.Engine | null;\n  private render: Matter.Render | null;\n  private canvas: HTMLCanvasElement | null;\n\n  // private debug_mode: boolean;\n\n  private vars: {};\n\n  // new puppy\n  public constructor(settings: PuppySettings, code: any, waitStart = false) {\n    this.settings = settings;\n    this.code = code;\n    this.world = null;\n    this.interval = 500;\n    this.waitRestart = waitStart;\n    this.isExecuting = false;\n    this.runner = null;\n    this.engine = null;\n    this.render = null;\n    this.canvas = null;\n    this.vars = {};\n  }\n\n  private initCode() {\n    const code = this.code;\n    const width = code.world['width'] || 1000;\n    const height = code.world['height'] || 1000;\n    const vwidth = code.world['viewWidth'] || width;\n    const vheight = code.world['viewHeight'] || height;\n    const pos: Matter.Vector = code.world['position'] || { x: 0, y: 0 };\n    this.code = code;\n    this.world = {\n      width,\n      height,\n      viewWidth: vwidth,\n      viewHeight: vheight,\n      background: code.world['background'] || 'white',\n      gravity: code.world['gravitiy'] || { x: 0.0, y: 1.0 },\n      colorScheme: chooseColorScheme(code.world['colorScheme'] || ''),\n      opacity: code.world['opacity'] || 1.0,\n      font: code.world['font'] || \"bold 60px 'Arial'\",\n      view: code.world['view'] || {\n        min: pos,\n        max: { x: pos.x + vwidth, y: pos.y + vheight },\n      },\n      density: code.world['density'] || 0.001,\n      friction: code.world['friction'] || 0.1,\n      airFriction: code.world['airFriction'] || 0.01,\n      frictionStatic: code.world['frictionStatic'] || 0.5,\n      motion: code.world['motion'] || 0,\n      restitution: code.world['restitution'] || 0,\n    };\n  }\n\n  private startCode() {\n    this.engine = Engine.create();\n\n    if (this.world!.gravity) {\n      const engine = this.engine;\n      window.addEventListener('deviceorientation', event => {\n        const orientation = window.orientation || 0;\n        const gravity = engine.world.gravity;\n        if (orientation === 0) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.beta!, -90, 90) / 90;\n        } else if (orientation === 180) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.beta!, -90, 90) / 90;\n        } else if (orientation === 90) {\n          gravity.x = Common.clamp(event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.gamma!, -90, 90) / 90;\n        } else if (orientation === -90) {\n          gravity.x = Common.clamp(-event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.gamma!, -90, 90) / 90;\n        }\n      });\n    }\n    Matter.Events.on(this.engine, 'beforeUpdate', () => {\n      const time = this.engine!.timing.timestamp;\n      if (this.settings.eachUpdate) {\n        this.settings.eachUpdate(time);\n      }\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        const body: Matter.Body = bodies[i];\n        if (body['move']) {\n          body['move'](body, time);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionActive', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionActive']) {\n          pair.bodyA['collisionActive'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionActive']) {\n          pair.bodyB['collisionActive'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionStart', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionStart']) {\n          pair.bodyA['collisionStart'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionStart']) {\n          pair.bodyB['collisionStart'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionEnd', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionEnd']) {\n          pair.bodyA['collisionEnd'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionEnd']) {\n          pair.bodyB['collisionEnd'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    this.runner = Runner.create({ isFixed: false });\n    // render\n    const canvas = document.getElementById(this.settings.canvas);\n    let render_width = canvas!.clientWidth;\n    let render_height =\n      (canvas!.clientWidth * this.world!.height) / this.world!.width;\n    if (render_height > canvas!.clientHeight) {\n      render_height = canvas!.clientHeight;\n      render_width =\n        (canvas!.clientHeight * this.world!.width) / this.world!.height;\n    }\n    const render = {\n      /* Matter.js  canvas   */\n      // element: document.getElementById('canvas'),\n      element: canvas,\n      engine: this.engine,\n      options: {\n        /*  */\n        width: render_width,\n        height: render_height,\n        background: this.world!.background,\n        font: this.world!.font,\n        wireframes: false,\n      },\n    };\n    this.render = Render.create(render);\n    this.canvas = this.render!.canvas;\n    /* / */\n    Render['lookAt'](this.render, this.world!.view);\n    /*  */\n    const mouse = Mouse.create(this.render!.canvas);\n    const constraintOptions = {\n      pointA: { x: 0, y: 0 },\n      pointB: { x: 0, y: 0 },\n      stiffness: this.world!['mouseStiffness'] || 0.2 /*  */,\n    };\n    constraintOptions['render'] = {\n      visible: false,\n    };\n    const mouseConstraint = MouseConstraint.create(this.engine, {\n      mouse,\n      constraint: Constraint.create(constraintOptions),\n    });\n    World.add(this.engine.world, mouseConstraint);\n    this.render!['mouse'] = mouse;\n\n    // an example of using mouse events on a mouse\n    // const mouse = Mouse.create(this.element);\n    // this.element.addEventListener('click', () => {\n    //   const query = Query.point(Composite.allBodies(world), mouse.position)\n    //   console.log(mouse.position);\n    //   console.log(query);\n    // });\n    Matter.Events.on(mouseConstraint, 'mousedown', event => {\n      const mouse = event.mouse;\n      let body = event.sourcebody;\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        body = bodies[i];\n        if (\n          Bounds.contains(body.bounds, mouse.position) &&\n          Detector.canCollide(\n            body.collisionFilter,\n            mouseConstraint.collisionFilter\n          )\n        ) {\n          for (\n            let j = body.parts.length > 1 ? 1 : 0;\n            j < body.parts.length;\n            j += 1\n          ) {\n            const part = body.parts[j];\n            if (\n              part['clicked'] &&\n              Vertices.contains(part.vertices, mouse.position)\n            ) {\n              part['clicked'](part);\n              break;\n            }\n          }\n        }\n      }\n    });\n    //\n    this.vars = initVars({});\n    // this.main = code.main || (function* (Matter: any, puppy: Puppy) { });\n\n    Runner.run(this.runner, this.engine); /* */\n    Render.run(this.render); /*  */\n    // this.runner.enabled = false; /* */\n  }\n\n  public dispose() {\n    if (this.engine) {\n      World.clear(this.engine.world, false);\n      Engine.clear(this.engine);\n    }\n    /* engine */\n    if (this.runner) {\n      Runner.stop(this.runner);\n    }\n    if (this.render) {\n      Render.stop(this.render);\n      this.render.canvas.remove();\n      // this.render!.canvas = null;\n      // this.render!.context = null;\n      this.render.textures = {};\n    }\n  }\n\n  // private DefaultRenderOptions: () => Matter.IRenderDefinition;\n\n  public getCode() {\n    return this.code;\n  }\n\n  public getCanvas() {\n    return this.canvas;\n  }\n\n  public resize(width: number, height: number) {\n    // console.log(`'resize width ${width} ${this.canvas.clientWidth} height ${height} ${this.canvas.clientHeight}`);\n    let w = width;\n    let h = (width * this.world!.viewHeight) / this.world!.viewWidth;\n    if (h > height) {\n      h = height;\n      w = (height * this.world!.viewWidth) / this.world!.viewHeight;\n    }\n    this.canvas!.setAttribute('width', w.toString());\n    this.canvas!.setAttribute('height', h.toString());\n    // console.log('resize width {this.render.options.width} => {w} height {this.render.options.height} => {h}');\n    this.render!.options.width = w;\n    this.render!.options.height = h;\n  }\n\n  public async wait(msec) {\n    await new Promise(resolve => setTimeout(resolve, msec));\n  }\n\n  public async waitForRun(interval) {\n    while (this.waitRestart) {\n      await this.wait(interval);\n    }\n    this.runner!.enabled = true;\n  }\n\n  public async execute_main() {\n    const diffStartLineNumber = getDiffStartLineNumber();\n    this.isExecuting = true;\n    for await (const lineNumber of this.code.main(this)) {\n      if (lineNumber < diffStartLineNumber && getIsLive()) {\n        for (let i = 0; i < this.interval / this.runner!.delta; i += 1) {\n          this.engine = Engine.update(this.engine!, undefined, undefined);\n        }\n      } else {\n        setCodeHighlight(lineNumber, lineNumber);\n        await this.waitForRun(1000);\n        await this.wait(this.interval);\n      }\n    }\n    this.isExecuting = false;\n    resetCodeHighlight();\n    // editor NG\n    // let prevline = 0;\n    // const lines: [string] = editor.getSession().getDocument().getAllLines();\n    // for await (const linenum of this.main(Matter, this)) {\n    //   if (prevline == 0 || prevline >= linenum || lines[prevline] == '') {\n    //     selectLine(linenum - 1, linenum);\n    //   }\n    //   else {\n    //     selectLine(prevline, linenum);\n    //   }\n    //   prevline = linenum;\n    //   if (this.isStep) {\n    //     this.runner.enabled = false;\n    //     this.isStep = false;\n    //   } else {\n    //     await this.wait(0.5);\n    //   }\n    //   await this.waitForRun(1);\n    // }\n    // removeLine();\n    // if (this.isStep) {\n    //   this.runner.enabled = true;\n    //   this.isStep = false;\n    // }\n  }\n\n  public isRunning() {\n    return this.runner && this.runner.enabled;\n  }\n\n  public runCode() {\n    this.initCode();\n    this.dispose();\n    this.startCode();\n    this.runner!.enabled = !this.waitRestart;\n    this.execute_main();\n  }\n\n  // public updateLiveCode(code: PuppyCode) {\n  //   this.code = code;\n  //   if (this.runner!.enabled) {\n  //     if (code.diff) {\n  //       this.initCode();\n  //       console.log(`live diff now ${code.diff}`);\n  //       code.diff(this);\n  //       return true;\n  //     }\n  //     if (code.lives && code.lives.length > 0) {\n  //       this.initCode();\n  //       const bodies = Matter.Composite.allBodies(this.engine!.world);\n  //       for (const body of bodies) {\n  //         for (const live of code.lives) {\n  //           if (body['oid'] === live[0]) {\n  //             console.log(body);\n  //             console.log(live);\n  //             const name = live[1];\n  //             console.log(`change ${name} ${body[name]} ${live[2]} ${live[3]}`);\n  //             // if (body[name] === live[3] || live[3] == null) {\n  //             setShapeProperty(this, body as Shape, name, live[2]);\n  //             // }\n  //           }\n  //         }\n  //       }\n  //       return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n\n  public pause() {\n    this.waitRestart = true;\n    this.runner!.enabled = false;\n  }\n\n  public start() {\n    if (this.isExecuting) {\n      this.waitRestart = false;\n    } else {\n      this.runner!.enabled = true;\n    }\n  }\n\n  public getTimeStamp() {\n    return this.engine!.timing.timestamp;\n  }\n\n  // lives\n\n  public ln(n: number) {\n    return this.code.lines[n];\n  }\n\n  // Puppy APIs\n\n  public new_ = (\n    cons: PuppyConstructor,\n    x: number,\n    y: number,\n    options: Shape\n  ) => {\n    if (!options.position) {\n      options.position = { x, y };\n    }\n    const body: Matter.Body = cons(this, options);\n    World.add(this.engine!.world, [body]);\n    return body;\n  };\n\n  public Circle = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Circle'], x, y, options);\n  };\n\n  public Rectangle = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Rectangle'], x, y, options);\n  };\n\n  public Polygon = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Polygon'], x, y, options);\n  };\n\n  public Label = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Label'], x, y, options);\n  };\n\n  public World = (x: number, y: number, options: Partial<PuppyWorld>) => {\n    if (this.engine && this.world) {\n      this.world.viewWidth = x;\n      this.world.viewHeight = y;\n      const pos = this.world.view.min;\n      this.world.view = {\n        min: pos,\n        max: { x: pos.x + x, y: pos.y + y },\n      };\n      this.resize(this.render!.options.width!, this.render!.options.height!);\n      Render['lookAt'](this.render, this.world!.view);\n      if (options) {\n        Object.keys(options).map((key: string) => {\n          if (this.world && key in this.world) {\n            if (key == 'background') {\n              this.render!.options['background'] = options['background'];\n            }\n            this.world[key] = options[key];\n          }\n          if (this.engine && key in this.engine.world) {\n            this.engine.world[key] = options[key];\n          }\n        });\n      }\n    }\n  };\n\n  public async input(msg?: string) {\n    this.runner!.enabled = false;\n    const x = await getInputValue(msg ? msg : '');\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    console.log(`input ${x}`);\n    return x;\n  }\n\n  public async input0(console?: string) {\n    this.runner!.enabled = false;\n    const awaitForClick = target => {\n      return new Promise(resolve => {\n        // A\n        const listener = resolve; // B\n        target.addEventListener('click', listener, { once: true }); // C\n      });\n    };\n    const text = document.getElementById('inputtext') as HTMLInputElement;\n    const f = async () => {\n      const target = document.querySelector('#submitInput');\n      let Text = '';\n      document.getElementById('submitInput')!.onclick = () => {\n        document.getElementById('myOverlay')!.style.display = 'none';\n        Text = text.value;\n        text.value = '';\n      };\n      await awaitForClick(target);\n      return Text;\n    };\n\n    text.placeholder = console ? console : 'Input here';\n    document.getElementById('myOverlay')!.style.display = 'block';\n    const x = await f();\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    return x;\n  }\n\n  public print(text: string, options = {}) {\n    const width = this.world!.width;\n    const _options: Shape = Common.extend(\n      {\n        shape: 'label',\n        value: `${text}`,\n        created: this.getTimeStamp(),\n        move: (body, time: number) => {\n          const px = width - 100 * (time - body['created']) * 0.003;\n          Matter.Body.setPosition(body, { x: px, y: body.position.y });\n          if (px < -1) {\n            World.remove(this.engine!.world, body);\n          }\n        },\n      },\n      options\n    );\n    const x = this.world!.width;\n    const y = this.world!.height * (Math.random() * 0.9 + 0.05);\n    this.new_(this.vars['Label'], x, y, _options);\n  }\n\n  public trace(log: {}) {\n    console.log(log);\n    // this.settings.trace(log);\n  }\n\n  /* operator */\n\n  public listAdd(x: [], y: []) {\n    return x.concat(y);\n  }\n\n  public anyMul(x, y) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: [any]) {\n    return a.indexOf(x) >= 0;\n  }\n\n  /* built-in */\n\n  public int(x: any) {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      return Number.parseInt(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public float(x: any) {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      return Number.parseFloat(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public str(x: any) {\n    if (typeof x === 'boolean') {\n      return x ? 'True' : 'False';\n    }\n    if (Array.isArray(x)) {\n      return '[' + x.map(x => this.str(x)).join(', ') + ']';\n    }\n    return `${x}`;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public getindex(a: any, index: number) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substr(x, y - x);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: []) {\n    return x.length;\n  }\n\n  public map(func: any, lst: number[]) {\n    return Array.from(lst, func); // func\n  }\n\n  /* Matter.Body */\n\n  public setPosition(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setPosition(body, { x, y });\n  }\n\n  public applyForce(\n    body: Matter.Body,\n    x: number,\n    y: number,\n    fx: number,\n    fy: number\n  ) {\n    Matter.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: Matter.Body, angle: number, _x?: number, _y?: number) {\n    Matter.Body.rotate(body, angle);\n  }\n\n  public scale(\n    body: Matter.Body,\n    sx: number,\n    sy: number,\n    _x?: number,\n    _y?: number\n  ) {\n    Matter.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: Matter.Body, angle: number) {\n    Matter.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: Matter.Body, velocity: number) {\n    Matter.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: Matter.Body, density: number) {\n    Matter.Body.setDensity(body, density);\n  }\n\n  public setMass(body: Matter.Body, mass: number) {\n    Matter.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: Matter.Body, flag: boolean) {\n    Matter.Body.setStatic(body, flag);\n  }\n}\n\n/* puppy controller */\n\nlet puppy_settings = {\n  canvas: 'puppy-screen',\n  ftrace: (_log: {}) => {},\n};\n\nexport const initPuppy = (settings?: PuppySettings) => {\n  if (settings) {\n    puppy_settings = settings;\n  }\n};\n\nexport const runPuppy = (\n  puppy: Puppy | null,\n  code: PuppyCode,\n  alwaysRun: boolean,\n  waitStart = false\n) => {\n  if (puppy != null) {\n    if (!alwaysRun && code) {\n      // if (puppy.getCode().hash === code.hash) {\n      //   return puppy;\n      // }\n      if (puppy.isRunning()) {\n        // console.log(`lives ${code.lives}`);\n        // console.log(`diff ${code.diff}`);\n        // if (puppy.updateLiveCode(code)) {\n        //   return puppy;\n        // }\n      }\n    }\n  }\n  if (code) {\n    if (puppy != null) {\n      puppy.dispose();\n    }\n    const newpuppy = new Puppy(puppy_settings, code, waitStart);\n    newpuppy.runCode();\n    return newpuppy;\n  }\n  return null;\n};\n","import { Action } from 'redux';\n\nenum VersionActionTypes {\n  SET_VERSION_SHOW = 'SET_VERSION_SHOW',\n}\n\ninterface SetShowAction extends Action {\n  type: VersionActionTypes.SET_VERSION_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: VersionActionTypes.SET_VERSION_SHOW,\n  payload: {\n    show,\n  },\n});\n\nexport type VersionActions = SetShowAction;\n\nexport type VersionState = {\n  show: boolean;\n};\n\nconst initialState: VersionState = {\n  show: false,\n};\n\nconst VersionReducer = (state = initialState, action: VersionActions) => {\n  switch (action.type) {\n    case VersionActionTypes.SET_VERSION_SHOW:\n      return { ...state, show: action.payload.show };\n    default:\n      return state;\n  }\n};\n\nexport default VersionReducer;\n","import { Action, createStore, combineReducers } from 'redux';\nimport editor, { EditorState, EditorActions } from './modules/editor';\nimport course, { CourseState, CourseActions } from './modules/course';\nimport puppy, { PuppyState, PuppyActions } from './modules/puppy';\nimport input, { InputState, InputActions } from './modules/input';\nimport version, { VersionState, VersionActions } from './modules/version';\n\nconst allReducers = combineReducers({\n  editor,\n  course,\n  puppy,\n  input,\n  version,\n});\n\nexport const store = createStore(allReducers);\n\nexport type ReduxState = {\n  editor: EditorState;\n  course: CourseState;\n  puppy: PuppyState;\n  input: InputState;\n  version: VersionState;\n};\n\nexport type ReduxActions =\n  | PuppyActions\n  | EditorActions\n  | CourseActions\n  | InputActions\n  | VersionActions\n  | Action;\n\nexport default store;\n","export class ParseTree {\n  public tag: string;\n  public urn: any;\n  public inputs: string;\n  public spos: number;\n  public epos: number;\n  public nodes: [string, ParseTree][];\n\n  public constructor(tag: string, spos: number, epos: number, child: any) {\n    this.tag = tag;\n    this.urn = child;\n    this.inputs = '';\n    this.spos = spos;\n    this.epos = epos;\n    this.nodes = ParseTree.empties;\n  }\n\n  static empties: [string, ParseTree][] = [];\n\n  protected setup(urn: string, inputs: string) {\n    if (this.urn !== null) {\n      const nodes: [string, ParseTree][] = [];\n      var entry: Merge = this.urn;\n      while (entry !== null) {\n        nodes.push([entry.edge, entry.child.setup(urn, inputs)]);\n        entry = entry.prev;\n      }\n      this.nodes = nodes.reverse();\n    }\n    this.urn = urn;\n    this.inputs = inputs;\n    var t: any = this;\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      t[i] = this.nodes[i][1];\n      if (this.nodes[i][0] !== '') {\n        t[this.nodes[i][0]] = this.nodes[i][1];\n      }\n    }\n    return this;\n  }\n\n  public is(tag: string) {\n    return this.tag === tag;\n  }\n\n  public isError() {\n    return this.tag === 'err';\n  }\n\n  public subs(): ParseTree[] {\n    const subs: ParseTree[] = [];\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      subs.push(this.nodes[i][1]);\n    }\n    return subs;\n  }\n\n  public size() {\n    return this.nodes.length;\n  }\n\n  public contains(edge: string) {\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      if (this.nodes[i][0] === edge) return true;\n    }\n    return false;\n  }\n\n  public get(index: any) {\n    return (this as any)[index];\n  }\n\n  public tokenize(index?: any, defstr?: string) {\n    if (index === undefined) {\n      return this.inputs.substring(this.spos, this.epos);\n    }\n    const child = (this as any)[index];\n    if (child === undefined) {\n      return defstr || '';\n    }\n    return child.tokenize();\n  }\n\n  private pos(pos: number) {\n    const s = this.inputs;\n    pos = Math.min(pos, s.length);\n    var row = 0;\n    var col = 0;\n    for (var i = 0; i <= pos; i += 1) {\n      if (s.charCodeAt(i) == 10) {\n        row += 1;\n        col = 0;\n      } else {\n        col += 1;\n      }\n    }\n    return [pos, row, col];\n  }\n\n  public begin() {\n    return this.pos(this.spos);\n  }\n\n  public end() {\n    return this.pos(this.spos);\n  }\n\n  public length() {\n    return this.epos - this.spos;\n  }\n\n  public toString() {\n    const sb: string[] = [];\n    this.strOut(sb);\n    return sb.join('');\n  }\n\n  protected strOut(sb: string[]) {\n    sb.push('[#');\n    sb.push(this.tag);\n    for (const node of this.nodes) {\n      sb.push(node[0] === '' ? ' ' : ` ${node[0]}=`);\n      node[1].strOut(sb);\n    }\n    if (this.nodes.length == 0) {\n      const s = this.inputs.substring(this.spos, this.epos);\n      sb.push(\" '\");\n      sb.push(s);\n      sb.push(\"'\");\n    }\n    sb.push(']');\n  }\n}\n\nclass Merge {\n  public prev: any;\n  public edge: string;\n  public child: ParseTree;\n\n  public constructor(prev: any, edge: string, child: ParseTree) {\n    this.prev = prev;\n    this.edge = edge;\n    this.child = child;\n  }\n}\n\nclass ParserContext {\n  public urn: string;\n  public inputs: String;\n  public pos: number;\n  public epos: number;\n  public head_pos: number;\n  public ast: any;\n  public state: State | null;\n  public memos: Memo[];\n  public constructor(urn: string, inputs: string, pos: number, epos: number) {\n    this.urn = urn;\n    this.inputs = inputs;\n    this.pos = pos;\n    this.epos = epos;\n    this.head_pos = pos;\n    this.ast = null;\n    this.state = null;\n    this.memos = [];\n    for (var i = 0; i < 1789; i++) {\n      this.memos.push(new Memo());\n    }\n  }\n}\n\nconst EMPTY = (px: ParserContext) => {\n  return true;\n};\n\nconst pEmpty = () => {\n  return EMPTY;\n};\n\nconst ANY = (px: ParserContext) => {\n  if (px.pos < px.epos) {\n    px.pos += 1;\n    return true;\n  }\n  return false;\n};\n\nconst pAny = () => {\n  return ANY;\n};\n\nconst pChar = (text: string) => {\n  const text_length = text.length;\n\n  return (px: ParserContext) => {\n    if (px.inputs.startsWith(text, px.pos)) {\n      px.pos += text_length;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst find_codemax = (chars: string, ranges: string[]) => {\n  var code = 0;\n  for (var i = 0; i < chars.length; i += 1) {\n    code = Math.max(chars.charCodeAt(i), code);\n  }\n  for (const range of ranges) {\n    code = Math.max(range.charCodeAt(0), code);\n    code = Math.max(range.charCodeAt(1), code);\n  }\n  return code;\n};\n\nconst set_bitmap = (bitmap: Uint8Array, c: number) => {\n  const n = (c / 8) | 0;\n  const mask = 1 << (c % 8 | 0);\n  //console.log(n);\n  //console.log(bitmap[n])\n  bitmap[n] |= mask;\n  //console.log(bitmap);\n};\n\nconst pRange = (chars: string, ranges: string[]) => {\n  const codemax = find_codemax(chars, ranges) + 1;\n  const bitmap = new Uint8Array(((codemax / 8) | 0) + 1);\n  bitmap[0] = 2;\n  for (var i = 0; i < chars.length; i += 1) {\n    set_bitmap(bitmap, chars.charCodeAt(i));\n  }\n  for (const range of ranges) {\n    for (var c = range.charCodeAt(0); c <= range.charCodeAt(1); c += 1) {\n      set_bitmap(bitmap, c);\n    }\n  }\n  //console.log(`bitmap ${ bitmap.length } `)\n  return (px: ParserContext) => {\n    if (px.pos < px.epos) {\n      const c = px.inputs.charCodeAt(px.pos);\n      const n = (c / 8) | 0;\n      const mask = 1 << (c % 8 | 0);\n      if (n < bitmap.length && (bitmap[n] & mask) === mask) {\n        px.pos += 1;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pMany = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    var pos = px.pos;\n    var ast = px.ast;\n    while (match(px) && px.pos > pos) {\n      pos = px.pos;\n      ast = px.ast;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return true;\n  };\n};\n\nconst pMany1 = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    if (match(px)) {\n      var pos = px.pos;\n      var ast = px.ast;\n      while (match(px) && px.pos > pos) {\n        pos = px.pos;\n        ast = px.ast;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAnd = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pNot = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return false;\n    }\n    return true;\n  };\n};\n\nconst pOption = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (!match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return true;\n  };\n};\n\nconst pSeq = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    for (const match of matches) {\n      if (!match(px)) {\n        return false;\n      }\n    }\n    return true;\n  };\n};\n\nconst pSeq2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px);\n  };\n};\n\nconst pSeq3 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean,\n  match3: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px) && match3(px);\n  };\n};\n\nconst pOre = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    for (const match of matches) {\n      if (match(px)) {\n        return true;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return false;\n  };\n};\n\nconst pOre2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      return true;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return match2(px);\n  };\n};\n\nconst pRef = (peg: any, name: string) => {\n  if (peg[name]) {\n    return peg[name];\n  }\n  return (px: ParserContext) => {\n    return peg[name](px);\n  };\n};\n\nclass Memo {\n  public key: number;\n  public constructor() {\n    this.key = -1;\n  }\n}\n\nconst pNode = (\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = null;\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\n//def Merge(prev, edge, child):\n//return (prev, edge, child)\n\nconst pEdge = (edge: string, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = new Merge(ast, edge, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pFold = (\n  edge: string,\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = new Merge(null, edge, px.ast);\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAbs = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pSkipErr = () => {\n  return (px: ParserContext) => {\n    px.pos = Math.min(px.head_pos, px.epos);\n    return true;\n  };\n};\n\nclass State {\n  public sid: number;\n  public value: any;\n  public prev: State | null;\n  public constructor(sid: number, value: any, prev: State | null) {\n    this.sid = sid;\n    this.value = value;\n    this.prev = prev;\n  }\n}\n\nconst getstate = (state: State | null, sid: number) => {\n  while (state !== null) {\n    if (state.sid === sid) {\n      return state;\n    }\n    state = state.prev;\n  }\n  return null;\n};\n\nconst pSymbol = (sid: number, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.state = new State(sid, px.inputs.substring(pos, px.pos), px.state);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pExists = (sid: number) => {\n  return (px: ParserContext) => {\n    return getstate(px.state, sid) !== null;\n  };\n};\n\nconst pMatch = (sid: number) => {\n  return (px: ParserContext) => {\n    const state = getstate(px.state, sid);\n    if (state !== null) {\n      if (px.inputs.startsWith(state.value, px.pos)) {\n        px.pos += (state.value as string).length;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pScope = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const state = px.state;\n    const res = match(px);\n    px.state = state;\n    return res;\n  };\n};\n\nexport const generate = (start: string) => {\n  const match = grammar(start);\n  if (match === undefined) {\n    console.log(`undefined ${start}`);\n    console.log(peg);\n  }\n  return (inputs: string, options?: any) => {\n    const op = options === undefined ? {} : options;\n    const pos = 0;\n    const px = new ParserContext(\n      op['urn'] || '(unknown source)',\n      inputs,\n      0,\n      inputs.length\n    );\n    if (match(px)) {\n      if (px.ast === null) {\n        px.ast = new ParseTree('', pos, px.pos, null);\n      }\n    } else {\n      px.ast = new ParseTree('err', px.head_pos, px.head_pos + 1, null);\n    }\n    return px.ast.setup(px.urn, inputs);\n  };\n};\n\nlet peg: any = null;\n\nconst grammar = (start: string) => {\n  if (peg === null) {\n    peg = {};\n    peg['Source'] = pSeq3(\n      pOption(pRef(peg, 'EOL')),\n      pNode(\n        pMany(pSeq2(pEdge('', pRef(peg, 'Statement')), pRef(peg, 'EOL'))),\n        'Source',\n        0\n      ),\n      pRef(peg, 'EOF')\n    );\n    peg['Block'] = pNode(\n      pScope(\n        pSeq3(\n          pSymbol(0, pRef(peg, 'INDENT')),\n          pOre2(\n            pSeq3(\n              pEdge('', pRef(peg, 'Statement')),\n              pMany(pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))),\n              pOption(pRef(peg, '\";\"'))\n            ),\n            pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n          ),\n          pMany(\n            pSeq2(\n              pMatch(0),\n              pOre2(\n                pSeq3(\n                  pEdge('', pRef(peg, 'Statement')),\n                  pMany(\n                    pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))\n                  ),\n                  pOption(pRef(peg, '\";\"'))\n                ),\n                pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n              )\n            )\n          )\n        )\n      ),\n      'Block',\n      0\n    );\n    peg['Statement'] = pOre(\n      pRef(peg, 'ClassDecl'),\n      pRef(peg, 'ImportDecl'),\n      pRef(peg, 'FuncDecl'),\n      pRef(peg, 'IfStmt'),\n      pRef(peg, 'ForStmt'),\n      pRef(peg, 'WhileStmt'),\n      pRef(peg, 'Return'),\n      pRef(peg, 'Yield'),\n      pRef(peg, 'Break'),\n      pRef(peg, 'Continue'),\n      pRef(peg, 'VarDecl'),\n      pRef(peg, 'Expression')\n    );\n    peg['ImportDecl'] = pOre2(\n      pNode(\n        pSeq3(\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pOption(\n            pSeq2(\n              pSeq2(pChar('as'), pRef(peg, 'S')),\n              pEdge('alias', pRef(peg, 'Name'))\n            )\n          )\n        ),\n        'ImportDecl',\n        0\n      ),\n      pNode(\n        pSeq(\n          pSeq2(pChar('from'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge(\n            'names',\n            pOre2(\n              pNode(\n                pSeq2(\n                  pEdge('', pRef(peg, 'Name')),\n                  pMany(\n                    pSeq3(\n                      pChar(','),\n                      pRef(peg, '_'),\n                      pEdge('', pRef(peg, 'Name'))\n                    )\n                  )\n                ),\n                '',\n                0\n              ),\n              pNode(pSeq2(pChar('*'), pRef(peg, '_')), '', 0)\n            )\n          )\n        ),\n        'FromDecl',\n        0\n      )\n    );\n    peg['ClassDecl'] = pNode(\n      pSeq(\n        pChar('class'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq(\n            pChar('('),\n            pRef(peg, '_'),\n            pEdge('extends', pRef(peg, 'Name')),\n            pChar(')'),\n            pRef(peg, '_')\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pOre2(pEdge('', pRef(peg, 'Block')), pEdge('', pRef(peg, 'Statement')))\n      ),\n      'ClassDecl',\n      0\n    );\n    peg['FuncDecl'] = pNode(\n      pSeq(\n        pChar('def'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pEdge('params', pRef(peg, 'FuncParams')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncDecl',\n      0\n    );\n    peg['FuncParams'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pOption(pEdge('', pRef(peg, 'FuncParam'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'FuncParam')))),\n        pRef(peg, '\")\"')\n      ),\n      'FuncParam',\n      0\n    );\n    peg['FuncParam'] = pNode(\n      pSeq2(\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq3(pChar(':'), pRef(peg, '_'), pEdge('type', pRef(peg, 'Name')))\n        )\n      ),\n      'Param',\n      0\n    );\n    peg['Lambda'] = pNode(\n      pSeq(\n        pChar('lambda'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('params', pRef(peg, 'LambdaParams'))\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncExpr',\n      0\n    );\n    peg['LambdaParams'] = pNode(\n      pSeq2(\n        pOption(pEdge('', pRef(peg, 'Name'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Name'))))\n      ),\n      'Param',\n      0\n    );\n    peg['Return'] = pNode(\n      pSeq2(\n        pChar('return'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('expr', pRef(peg, 'Expression'))\n          )\n        )\n      ),\n      'Return',\n      0\n    );\n    peg['Yield'] = pNode(pSeq2(pChar('yield'), pRef(peg, '_')), 'Yield', 0);\n    peg['Pass'] = pNode(pSeq2(pChar('pass'), pRef(peg, '_')), 'Pass', 0);\n    peg['Break'] = pNode(pSeq2(pChar('break'), pRef(peg, '_')), 'Break', 0);\n    peg['Continue'] = pNode(\n      pSeq2(pChar('continue'), pRef(peg, '_')),\n      'Continue',\n      0\n    );\n    peg['IfStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('if'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement'))),\n        pOption(pEdge('elif', pRef(peg, 'ElifBlock'))),\n        pOption(\n          pSeq(\n            pOre2(pMatch(0), pRef(peg, 'NL')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pChar(':'),\n            pRef(peg, '_'),\n            pEdge('else', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n          )\n        )\n      ),\n      'IfStmt',\n      0\n    );\n    peg['ElifBlock'] = pNode(pMany1(pEdge('', pRef(peg, 'ElifStmt'))), '', 0);\n    peg['ElifStmt'] = pNode(\n      pSeq(\n        pOre2(pMatch(0), pRef(peg, 'NL')),\n        pSeq2(pChar('elif'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ElifStmt',\n      0\n    );\n    peg['ForStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('for'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('each', pRef(peg, 'Name')),\n        pSeq2(pChar('in'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('list', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ForStmt',\n      0\n    );\n    peg['WhileStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('while'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'WhileStmt',\n      0\n    );\n    peg['VarDecl'] = pOre2(\n      pNode(\n        pSeq(\n          pEdge('left', pRef(peg, 'LeftHand')),\n          pChar('='),\n          pRef(peg, '_'),\n          pEdge('right', pRef(peg, 'Expression'))\n        ),\n        'VarDecl',\n        0\n      ),\n      pRef(peg, 'SelfAssign')\n    );\n    peg['LeftHand'] = pSeq2(\n      pRef(peg, 'Name'),\n      pMany(\n        pOre2(\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['SelfAssign'] = pNode(\n      pSeq3(\n        pEdge('left', pRef(peg, 'LeftHand')),\n        pEdge('name', pRef(peg, 'SelfAssignOp')),\n        pEdge('right', pRef(peg, 'Expression'))\n      ),\n      'SelfAssign',\n      0\n    );\n    peg['SelfAssignOp'] = pSeq2(\n      pNode(\n        pSeq2(\n          pOre(\n            pChar('<<'),\n            pChar('>>'),\n            pChar('**'),\n            pChar('//'),\n            pRange('+=*@/%&|^', [])\n          ),\n          pChar('=')\n        ),\n        '',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Expression'] = pSeq2(\n      pRef(peg, 'Operator'),\n      pOption(\n        pFold(\n          'then',\n          pSeq(\n            pChar('if'),\n            pRef(peg, '_'),\n            pEdge('cond', pRef(peg, 'Expression')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pEdge('else', pRef(peg, 'Expression'))\n          ),\n          'IfExpr',\n          0\n        )\n      )\n    );\n    peg['Operator'] = pSeq2(\n      pRef(peg, 'AndExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'OR'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'AndExpr'))\n          ),\n          'Or',\n          0\n        )\n      )\n    );\n    peg['OR'] = pOre2(pChar('or'), pChar('||'));\n    peg['AndExpr'] = pSeq2(\n      pRef(peg, 'NotExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'AND'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'NotExpr'))\n          ),\n          'And',\n          0\n        )\n      )\n    );\n    peg['AND'] = pOre2(pChar('and'), pChar('&&'));\n    peg['NotExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pRef(peg, 'NOT'),\n          pRef(peg, '_'),\n          pEdge('', pRef(peg, 'NotExpr'))\n        ),\n        'Not',\n        0\n      ),\n      pRef(peg, 'EqExpr')\n    );\n    peg['NOT'] = pOre2(pSeq2(pChar('not'), pRef(peg, 'S')), pChar('!'));\n    peg['EqExpr'] = pSeq2(\n      pRef(peg, 'SumExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'EQ'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'SumExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['EQ'] = pOre(\n      pSeq2(pChar('=='), pNot(pChar('='))),\n      pSeq2(pChar('!='), pNot(pChar('='))),\n      pSeq2(pChar('<='), pNot(pChar('='))),\n      pSeq2(pChar('>='), pNot(pChar('='))),\n      pSeq2(pChar('<'), pNot(pChar('<'))),\n      pSeq2(pChar('>'), pNot(pChar('>'))),\n      pSeq2(pChar('in'), pRef(peg, 'S')),\n      pSeq2(pChar('is'), pRef(peg, 'S')),\n      pSeq2(pChar('is not'), pRef(peg, 'S'))\n    );\n    peg['SumExpr'] = pSeq2(\n      pRef(peg, 'ProdExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'SUM'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'ProdExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['SUM'] = pRange('+-|', []);\n    peg['ProdExpr'] = pSeq2(\n      pRef(peg, 'PowExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'PROD'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'PowExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['PROD'] = pOre(\n      pChar('//'),\n      pChar('<<'),\n      pChar('>>'),\n      pRange('*/%^&', [])\n    );\n    peg['PowExpr'] = pSeq2(\n      pRef(peg, 'UnaryExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pChar('**'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'UnaryExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['UnaryExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pEdge('name', pNode(pRef(peg, 'PRE'), 'Name', 0)),\n          pRef(peg, '_'),\n          pEdge('expr', pRef(peg, 'UnaryExpr'))\n        ),\n        'Unary',\n        0\n      ),\n      pRef(peg, 'SuffixExpr')\n    );\n    peg['PRE'] = pRange('+-~', []);\n    peg['SuffixExpr'] = pSeq2(\n      pRef(peg, 'Primary'),\n      pMany(\n        pOre(\n          pFold(\n            'recv',\n            pSeq(\n              pChar('.'),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name')),\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'MethodExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'name',\n            pSeq(\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'ApplyExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq(\n              pRef(peg, '\"[\"'),\n              pOption(pEdge('left', pRef(peg, 'Expression'))),\n              pChar(':'),\n              pRef(peg, '_'),\n              pOption(pEdge('right', pRef(peg, 'Expression'))),\n              pRef(peg, '\"]\"')\n            ),\n            'Slice',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['Arguments'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pEdge('', pRef(peg, 'Expression')), pNot(pChar('=')))),\n        pMany(\n          pSeq(\n            pChar(','),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'Expression')),\n            pNot(pChar('='))\n          )\n        ),\n        pOption(pEdge('', pRef(peg, 'KeywordArgument')))\n      ),\n      'Arguments',\n      0\n    );\n    peg['KeywordArgument'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pChar(','), pRef(peg, '__'))),\n        pEdge('', pRef(peg, 'Argument')),\n        pMany(\n          pSeq3(pChar(','), pRef(peg, '__'), pEdge('', pRef(peg, 'Argument')))\n        )\n      ),\n      'Data',\n      0\n    );\n    peg['Argument'] = pNode(\n      pSeq(\n        pEdge('name', pRef(peg, 'Name')),\n        pChar('='),\n        pRef(peg, '_'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Primary'] = pOre(\n      pRef(peg, 'GroupExpr'),\n      pRef(peg, 'ListExpr'),\n      pRef(peg, 'DataExpr'),\n      pRef(peg, 'Lambda'),\n      pRef(peg, 'Constant'),\n      pRef(peg, 'Name')\n    );\n    peg['GroupExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pEdge('', pRef(peg, 'Expression')),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression')))),\n        pRef(peg, '__'),\n        pRef(peg, '\")\"')\n      ),\n      'Tuple',\n      0\n    );\n    peg['ListExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"[\"'),\n        pOption(\n          pSeq2(\n            pEdge('', pRef(peg, 'Expression')),\n            pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression'))))\n          )\n        ),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"]\"')\n      ),\n      'List',\n      0\n    );\n    peg['DataExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"{\"'),\n        pEdge('', pRef(peg, 'KeyValue')),\n        pMany(pSeq2(pMany(pRef(peg, '\",\"')), pEdge('', pRef(peg, 'KeyValue')))),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"}\"')\n      ),\n      'Data',\n      0\n    );\n    peg['KeyValue'] = pNode(\n      pSeq3(\n        pEdge(\n          'name',\n          pOre(\n            pRef(peg, 'Name'),\n            pRef(peg, 'StringExpr'),\n            pRef(peg, 'CharExpr')\n          )\n        ),\n        pRef(peg, '\":\"'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Name'] = pOre2(pRef(peg, 'Identifier'), pRef(peg, 'NLPSymbol'));\n    peg['Identifier'] = pSeq2(\n      pNode(\n        pSeq2(pRange('', ['AZ', 'az']), pMany(pRange('_', ['AZ', 'az', '09']))),\n        'Name',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['NLPSymbol'] = pSeq2(\n      pNode(\n        pMany1(pOre(pRef(peg, 'HIRA'), pRef(peg, 'KATA'), pRef(peg, 'KANJI'))),\n        'NLPSymbol',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Constant'] = pOre(\n      pRef(peg, 'FormatString'),\n      pRef(peg, 'LongString'),\n      pRef(peg, 'StringExpr'),\n      pRef(peg, 'CharExpr'),\n      pRef(peg, 'Number'),\n      pRef(peg, 'TrueExpr'),\n      pRef(peg, 'FalseExpr'),\n      pRef(peg, 'NullExpr')\n    );\n    peg['FormatString'] = pSeq3(\n      pRange('Ff', []),\n      pOre(\n        pSeq3(\n          pChar(\"'''\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3'))), 'Format', 0),\n          pChar(\"'''\")\n        ),\n        pSeq3(\n          pChar(\"'\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1'))), 'Format', 0),\n          pChar(\"'\")\n        ),\n        pSeq3(\n          pChar('\"\"\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3D'))), 'Format', 0),\n          pChar('\"\"\"')\n        ),\n        pSeq3(\n          pChar('\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1D'))), 'Format', 0),\n          pChar('\"')\n        )\n      ),\n      pRef(peg, '_')\n    );\n    peg['FormatContent3'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'''\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent3D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"\"\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['LongString'] = pOre2(\n      pSeq(\n        pChar(\"''\"),\n        pNode(\n          pSeq3(\n            pChar(\"'\"),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange(\"\\\\'\", [])), pAny()),\n                pSeq2(pNot(pChar(\"'''\")), pChar(\"'\"))\n              )\n            ),\n            pChar(\"'\")\n          ),\n          'MultiString',\n          0\n        ),\n        pChar(\"''\"),\n        pRef(peg, '_')\n      ),\n      pSeq(\n        pChar('\"\"'),\n        pNode(\n          pSeq3(\n            pChar('\"'),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange('\\\\\"', [])), pAny()),\n                pSeq2(pNot(pChar('\"\"\"')), pChar('\"'))\n              )\n            ),\n            pChar('\"')\n          ),\n          'MultiString',\n          0\n        ),\n        pChar('\"\"'),\n        pRef(peg, '_')\n      )\n    );\n    peg['StringExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar('\"'), pMany(pRef(peg, 'STRING_CONTENT')), pChar('\"')),\n        'String',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['CharExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar(\"'\"), pMany(pRef(peg, 'CHAR_CONTENT')), pChar(\"'\")),\n        'Char',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['STRING_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange('\"\\n\\\\', [])), pAny())\n    );\n    peg['CHAR_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange(\"'\\n\\\\\", [])), pAny())\n    );\n    peg['ESCAPE'] = pOre(\n      pSeq2(pChar('\\\\'), pRange('\\'\"\\\\bfnrt', [])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('', ['03']),\n        pRange('', ['07']),\n        pRange('', ['07'])\n      ),\n      pSeq3(pChar('\\\\'), pRange('', ['07']), pRange('', ['07'])),\n      pSeq2(pChar('\\\\'), pRange('', ['07'])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('uU', []),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX')\n      )\n    );\n    peg['IntExpr'] = pSeq2(\n      pNode(\n        pOre(\n          pRef(peg, 'DECIMAL'),\n          pRef(peg, 'HEXADECIMAL'),\n          pRef(peg, 'BINARY'),\n          pRef(peg, 'OCTAL')\n        ),\n        'Int',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['DECIMAL'] = pOre2(\n      pSeq2(pChar('0'), pNot(pRange('bBxX_', ['09']))),\n      pSeq2(\n        pRange('', ['19']),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      )\n    );\n    peg['HEXADECIMAL'] = pSeq(\n      pChar('0'),\n      pRange('xX', []),\n      pRef(peg, 'HEX'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'HEX')))\n    );\n    peg['BINARY'] = pSeq(\n      pChar('0'),\n      pRange('bB', []),\n      pRange('01', []),\n      pMany(pSeq2(pMany(pChar('_')), pRange('01', [])))\n    );\n    peg['OCTAL'] = pSeq2(\n      pChar('0'),\n      pMany(pSeq2(pMany(pChar('_')), pRange('', ['07'])))\n    );\n    peg['DIGIT'] = pRange('', ['09']);\n    peg['HEX'] = pRange('', ['af', 'AF', '09']);\n    peg['LONG_SUFFIX'] = pRange('lL', []);\n    peg['FloatExpr'] = pSeq2(\n      pNode(pRef(peg, 'FLOAT'), 'Double', 0),\n      pRef(peg, '_')\n    );\n    peg['FLOAT'] = pOre2(\n      pSeq2(pRef(peg, 'FRACTION'), pOption(pRef(peg, 'EXPONENT'))),\n      pSeq2(pMany1(pRef(peg, 'DIGIT')), pRef(peg, 'EXPONENT'))\n    );\n    peg['FRACTION'] = pOre2(\n      pSeq(\n        pNot(pChar('_')),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      ),\n      pSeq(\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pNot(pChar('.'))\n      )\n    );\n    peg['EXPONENT'] = pSeq(\n      pRange('eE', []),\n      pOption(pRange('+-', [])),\n      pRef(peg, 'DIGIT'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n    );\n    peg['Number'] = pOre2(pRef(peg, 'FloatExpr'), pRef(peg, 'IntExpr'));\n    peg['TrueExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Tt', []), pChar('rue')), 'TrueExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['FalseExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Ff', []), pChar('alse')), 'FalseExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['NullExpr'] = pSeq2(\n      pNode(pOre2(pChar('None'), pChar('null')), 'Null', 0),\n      pRef(peg, '_')\n    );\n    peg['EOF'] = pNot(pAny());\n    peg['NL'] = pOre2(pChar('\\n'), pRef(peg, 'EOF'));\n    peg['S'] = pRange(' \\t\\r\\u3000', []);\n    peg['_'] = pMany(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['__'] = pMany(\n      pOre(\n        pRef(peg, 'S'),\n        pChar('\\n'),\n        pRef(peg, 'BLOCKCOMMENT'),\n        pRef(peg, 'LINECOMMENT')\n      )\n    );\n    peg['SPC'] = pMany1(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['BLOCKCOMMENT'] = pOre2(\n      pSeq3(pChar('/*'), pMany(pSeq2(pNot(pChar('*/')), pAny())), pChar('*/')),\n      pSeq3(pChar('(*'), pMany(pSeq2(pNot(pChar('*)')), pAny())), pChar('*)'))\n    );\n    peg['LINECOMMENT'] = pSeq2(\n      pChar('#'),\n      pMany(pSeq2(pNot(pRef(peg, 'NL')), pAny()))\n    );\n    peg['EOL'] = pSeq3(\n      pRef(peg, '_'),\n      pRef(peg, 'NL'),\n      pMany(pSeq2(pRef(peg, '_'), pRef(peg, 'NL')))\n    );\n    peg['INDENT'] = pSeq2(pChar('\\n'), pMany1(pRange(' \\t', [])));\n    peg['C'] = pOre(\n      pRef(peg, 'HIRA'),\n      pRef(peg, 'KATA'),\n      pRef(peg, 'KANJI'),\n      pRef(peg, 'MARK'),\n      pRange('', ['', '', ''])\n    );\n    peg['HIRA'] = pRange('', ['']);\n    peg['KATA'] = pRange('', ['']);\n    peg['KANJI'] = pRange('', ['', '']);\n    peg['MARK'] = pRange('', []);\n    peg['W'] = pRange('', ['', '', '', '']);\n    peg['\"{\"'] = pSeq2(pRange('{', []), pRef(peg, '__'));\n    peg['\"}\"'] = pSeq2(pRange('}', []), pRef(peg, '_'));\n    peg['\"[\"'] = pSeq2(pRange('[', []), pRef(peg, '__'));\n    peg['\"]\"'] = pSeq2(pRange(']', []), pRef(peg, '_'));\n    peg['\"(\"'] = pSeq2(pRange('(', []), pRef(peg, '__'));\n    peg['\")\"'] = pSeq2(pRange(')', []), pRef(peg, '_'));\n    peg['\"=\"'] = pSeq3(\n      pRange('=', []),\n      pNot(pRange('=', [])),\n      pRef(peg, '_')\n    );\n    peg['\".\"'] = pSeq2(pRange('.', []), pRef(peg, '_'));\n    peg['\",\"'] = pSeq2(pRange(',', []), pRef(peg, '_'));\n    peg['\";\"'] = pMany1(pSeq2(pRange(';', []), pRef(peg, '_')));\n    peg['\":\"'] = pSeq2(pRange(':', []), pRef(peg, '_'));\n  }\n  return peg[start];\n};\n\nconst example = (start: string, sample?: string) => {\n  const parser = generate(start);\n  const t = parser(sample || 'abc');\n  console.log(`${start} ${sample}`);\n  console.log(t.toString());\n};\n\n// example('Source',\"from puppy import *\\ndef cat_clicked(cat): print('Meaw')\\ncat = Circle(500, 500, clicked=cat_clicked)\\n\")\n// example('ClassDecl','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('Statement','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('FuncDecl','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Statement','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Lambda','lambda: print(1)')\n// example('Lambda','lambda x: print(x)')\n// example('Lambda','lambda x,y: print(x,y)')\n// example('Statement','if A == 1 :\\n    print(A)\\n    #hoge\\n    print(A, B)\\n    A = Ball()\\nelse:\\n    print(A, B)\\n\\n    A = 2\\n')\n// example('Statement','if A :\\n    pass\\nelif B :\\n    pass\\nelif C :\\n    pass\\nelse :\\n    pass\\n')\n// example('Statement','for x in [1,2,3]:\\n    print(x)\\n    print(x+1)\\n')\n// example('VarDecl','A = 1')\n// example('Statement','A = 1')\n// example('VarDecl','A += 1')\n// example('Statement','A += 1')\n// example('Expression','not 1 == 2')\n// example('Expression','not 1 == 2 and 1 > 3')\n// example('Expression','a[1:2]')\n// example('Expression','a[1:]')\n// example('Expression','a[:2]')\n// example('Expression','Circle(500, 500)')\n// example('Expression','Circle(500, 500, clicked=cat_clicked)')\n// example('Expression','Circle(clicked=1, move=1)')\n// example('Primary','(1,2) //')\n// example('Expression','(1,2) //')\n// example('Primary','(1)')\n// example('Expression','(1)')\n// example('Primary','[1,2,3]')\n// example('Expression','[1,2,3]')\n// example('Primary',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"f'{a}+{1}'\")\n// example('Expression','world(\\n    hoge=1,\\n    hoge=1*2**2*3\\n)\\n')\n\n// pegpy nezcc -g math.tpeg parser.ts > math.ts\n// npx ts-node math.ts\n","import { generate, ParseTree } from './puppy-parser';\n\nconst INDENT = '\\t';\n\n/* Type System */\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(ty: Type, update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any): Type {\n    return this;\n  }\n}\n\nclass BaseType extends Type {\n  private name: string;\n\n  constructor(name: string, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.name = name;\n  }\n\n  public toString() {\n    return this.name;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof BaseType) {\n      return this.name === v.name;\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public hasAlpha(): boolean {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ty = map[this.name];\n      if (ty === undefined) {\n        map[this.name] = new VarType(map.env, map.t);\n      }\n      return map[this.name];\n    }\n    return this;\n  }\n}\n\nclass VoidType extends BaseType {\n  constructor() {\n    super('void', false);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VarType) {\n      v.must(this, update);\n    }\n    return true;\n  }\n}\n\nclass AnyType extends BaseType {\n  constructor(isOptional?: any) {\n    super('any', isOptional);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VoidType) {\n      return false;\n    }\n    return true;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha() {\n    return true;\n  }\n\n  public toVarType(map: any) {\n    return new VarType(map.env, map.t);\n  }\n}\n\nclass FuncType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss = ['('];\n    for (var i = 1; i < this.types.length; i += 1) {\n      if (i > 1) {\n        ss.push(',');\n      }\n      ss.push(this.types[i].toString());\n    }\n    ss.push(')->');\n    ss.push(this.types[0].toString());\n    return ss.join('');\n  }\n\n  public rtype() {\n    return this.types[0];\n  }\n  public psize() {\n    return this.types.length - 1;\n  }\n  public ptype(index: number) {\n    return this.types[index + 1];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof FuncType && this.psize() == v.psize()) {\n      for (var i = 0; i < this.types.length; i += 1) {\n        if (!this.types[i].accept(v.types[i], update)) {\n          return false;\n        }\n        return true;\n      }\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    for (const ty of this.types) {\n      if (ty.isPattern()) return true;\n    }\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) return true;\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const v: Type[] = [];\n      for (const ty of this.types) {\n        v.push(ty.toVarType(map));\n      }\n      return new FuncType(...v);\n    }\n    return this;\n  }\n}\n\nclass ListType extends Type {\n  private param: Type;\n  constructor(param: Type, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.param = param;\n  }\n\n  public toString() {\n    return `List[${this.param.toString()}]`;\n  }\n\n  public psize() {\n    return 1;\n  }\n  public ptype(index: number) {\n    return this.param;\n  }\n\n  public realType(): Type {\n    const p = this.param.realType();\n    if (p !== this.param) {\n      return new ListType(p);\n    }\n    return this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof ListType) {\n      if (this.param == tAny) {\n        return true;\n      }\n      return this.param.accept(v.param, update);\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.param.isPattern();\n  }\n\n  public hasAlpha(): boolean {\n    return this.param.hasAlpha();\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      return new ListType(this.param.toVarType(map));\n    }\n    return this;\n  }\n}\n\nclass UnionType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss: string[] = [];\n    for (var i = 0; i < this.types.length; i += 1) {\n      if (i > 0) {\n        ss.push('|');\n      }\n      ss.push(this.types[i].toString());\n    }\n    return ss.join('');\n  }\n  public psize() {\n    return this.types.length;\n  }\n\n  public ptype(index: number) {\n    return this.types[index];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    for (const ty0 of this.types) {\n      if (ty0.accept(ty, false)) {\n        return true;\n      }\n    }\n    console.log(`FAIL ${ty} ${this.toString()}`);\n    return false;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ts: Type[] = [];\n      for (const ty of this.types) {\n        ts.push(ty.toVarType(map));\n      }\n      return new UnionType(...ts);\n    }\n    return this;\n  }\n}\n\nconst union = (...types: Type[]) => {\n  if (types.length === 1) {\n    return types[0];\n  }\n  return new UnionType(...types);\n};\n\nconst tAny = new AnyType();\nconst tVoid = new VoidType();\nconst tBool = new BaseType('Bool');\nconst tInt = new BaseType('Number');\nconst tInt_ = new BaseType('Number', true);\nconst tFloat = tInt;\nconst tFloat_ = tInt_;\nconst tString = new BaseType('String');\nconst tString_ = new BaseType('String', true);\nconst tA = new BaseType('a');\nconst tListA = new ListType(tA);\nconst tListInt = new ListType(tInt);\nconst tListAny = new ListType(tAny);\nconst tMatter = new BaseType('Object');\nconst tObject = tMatter;\nconst tVec = new BaseType('Vec');\n\n//const tUndefined = new BaseType('undefined');\n\nconst EmptyNumberSet: number[] = [];\n\nconst unionSet = (a: number[], b: number[], c?: number[]) => {\n  const A: number[] = [];\n  for (const id of a) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  for (const id of b) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  if (c !== undefined) {\n    for (const id of b) {\n      if (A.indexOf(id) === -1) {\n        A.push(id);\n      }\n    }\n  }\n  return A;\n};\n\nclass VarType extends Type {\n  private varMap: (Type | number[])[];\n  private varid: number;\n  private ref: ParseTree | null;\n\n  constructor(env: Env, ref: ParseTree) {\n    super(false);\n    this.varMap = env.getroot('@varmap');\n    this.varid = this.varMap.length;\n    this.varMap.push(EmptyNumberSet);\n    this.ref = ref;\n  }\n\n  public toString() {\n    const v = this.varMap[this.varid];\n    if (v instanceof Type) {\n      return v.toString();\n    }\n    return 'any';\n  }\n\n  public realType(): Type {\n    const v = this.varMap[this.varid];\n    return v instanceof Type ? v : this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    var v = this.varMap[this.varid];\n    if (v instanceof Type && v !== this) {\n      return v.accept(ty, update);\n    }\n    return this.must(ty.realType(), update);\n  }\n\n  public must(ty: Type, update: boolean): boolean {\n    const v1 = ty.realType();\n    if (update) {\n      if (v1 instanceof VarType) {\n        if (v1.varid === this.varid) {\n          return true;\n        }\n        const u = unionSet(\n          this.varMap[this.varid] as number[],\n          this.varMap[v1.varid] as number[],\n          [v1.varid, this.varid]\n        );\n        for (const id of u) {\n          this.varMap[id] = u;\n        }\n        return true;\n      }\n      if (!v1.isPattern()) {\n        const u = this.varMap[this.varid] as number[];\n        for (const id of u) {\n          this.varMap[id] = v1;\n        }\n        this.varMap[this.varid] = v1;\n      }\n    }\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n}\n\nclass OptionType extends Type {\n  public options: any;\n  constructor(options: any) {\n    super(false);\n    this.options = options;\n  }\n\n  public toString() {\n    return JSON.stringify(this.options);\n  }\n\n  public accept(ty: Type): boolean {\n    const v = ty.realType();\n    if (v instanceof OptionType) {\n      return true;\n    }\n    return false;\n  }\n\n  public equals(ty: Type, update: boolean): boolean {\n    return this.accept(ty);\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any) {\n    return this;\n  }\n}\n\nclass Symbol {\n  public code: string;\n  public ty: Type;\n  public isMatter: boolean = false;\n  public isMutable: boolean = false;\n  public constructor(code: string, ty: Type, options?: any) {\n    this.code = code;\n    this.ty = ty.realType();\n    if (options !== undefined) {\n      this.isMatter = options.isMatter === undefined ? false : options.isMatter;\n      this.isMutable =\n        options.isMutable == undefined ? false : options.isMutable;\n    }\n  }\n  public isGlobal() {\n    return this.code.indexOf('vars[') == 0;\n  }\n}\n\nconst tColor = new UnionType(tString, tInt);\nconst tOption = new OptionType({});\nconst tFuncFloatFloat = new FuncType(tFloat, tFloat);\nconst tFuncFloatFloatFloat = new FuncType(tFloat, tFloat, tFloat);\nconst tFuncShape = new FuncType(tMatter, tInt, tInt, tOption);\n\nconst import_math = {\n  pi: new Symbol('3.14159', tFloat),\n  sin: new Symbol('Math.sin', tFuncFloatFloat),\n  cos: new Symbol('Math.cos', tFuncFloatFloat),\n  tan: new Symbol('Math.tan', tFuncFloatFloat),\n  sqrt: new Symbol('Math.sqrt', tFuncFloatFloat),\n  log: new Symbol('Math.log', tFuncFloatFloat),\n  log10: new Symbol('Math.log10', tFuncFloatFloat),\n\n  pow: new Symbol('Math.pow', tFuncFloatFloatFloat),\n  hypot: new Symbol('Math.hypot', tFuncFloatFloatFloat),\n  gcd: new Symbol('puppy.gcd', tFuncFloatFloatFloat),\n};\n\nconst import_python = {\n  // 'math.': IMPORT_MATH,\n  // 'random.': IMPORT_RANDOM,\n  input: new Symbol('await puppy.input', new FuncType(tString, tString_)),\n  print: new Symbol('puppy.print', new FuncType(tVoid, tAny, tOption), {\n    isMatter: true,\n  }),\n\n  //# , ..None \n  len: new Symbol('lib.len', new FuncType(tInt, union(tString, tListA))),\n  //\n  range: new Symbol('lib.range', new FuncType(tListInt, tInt, tInt_, tInt_)),\n  //append\n  '.append': new Symbol('lib.append', new FuncType(tVoid, tListA, tA)),\n\n  // \n  int: new Symbol('lib.int', new FuncType(tInt, union(tBool, tString, tInt))),\n  float: new Symbol(\n    'lib.float',\n    new FuncType(tFloat, union(tBool, tString, tInt))\n  ),\n  str: new Symbol('lib.str', new FuncType(tString, tAny)),\n  //'random': new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_random = {\n  random: new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_matterjs = {\n  // # \n  World: new Symbol('puppy.World', tFuncShape, { isMatter: true }),\n  Circle: new Symbol('puppy.Circle', tFuncShape, { isMatter: true }),\n  Rectangle: new Symbol('puppy.Rectangle', tFuncShape, { isMatter: true }),\n  Polygon: new Symbol('puppy.Polygon', tFuncShape, { isMatter: true }),\n  Label: new Symbol('puppy.Label', tFuncShape, { isMatter: true }),\n  // 'Ball': new Symbol('puppy.Circle', tFuncShape),\n  // 'Block': new Symbol('puppy.Ball', tFuncShape),\n\n  // # \n  '.setPosition': new Symbol(\n    'lib.setPosition',\n    new FuncType(tVoid, tMatter, tInt, tInt)\n  ),\n  '.applyForce': new Symbol(\n    'lib.applyForce',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt, tInt)\n  ),\n  '.rotate': new Symbol(\n    'lib.rotate',\n    new FuncType(tVoid, tMatter, tInt, tInt_, tInt_)\n  ),\n  '.scale': new Symbol(\n    'lib.scale',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt_, tInt_)\n  ),\n  '.setAngle': new Symbol('lib.setAngle', new FuncType(tVoid, tMatter, tInt)),\n  '.setAngularVelocity': new Symbol(\n    'lib.setAngularVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setDensity': new Symbol(\n    'lib.setDensity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setMass': new Symbol('lib.setMass', new FuncType(tVoid, tMatter, tInt)),\n  '.setStatic': new Symbol(\n    'lib.setStatic',\n    new FuncType(tVoid, tMatter, tBool)\n  ),\n  '.setVelocity': new Symbol(\n    'lib.setVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n};\n\nconst modules: any = {\n  math: import_math,\n  random: import_random,\n  matterjs: import_matterjs,\n};\n\nconst symbolPackageMap: any = {};\n\nconst checkSymbolNames = () => {\n  for (const pkgname of Object.keys(modules)) {\n    for (const name of Object.keys(modules[pkgname])) {\n      symbolPackageMap[name] = pkgname;\n    }\n  }\n};\ncheckSymbolNames();\n\nconst KEYTYPES = {\n  width: tInt,\n  height: tInt,\n  x: tInt,\n  y: tInt,\n  image: tString,\n  strokeStyle: tColor,\n  lineWidth: tInt,\n  fillStyle: tColor,\n  restitution: tFloat,\n  angle: tFloat,\n  position: tVec,\n  mass: tInt,\n  density: tInt,\n  area: tInt,\n  friction: tFloat,\n  frictionStatic: tFloat,\n  airFriction: tFloat,\n  torque: tFloat,\n  stiffness: tFloat,\n  isSensor: tBool,\n  isStatic: tBool,\n  damping: tFloat,\n  in: new FuncType(tVoid, tMatter, tMatter),\n  out: new FuncType(tVoid, tMatter, tMatter),\n  over: new FuncType(tVoid, tMatter, tMatter),\n  clicked: new FuncType(tVoid, tMatter),\n  font: tString,\n  fontColor: tColor,\n  textAlign: tString,\n  value: tInt,\n  message: tString,\n};\n\n//const ty1 = this.check(tleft(op), env, t['left'], out1);\n//const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n//return tbinary(env, t, ty1, out1.join(''), ty2, out1.join(''), out);\nconst tCompr = union(tInt, tString);\n\nconst opset: any = {\n  and: '&&',\n  or: '||',\n  not: '!',\n  '+=': '+',\n  '-=': '-',\n  '*=': '*',\n  '//=': '//',\n  '/=': '/',\n  '<<=': '<<',\n  '>>=': '>>',\n  '|=': '|',\n  '&=': '&',\n  '^=': '^',\n};\n\nconst operator = (op: string) => {\n  const op2 = opset[op];\n  if (op2 !== undefined) {\n    return op2;\n  }\n  return op;\n};\n\nconst tleftMap = {\n  '+': union(tInt, tString, tListAny),\n  '-': tInt,\n  '**': tInt,\n  '*': union(tInt, tString, tListAny),\n  '/': tInt,\n  '//': tInt,\n  '%': tInt,\n  '==': tAny,\n  '!=': tAny,\n  in: tAny,\n  '<': tCompr,\n  '<=': tCompr,\n  '>': tCompr,\n  '>=': tCompr,\n  '^': tInt,\n  '|': tInt,\n  '&': tInt,\n  '<<': tInt,\n  '>>': tInt,\n};\n\nconst tleft = (op: string) => {\n  const ty = (tleftMap as any)[op];\n  if (ty === undefined) {\n    console.log(`FIXME undefined '${op}'`);\n    return tAny;\n  }\n  return ty;\n};\n\nconst tright = (op: string, ty: Type) => {\n  if (op == 'in') {\n    return union(new ListType(ty), tString);\n  }\n  const ty2 = (tleftMap as any)[op];\n  if (ty2 === tAny || ty2 === tInt || op === '*') {\n    return ty2;\n  }\n  return ty; // \n};\n\ntype ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nconst setpos = (s: string, pos: number, elog: ErrorLog) => {\n  const max = Math.min(pos + 1, s.length);\n  var r = 1;\n  var c = 0;\n  for (var i = 0; i < max; i += 1) {\n    if (s.charCodeAt(i) == 10) {\n      r += 1;\n      c = 0;\n    }\n    c += 1;\n  }\n  elog.pos = pos;\n  elog.row = r;\n  elog.col = c;\n  return elog;\n};\n\nclass Env {\n  private root: Env;\n  private parent: Env | null;\n  private vars: any;\n\n  public constructor(env?: Env) {\n    this.vars = {};\n    if (env === undefined) {\n      this.root = this;\n      this.parent = null;\n      this.vars['@varmap'] = [];\n      this.vars['@logs'] = [];\n      this.vars['@trace'] = [];\n      this.vars['@indent'] = INDENT;\n    } else {\n      this.root = env.root;\n      this.parent = env;\n    }\n  }\n\n  public get(key: string, value?: any) {\n    var e: Env | null = this;\n    while (e !== null) {\n      const v = e.vars[key];\n      if (v !== undefined) {\n        return v;\n      }\n      e = e.parent;\n    }\n    return value;\n  }\n\n  public has(key: string) {\n    return this.get(key) !== undefined;\n  }\n\n  public set(key: string, value: any) {\n    this.vars[key] = value;\n    return value;\n  }\n\n  public getroot(key: string, value?: any) {\n    return this.root.vars[key] || value;\n  }\n\n  public setroot(key: string, value: any) {\n    this.root.vars[key] = value;\n    return value;\n  }\n\n  public from_import(pkg: any, list?: string[]) {\n    for (const name of Object.keys(pkg)) {\n      //console.log(name);\n      if (list === undefined || list.indexOf(name) !== -1) {\n        this.vars[name] = pkg[name];\n      }\n    }\n  }\n\n  public setModule(name: string, options: any) {\n    this.set(name, new Symbol('undefined', new OptionType(options)));\n  }\n\n  public isModule(name: string) {\n    const s = this.get(name) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public getModule(pkgname: string, name: string) {\n    const s = this.get(pkgname) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      const options = (s.ty as OptionType).options;\n      return options[name];\n    }\n    return undefined;\n  }\n\n  public perror(t: ParseTree, elog: ErrorLog) {\n    const logs = this.root.vars['@logs'];\n    if (elog.type === undefined) {\n      elog.type = 'error';\n    }\n    if (elog.pos === undefined) {\n      const pos = t.begin();\n      elog.pos = pos[0];\n      elog.row = pos[1];\n      elog.col = pos[2];\n    }\n    if (elog.len === undefined) {\n      elog.len = t.epos - t.spos;\n    }\n    logs.push(elog);\n  }\n\n  public trace(t: ParseTree) {\n    const trace: number[][] = this.getroot('@trace');\n    const id = trace.length;\n    const pos = t.begin();\n    trace.push([pos[0], pos[1], pos[2], t.epos - t.spos]);\n    return `,puppy,${id}`;\n  }\n\n  public setInLoop() {\n    this.set('@inloop', true);\n    return true;\n  }\n\n  public inLoop() {\n    return this.get('@inloop') === true;\n  }\n\n  public setFunc(data: any) {\n    this.set('@func', data);\n    return data;\n  }\n\n  public inFunc() {\n    return this.get('@func') !== undefined;\n  }\n\n  public foundFunc(t: ParseTree, symbol: Symbol) {\n    if (symbol.isMatter) {\n      const data = this.get('@func');\n      if (data !== undefined) {\n        data['isMatter'] = true;\n      } else {\n        const pos = setpos(t.inputs, t.spos, { type: '', key: '' });\n        this.setroot('@yeild', pos.row);\n      }\n    }\n  }\n\n  private isUtf8Name(s: string) {\n    for (var i = 0; i < s.length; i += 1) {\n      if (s.charCodeAt(i) > 128) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private local(s: string): string {\n    if (this.isUtf8Name(s)) {\n      const map = this.getroot('@utf8map');\n      if (map === undefined) {\n        this.setroot('@utf8map', {});\n        return this.local(s);\n      }\n      var vname = map[name];\n      if (vname === undefined) {\n        const id = Object.keys(map).length;\n        vname = `_v${id}`;\n        map[name] = vname;\n      }\n      return vname as string;\n    }\n    return s;\n  }\n\n  public declVar(name: string, ty: Type) {\n    var code =\n      this.inFunc() || this.inLoop() ? this.local(name) : `vars['${name}']`;\n    const symbol = new Symbol(code, ty);\n    symbol.isMutable = true;\n    return this.set(name, symbol) as Symbol;\n  }\n\n  public emitAutoYield(out: string[]) {\n    const yieldparam = this.getroot('@yeild');\n    if (yieldparam !== undefined && !this.inFunc()) {\n      out.push(`; yield ${yieldparam};\\n`);\n      this.setroot('@yeild', undefined);\n    } else {\n      out.push('\\n');\n    }\n  }\n}\n\nclass PuppyError {\n  public constructor() {}\n}\n\nconst FIXME_subs = (t: any) => {\n  return t instanceof ParseTree ? t.subs() : ([] as ParseTree[]);\n};\n\nclass Transpiler {\n  public constructor() {}\n\n  public conv(env: Env, t: ParseTree, out: string[]) {\n    console.log(t.toString());\n    console.log((this as any)[t.tag]);\n    try {\n      return (this as any)[t.tag](env, t, out);\n    } catch (e) {\n      if (e instanceof PuppyError) {\n        throw e;\n      }\n      if ((this as any)[t.tag] === undefined) {\n        //console.log(e);\n        env.perror(t, {\n          type: 'error',\n          key: 'UndefinedParseTree',\n          subject: t.toString(),\n        });\n        return this.skip(env, t, out);\n      }\n      throw e;\n    }\n  }\n\n  public skip(env: Env, t: ParseTree, out: string[]): Type {\n    throw new PuppyError();\n    // out.push('undefined');\n    // return tAny;\n  }\n\n  public check(\n    req: Type,\n    env: Env,\n    t: ParseTree,\n    out: string[],\n    elog?: ErrorLog\n  ) {\n    const ty = this.conv(env, t, out);\n    if (req.accept(ty, true)) {\n      return ty;\n    }\n    if (elog === undefined) {\n      elog = {\n        type: 'error',\n        key: 'TypeError',\n      };\n    }\n    elog.request = req;\n    elog.given = ty;\n    env.perror(t, elog);\n    return this.skip(env, t, out);\n  }\n\n  private checkBinary(\n    env: Env,\n    t: any,\n    op: string,\n    ty1: Type,\n    left: string,\n    ty2: Type,\n    right: string,\n    out: string[]\n  ) {\n    if (op === '==' || op === '!=') {\n      out.push(`${left} ${op}= ${right}`);\n      return tBool;\n    }\n    ty1 = ty1.realType();\n    ty2 = ty2.realType();\n    if (op === '+') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} + ${right})`);\n        return tInt;\n      }\n      if (ty1.accept(ty2, true)) {\n        out.push(`lib.anyAdd(${left},${right})`);\n        return ty1;\n      }\n      env.perror(t, {\n        key: 'BinaryTypeError',\n        subject: op,\n        request: ty1,\n        given: ty2,\n      });\n      return this.skip(env, t, out);\n    }\n    if (op === '*') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} * ${right})`);\n        return tInt;\n      }\n      out.push(`lib.anyMul(${left},${right})`);\n      if (ty1 === tInt || tListAny.accept(ty2, false)) return ty2;\n      if (ty2 === tInt || tListAny.accept(ty1, false)) return ty1;\n      return ty1;\n    }\n    if (op === '//') {\n      out.push(`((${left}/${right})|0)`);\n      return tInt;\n    }\n    if (op === '**') {\n      out.push(`Math.pow(${left},${right})`);\n      return tInt;\n    }\n    if (ty1.accept(ty2, true)) {\n      out.push(`(${left} ${op} ${right})`);\n      if ((tleftMap as any)[op] === tCompr) {\n        return tBool;\n      }\n      return ty1;\n    }\n    env.perror(t, {\n      key: 'BinaryTypeError',\n      subject: op,\n      request: ty1,\n      given: ty2,\n    });\n    return this.skip(env, t, out);\n  }\n\n  public err(env: Env, t: ParseTree, out: string[]) {\n    env.perror(t, {\n      type: 'error',\n      key: 'SyntaxError',\n    });\n    return tVoid;\n  }\n\n  public FromDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.from_import(pkg); // FIXME\n    return tVoid;\n  }\n\n  public ImportDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const alias = t.tokenize('alias', name);\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.setModule(alias, pkg);\n    return tVoid;\n  }\n\n  public Source(env: Env, t: ParseTree, out: string[]) {\n    for (const subtree of FIXME_subs(t)) {\n      try {\n        const out2: string[] = [];\n        out2.push(env.get('@indent'));\n        this.conv(env, subtree, out2);\n        env.emitAutoYield(out2);\n        out.push(out2.join(''));\n      } catch (e) {\n        if (!(e instanceof PuppyError)) {\n          throw e;\n        }\n      }\n    }\n    return tVoid;\n  }\n\n  public Block(penv: Env, t: ParseTree, out: string[]) {\n    const indent = penv.get('@indent');\n    const nested = INDENT + indent;\n    const env = new Env(penv);\n    env.set('@indent', nested);\n    out.push('{\\n');\n    for (const subtree of FIXME_subs(t)) {\n      out.push(env.get('@indent'));\n      this.conv(env, subtree, out);\n      env.emitAutoYield(out);\n    }\n    out.push(indent + '}');\n    return tVoid;\n  }\n\n  public IfExpr(env: Env, t: any, out: string[]) {\n    out.push('((');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ? (');\n    const ty = this.conv(env, t['then'], out);\n    out.push(') : (');\n    this.check(ty, env, t['else'], out);\n    out.push('))');\n    return ty;\n  }\n\n  public IfStmt(env: Env, t: any, out: string[]) {\n    out.push('if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    if (t['elif'] !== undefined) {\n      for (const stmt of t['elif'].subs()) {\n        this.conv(env, stmt, out);\n      }\n    }\n    if (t['else'] !== undefined) {\n      out.push('else ');\n      this.conv(env, t['else'], out);\n    }\n    return tVoid;\n  }\n\n  public ElifStmt(env: Env, t: any, out: string[]) {\n    out.push('else if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    return tVoid;\n  }\n\n  public ForStmt(env: Env, t: any, out: string[]) {\n    // if (t['each'].tag !== 'Name') {\n    //   env.perror(t['each'], {\n    //     type: 'error', key: 'RequiredIdentifier',\n    //   });\n    //   return tVoid;\n    // }\n    const name = t['each'].tokenize();\n    const ty = new VarType(env, t['each']);\n    out.push(`for (let ${name} of `);\n    this.check(new ListType(ty), env, t['list'], out);\n    out.push(')');\n    const lenv = new Env(env);\n    lenv.setInLoop();\n    lenv.declVar(name, ty);\n    this.conv(lenv, t['body'], out);\n    return tVoid;\n  }\n\n  public FuncDecl(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    const types = [new VarType(env, t['name'])];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      name: name,\n      return: types[0],\n      hasReturn: false,\n      isMatter: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    const symbol = env.declVar(name, funcType);\n    const defun = symbol.isGlobal() ? '' : 'var ';\n    out.push(`${defun}${symbol.code} = (${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    symbol.isMatter = funcData['isMatter'];\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    console.log(`DEFINED ${name} :: ${funcType}`);\n    return tVoid;\n  }\n\n  public FuncExpr(env: Env, t: any, out: string[]) {\n    const types = [new VarType(env, t)];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      return: types[0],\n      hasReturn: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    out.push(`(${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    return funcType;\n  }\n\n  public Return(env: Env, t: any, out: string[]) {\n    if (!env.inFunc()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInFunction',\n        subject: 'return',\n      });\n      return tVoid;\n    }\n    const funcData = env.get('@func');\n    funcData['hasReturn'] = true;\n    if (t['expr'] !== undefined) {\n      out.push('return ');\n      this.check(funcData['return'], env, t['expr'], out);\n    } else {\n      out.push('return');\n    }\n    return tVoid;\n  }\n\n  public Continue(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'continue',\n      });\n      return tVoid;\n    }\n    out.push('continue');\n    return tVoid;\n  }\n\n  public Break(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'break',\n      });\n      return tVoid;\n    }\n    out.push('break');\n    return tVoid;\n  }\n\n  public Pass(env: Env, t: any, out: string[]) {\n    return tVoid;\n  }\n\n  public VarDecl(env: Env, t: any, out: string[]) {\n    const left = t['left'] as ParseTree;\n    if (left.tag === 'Name') {\n      const name = left.tokenize();\n      var symbol = env.get(name) as Symbol;\n      if (symbol === undefined || (env.inFunc() && symbol.isGlobal())) {\n        const ty = new VarType(env, left);\n        const out1: string[] = [];\n        this.check(ty, env, t['right'], out1);\n        symbol = env.declVar(name, ty);\n        const qual = symbol.isGlobal() ? '' : 'var ';\n        out.push(`${qual}${symbol.code} = ${out1.join('')}`);\n        return tVoid;\n      }\n    }\n    t['left'].tag = `Set${t['left'].tag}`;\n    const ty = this.conv(env, t['left'], out);\n    out.push(' = ');\n    this.check(ty, env, t['right'], out);\n    return tVoid;\n  }\n\n  public Name(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public SetName(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    if (!symbol.isMutable) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public And(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' && ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Or(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' || ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Not(env: Env, t: any, out: string[]) {\n    out.push('!(');\n    this.check(tBool, env, t[0], out);\n    out.push(')');\n    return tBool;\n  }\n\n  public Infix(env: Env, t: any, out: string[]) {\n    const op = operator(t.tokenize('name'));\n    const out1: string[] = [];\n    const out2: string[] = [];\n    const ty1 = this.check(tleft(op), env, t['left'], out1);\n    const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n    return this.checkBinary(\n      env,\n      t,\n      op,\n      ty1,\n      out1.join(''),\n      ty2,\n      out2.join(''),\n      out\n    );\n  }\n\n  public Unary(env: Env, t: any, out: string[]) {\n    const op = t.tokenize('name');\n    if (op === '!' || op === 'not') {\n      out.push(`${op}(`);\n      this.check(tBool, env, t['expr'], out);\n      out.push(')');\n      return tBool;\n    } else {\n      out.push(`${op}(`);\n      this.check(tInt, env, t['expr'], out);\n      out.push(')');\n      return tInt;\n    }\n  }\n\n  public ApplyExpr(env: Env, t: any, out: string[]): Type {\n    const name = t.tokenize('name');\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      const pkgname = symbolPackageMap[name];\n      if (pkgname !== undefined) {\n        console.log(`importing ${pkgname} ...`);\n        env.from_import(modules[pkgname]);\n        env.perror(t['name'], {\n          type: 'info',\n          key: 'InferredPackage',\n          subject: pkgname,\n          code: `from ${pkgname} import *`,\n        });\n        return this.ApplySymbolExpr(\n          env,\n          t,\n          env.get(name) as Symbol,\n          undefined,\n          out\n        ); // Again\n      }\n    }\n    return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n  }\n\n  private ApplySymbolExpr(\n    env: Env,\n    t: any,\n    symbol: Symbol,\n    recv: ParseTree | undefined,\n    out: string[]\n  ): Type {\n    if (symbol === undefined) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'UnknownName',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    out.push('(');\n    const args = t['params'].subs();\n    if (recv !== undefined) {\n      args.unshift(recv);\n    }\n    var funcType = symbol.ty;\n    if (!(funcType instanceof FuncType)) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'NotFunction',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    if (funcType.hasAlpha()) {\n      funcType = funcType.toVarType({ env, ref: t });\n      //console.log(funcType.toString());\n    }\n\n    for (var i = 0; i < args.length; i += 1) {\n      if (!(i < funcType.psize())) {\n        env.perror(args[i], {\n          type: 'warning',\n          key: 'TooManyArguments',\n          subject: args[i],\n        });\n        break;\n      }\n      if (i > 0) {\n        out.push(',');\n      }\n      const ty = funcType.ptype(i);\n      this.check(ty, env, args[i], out);\n    }\n    if (args.length < funcType.psize()) {\n      if (!funcType.ptype(args.length)) {\n        env.perror(\n          t['name'],\n          setpos(t.inputs, t['params'].epos, {\n            type: 'error',\n            key: 'RequiredArguments',\n          })\n        );\n      }\n    }\n    out.push(')');\n    env.foundFunc(t, symbol);\n    return funcType.rtype();\n  }\n\n  public MethodExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n    }\n    const methodname = `.${t.tokenize('name')}`;\n    const symbol = env.get(methodname);\n    return this.ApplySymbolExpr(env, t, symbol, t['recv'], out);\n  }\n\n  //\"[#SelfAssign left=[#Name 'a'] name=[# '+='] right=[#Int '1']]\"\n  public SelfAssign(env: Env, t: any, out: string[]) {\n    const tag = t['left'].tag;\n    t['left'].tag = `Set${tag}`;\n    this.conv(env, t['left'], out);\n    out.push(' = ');\n    t['left'].tag = tag;\n    this.Infix(env, t, out);\n    return tVoid;\n  }\n\n  public GetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      out.push(symbol.code);\n      return symbol.ty;\n    }\n    out.push('lib.get(');\n    this.check(tMatter, env, t['recv'], out);\n    const name = t.tokenize('name');\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    out.push(`,'${name}'${env.trace(t['name'])})`);\n    return ty;\n  }\n\n  public SetGetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: t.tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    const name = t.tokenize('name');\n    this.check(tMatter, env, t['recv'], out);\n    out.push(`.${name}`);\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    return ty instanceof UnionType ? ty.ptype(0) : ty;\n  }\n\n  public IndexExpr(env: Env, t: any, out: string[]) {\n    out.push('lib.index(');\n    const ty = this.check(\n      union(new ListType(new VarType(env, t)), tString),\n      env,\n      t['recv'],\n      out\n    );\n    out.push(',');\n    this.check(tInt, env, t['index'], out);\n    out.push(`${env.trace(t['index'])})`);\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public SetIndexExpr(env: Env, t: any, out: string[]) {\n    const ty = this.check(tListAny, env, t['recv'], out);\n    out.push('[');\n    this.check(tInt, env, t['index'], out);\n    out.push(']');\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public Data(env: Env, t: ParseTree, out: string[]) {\n    out.push('{');\n    for (const sub of FIXME_subs(t)) {\n      this.conv(env, sub, out);\n      out.push(',');\n    }\n    out.push('}');\n    return tOption;\n  }\n\n  public KeyValue(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    out.push(`'${name}': `);\n    const ty = (KEYTYPES as any)[name];\n    if (ty === undefined) {\n      env.perror(t['name'], {\n        type: 'warning',\n        key: 'UnknownName',\n        subject: name,\n      });\n      this.conv(env, t['value'], out);\n    } else {\n      this.check(ty, env, t['value'], out);\n    }\n    return tVoid;\n  }\n\n  public Tuple(env: Env, t: ParseTree, out: string[]) {\n    const subs = FIXME_subs(t);\n    if (subs.length > 2) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'ListSyntaxError', //[ ]\n      });\n      return this.List(env, t, out);\n    }\n    if (subs.length == 1) {\n      out.push('(');\n      const ty = this.conv(env, subs[0], out);\n      out.push(')');\n      return ty;\n    }\n    out.push('{ x: ');\n    this.check(tInt, env, subs[0], out);\n    out.push(', y: ');\n    this.check(tInt, env, subs[1], out);\n    out.push('}');\n    return tVec;\n  }\n\n  public List(env: Env, t: ParseTree, out: string[]) {\n    var ty = new VarType(env, t);\n    out.push('[');\n    for (const sub of FIXME_subs(t)) {\n      ty = this.check(ty, env, sub, out, {\n        type: 'error',\n        key: 'AllTypeAsSame', //\n      });\n      out.push(',');\n    }\n    out.push(']');\n    return new ListType(ty);\n  }\n\n  public Format(env: Env, t: ParseTree, out: string[]) {\n    var c = 0;\n    out.push('(');\n    for (const e of FIXME_subs(t)) {\n      if (c > 0) {\n        out.push('+');\n      }\n      if (e.tag === 'StringPart') {\n        out.push(`'${e.tokenize()}'`);\n      } else {\n        const out2: string[] = [];\n        const ty = this.conv(env, e, out2);\n        if (ty === tString) {\n          out.push(out2.join(''));\n        } else {\n          out.push(`lib.str(${out2.join('')})`);\n        }\n      }\n      c++;\n    }\n    out.push(')');\n    return tString;\n  }\n\n  public TrueExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('true');\n    return tBool;\n  }\n\n  public FalseExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('false');\n    return tBool;\n  }\n\n  public Int(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tInt;\n  }\n\n  public Float(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public Double(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public String(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public Char(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public MultiString(env: Env, t: ParseTree, out: string[]) {\n    out.push(JSON.stringify(JSON.parse(t.tokenize())));\n    return tString;\n  }\n}\n\nconst parser = generate('Source');\n\nconst transpile = (s: string) => {\n  const t = parser(s);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  //console.log('DEBUG: ERROR LOGS')\n  //console.log(JSON.stringify(env.get('@logs')));\n  console.log(env.get('@logs'));\n  return out.join('');\n};\n\nexport type Source = {\n  source: string;\n  lang?: string;\n};\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\nexport const compile = (s: Source): PuppyCode => {\n  //const start = performance.now();\n  const t = parser(s.source);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  const jscode = out.join('');\n  const main = `\nreturn {\n  main: async function*(puppy) {\n\\tconst lib = puppy.lib;\n\\tconst vars = puppy.vars;\n${jscode}\n  },\n}`;\n  var code: any = {};\n  try {\n    code = new Function(main)();\n  } catch (e) {\n    env.perror(t, {\n      type: 'error',\n      key: 'CompileError',\n      subject: e.toString(),\n    });\n  }\n  //const end = performance.now();\n  code['world'] = {};\n  code['tree'] = t; //\n  code['code'] = jscode;\n  code['errors'] = env.get('@logs');\n  //code['time'] = end - start;\n  return code as PuppyCode;\n};\n\nexport const utest = (s: string) => {\n  const src = { source: s };\n  const code = compile(src);\n  if (code.errors.length > 0) {\n    return code.errors[0].key;\n  }\n  const ss = code.code.split('\\n');\n  if (ss.length > 1) {\n    const s = ss[ss.length - 2].trim();\n    return s === '}' ? ss[ss.length - 3].trim() : s;\n  }\n  return '';\n};\n\n// console.log(transpile(`\n// '''\n// This is a apple.\n// I'm from Chiba.\n// '''\n// `));\n\nconsole.log(\n  transpile(`\nif True :\n  1\nelif True :\n  2\nelif True :\n  3\nelse :\n  4\n`)\n);\n\nconsole.log(\n  transpile(`\nfor x in range(1,2):\n  for y in range(x,2):\n    x+y\n`)\n);\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x*y;\n// `));\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x//y;\n// `));\n","import { setTheme, setCode, setMarker, setDecoration } from './editor';\nimport { CourseShape, setCourse, setContent, setCources } from './course';\nimport { setPuppy } from './puppy';\nimport { setPlaceholder, setShow } from './input';\nimport { PuppyCode, Puppy, runPuppy, ErrorLog } from '../vm/vm';\nimport store, { ReduxActions } from '../store';\nimport { compile } from '../puppy-transpiler/puppy';\n\nimport { Range } from 'monaco-editor';\n\nconst checkError = (\n  dispatch: (action: ReduxActions) => void,\n  code: PuppyCode\n) => {\n  let error_count = 0;\n  const annos: ErrorLog[] = [];\n  // editor.getSession().clearAnnotations();\n  for (const e of code.errors) {\n    if (e.type === 'error') {\n      error_count += 1;\n    }\n    annos.push(e);\n    // editor.getSession().setAnnotations(annos);\n  }\n  dispatch(setMarker(annos));\n  if (error_count === 0) {\n    dispatch(setTheme('vs'));\n    return false;\n  }\n  dispatch(setTheme('error'));\n  // editorPanel.style.backgroundColor = 'rgba(254,244,244,0.7)';\n  return true;\n};\n\nlet new_puppy: Puppy | null = null;\n\nexport const trancepile = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  source: string,\n  alwaysRun: boolean,\n  waitStart = false,\n  _isLive = false\n): Puppy | null => {\n  const code = compile({ source }) as PuppyCode; // Eval javascript code\n  console.log(code);\n  if (!checkError(dispatch, code)) {\n    // if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n    //   return puppy;\n    // }\n    if (new_puppy) {\n      new_puppy.dispose();\n    }\n    new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n    dispatch(setPuppy(new_puppy));\n  }\n  return new_puppy;\n};\n\n// export const trancepile = (dispatch: (action: ReduxActions) => void) => (\n//   puppy: Puppy | null,\n//   source: string,\n//   alwaysRun: boolean,\n//   waitStart = false,\n//   isLive = false\n// ): Promise<Puppy | null> =>\n//   fetch('/api/compile', {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/text; charset=utf-8',\n//     },\n//     body: source,\n//   })\n//     .then((res: Response) => {\n//       if (res.ok) {\n//         return res.text();\n//       }\n//       throw new Error(res.statusText);\n//     })\n//     .then((js: string) => {\n//       try {\n//         const code = Function(js)(); // Eval javascript code\n//         if (!checkError(dispatch, code)) {\n//           if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n//             return puppy;\n//           }\n//           if (new_puppy) {\n//             new_puppy.dispose();\n//           }\n//           new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n//           dispatch(setPuppy(new_puppy));\n//         }\n//         return new_puppy;\n//       } catch (e) {\n//         // alert(` ${e}`);\n//         // editorPanel.style.backgroundColor = 'rgba(244,244,254,0.7)';\n//         console.log(js);\n//         console.log(`FAIL TO TRANSCOMPILE ${e}`);\n//         console.log(e);\n//         return null;\n//       }\n//     })\n//     .catch((msg: string) => {\n//       alert(`Puppy is down!! ${msg}`);\n//       return null;\n//     });\n\nconst loadFile: (path: string) => Promise<string> = path => {\n  return fetch(path, {\n    method: 'GET',\n  })\n    .then((res: Response) => {\n      if (res.ok) {\n        return res.text();\n      }\n      throw new Error(res.statusText);\n    })\n    .then((sample: string) => {\n      return sample;\n    });\n};\n\nexport const fetchSetting = (dispatch: (action: ReduxActions) => void) => (\n  path: string\n): Promise<void> =>\n  loadFile(`/LIVE2019/course/${path}/setting.json`)\n    .then((s: string) => {\n      return JSON.parse(s);\n    })\n    .then((course: CourseShape) => {\n      dispatch(setCourse(course));\n    })\n    .catch((msg: string) => {\n      console.log(`ERR ${msg}`);\n    });\n\nexport const fetchContent = (dispatch: (action: ReduxActions) => void) => (\n  coursePath: string,\n  path: string\n): Promise<void> =>\n  loadFile(`/LIVE2019/course/${coursePath}/${path}/index.md`).then(\n    (content: string) => dispatch(setContent(content))\n  );\n\nexport const fetchSample = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  coursePath: string,\n  page: number,\n  path: string\n): void => {\n  const sample = window.sessionStorage.getItem(\n    `/LIVE2019/course/${coursePath}/${path}/sample.py`\n  );\n  if (sample) {\n    dispatch(setCode(sample));\n    trancepile(dispatch)(puppy, sample, false);\n  } else {\n    loadFile(`/LIVE2019/course/${coursePath}/${path}/sample.py`).then(\n      (sample: string) => {\n        dispatch(setCode(sample));\n        trancepile(dispatch)(puppy, sample, false);\n      }\n    );\n  }\n};\n\nexport const getInputValue = async (msg: string) => {\n  const awaitForClick = target => {\n    return new Promise(resolve => {\n      target.addEventListener('submit', resolve, { once: true });\n    });\n  };\n  store.dispatch(setShow(true));\n  store.dispatch(setPlaceholder(msg));\n  await awaitForClick(document.getElementById('puppy-input-form'));\n  return store.getState().input.value;\n};\n\nexport const getIsLive = () => store.getState().puppy.isLive;\n\nexport const getDiffStartLineNumber = () => {\n  const num = store.getState().editor.diffStartLineNumber;\n  return num === null ? 0 : num;\n};\n\nexport const setCodeHighlight = (startLineNum: number, endLineNum: number) => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(\n    setDecoration(\n      codeEditor.deltaDecorations(decoration, [\n        {\n          range: new Range(startLineNum, 1, endLineNum, 1),\n          options: { isWholeLine: true, className: 'code-highlight' },\n        },\n      ])\n    )\n  );\n};\n\nexport const resetCodeHighlight = () => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(setDecoration(codeEditor.deltaDecorations(decoration, [])));\n};\n\nexport const fetchCourses = (\n  dispatch: (action: ReduxActions) => void\n) => (): void => {\n  const courses: { [path: string]: CourseShape } = {};\n  const get_course: Promise<void>[] = [];\n  ['Puppy', 'PuppyCourse', 'LIVE2019'].forEach(path => {\n    get_course.push(\n      loadFile(`/LIVE2019/course/${path}/setting.json`)\n        .then((s: string) => {\n          return JSON.parse(s);\n        })\n        .then((course: CourseShape) => {\n          courses[path] = course;\n        })\n    );\n  });\n  Promise.all(get_course).then(() => dispatch(setCources(courses)));\n  // fetch('/api/courses')\n  //   .then((res: Response) => {\n  //     if (res.ok) {\n  //       return res.json();\n  //     }\n  //     throw new Error(res.statusText);\n  //   })\n  //   .then((json: { [path: string]: CourseShape }) => {\n  //     dispatch(setCources(json));\n  //   });\n};\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Header from '../components/Header/Header';\nimport { fetchCourses } from '../modules/operations';\nimport { setShow } from '../modules/version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  course: state.course.course,\n  courses: state.course.courses,\n});\n\nconst mapDispatchToProps = (dispathch: (action: ReduxActions) => void) => ({\n  fetchCourses: fetchCourses(dispathch),\n  setShow: (show: boolean) => dispathch(setShow(show)),\n});\n\nconst HeaderContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Header);\n\nexport default HeaderContainer;\n","import React, { useEffect } from 'react';\nimport MonacoEditor from 'react-monaco-editor';\nimport * as monacoEditor from 'monaco-editor';\nimport './Editor.css';\nimport { Puppy } from '../../vm/vm';\n\nimport { Button, Spinner } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faMinus, faPlay } from '@fortawesome/free-solid-svg-icons';\n\nimport { CodeEditor } from '../../modules/editor';\n\nmonacoEditor.editor.defineTheme('error', {\n  base: 'vs',\n  inherit: true,\n  rules: [],\n  colors: {\n    'editor.background': '#ffb7b7',\n  },\n});\n\nconst zenkaku =\n  '[' +\n  '' +\n  '' +\n  '' +\n  ']';\n\ntype EditorFooterProps = {\n  setFontSize: (fontSize: number) => void;\n  fontSize: number;\n  setIsLive: (isLive: boolean) => void;\n  isLive: boolean;\n};\n\nconst EditorFooter: React.FC<EditorFooterProps> = (\n  props: EditorFooterProps\n) => {\n  const fontPlus = () => {\n    props.setFontSize(props.fontSize + 3);\n  };\n  const fontMinus = () => {\n    props.setFontSize(Math.max(12, props.fontSize - 3));\n  };\n  return (\n    <div id=\"editor-footer\">\n      <Button onClick={() => props.setIsLive(!props.isLive)}>\n        {props.isLive ? (\n          <Spinner animation=\"grow\" variant=\"light\" size=\"sm\" />\n        ) : (\n          <FontAwesomeIcon icon={faPlay} />\n        )}\n        {' LIVE'}\n      </Button>\n      <Button onClick={fontPlus}>\n        <FontAwesomeIcon icon={faPlus} />\n      </Button>\n      <Button onClick={fontMinus}>\n        <FontAwesomeIcon icon={faMinus} />\n      </Button>\n    </div>\n  );\n};\n\nexport type EditorProps = {\n  width: number;\n  height: number;\n  codeEditor: CodeEditor | null;\n  decoration: string[];\n  fontSize: number;\n  theme: string;\n  code: string;\n  diffStartLineNumber: number | null;\n  puppy: Puppy | null;\n  isLive: boolean;\n  coursePath: string;\n  page: number;\n  setCode: (code: string) => void;\n  setSize: (width: number, height: number) => void;\n  setCodeEditor: (codeEditor: CodeEditor | null) => void;\n  setDecoration: (decoration: string[]) => void;\n  setFontSize: (fontSize: number) => void;\n  setDiffStartLineNumber: (startLineNumber: number | null) => void;\n  setIsLive: (isLive: boolean) => void;\n  trancepile: (\n    puppy: Puppy | null,\n    code: string,\n    alwaysRun: boolean,\n    waitStart?: boolean,\n    isLive?: boolean\n  ) => Puppy | null;\n};\n\nlet resizeTimer: NodeJS.Timeout;\nlet trancepileTimer: NodeJS.Timeout | null;\nlet startTimer: NodeJS.Timeout | null;\n\nconst Editor: React.FC<EditorProps> = (props: EditorProps) => {\n  const editorOptions = {\n    selectOnLineNumbers: true,\n    fontSize: props.fontSize,\n    wordWrap: 'on' as 'on',\n  };\n\n  addEventListener('resize', () => {\n    clearTimeout(resizeTimer!);\n    resizeTimer = setTimeout(function() {\n      props.setSize(\n        document.getElementById('right-col')!.clientWidth,\n        document.getElementById('right-col')!.clientHeight\n      );\n    }, 300);\n  });\n\n  useEffect(() => {\n    props.setSize(\n      document.getElementById('right-col')!.clientWidth,\n      document.getElementById('right-col')!.clientHeight\n    );\n  }, []);\n\n  const checkZenkaku = (codeEditor: CodeEditor) => {\n    const zenkakuRanges = codeEditor\n      .getModel()!\n      .findMatches(zenkaku, true, true, false, null, false);\n    const decos: monacoEditor.editor.IModelDeltaDecoration[] = zenkakuRanges.map(\n      (match: monacoEditor.editor.FindMatch) => ({\n        range: match.range,\n        options: { inlineClassName: 'zenkakuClass' },\n      })\n    );\n    props.setDecoration(codeEditor.deltaDecorations(props.decoration, decos));\n  };\n\n  const codeOnChange = (\n    new_code: string,\n    event: monacoEditor.editor.IModelContentChangedEvent\n  ) => {\n    let startNumber = props.diffStartLineNumber;\n    event.changes.map(change => {\n      startNumber =\n        startNumber === null\n          ? change.range.startLineNumber\n          : Math.min(startNumber, change.range.startLineNumber);\n    });\n    if (startNumber !== null) {\n      props.setDiffStartLineNumber(startNumber);\n    }\n    props.setCode(new_code);\n    if (props.codeEditor) {\n      checkZenkaku(props.codeEditor);\n    }\n    if (props.isLive) {\n      if (trancepileTimer) {\n        clearTimeout(trancepileTimer);\n        trancepileTimer = null;\n      }\n      // trancepileTimer = setTimeout(() => {\n      //   props.trancepile(props.puppy, new_code, false);\n      //   window.sessionStorage.setItem(\n      //     `/api/sample/${props.coursePath}/${props.page}`,\n      //     new_code\n      //   );\n      // }, 1500);\n      trancepileTimer = setTimeout(() => {\n        (puppy => {\n          if (startTimer) {\n            clearTimeout(startTimer);\n            startTimer = null;\n          }\n          startTimer = setTimeout(() => {\n            if (puppy) {\n              puppy.start();\n            }\n            props.setDiffStartLineNumber(null);\n          }, 1500);\n        })(props.trancepile(props.puppy, new_code, false, true, true));\n        window.sessionStorage.setItem(\n          `/api/sample/${props.coursePath}/${props.page}`,\n          new_code\n        );\n      }, 100);\n    }\n  };\n  const hoge: string = 'piyo';\n\n  hoge.startsWith('hoge');\n\n  const editorDidMount = (editor: CodeEditor) => {\n    props.setCodeEditor(editor);\n  };\n\n  return (\n    <div id=\"puppy-editor\">\n      <MonacoEditor\n        width={props.width}\n        height={props.height}\n        language=\"python\"\n        theme={props.theme}\n        value={props.code}\n        options={editorOptions}\n        onChange={codeOnChange}\n        editorDidMount={editorDidMount}\n      />\n      <EditorFooter\n        setFontSize={props.setFontSize}\n        fontSize={props.fontSize}\n        setIsLive={props.setIsLive}\n        isLive={props.isLive}\n      />\n    </div>\n  );\n};\n\nexport default Editor;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Editor from '../components/Editor/Editor';\nimport { trancepile } from '../modules/operations';\nimport {\n  setCode,\n  setSize,\n  setCodeEditor,\n  setDecoration,\n  setFontSize,\n  setDiffStartLineNumber,\n  CodeEditor,\n} from '../modules/editor';\nimport { setIsLive } from '../modules/puppy';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  width: state.editor.width,\n  height: state.editor.height,\n  codeEditor: state.editor.codeEditor,\n  decoration: state.editor.decoration,\n  theme: state.editor.theme,\n  fontSize: state.editor.fontSize,\n  code: state.editor.code,\n  diffStartLineNumber: state.editor.diffStartLineNumber,\n  puppy: state.puppy.puppy,\n  isLive: state.puppy.isLive,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setCode: (code: string) => dispatch(setCode(code)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  setCodeEditor: (codeEditor: CodeEditor | null) =>\n    dispatch(setCodeEditor(codeEditor)),\n  setDecoration: (decoration: string[]) => dispatch(setDecoration(decoration)),\n  setFontSize: (fontSize: number) => dispatch(setFontSize(fontSize)),\n  setDiffStartLineNumber: (LineNumber: number | null) =>\n    dispatch(setDiffStartLineNumber(LineNumber)),\n  setIsLive: (isLive: boolean) => dispatch(setIsLive(isLive)),\n  trancepile: trancepile(dispatch),\n});\n\nexport const EditorContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Editor);\n\nexport default EditorContainer;\n","import React from 'react';\nimport { Puppy } from '../../vm/vm';\nimport { Button } from 'react-bootstrap';\nimport './PuppyScreen.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faPlay,\n  faExpand,\n  faBookOpen,\n  faBook,\n} from '@fortawesome/free-solid-svg-icons';\n\ntype PuppyFooterProps = {\n  isCourseVisible: boolean;\n  setIsCourseVisible: (visible: boolean) => void;\n  code: string;\n  puppy: Puppy | null;\n  trancepile: (puppy: Puppy | null, code: string, alwaysRun: boolean) => void;\n};\n\nconst PuppyFooter: React.FC<PuppyFooterProps> = (props: PuppyFooterProps) => {\n  const fullscreen = () => {\n    if (props.puppy != null) {\n      const canvas = props.puppy.getCanvas();\n      if (canvas) {\n        // FIXME\n        if (canvas['webkitRequestFullscreen']) {\n          canvas['webkitRequestFullscreen'](); // Chrome15+, Safari5.1+, Opera15+\n        } else if (canvas['mozRequestFullScreen']) {\n          canvas['mozRequestFullScreen'](); // FF10+\n        } else if (canvas['msRequestFullscreen']) {\n          canvas['msRequestFullscreen'](); // IE11+\n        } else if (canvas['requestFullscreen']) {\n          canvas['requestFullscreen'](); // HTML5 Fullscreen API\n        } else {\n          // alert('');\n          return;\n        }\n      }\n    }\n  };\n  return (\n    <div id=\"puppy-footer\">\n      <Button onClick={() => props.trancepile(props.puppy, props.code, true)}>\n        <FontAwesomeIcon icon={faPlay} />\n        {' Play'}\n      </Button>\n      <Button onClick={fullscreen}>\n        <FontAwesomeIcon icon={faExpand} />\n      </Button>\n      <Button onClick={() => props.setIsCourseVisible(!props.isCourseVisible)}>\n        <FontAwesomeIcon icon={props.isCourseVisible ? faBook : faBookOpen} />\n      </Button>\n    </div>\n  );\n};\n\nexport type PuppyScreenProps = PuppyFooterProps & {\n  setSize: (width: number, height: number) => void;\n};\n\nlet timer: NodeJS.Timeout | null = null;\n\nconst PuppyScreen: React.FC<PuppyScreenProps> = (props: PuppyScreenProps) => {\n  addEventListener('resize', () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    timer = setTimeout(function() {\n      const w = document.getElementById('puppy-screen')!.clientWidth;\n      const h = document.getElementById('puppy-screen')!.clientHeight;\n      props.setSize(w, h);\n    }, 300);\n  });\n\n  return (\n    <>\n      <div id=\"puppy-screen\"></div>\n      <PuppyFooter\n        isCourseVisible={props.isCourseVisible}\n        setIsCourseVisible={props.setIsCourseVisible}\n        code={props.code}\n        puppy={props.puppy}\n        trancepile={props.trancepile}\n      />\n    </>\n  );\n};\n\nexport default PuppyScreen;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setVisible } from '../modules/course';\nimport { setSize } from '../modules/puppy';\nimport { trancepile } from '../modules/operations';\nimport PuppyScreen from '../components/PuppyScreen/PuppyScreen';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  isCourseVisible: state.course.visible,\n  code: state.editor.code,\n  puppy: state.puppy.puppy,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setIsCourseVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  trancepile: trancepile(dispatch),\n});\n\nconst PuppyScreenContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PuppyScreen);\n\nexport default PuppyScreenContainer;\n","import React, { useEffect } from 'react';\nimport * as marked from 'marked';\nimport { Card, Col, Row } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChevronRight,\n  faChevronLeft,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { Puppy } from '../../vm/vm';\n\nimport { CourseShape } from '../../modules/course';\n\nimport './Course.css';\nimport './github-markdown.css';\n\ntype CourseProps = {\n  course: CourseShape;\n  coursePath: string;\n  puppy: Puppy | null;\n  page: number;\n  content: string;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n  setCode: (code: string) => void;\n  setContent: (content: string) => void;\n  setCourse: (course: CourseShape) => void;\n  fetchContent: (coursePath: string, path: string) => void;\n  fetchSample: (\n    puppy: Puppy | null,\n    coursePath: string,\n    page: number,\n    path: string\n  ) => void;\n  fetchSetting: (coursePath: string) => void;\n};\n\nconst Course: React.FC<CourseProps> = (props: CourseProps) => {\n  useEffect(() => {\n    if (props.course.list.length !== 0) {\n      props.fetchContent(props.coursePath, props.course.list[props.page].path);\n      props.fetchSample(\n        props.puppy,\n        props.coursePath,\n        props.page,\n        props.course.list[props.page].path\n      );\n    }\n  }, [props.page, props.coursePath, props.course]);\n\n  useEffect(() => {\n    props.fetchSetting(props.coursePath);\n  }, [props.coursePath]);\n\n  return (\n    <div\n      id=\"puppy-course\"\n      style={{ visibility: props.visible ? 'visible' : 'hidden' }}\n    >\n      <Card className=\"course-all\">\n        <Card.Header className=\"course-header\">\n          <Row>\n            <button\n              className=\"close-button\"\n              onClick={() => props.setVisible(false)}\n            >\n              <FontAwesomeIcon icon={faTimes} />\n            </button>\n          </Row>\n          <Row>\n            <Col className=\"card-header-left\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== 0 ? (\n                <a href={`#${props.page - 1}`}>\n                  <FontAwesomeIcon icon={faChevronLeft} />\n                  {` ${props.course.list[props.page - 1].title}`}\n                </a>\n              ) : null}\n            </Col>\n            <Col className=\"card-header-right\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== props.course.list.length - 1 ? (\n                <a href={`#${props.page + 1}`}>\n                  {`${props.course.list[props.page + 1].title} `}\n                  <FontAwesomeIcon icon={faChevronRight} />\n                </a>\n              ) : null}\n            </Col>\n          </Row>\n        </Card.Header>\n        <Card.Body className=\"course-body\">\n          <div\n            className=\"markdown-body\"\n            dangerouslySetInnerHTML={{\n              __html: marked(props.content),\n            }}\n          ></div>\n        </Card.Body>\n      </Card>\n    </div>\n  );\n};\n\nexport default Course;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Course from '../components/Course/Course';\nimport {\n  setContent,\n  setCourse,\n  CourseShape,\n  setVisible,\n} from '../modules/course';\nimport { setCode } from '../modules/editor';\nimport { fetchContent, fetchSample, fetchSetting } from '../modules/operations';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  course: state.course.course,\n  puppy: state.puppy.puppy,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n  content: state.course.content,\n  visible: state.course.visible,\n});\n\nconst mapDispathToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setContent: (content: string) => dispatch(setContent(content)),\n  setCourse: (course: CourseShape) => dispatch(setCourse(course)),\n  setCode: (code: string) => dispatch(setCode(code)),\n  setVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  fetchContent: fetchContent(dispatch),\n  fetchSample: fetchSample(dispatch),\n  fetchSetting: fetchSetting(dispatch),\n});\n\nconst CourseContainer = connect(\n  mapStateToProps,\n  mapDispathToProps\n)(Course);\n\nexport default CourseContainer;\n","import React from 'react';\nimport { Modal, Button, InputGroup, FormControl, Form } from 'react-bootstrap';\n\nexport type InputState = {\n  show: boolean;\n  value: string;\n  placeholder: string;\n};\n\nexport type InputHandler = {\n  setShow: (show: boolean) => void;\n  setValue: (value: string) => void;\n};\n\nexport type InputProps = InputState & InputHandler;\n\nconst Input: React.FC<InputProps> = (props: InputProps) => {\n  return (\n    <Modal size=\"lg\" show={props.show} centered>\n      <Modal.Body>\n        <Form id=\"puppy-input-form\" onSubmit={() => props.setShow(false)}>\n          <InputGroup className=\"mb-3\">\n            <FormControl\n              placeholder={props.placeholder}\n              value={props.value}\n              onChange={e => props.setValue(e.target.value)}\n            />\n            <InputGroup.Append>\n              <Button type=\"submit\"></Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Input;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow, setValue } from '../modules/input';\nimport Input, { InputState, InputHandler } from '../components/Input/Input';\n\nconst mapStateToProps = (state: ReduxState): InputState => ({\n  show: state.input.show,\n  value: state.input.value,\n  placeholder: state.input.placeholder,\n});\n\nconst mapDispatchToProps = (\n  dispatch: (action: ReduxActions) => void\n): InputHandler => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n  setValue: (value: string) => dispatch(setValue(value)),\n});\n\nconst InputContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Input);\n\nexport default InputContainer;\n","import React from 'react';\nimport { Modal, Button } from 'react-bootstrap';\n\ntype VersionProps = {\n  show: boolean;\n  setShow: (show: boolean) => void;\n};\n\nconst Version: React.FC<VersionProps> = (props: VersionProps) => {\n  return (\n    <>\n      <Modal show={props.show} onHide={() => props.setShow(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Modal heading</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {\"Woohoo, you're reading this text in a modal!\"}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => props.setShow(false)}>\n            Close\n          </Button>\n          <Button variant=\"primary\" onClick={() => props.setShow(false)}>\n            Save Changes\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\n// render(<Example />);\n\nexport default Version;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow } from '../modules/version';\nimport Version from '../components/Version/Version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  show: state.version.show,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n});\n\nconst VersionContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Version);\n\nexport default VersionContainer;\n","import React from 'react';\nimport './App.css';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport Header from './containers/Header';\nimport Editor from './containers/Editor';\nimport PuppyScreen from './containers/PuppyScreen';\nimport Course from './containers/Course';\nimport Input from './containers/Input';\nimport Version from './containers/Version';\nimport { QueryParams } from './index';\n\ntype AppProps = { qs: QueryParams; hash: string };\n\nconst App: React.FC<AppProps> = (props: AppProps) => {\n  const coursePath = props.qs.course ? props.qs.course : 'LIVE2019';\n  const page = props.hash !== '' ? parseInt(props.hash.substr(1)) : 0;\n  return (\n    <div className=\"App\">\n      <Container className=\"container\">\n        <Header />\n        <Input />\n        <Version />\n        <Row id=\"main-row\">\n          <Col id=\"left-col\" xs={6}>\n            <Course coursePath={coursePath} page={page} />\n            <PuppyScreen />\n          </Col>\n          <Col id=\"right-col\" xs={6}>\n            <Editor coursePath={coursePath} page={page} />\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { store } from './store';\n\nexport type QueryParams = {\n  course?: string;\n};\n\nconst queryParser = (query: string) =>\n  query\n    .substr(1)\n    .split('&')\n    .reduce((obj, v) => {\n      const pair = v.split('=');\n      obj[pair[0]] = pair[1];\n      return obj;\n    }, {});\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <Route\n        render={props => (\n          <App\n            qs={queryParser(props.location.search)}\n            hash={props.location.hash}\n          />\n        )}\n      />\n    </Router>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}