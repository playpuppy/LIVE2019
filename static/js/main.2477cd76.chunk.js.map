{"version":3,"sources":["components/Header/Header.tsx","modules/editor.ts","modules/course.ts","modules/puppy.ts","modules/input.ts","env.ts","vm/shape.ts","vm/color.ts","puppy-transpiler/puppy-lib.ts","vm/vm.ts","vm/render.ts","modules/version.ts","store.ts","puppy-transpiler/puppy-parser.ts","puppy-transpiler/puppy.ts","modules/operations.ts","containers/Header.ts","components/Editor/Editor.tsx","containers/Editor.ts","components/PuppyScreen/PuppyScreen.tsx","containers/PuppyScreen.ts","components/Course/Course.tsx","containers/Course.ts","components/Input/Input.tsx","containers/Input.ts","components/Version/Version.tsx","containers/Version.ts","App.tsx","index.tsx"],"names":["Header","EditorActionTypes","props","useEffect","fetchCourses","react_default","a","createElement","className","id","__source","fileName","_jsxFileName","lineNumber","__self","undefined","Navbar","bg","variant","expand","Brand","onClick","setShow","src","width","height","Nav","NavDropdown","title","course","Object","keys","courses","map","course_path","concat","drop","key","list","page","i","Item","href","setCode","code","type","SET_CODE","payload","setDecoration","decoration","SET_DECORATION","type2severity","monacoEditor","Error","Info","Warning","Hint","setTheme","theme","SET_THEME","initialState","codeEditor","fontSize","markers","diffStartLineNumber","editorReducer","CourseActionTypes","state","action","SET_SIZE","_objectSpread","SET_CODEEDITOR","SET_FONTSIZE","value","SET_MARKER","setModelMarkers","getModel","SET_DIFFSTARTLINENUMBER","startLineNumber","setContent","content","SET_CONTENT","setCourse","SET_COURSE","setVisible","visible","SET_VISIBLE","coursePath","courseReducer","PuppyActionTypes","course_objectSpread","SET_COURSES","puppy","isLive","puppyReducer","InputActionTypes","resize","puppy_objectSpread","SET_PUPPY","SET_ISLIVE","show","SET_SHOW","placeholder","InputReducer","SET_VALUE","input_objectSpread","SET_PLACEHOLDER","Bodies","Matter","Composite","Common","PropertyMap","radius","options","base","fillStyle","color","Array","isArray","choose","world","colorScheme","length","convColor","setShapeProperty","checkShapeProperty","circle","assign","position","x","y","rectangle","isStatic","polygon","sides","label","isSensor","collisionFilter","category","mask","group","created","getTimeStamp","pendulum","column","viewWidth","size","xx","yy","newtonsCradle","create","_options","inertia","interia","Infinity","restitution","friction","frictionAir","slop","constraint","pointA","bodyB","render","lineWidth","strokeStyle","console","log","initVars","vars","Circle","Rectangle","Polygon","Label","Drop","Pendulum","PuppyColorScheme","pop","cute","dynamic","gorgeous","casual","psychedelic","bright","fairytale","heavy","impact","street","cool","elegant","fresh","warm","soft","man","woman","boy","girl","smart","light","stylish","natural","spring","summer","fall","winter","japan","euro","nordic","asian","chooseColorScheme","cs","targets","document","getElementsByClassName","style","backgroundColor","borderColor","Lib","constructor","this","Body","Constraint","[object Object]","Number","parseInt","parseFloat","str","join","anyAdd","anyMul","s","anyIn","indexOf","range","z","start","end","step","xs","push","get","name","index","charAt","slice","substr","find","sub","append","len","setPosition","body","translate","applyForce","fx","fy","rotate","angle","_x","_y","scale","sx","sy","setAngle","setVelocity","setAngularVelocity","velocity","setDensity","density","setMass","mass","setStatic","flag","newComosite","addBody","parent","addConstraint","Engine","Runner","Render","_getTexture","imagePath","image","textures","Image","startsWith","bodies","context","c","showInternalEdges","wireframes","defaultFont","font","defaultFontColor","fontColor","k","parts","part","opacity","globalAlpha","texture","drawImage","circleRadius","beginPath","arc","Math","PI","moveTo","vertices","j","isInternal","lineTo","closePath","stroke","fill","ref","save","textAlign","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","fillText","restore","myRender","MouseConstraint","Mouse","World","Bounds","Vertices","Detector","Puppy","settings","waitStart","interval","waitRestart","isExecuting","runner","engine","canvas","lib","new_","cons","add","viewHeight","pos","view","min","max","initCode","vwidth","vheight","background","gravity","airFriction","frictionStatic","motion","startCode","window","addEventListener","event","orientation","clamp","gamma","beta","on","time","timing","timestamp","eachUpdate","allBodies","pairs","pair","bodyA","isFixed","getElementById","render_width","clientWidth","render_height","clientHeight","element","mouse","constraintOptions","pointB","stiffness","mouseConstraint","sourcebody","contains","bounds","canCollide","run","dispose","clear","stop","remove","getCode","getCanvas","w","h","setAttribute","toString","msec","Promise","resolve","setTimeout","wait","enabled","getDiffStartLineNumber","main","getIsLive","delta","update","setCodeHighlight","waitForRun","resetCodeHighlight","isRunning","runCode","execute_main","pause","ln","n","lines","msg","getInputValue","text","display","async","target","querySelector","Text","onclick","listener","once","awaitForClick","f","print","extend","shape","move","px","random","trace","listAdd","int","float","getindex","func","lst","from","puppy_settings","ftrace","_log","VersionActionTypes","SET_VERSION_SHOW","VersionReducer","version_objectSpread","allReducers","combineReducers","editor","input","version","store","createStore","ParseTree","tag","spos","epos","child","urn","inputs","nodes","empties","setup","entry","edge","prev","reverse","is","isError","subs","tokenize","defstr","substring","row","col","charCodeAt","begin","sb","strOut","node","Merge","ParserContext","head_pos","ast","memos","Memo","ANY","pAny","pChar","text_length","set_bitmap","bitmap","pRange","chars","ranges","codemax","find_codemax","Uint8Array","pMany","match","pMany1","pAnd","pNot","pOption","pSeq","matches","pSeq2","match2","pSeq3","match3","pOre","pOre2","pRef","peg","pNode","shift","pEdge","pFold","State","sid","getstate","pMatch","generate","grammar","res","pScope","pSymbol","INDENT","Type","isOptional","rtype","psize","ptype","accept","ty","realType","isPattern","hasAlpha","toVarType","BaseType","super","v","VarType","must","env","t","VoidType","FuncType","types","ss","ListType","param","p","tAny","UnionType","ty0","ts","union","tVoid","tBool","tInt","tInt_","tFloat","tString","tString_","tA","tListA","tListInt","tListAny","tMatter","tVec","EmptyNumberSet","unionSet","b","A","varMap","varid","getroot","v1","u","OptionType","JSON","stringify","equals","Symbol","isMatter","isMutable","isGlobal","tColor","tOption","tFuncFloatFloat","tFuncFloatFloatFloat","tFuncShape","import_math","pi","sin","cos","tan","sqrt","log10","pow","hypot","gcd","import_python",".append","modules","math","matterjs",".setPosition",".applyForce",".rotate",".scale",".setAngle",".setAngularVelocity",".setDensity",".setMass",".setStatic",".setVelocity","symbolPackageMap","pkgname","checkSymbolNames","KEYTYPES","area","torque","damping","in","out","over","clicked","message","tCompr","opset","and","or","not","+=","-=","*=","//=","/=","<<=",">>=","|=","&=","^=","operator","op","op2","tleftMap","+","-","**","*","/","//","%","==","!=","<","<=",">",">=","^","|","&","<<",">>","tleft","tright","ty2","setpos","elog","r","Env","root","e","has","set","setroot","from_import","pkg","setModule","isModule","getModule","perror","logs","setInLoop","inLoop","setFunc","data","inFunc","foundFunc","symbol","isUtf8Name","local","vname","declVar","emitAutoYield","yieldparam","PuppyError","FIXME_subs","Transpiler","conv","subject","skip","check","req","request","given","checkBinary","ty1","left","right","err","FromDecl","ImportDecl","alias","Source","subtree","out2","Block","penv","indent","nested","IfExpr","IfStmt","stmt","ElifStmt","ForStmt","lenv","FuncDecl","names","funcData","return","hasReturn","pname","funcType","defun","FuncExpr","Return","Continue","Break","Pass","VarDecl","out1","qual","Name","SetName","And","Or","Not","Infix","Unary","ApplyExpr","ApplySymbolExpr","recv","args","unshift","MethodExpr","methodname","SelfAssign","GetExpr","SetGetExpr","IndexExpr","SetIndexExpr","Data","KeyValue","Tuple","List","Format","TrueExpr","FalseExpr","Int","Float","Double","String","Char","MultiString","parse","parser","transpile","compile","source","jscode","Function","checkError","dispatch","error_count","annos","errors","marker","severity","startColumn","endLineNumber","endColumn","setMarker","new_puppy","trancepile","alwaysRun","_isLive","newpuppy","runPuppy","setPuppy","loadFile","path","fetch","method","then","ok","statusText","sample","fetchSetting","catch","fetchContent","fetchSample","sessionStorage","getItem","setPlaceholder","getState","num","startLineNum","endLineNum","deltaDecorations","Range","isWholeLine","get_course","forEach","all","setCources","HeaderContainer","connect","dispathch","defineTheme","inherit","rules","colors","editor.background","registerCompletionItemProvider","provideCompletionItems","model","_token","wordInfo","getWordUntilPosition","suggestions","kind","CompletionItemKind","insertText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","Constructor","Property","EditorFooter","Editor_jsxFileName","Button","setIsLive","Spinner","animation","index_es","icon","faPlay","setFontSize","faPlus","faMinus","resizeTimer","trancepileTimer","startTimer","Editor","editorOptions","selectOnLineNumbers","wordWrap","clearTimeout","setSize","lib_default","language","onChange","new_code","startNumber","changes","change","setDiffStartLineNumber","decos","findMatches","inlineClassName","checkZenkaku","setItem","editorDidMount","setCodeEditor","EditorContainer","ownProps","LineNumber","PuppyFooter","PuppyScreen_jsxFileName","faExpand","setIsCourseVisible","isCourseVisible","faBookOpen","faBook","timer","PuppyScreen","Fragment","PuppyScreenContainer","Course","visibility","Course_jsxFileName","Card","Row","faTimes","Col","faChevronLeft","faChevronRight","dangerouslySetInnerHTML","__html","marked","CourseContainer","Input","Modal","centered","Input_jsxFileName","Form","onSubmit","InputGroup","FormControl","setValue","Append","InputContainer","Version","onHide","Version_jsxFileName","closeButton","Title","Footer","VersionContainer","App","qs","hash","App_jsxFileName","Container","containers_Header","containers_Input","containers_Version","containers_Course","containers_PuppyScreen","containers_Editor","queryParser","query","split","reduce","obj","ReactDOM","es","src_jsxFileName","react_router_dom","react_router","src_App","location","search"],"mappings":"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C5BC,YAAa1C,EAAQ0C,aAAe,EACpCC,SAAU3C,EAAQ2C,UAAY,EAC9BC,YAAa5C,EAAQ4C,aAAe,KACpCC,KAAM7C,EAAQ6C,MAAQ,GAElBhC,EAASlB,SAAckB,OAC3BqB,EAAK3G,GA/BU,IA+BL0G,GACVE,EAAK3H,EACLyH,EACAK,GAEIQ,EAAanD,aAAkB0C,OAAO,CAC1CU,OAAQ,CACN/B,EAAGkB,EAAK3G,GAtCK,IAsCA0G,GACbhB,EAAGkB,GAELa,MAAOnC,EACPoC,OAAQ,CACN7E,SAAS,EACT8E,UAAgC,EAArBlD,EAAQkD,UACnBC,YAAanD,EAAQmD,aAAe,UAGxCvD,EAAS,QAAYwC,EAAevB,GACpCjB,EAAS,cAAkBwC,EAAeU,GAI5C,OAFAM,QAAQC,IAAIjB,GACZgB,QAAQC,IAAIjB,EAAa,OAClBA,GAGIkB,GAAYC,IACvB1I,OAAOiG,OAAOyC,EAAM,CAClBC,OAAQ3C,EACR4C,UAAWvC,GACXwC,QAAStC,GACTuC,MAAOrC,GACPsC,KAAMzI,GACN0I,SAAU/B,KAELyB,GAgHF,MClbD1D,GAASF,SAETmE,GAAmB,CACvBC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,SAAU,CACR,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,YAAa,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,UAAW,CACT,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAISC,GAAqB3K,IAChC,MAAM4K,EACJ5K,KAAO0I,GACHA,GAAiB1I,GACjB0I,GACEjE,GAAOS,OAAO,CACZ,MACA,OACA,UACA,WACA,SACA,cACA,SACA,YACA,QACA,SACA,SACA,OACA,UACA,QACA,OACA,OACA,MACA,QACA,MACA,OACA,QACA,QACA,UACA,UACA,SACA,SACA,OACA,SACA,QACA,OACA,SACA,WAGJ2F,EACJC,SAASC,uBAAuB,OAElC,IAAK,IAAI5K,EAAI,EAAGA,EAAI0K,EAAQxF,OAAQlF,GAAK,EACvC0K,EAAQ1K,GAAG6K,MAAMC,gBAAkBL,EAAGzK,EAAIyK,EAAGvF,QAC7CwF,EAAQ1K,GAAG6K,MAAME,YAAcN,EAAGzK,EAAIyK,EAAGvF,QAE3C,OAAOuF,GCtfF,MAAMO,GAKJC,YAAY7G,GAAa8G,KAJxBC,UAIwB,EAAAD,KAHxB7G,eAGwB,EAAA6G,KAFxBE,gBAEwB,EAC9BF,KAAKC,KAAO/G,EAAM,KAClB8G,KAAK7G,UAAYD,EAAM,UACvB8G,KAAKE,WAAahH,EAAM,WAK1BiH,WAAkB5F,GAChB,MAAiB,kBAANA,EACE,EAAJA,EAEQ,kBAANA,EACF6F,OAAOC,SAAS9F,GAER,mB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","file":"static/js/main.2477cd76.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\nimport { CourseShape } from '../../modules/course';\nimport './Header.css';\n\nexport type HeaderProps = {\n  course: CourseShape;\n  courses: { [path: string]: CourseShape };\n  fetchCourses: () => void;\n  setShow: (show: boolean) => void;\n};\n\nconst Header: React.FC<HeaderProps> = (props: HeaderProps) => {\n  useEffect(() => {\n    props.fetchCourses();\n  }, []);\n  return (\n    <div className=\"Header\" id=\"puppy-header\">\n      <Navbar bg=\"white\" variant=\"light\" expand=\"lg\">\n        <Navbar.Brand onClick={() => props.setShow(true)}>\n          <img\n            src=\"./image/logo.png\"\n            width=\"25\"\n            height=\"25\"\n            className=\"d-inline-block align-top\"\n          />\n          {' Puppy'}\n        </Navbar.Brand>\n        <Nav className=\"mr-auto\">\n          <NavDropdown title={props.course.title} id=\"nav-dropdown-courses\">\n            {Object.keys(props.courses).map(course_path => {\n              const course = props.courses[course_path];\n              return (\n                <NavDropdown\n                  title={course.title}\n                  id={`nav-dropdown-pages-${course.title}`}\n                  drop=\"right\"\n                  key={course.title}\n                >\n                  {course.list.map(\n                    (page: { path: string; title: string }, i: number) => (\n                      <NavDropdown.Item\n                        href={`?course=${course_path}#${i}`}\n                        key={i}\n                      >\n                        {page.title}\n                      </NavDropdown.Item>\n                    )\n                  )}\n                </NavDropdown>\n              );\n            })}\n          </NavDropdown>\n        </Nav>\n      </Navbar>\n    </div>\n  );\n};\n\nexport default Header;\n","import { Action } from 'redux';\nimport * as monacoEditor from 'monaco-editor';\nexport type CodeEditor = monacoEditor.editor.IStandaloneCodeEditor;\nimport { ErrorLog } from '../vm/vm';\n\nenum EditorActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_CODE = 'SET_CODE',\n  SET_CODEEDITOR = 'SET_CODEEDITOR',\n  SET_FONTSIZE = 'SET_FONTSIZE',\n  SET_DECORATION = 'SET_DECORATION',\n  SET_MARKER = 'SET_MARKER',\n  SET_THEME = 'SETTHEME',\n  SET_DIFFSTARTLINENUMBER = 'SET_DIFFSTARTLINENUMBER',\n}\n\ninterface SetSizeAction extends Action {\n  type: EditorActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number): SetSizeAction => ({\n  type: EditorActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetCodeAction extends Action {\n  type: EditorActionTypes.SET_CODE;\n  payload: {\n    code: string;\n  };\n}\n\nexport const setCode = (code: string): SetCodeAction => ({\n  type: EditorActionTypes.SET_CODE,\n  payload: {\n    code,\n  },\n});\n\ninterface SetCodeEditorAction extends Action {\n  type: EditorActionTypes.SET_CODEEDITOR;\n  payload: {\n    codeEditor: CodeEditor | null;\n  };\n}\n\nexport const setCodeEditor = (\n  codeEditor: CodeEditor | null\n): SetCodeEditorAction => ({\n  type: EditorActionTypes.SET_CODEEDITOR,\n  payload: {\n    codeEditor,\n  },\n});\n\ninterface SetFontSizeAction extends Action {\n  type: EditorActionTypes.SET_FONTSIZE;\n  payload: {\n    value: number;\n  };\n}\n\nexport const setFontSize = (value: number): SetFontSizeAction => ({\n  type: EditorActionTypes.SET_FONTSIZE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetDecorationAction extends Action {\n  type: EditorActionTypes.SET_DECORATION;\n  payload: {\n    decoration: string[];\n  };\n}\n\nexport const setDecoration = (decoration: string[]): SetDecorationAction => ({\n  type: EditorActionTypes.SET_DECORATION,\n  payload: {\n    decoration,\n  },\n});\n\ninterface SetMarkerAction extends Action {\n  type: EditorActionTypes.SET_MARKER;\n  payload: {\n    markers: monacoEditor.editor.IMarkerData[];\n  };\n}\n\nconst type2severity = (type: 'error' | 'info' | 'warning' | 'hint') => {\n  switch (type) {\n    case 'error':\n      return monacoEditor.MarkerSeverity.Error;\n    case 'info':\n      return monacoEditor.MarkerSeverity.Info;\n    case 'warning':\n      return monacoEditor.MarkerSeverity.Warning;\n    case 'hint':\n      return monacoEditor.MarkerSeverity.Hint;\n  }\n};\n\nexport const setMarker = (markers: ErrorLog[]): SetMarkerAction => ({\n  type: EditorActionTypes.SET_MARKER,\n  payload: {\n    markers: markers.map(marker => ({\n      severity: type2severity(marker.type as\n        | 'error'\n        | 'info'\n        | 'warning'\n        | 'hint'),\n      startLineNumber: marker.row! + 1,\n      startColumn: marker.col!,\n      endLineNumber: marker.row! + 1,\n      endColumn: marker.col! + marker.len!,\n      message: marker.key,\n    })),\n  },\n});\n\ninterface SetThemeAction extends Action {\n  type: EditorActionTypes.SET_THEME;\n  payload: {\n    theme: string;\n  };\n}\n\nexport const setTheme = (theme: string): SetThemeAction => ({\n  type: EditorActionTypes.SET_THEME,\n  payload: {\n    theme,\n  },\n});\n\ninterface SetDiffStartLineNumber extends Action {\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER;\n  payload: {\n    startLineNumber: number | null;\n  };\n}\n\nexport const setDiffStartLineNumber = (startLineNumber: number | null) => ({\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER,\n  payload: {\n    startLineNumber,\n  },\n});\n\nexport type EditorActions =\n  | SetCodeAction\n  | SetSizeAction\n  | SetCodeEditorAction\n  | SetFontSizeAction\n  | SetDecorationAction\n  | SetMarkerAction\n  | SetThemeAction\n  | SetDiffStartLineNumber;\n\nexport type EditorState = {\n  width: number;\n  height: number;\n  code: string;\n  codeEditor: CodeEditor | null;\n  theme: string;\n  fontSize: number;\n  decoration: string[];\n  markers: monacoEditor.editor.IMarkerData[];\n  diffStartLineNumber: number | null;\n};\n\nconst initialState: EditorState = {\n  width: 500,\n  height: 500,\n  code: '',\n  codeEditor: null,\n  theme: 'vs',\n  fontSize: 24,\n  decoration: [],\n  markers: [],\n  diffStartLineNumber: null,\n};\n\nexport const editorReducer = (state = initialState, action: EditorActions) => {\n  switch (action.type) {\n    case EditorActionTypes.SET_SIZE:\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case EditorActionTypes.SET_CODE:\n      return { ...state, code: action.payload.code };\n    case EditorActionTypes.SET_CODEEDITOR:\n      return { ...state, codeEditor: action.payload.codeEditor };\n    case EditorActionTypes.SET_FONTSIZE:\n      return { ...state, fontSize: action.payload.value };\n    case EditorActionTypes.SET_DECORATION:\n      return { ...state, decoration: action.payload.decoration };\n    case EditorActionTypes.SET_MARKER:\n      monacoEditor.editor.setModelMarkers(\n        state.codeEditor!.getModel()!,\n        'puppy',\n        action.payload.markers\n      );\n      return {\n        ...state,\n        codeEditor: state.codeEditor,\n        markers: action.payload.markers,\n      };\n    case EditorActionTypes.SET_THEME:\n      return { ...state, theme: action.payload.theme };\n    case EditorActionTypes.SET_DIFFSTARTLINENUMBER:\n      return { ...state, diffStartLineNumber: action.payload.startLineNumber };\n    default:\n      return state;\n  }\n};\n\nexport default editorReducer;\n","import { Action } from 'redux';\n\nexport type CourseShape = {\n  title: string;\n  list: {\n    path: string;\n    title: string;\n  }[];\n};\n\nenum CourseActionTypes {\n  SET_CONTENT = 'SET_CONTENT',\n  SET_COURSES = 'SET_COURCES',\n  SET_COURSE = 'SET_COURSE',\n  SET_VISIBLE = 'SET_VISIBLE',\n}\n\ninterface SetContentAction extends Action {\n  type: CourseActionTypes.SET_CONTENT;\n  payload: {\n    content: string;\n  };\n}\n\nexport const setContent = (content: string): SetContentAction => ({\n  type: CourseActionTypes.SET_CONTENT,\n  payload: {\n    content,\n  },\n});\n\ninterface SetCoursesAction extends Action {\n  type: CourseActionTypes.SET_COURSES;\n  payload: {\n    courses: { [path: string]: CourseShape };\n  };\n}\n\nexport const setCources = (courses: {\n  [path: string]: CourseShape;\n}): SetCoursesAction => ({\n  type: CourseActionTypes.SET_COURSES,\n  payload: {\n    courses,\n  },\n});\n\ninterface SetCourseAction extends Action {\n  type: CourseActionTypes.SET_COURSE;\n  payload: {\n    course: CourseShape;\n  };\n}\n\nexport const setCourse = (course: CourseShape): SetCourseAction => ({\n  type: CourseActionTypes.SET_COURSE,\n  payload: {\n    course,\n  },\n});\n\ninterface SetVisibleAction extends Action {\n  type: CourseActionTypes.SET_VISIBLE;\n  payload: {\n    visible: boolean;\n  };\n}\n\nexport const setVisible = (visible: boolean): SetVisibleAction => ({\n  type: CourseActionTypes.SET_VISIBLE,\n  payload: {\n    visible,\n  },\n});\n\nexport type CourseActions =\n  | SetContentAction\n  | SetCoursesAction\n  | SetCourseAction\n  | SetVisibleAction;\n\nexport type CourseState = {\n  content: string;\n  courses: { [path: string]: CourseShape };\n  course: CourseShape;\n  coursePath: string;\n  page: number;\n  visible: boolean;\n};\n\nconst initialState: CourseState = {\n  content: '# Hello World \\n\\n Rendered by **marked**',\n  courses: {},\n  course: { title: '', list: [] },\n  coursePath: '',\n  page: 0,\n  visible: true,\n};\n\nconst courseReducer = (state = initialState, action: CourseActions) => {\n  switch (action.type) {\n    case CourseActionTypes.SET_CONTENT:\n      return { ...state, content: action.payload.content };\n    case CourseActionTypes.SET_COURSES:\n      return { ...state, courses: action.payload.courses };\n    case CourseActionTypes.SET_COURSE:\n      return { ...state, course: action.payload.course };\n    case CourseActionTypes.SET_VISIBLE:\n      return { ...state, visible: action.payload.visible };\n    default:\n      return state;\n  }\n};\n\nexport default courseReducer;\n","import { Action } from 'redux';\nimport { Puppy } from '../vm/vm';\n\nenum PuppyActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_PUPPY = 'SET_PUPPY',\n  SET_ISLIVE = 'SET_ISLIVE',\n}\n\ninterface SetSizeAction extends Action {\n  type: PuppyActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number) => ({\n  type: PuppyActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetPuppyAction extends Action {\n  type: PuppyActionTypes.SET_PUPPY;\n  payload: {\n    puppy: Puppy | null;\n  };\n}\n\nexport const setPuppy = (puppy: Puppy | null) => ({\n  type: PuppyActionTypes.SET_PUPPY,\n  payload: {\n    puppy,\n  },\n});\n\ninterface SetIsLiveAction extends Action {\n  type: PuppyActionTypes.SET_ISLIVE;\n  payload: {\n    isLive: boolean;\n  };\n}\n\nexport const setIsLive = (isLive: boolean) => ({\n  type: PuppyActionTypes.SET_ISLIVE,\n  payload: {\n    isLive,\n  },\n});\n\nexport type PuppyActions = SetSizeAction | SetPuppyAction | SetIsLiveAction;\n\nexport type PuppyState = {\n  width: number;\n  height: number;\n  puppy: Puppy | null;\n  isLive: boolean;\n};\n\nconst initialState: PuppyState = {\n  width: 500,\n  height: 500,\n  puppy: null,\n  isLive: true,\n};\n\nexport const puppyReducer = (state = initialState, action: PuppyActions) => {\n  switch (action.type) {\n    case PuppyActionTypes.SET_SIZE:\n      if (state.puppy) {\n        state.puppy.resize(action.payload.width, action.payload.height);\n      }\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case PuppyActionTypes.SET_PUPPY:\n      return { ...state, puppy: action.payload.puppy };\n    case PuppyActionTypes.SET_ISLIVE:\n      return { ...state, isLive: action.payload.isLive };\n    default:\n      return state;\n  }\n};\n\nexport default puppyReducer;\n","import { Action } from 'redux';\n\nenum InputActionTypes {\n  SET_VALUE = 'SET_VALUE',\n  SET_SHOW = 'SET_SHOW',\n  SET_PLACEHOLDER = 'SET_PLACEHOLDER',\n}\n\ninterface SetValueAction extends Action {\n  type: InputActionTypes.SET_VALUE;\n  payload: {\n    value: string;\n  };\n}\n\nexport const setValue = (value: string): SetValueAction => ({\n  type: InputActionTypes.SET_VALUE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetShowAction extends Action {\n  type: InputActionTypes.SET_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: InputActionTypes.SET_SHOW,\n  payload: {\n    show,\n  },\n});\n\ninterface SetPlaceholderAction extends Action {\n  type: InputActionTypes.SET_PLACEHOLDER;\n  payload: {\n    placeholder: string;\n  };\n}\n\nexport const setPlaceholder = (placeholder: string): SetPlaceholderAction => ({\n  type: InputActionTypes.SET_PLACEHOLDER,\n  payload: {\n    placeholder,\n  },\n});\n\nexport type InputActions =\n  | SetValueAction\n  | SetShowAction\n  | SetPlaceholderAction;\n\nexport type InputState = {\n  value: string;\n  show: boolean;\n  placeholder: string;\n};\n\nconst initialState: InputState = {\n  value: '',\n  show: false,\n  placeholder: '',\n};\n\nconst InputReducer = (state = initialState, action: InputActions) => {\n  switch (action.type) {\n    case InputActionTypes.SET_VALUE:\n      return { ...state, value: action.payload.value };\n    case InputActionTypes.SET_SHOW:\n      if (action.payload.show) {\n        return { value: '', show: action.payload.show, placeholder: '' };\n      } else {\n        return { ...state, show: action.payload.show };\n      }\n    case InputActionTypes.SET_PLACEHOLDER:\n      return { ...state, placeholder: action.payload.placeholder };\n    default:\n      return state;\n  }\n};\n\nexport default InputReducer;\n","export const PATH_PREFIX = '/LIVE2019';\n// export const PATH_PREFIX = '';\n","import * as Matter from 'matter-js';\n\nconst Bodies = Matter.Bodies;\nconst Composite = Matter.Composite;\nconst Common = Matter['Common'];\n\nimport { Puppy } from './vm'; // eslint-disable-line no-unused-vars\n\nexport type PuppyShape =\n  | 'circle'\n  | 'rectangle'\n  | 'trapezoid'\n  | 'polygon'\n  | 'label';\nexport type CollisionFunc = (obj1: {}, obj2: {}) => void;\nexport type ClickedFunc = (obj: {}) => void;\n\nexport type PuppyConstructor = (puppy: Puppy, options: Shape) => Matter.Body;\n\nexport type Shape = {\n  position?: {\n    x: number;\n    y: number;\n  };\n  isSensor?: boolean;\n  isStatic?: boolean;\n  width?: number;\n  height?: number;\n\n  angle?: number;\n  interia?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n};\n\n// const flatten = part => {\n//   console.log(part);\n//   Object.keys(part.render).forEach(key => {\n//     if (!(key in part)) {\n//       console.log(`key ${key}`);\n//       part[key] = part.render[key];\n//     }\n//   });\n// };\n\nconst convColor = (puppy: Puppy, color: any) => {\n  if (Array.isArray(color)) {\n    color = Common.choose(color);\n  }\n  if (typeof color === 'number') {\n    const list: [string] = puppy.world!.colorScheme;\n    return list[color % list.length];\n  }\n  return color;\n};\n\nexport const PropertyMap: {} = {\n  radius: (puppy: Puppy, options: Shape, value: any) => {\n    options.radius = value;\n    if (options.base === 'circle') {\n      options.width = value * 2;\n      options.height = value * 2;\n    }\n  },\n  width: (puppy: Puppy, options: Shape, value: any) => {\n    options.width = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.height = value;\n    }\n  },\n  height: (puppy: Puppy, options: Shape, value: any) => {\n    options.height = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.width = value;\n    }\n  },\n  fillStyle: (puppy: Puppy, options: Shape, value: any) => {\n    options.fillStyle = convColor(puppy, value);\n  },\n};\n\nexport const setShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value: any\n) => {\n  if (key in PropertyMap) {\n    PropertyMap[key](puppy, options, value);\n  } else {\n    options[key] = value;\n  }\n  return value;\n};\n\nconst checkShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value?: any\n) => {\n  if (options[key]) {\n    return setShapeProperty(puppy, options, key, options[key]);\n  }\n  if (value) {\n    return setShapeProperty(puppy, options, key, value);\n  }\n  return undefined;\n};\n\n/* constructor functions */\n\nconst circle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst rectangle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'width', 100);\n  checkShapeProperty(puppy, options, 'height', 100);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    options.isStatic ? 'black' : Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst polygon = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'polygon',\n    visible: true,\n  });\n  const sides = checkShapeProperty(puppy, options, 'sides', 5);\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  return Bodies.polygon(\n    options.position!.x,\n    options.position!.y,\n    sides,\n    options.radius!,\n    options\n  );\n};\n\nconst label = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n  });\n  checkShapeProperty(puppy, options, 'width', 10);\n  checkShapeProperty(puppy, options, 'height', 10);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fontColor',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  checkShapeProperty(puppy, options, 'fillStyle', 'rgba(255, 255, 255, 0)');\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst drop = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n    created: puppy.getTimeStamp(),\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 10);\n  checkShapeProperty(puppy, options, 'fillStyle', 0);\n  checkShapeProperty(puppy, options, 'opacity', 0.8);\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst pendulum = (puppy: Puppy, options: Shape) => {\n  const separation = 1.9;\n  const column = checkShapeProperty(puppy, options, 'column', 5);\n  const width = checkShapeProperty(\n    puppy,\n    options,\n    'width',\n    puppy.world!.viewWidth / 2\n  );\n  const height = checkShapeProperty(\n    puppy,\n    options,\n    'height',\n    puppy.world!.viewWidth / 2\n  );\n  const size = width / (column * 2);\n  const xx = options.position!.x - width / 2;\n  const yy = options.position!.y - height / 2;\n  const newtonsCradle = Matter.Composite.create({\n    label: 'Newtons Cradle',\n  });\n  for (let i = 0; i < column; i += 1) {\n    const _options = {\n      visible: true,\n      fillStyle: Common.choose(puppy.world!.colorScheme),\n      inertia: options.interia || Infinity,\n      restitution: options.restitution || 1,\n      friction: options.friction || 0,\n      frictionAir: options.frictionAir || 0.0001,\n      slop: options.slop || 1,\n    };\n    const circle = Matter.Bodies.circle(\n      xx + i * (size * separation),\n      yy + height,\n      size,\n      _options\n    );\n    const constraint = Matter.Constraint.create({\n      pointA: {\n        x: xx + i * (size * separation),\n        y: yy,\n      },\n      bodyB: circle,\n      render: {\n        visible: true,\n        lineWidth: options.lineWidth! | 1,\n        strokeStyle: options.strokeStyle || 'gray',\n      },\n    });\n    Composite['addBody'](newtonsCradle, circle);\n    Composite['addConstraint'](newtonsCradle, constraint);\n  }\n  console.log(newtonsCradle);\n  console.log(newtonsCradle['parts']);\n  return newtonsCradle;\n};\n\nexport const initVars = (vars: {}) => {\n  Object.assign(vars, {\n    Circle: circle,\n    Rectangle: rectangle,\n    Polygon: polygon,\n    Label: label,\n    Drop: drop,\n    Pendulum: pendulum,\n  });\n  return vars;\n};\n\n/* shapeFunc  */\n\nexport type ShapeOptions = {\n  // Matter Options\n  id?: number;\n  type?: string;\n  label?: string;\n  parts?: [];\n  plugin?: {};\n  angle?: number;\n  interia?: number;\n  position: {\n    x: number;\n    y: number;\n  };\n  width?: number;\n  height?: number;\n  force?: {\n    x: number;\n    y: number;\n  };\n  torque?: number;\n  positionImpulse?: { x?: number; y?: number };\n  constraintImpulse?: { x?: number; y?: number; angle?: number };\n  totalContacts?: number;\n  speed?: number;\n  angularSpeed?: number;\n  velocity?: { x: number; y: number };\n  angularVelocity?: number;\n  isSensor?: boolean;\n  isStatic?: boolean;\n  isSleeping?: boolean;\n  motion?: number;\n  sleepThreshold?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  sprite?: {\n    xScale?: number;\n    yScale?: number;\n    xOffset?: number;\n    yOffset?: number;\n  };\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n  collisionStart?: CollisionFunc;\n  collisionEnd?: CollisionFunc;\n  collisionActive?: CollisionFunc;\n  clicked?: ClickedFunc;\n};\n\n// export const isShapeOptions = (obj: {}) => ('shape' in obj) && ('position' in obj) && ('x' in obj['position']) && ('y' in obj['position']);\n\nexport class PuppyShapeBase implements ShapeOptions {\n  shape: PuppyShape = 'circle';\n  position: {\n    x: number;\n    y: number;\n  };\n\n  constructor(x: number, y: number, options = {}) {\n    Object.assign(this, options);\n    this.position = { x, y };\n  }\n}\n\nexport class Circle extends PuppyShapeBase {\n  shape: PuppyShape = 'circle';\n}\n\nexport class Rectangle extends PuppyShapeBase {\n  shape: PuppyShape = 'rectangle';\n}\n\nexport class Polygon extends PuppyShapeBase {\n  shape: PuppyShape = 'polygon';\n}\n\nexport class Trapezoid extends PuppyShapeBase {\n  shape: PuppyShape = 'trapezoid';\n}\n\nexport class Label extends PuppyShapeBase {\n  shape: PuppyShape = 'label';\n}\n\nexport const shapeFuncMap: {\n  [key in PuppyShape]: (world: {}, options: ShapeOptions) => Matter.Body;\n} = {\n  circle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      radius: _options.width\n        ? _options.width / 2\n        : _options.height\n        ? _options.height / 2\n        : 25,\n      fillStyle: Common.choose(world['colorScheme']),\n      visible: true,\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    // width, height texture \n    if (!options.width) {\n      options.width = options.radius * 2;\n    }\n    if (!options.height) {\n      options.height = options.radius * 2;\n    }\n    return Bodies.circle(\n      options.position.x,\n      options.position.y,\n      options.radius,\n      options\n    );\n  },\n  rectangle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'black'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n  polygon(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      sides: 5,\n      radius: 25,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend(\n      {},\n      defaultOptions,\n      { radius: _options.width ? _options.width / 2 : defaultOptions.radius },\n      _options\n    );\n    return Bodies.polygon(\n      options.position.x,\n      options.position.y,\n      options.sides,\n      options.radius,\n      options\n    );\n  },\n  trapezoid(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      slope: 0.5,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.trapezoid(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options.slope,\n      options\n    );\n  },\n  label(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      isSensor: true,\n      isStatic: true,\n      fillStyle: 'rgba(255, 255, 255, 0)',\n      fontColor: Common.choose(world['colorScheme']),\n      visible: true,\n      collisionFilter: {\n        category: 0x0001,\n        mask: 0x00000000,\n        group: 3,\n      },\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n};\n","import * as Matter from 'matter-js';\n\nconst Common = Matter['Common'];\n\nconst PuppyColorScheme = {\n  pop: [\n    '#de9610',\n    '#c93a40',\n    '#fff001',\n    '#d06d8c',\n    '#65ace4',\n    '#a0c238',\n    '#56a764',\n    '#d16b16',\n    '#cc528b',\n    '#9460a0',\n    '#f2cf01',\n    '#0074bf',\n  ],\n  cute: [\n    '#e2b2c0',\n    '#fff353',\n    '#a5d1f4',\n    '#e4ad6d',\n    '#d685b0',\n    '#dbe159',\n    '#7fc2ef',\n    '#c4a6ca',\n    '#eabf4c',\n    '#f9e697',\n    '#b3d3ac',\n    '#eac7cd',\n  ],\n  dynamic: [\n    '#b80117',\n    '#222584',\n    '#00904a',\n    '#edc600',\n    '#261e1c',\n    '#6d1782',\n    '#8f253b',\n    '#a0c238',\n    '#d16b16',\n    '#0168b3',\n    '#b88b26',\n    '#c30068',\n  ],\n  gorgeous: [\n    '#7d0f80',\n    '#b08829',\n    '#a03c44',\n    '#018a9a',\n    '#ab045c',\n    '#391d2b',\n    '#d5a417',\n    '#546474',\n    '#0f5ca0',\n    '#d0b98d',\n    '#d4c91f',\n    '#c1541c',\n  ],\n  casual: [\n    '#7b9ad0',\n    '#f8e352',\n    '#c8d627',\n    '#d5848b',\n    '#e5ab47',\n    '#e1cea3',\n    '#51a1a2',\n    '#b1d7e4',\n    '#66b7ec',\n    '#c08e47',\n    '#ae8dbc',\n    '#c3cfa9',\n  ],\n  psychedelic: [\n    '#b7007c',\n    '#009b85',\n    '#382284',\n    '#e2c80f',\n    '#009dc6',\n    '#c4c829',\n    '#95007e',\n    '#d685b0',\n    '#eee800',\n    '#bf5116',\n    '#b80e3b',\n    '#0178bc',\n  ],\n  bright: [\n    '#fff001',\n    '#cb5393',\n    '#a0c238',\n    '#d78114',\n    '#00a5e7',\n    '#cd5638',\n    '#0168b3',\n    '#d685b0',\n    '#00984b',\n    '#f2cf01',\n    '#6bb6bb',\n    '#a563a0',\n  ],\n  fairytale: [\n    '#cca9ca',\n    '#9bcad0',\n    '#dd9dbf',\n    '#edef9c',\n    '#aabade',\n    '#f2dae8',\n    '#c7ddae',\n    '#a199c8',\n    '#faede5',\n    '#d5a87f',\n    '#f7f06e',\n    '#95bfe7',\n  ],\n  heavy: [\n    '#000000',\n    '#998c69',\n    '#5c002f',\n    '#244765',\n    '#814523',\n    '#5e2a58',\n    '#1a653c',\n    '#6a6a68',\n    '#bf7220',\n    '#5f556e',\n    '#84762f',\n    '#872226',\n  ],\n  impact: [\n    '#c60019',\n    '#fff001',\n    '#1d4293',\n    '#00984b',\n    '#019fe6',\n    '#c2007b',\n    '#261e1c',\n    '#7d0f80',\n    '#dc9610',\n    '#dbdf19',\n    '#d685b0',\n    '#a0c238',\n  ],\n  street: [\n    '#33476a',\n    '#211917',\n    '#6c7822',\n    '#c2007b',\n    '#44aeea',\n    '#5e3032',\n    '#d16b16',\n    '#c8d627',\n    '#9193a0',\n    '#816945',\n    '#c50030',\n    '#0080c9',\n  ],\n  cool: [\n    '#b0d7f4',\n    '#c0cbe9',\n    '#eef0b1',\n    '#44aeea',\n    '#85beab',\n    '#c4a6ca',\n    '#f7f06e',\n    '#c8d627',\n    '#bcccd9',\n    '#e4f0fc',\n    '#f2dae8',\n    '#6490cd',\n  ],\n  elegant: [\n    '#ae8dbc',\n    '#e3b3cd',\n    '#d6ddf0',\n    '#e5d57d',\n    '#82c0cd',\n    '#afc7a7',\n    '#834e62',\n    '#6a9176',\n    '#7f7eb8',\n    '#a04e90',\n    '#dbbc86',\n    '#c4c829',\n  ],\n  fresh: [\n    '#70b062',\n    '#c8d85b',\n    '#f8e133',\n    '#dbdf19',\n    '#e3ab30',\n    '#dd9dbf',\n    '#a979ad',\n    '#cd5638',\n    '#399548',\n    '#6bb6bb',\n    '#f7f39c',\n    '#9acce3',\n  ],\n  warm: [\n    '#c59f22',\n    '#dd9b9d',\n    '#ebcc00',\n    '#d6d11d',\n    '#8d4f42',\n    '#d8836e',\n    '#f8e469',\n    '#cbb586',\n    '#e4aa01',\n    '#eac287',\n    '#f2d8bf',\n    '#a6658d',\n  ],\n  soft: [\n    '#f8e469',\n    '#e7e0aa',\n    '#d9de84',\n    '#e4bd60',\n    '#9ac29f',\n    '#e3be87',\n    '#edef9c',\n    '#dd9b9d',\n    '#b2d6d4',\n    '#f5dfa6',\n    '#ebeddf',\n    '#e1d4e6',\n  ],\n  man: [\n    '#23466e',\n    '#4d639f',\n    '#dfe0d8',\n    '#1d695f',\n    '#9aadbe',\n    '#844f30',\n    '#934e61',\n    '#7e9895',\n    '#77aad7',\n    '#848a96',\n    '#a76535',\n    '#7e8639',\n  ],\n  woman: [\n    '#7b0050',\n    '#a8006d',\n    '#bea620',\n    '#a26c54',\n    '#949b34',\n    '#614983',\n    '#cba777',\n    '#de9610',\n    '#bd8683',\n    '#be87a6',\n    '#bf5346',\n    '#e1d0b4',\n  ],\n  boy: [\n    '#0168b3',\n    '#66b7ec',\n    '#afd0ef',\n    '#88b83e',\n    '#b8b2d6',\n    '#6bb6bb',\n    '#5e4694',\n    '#f2cf01',\n    '#c6e2f8',\n    '#d5dbcf',\n    '#7a8bc3',\n    '#e8e6f3',\n  ],\n  girl: [\n    '#d06da3',\n    '#c2d3ed',\n    '#be91bc',\n    '#c73576',\n    '#f8e352',\n    '#c8d627',\n    '#e3b3cd',\n    '#c6e0d5',\n    '#e4ab5a',\n    '#cb6c58',\n    '#845d9e',\n    '#82c0cd',\n  ],\n  smart: [\n    '#4d639f',\n    '#356c92',\n    '#c9ced1',\n    '#dfd4be',\n    '#92a1a6',\n    '#a67b2d',\n    '#bda5bb',\n    '#2c4b79',\n    '#d6d680',\n    '#babea5',\n    '#ebc175',\n    '#3a614f',\n  ],\n  light: [\n    '#44aeea',\n    '#b4cb32',\n    '#b2b6db',\n    '#b2d6d4',\n    '#ebe9ae',\n    '#0080c9',\n    '#71b174',\n    '#e4c4db',\n    '#7da8db',\n    '#eac39a',\n    '#dbe585',\n    '#6db5a9',\n  ],\n  stylish: [\n    '#58656e',\n    '#bac1c7',\n    '#487ca3',\n    '#dfd4be',\n    '#004679',\n    '#c0542d',\n    '#a44682',\n    '#9599b2',\n    '#d6d680',\n    '#8eb4d9',\n    '#6c5776',\n    '#499475',\n  ],\n  natural: [\n    '#ba9648',\n    '#87643e',\n    '#c2b5d1',\n    '#ba7d8c',\n    '#b8ac60',\n    '#797c85',\n    '#f9ebd1',\n    '#9cb1c2',\n    '#81a47a',\n    '#acb130',\n    '#8b342a',\n    '#acae98',\n  ],\n  spring: [\n    '#dd9cb4',\n    '#eeea55',\n    '#ebc061',\n    '#b2d6d4',\n    '#f2dae8',\n    '#c9d744',\n    '#b8b2d6',\n    '#afd0ef',\n    '#d7847e',\n    '#f8e352',\n    '#b3ce5b',\n    '#cbacbe',\n  ],\n  summer: [\n    '#174e9e',\n    '#68b8dd',\n    '#d16b16',\n    '#88b83e',\n    '#f2cf01',\n    '#019fe6',\n    '#c60019',\n    '#019c96',\n    '#b0d7f4',\n    '#fff001',\n    '#0074bf',\n    '#c83955',\n  ],\n  fall: [\n    '#ae3c22',\n    '#902342',\n    '#c59f22',\n    '#7e8639',\n    '#eabd00',\n    '#a49e2e',\n    '#ac5238',\n    '#9f832f',\n    '#ba7c6f',\n    '#875f3b',\n    '#bba929',\n    '#786b4b',\n  ],\n  winter: [\n    '#a5aad4',\n    '#6591b6',\n    '#623d82',\n    '#5f897b',\n    '#858aa0',\n    '#eff3f6',\n    '#c2d3dd',\n    '#4f616f',\n    '#7f7073',\n    '#42629f',\n    '#674c51',\n    '#b38da4',\n  ],\n  japan: [\n    '#c3003a',\n    '#3a546b',\n    '#d5a02e',\n    '#918d43',\n    '#787cac',\n    '#604439',\n    '#6f2757',\n    '#c1541c',\n    '#565d63',\n    '#afc9ca',\n    '#baaa52',\n    '#e2b2c0',\n  ],\n  euro: [\n    '#bf541c',\n    '#25a4b7',\n    '#e4aa01',\n    '#b2bfe1',\n    '#ad438e',\n    '#1d4293',\n    '#b71232',\n    '#e8e2be',\n    '#b0bf30',\n    '#6aa43e',\n    '#6276b5',\n    '#d7832d',\n  ],\n  nordic: [\n    '#149bdf',\n    '#dbdf19',\n    '#c97a2b',\n    '#945141',\n    '#9abca4',\n    '#a5a79a',\n    '#e6d9b9',\n    '#eabd00',\n    '#bf545e',\n    '#86b070',\n    '#665e51',\n    '#b59a4d',\n  ],\n  asian: [\n    '#946761',\n    '#b80040',\n    '#4eacb8',\n    '#7f1f69',\n    '#c8b568',\n    '#147472',\n    '#1d518b',\n    '#b1623b',\n    '#95a578',\n    '#b9b327',\n    '#af508a',\n    '#dab100',\n  ],\n};\n\nexport const chooseColorScheme = (key: string) => {\n  const cs =\n    key in PuppyColorScheme\n      ? PuppyColorScheme[key]\n      : PuppyColorScheme[\n          Common.choose([\n            'pop',\n            'cute',\n            'dynamic',\n            'gorgeous',\n            'casual',\n            'psychedelic',\n            'bright',\n            'fairytale',\n            'heavy',\n            'impact',\n            'street',\n            'cool',\n            'elegant',\n            'fresh',\n            'warm',\n            'soft',\n            'man',\n            'woman',\n            'boy',\n            'girl',\n            'smart',\n            'light',\n            'stylish',\n            'natural',\n            'spring',\n            'summer',\n            'fall',\n            'winter',\n            'japan',\n            'euro',\n            'nordic',\n            'asian',\n          ])\n        ];\n  const targets = <HTMLCollectionOf<HTMLElement>>(\n    document.getElementsByClassName('btn')\n  );\n  for (let i = 0; i < targets.length; i += 1) {\n    targets[i].style.backgroundColor = cs[i % cs.length];\n    targets[i].style.borderColor = cs[i % cs.length];\n  }\n  return cs;\n};\n","export class Lib {\n  private Body: any;\n  private Composite: any;\n  private Constraint: any;\n\n  public constructor(Matter: any) {\n    this.Body = Matter['Body'];\n    this.Composite = Matter['Composite'];\n    this.Constraint = Matter['Constraint'];\n  }\n\n  /* python */\n\n  public static int(x: any): number {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      return Number.parseInt(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public static float(x: any): number {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      return Number.parseFloat(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public static str(x: any): string {\n    if (typeof x === 'boolean') {\n      return x ? 'True' : 'False';\n    }\n    if (Array.isArray(x)) {\n      return '[' + x.map(x => this.str(x)).join(', ') + ']';\n    }\n    return `${x}`;\n  }\n\n  /* operator */\n\n  public anyAdd(x: any, y: any) {\n    if (Array.isArray(x) && Array.isArray(y)) {\n      return x.concat(y);\n    }\n    return x + y;\n  }\n\n  public anyMul(x: any, y: any) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: any) {\n    return a.indexOf(x) >= 0;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public get(a: any, name: string, puppy?: any) {\n    const v = a[name];\n    // if (v === undefined) {\n    // }\n    return v;\n  }\n\n  public index(a: any, index: number, puppy?: any) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substr(x, y - x);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: any) {\n    if (typeof x === 'string' || Array.isArray(x.length)) {\n      return x.length;\n    }\n    return 0;\n  }\n\n  // public map(func: any, xs: number[]) {\n  //   return Array.from(xs, func); // func\n  // }\n\n  /* Matter.Body */\n\n  public setPosition(body: any, x: number, y: number) {\n    this.Body.setPosition(body, { x, y });\n  }\n\n  public translate(body: any, x: number, y: number) {\n    this.Body.translate(body, { x, y });\n  }\n\n  public applyForce(body: any, x: number, y: number, fx: number, fy: number) {\n    this.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: any, angle: number, _x?: number, _y?: number) {\n    this.Body.rotate(body, angle);\n  }\n\n  public scale(body: any, sx: number, sy: number, _x?: number, _y?: number) {\n    this.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: any, angle: number) {\n    this.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: any, x: number, y: number) {\n    this.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: any, velocity: number) {\n    this.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: any, density: number) {\n    this.Body.setDensity(body, density);\n  }\n\n  public setMass(body: any, mass: number) {\n    this.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: any, flag: boolean) {\n    this.Body.setStatic(body, flag);\n  }\n\n  public newComosite(options: {}) {\n    return this.Composite.create({ label: 'comosite' });\n  }\n\n  public addBody(parent: any, body: any) {\n    this.Composite.addBody(parent, body);\n  }\n\n  public addConstraint(parent: any, options: any) {\n    this.Composite.addConstraint(this.Constraint.create(options));\n  }\n}\n","import * as Matter from 'matter-js';\nimport { myRender } from './render';\nimport { initVars, Shape, PuppyConstructor } from './shape';\nimport {\n  getInputValue,\n  getDiffStartLineNumber,\n  setCodeHighlight,\n  resetCodeHighlight,\n  getIsLive,\n} from '../modules/operations';\nimport { chooseColorScheme } from './color';\nimport { Lib } from '../puppy-transpiler/puppy-lib';\n\n// const Bodies = Matter.Bodies;\nconst Engine = Matter.Engine;\nconst Runner = Matter.Runner;\nconst Render = myRender(Matter.Render);\nconst Constraint = Matter.Constraint;\nconst MouseConstraint = Matter.MouseConstraint;\nconst Mouse = Matter.Mouse;\nconst World = Matter.World;\nconst Bounds = Matter.Bounds;\nconst Vertices = Matter.Vertices;\nconst Detector = Matter['Detector'];\nconst Common = Matter['Common'];\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\n// export type ErrorShape = {\n//   type: 'error' | 'info' | 'warning' | 'hint';\n//   row: number;\n//   col: number;\n//   len: number;\n//   text: string;\n// };\n\nexport type ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(_index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(_ty: Type, _update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(_map: any): Type {\n    return this;\n  }\n}\n\nexport type PuppySettings = {\n  canvas: string;\n  ftrace: (log: {}) => void;\n  eachUpdate?: (time: number) => void;\n};\n\ntype PuppyWorld = {\n  background: string;\n  width: number;\n  height: number;\n  viewWidth: number;\n  viewHeight: number;\n  view: { min: Matter.Vector; max: Matter.Vector };\n  colorScheme: [string];\n\n  opacity: number /* Default 1.0 */;\n\n  font: string;\n  gravity: Matter.Vector;\n  density: number /* Default: 0.001 */;\n  friction: number /* Default: 0.1 */;\n  airFriction: number /* Default: 0.01 */;\n  frictionStatic: number /* Default: 0.5 */;\n  motion: number /* Default: 0 */;\n  restitution: number /* 0 */;\n};\n\n// (Puppy, {}) -> (number, number, number) -> any\nexport class Puppy {\n  private settings: PuppySettings;\n  public code: any;\n  public world: PuppyWorld | null;\n\n  public interval: number;\n  public waitRestart: boolean;\n  public isExecuting: boolean;\n\n  private runner: Matter.Runner | null;\n  private engine: Matter.Engine | null;\n  private render: Matter.Render | null;\n  private canvas: HTMLCanvasElement | null;\n\n  // private debug_mode: boolean;\n\n  private vars: {};\n  private lib: Lib;\n\n  // new puppy\n  public constructor(settings: PuppySettings, code: any, waitStart = false) {\n    this.settings = settings;\n    this.code = code;\n    this.world = null;\n    this.interval = 500;\n    this.waitRestart = waitStart;\n    this.isExecuting = false;\n    this.runner = null;\n    this.engine = null;\n    this.render = null;\n    this.canvas = null;\n    this.vars = {};\n    this.lib = new Lib({\n      Body: Matter.Body,\n      Composite: Matter.Composite,\n      Constraint: Matter.Constraint,\n    });\n  }\n\n  private initCode() {\n    const code = this.code;\n    const width = code.world['width'] || 1000;\n    const height = code.world['height'] || 1000;\n    const vwidth = code.world['viewWidth'] || width;\n    const vheight = code.world['viewHeight'] || height;\n    const pos: Matter.Vector = code.world['position'] || { x: 0, y: 0 };\n    this.code = code;\n    this.world = {\n      width,\n      height,\n      viewWidth: vwidth,\n      viewHeight: vheight,\n      background: code.world['background'] || 'white',\n      gravity: code.world['gravitiy'] || { x: 0.0, y: 1.0 },\n      colorScheme: chooseColorScheme(code.world['colorScheme'] || ''),\n      opacity: code.world['opacity'] || 1.0,\n      font: code.world['font'] || \"bold 60px 'Arial'\",\n      view: code.world['view'] || {\n        min: pos,\n        max: { x: pos.x + vwidth, y: pos.y + vheight },\n      },\n      density: code.world['density'] || 0.001,\n      friction: code.world['friction'] || 0.1,\n      airFriction: code.world['airFriction'] || 0.01,\n      frictionStatic: code.world['frictionStatic'] || 0.5,\n      motion: code.world['motion'] || 0,\n      restitution: code.world['restitution'] || 0,\n    };\n  }\n\n  private startCode() {\n    this.engine = Engine.create();\n\n    if (this.world!.gravity) {\n      const engine = this.engine;\n      window.addEventListener('deviceorientation', event => {\n        const orientation = window.orientation || 0;\n        const gravity = engine.world.gravity;\n        if (orientation === 0) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.beta!, -90, 90) / 90;\n        } else if (orientation === 180) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.beta!, -90, 90) / 90;\n        } else if (orientation === 90) {\n          gravity.x = Common.clamp(event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.gamma!, -90, 90) / 90;\n        } else if (orientation === -90) {\n          gravity.x = Common.clamp(-event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.gamma!, -90, 90) / 90;\n        }\n      });\n    }\n    Matter.Events.on(this.engine, 'beforeUpdate', () => {\n      const time = this.engine!.timing.timestamp;\n      if (this.settings.eachUpdate) {\n        this.settings.eachUpdate(time);\n      }\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        const body: Matter.Body = bodies[i];\n        if (body['move']) {\n          body['move'](body, time);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionActive', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionActive']) {\n          pair.bodyA['collisionActive'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionActive']) {\n          pair.bodyB['collisionActive'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionStart', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionStart']) {\n          pair.bodyA['collisionStart'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionStart']) {\n          pair.bodyB['collisionStart'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionEnd', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionEnd']) {\n          pair.bodyA['collisionEnd'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionEnd']) {\n          pair.bodyB['collisionEnd'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    this.runner = Runner.create({ isFixed: false });\n    // render\n    const canvas = document.getElementById(this.settings.canvas);\n    let render_width = canvas!.clientWidth;\n    let render_height =\n      (canvas!.clientWidth * this.world!.height) / this.world!.width;\n    if (render_height > canvas!.clientHeight) {\n      render_height = canvas!.clientHeight;\n      render_width =\n        (canvas!.clientHeight * this.world!.width) / this.world!.height;\n    }\n    const render = {\n      /* Matter.js  canvas   */\n      // element: document.getElementById('canvas'),\n      element: canvas,\n      engine: this.engine,\n      options: {\n        /*  */\n        width: render_width,\n        height: render_height,\n        background: this.world!.background,\n        font: this.world!.font,\n        wireframes: false,\n      },\n    };\n    this.render = Render.create(render);\n    this.canvas = this.render!.canvas;\n    /* / */\n    Render['lookAt'](this.render, this.world!.view);\n    /*  */\n    const mouse = Mouse.create(this.render!.canvas);\n    const constraintOptions = {\n      pointA: { x: 0, y: 0 },\n      pointB: { x: 0, y: 0 },\n      stiffness: this.world!['mouseStiffness'] || 0.2 /*  */,\n    };\n    constraintOptions['render'] = {\n      visible: false,\n    };\n    const mouseConstraint = MouseConstraint.create(this.engine, {\n      mouse,\n      constraint: Constraint.create(constraintOptions),\n    });\n    World.add(this.engine.world, mouseConstraint);\n    this.render!['mouse'] = mouse;\n\n    // an example of using mouse events on a mouse\n    // const mouse = Mouse.create(this.element);\n    // this.element.addEventListener('click', () => {\n    //   const query = Query.point(Composite.allBodies(world), mouse.position)\n    //   console.log(mouse.position);\n    //   console.log(query);\n    // });\n    Matter.Events.on(mouseConstraint, 'mousedown', event => {\n      const mouse = event.mouse;\n      let body = event.sourcebody;\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        body = bodies[i];\n        if (\n          Bounds.contains(body.bounds, mouse.position) &&\n          Detector.canCollide(\n            body.collisionFilter,\n            mouseConstraint.collisionFilter\n          )\n        ) {\n          for (\n            let j = body.parts.length > 1 ? 1 : 0;\n            j < body.parts.length;\n            j += 1\n          ) {\n            const part = body.parts[j];\n            if (\n              part['clicked'] &&\n              Vertices.contains(part.vertices, mouse.position)\n            ) {\n              part['clicked'](part);\n              break;\n            }\n          }\n        }\n      }\n    });\n    //\n    this.vars = initVars({});\n    // this.main = code.main || (function* (Matter: any, puppy: Puppy) { });\n\n    Runner.run(this.runner, this.engine); /* */\n    Render.run(this.render); /*  */\n    // this.runner.enabled = false; /* */\n  }\n\n  public dispose() {\n    if (this.engine) {\n      World.clear(this.engine.world, false);\n      Engine.clear(this.engine);\n    }\n    /* engine */\n    if (this.runner) {\n      Runner.stop(this.runner);\n    }\n    if (this.render) {\n      Render.stop(this.render);\n      this.render.canvas.remove();\n      // this.render!.canvas = null;\n      // this.render!.context = null;\n      this.render.textures = {};\n    }\n  }\n\n  // private DefaultRenderOptions: () => Matter.IRenderDefinition;\n\n  public getCode() {\n    return this.code;\n  }\n\n  public getCanvas() {\n    return this.canvas;\n  }\n\n  public resize(width: number, height: number) {\n    // console.log(`'resize width ${width} ${this.canvas.clientWidth} height ${height} ${this.canvas.clientHeight}`);\n    let w = width;\n    let h = (width * this.world!.viewHeight) / this.world!.viewWidth;\n    if (h > height) {\n      h = height;\n      w = (height * this.world!.viewWidth) / this.world!.viewHeight;\n    }\n    this.canvas!.setAttribute('width', w.toString());\n    this.canvas!.setAttribute('height', h.toString());\n    // console.log('resize width {this.render.options.width} => {w} height {this.render.options.height} => {h}');\n    this.render!.options.width = w;\n    this.render!.options.height = h;\n  }\n\n  public async wait(msec) {\n    await new Promise(resolve => setTimeout(resolve, msec));\n  }\n\n  public async waitForRun(interval) {\n    while (this.waitRestart) {\n      await this.wait(interval);\n    }\n    this.runner!.enabled = true;\n  }\n\n  public async execute_main() {\n    const diffStartLineNumber = getDiffStartLineNumber();\n    this.isExecuting = true;\n    for await (const lineNumber of this.code.main(this)) {\n      if (lineNumber < diffStartLineNumber && getIsLive()) {\n        for (let i = 0; i < this.interval / this.runner!.delta; i += 1) {\n          this.engine = Engine.update(this.engine!, undefined, undefined);\n        }\n      } else {\n        setCodeHighlight(lineNumber, lineNumber);\n        await this.waitForRun(1000);\n        await this.wait(this.interval);\n      }\n    }\n    this.isExecuting = false;\n    resetCodeHighlight();\n    // editor NG\n    // let prevline = 0;\n    // const lines: [string] = editor.getSession().getDocument().getAllLines();\n    // for await (const linenum of this.main(Matter, this)) {\n    //   if (prevline == 0 || prevline >= linenum || lines[prevline] == '') {\n    //     selectLine(linenum - 1, linenum);\n    //   }\n    //   else {\n    //     selectLine(prevline, linenum);\n    //   }\n    //   prevline = linenum;\n    //   if (this.isStep) {\n    //     this.runner.enabled = false;\n    //     this.isStep = false;\n    //   } else {\n    //     await this.wait(0.5);\n    //   }\n    //   await this.waitForRun(1);\n    // }\n    // removeLine();\n    // if (this.isStep) {\n    //   this.runner.enabled = true;\n    //   this.isStep = false;\n    // }\n  }\n\n  public isRunning() {\n    return this.runner && this.runner.enabled;\n  }\n\n  public runCode() {\n    this.initCode();\n    this.dispose();\n    this.startCode();\n    this.runner!.enabled = !this.waitRestart;\n    this.execute_main();\n  }\n\n  // public updateLiveCode(code: PuppyCode) {\n  //   this.code = code;\n  //   if (this.runner!.enabled) {\n  //     if (code.diff) {\n  //       this.initCode();\n  //       console.log(`live diff now ${code.diff}`);\n  //       code.diff(this);\n  //       return true;\n  //     }\n  //     if (code.lives && code.lives.length > 0) {\n  //       this.initCode();\n  //       const bodies = Matter.Composite.allBodies(this.engine!.world);\n  //       for (const body of bodies) {\n  //         for (const live of code.lives) {\n  //           if (body['oid'] === live[0]) {\n  //             console.log(body);\n  //             console.log(live);\n  //             const name = live[1];\n  //             console.log(`change ${name} ${body[name]} ${live[2]} ${live[3]}`);\n  //             // if (body[name] === live[3] || live[3] == null) {\n  //             setShapeProperty(this, body as Shape, name, live[2]);\n  //             // }\n  //           }\n  //         }\n  //       }\n  //       return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n\n  public pause() {\n    this.waitRestart = true;\n    this.runner!.enabled = false;\n  }\n\n  public start() {\n    if (this.isExecuting) {\n      this.waitRestart = false;\n    } else {\n      this.runner!.enabled = true;\n    }\n  }\n\n  public getTimeStamp() {\n    return this.engine!.timing.timestamp;\n  }\n\n  // lives\n\n  public ln(n: number) {\n    return this.code.lines[n];\n  }\n\n  // Puppy APIs\n\n  public new_ = (\n    cons: PuppyConstructor,\n    x: number,\n    y: number,\n    options: Shape\n  ) => {\n    if (!options.position) {\n      options.position = { x, y };\n    }\n    const body: Matter.Body = cons(this, options);\n    World.add(this.engine!.world, [body]);\n    return body;\n  };\n\n  public Circle = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Circle'], x, y, options);\n  };\n\n  public Rectangle = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Rectangle'], x, y, options);\n  };\n\n  public Polygon = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Polygon'], x, y, options);\n  };\n\n  public Label = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Label'], x, y, options);\n  };\n\n  public World = (x: number, y: number, options: Partial<PuppyWorld>) => {\n    if (this.engine && this.world) {\n      this.world.viewWidth = x;\n      this.world.viewHeight = y;\n      const pos = this.world.view.min;\n      this.world.view = {\n        min: pos,\n        max: { x: pos.x + x, y: pos.y + y },\n      };\n      this.resize(this.render!.options.width!, this.render!.options.height!);\n      Render['lookAt'](this.render, this.world!.view);\n      if (options) {\n        Object.keys(options).map((key: string) => {\n          if (this.world && key in this.world) {\n            if (key == 'background') {\n              this.render!.options['background'] = options['background'];\n            }\n            this.world[key] = options[key];\n          }\n          if (this.engine && key in this.engine.world) {\n            this.engine.world[key] = options[key];\n          }\n        });\n      }\n    }\n  };\n\n  public async input(msg?: string) {\n    this.runner!.enabled = false;\n    const x = await getInputValue(msg ? msg : '');\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    console.log(`input ${x}`);\n    return x;\n  }\n\n  public async input0(console?: string) {\n    this.runner!.enabled = false;\n    const awaitForClick = target => {\n      return new Promise(resolve => {\n        // A\n        const listener = resolve; // B\n        target.addEventListener('click', listener, { once: true }); // C\n      });\n    };\n    const text = document.getElementById('inputtext') as HTMLInputElement;\n    const f = async () => {\n      const target = document.querySelector('#submitInput');\n      let Text = '';\n      document.getElementById('submitInput')!.onclick = () => {\n        document.getElementById('myOverlay')!.style.display = 'none';\n        Text = text.value;\n        text.value = '';\n      };\n      await awaitForClick(target);\n      return Text;\n    };\n\n    text.placeholder = console ? console : 'Input here';\n    document.getElementById('myOverlay')!.style.display = 'block';\n    const x = await f();\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    return x;\n  }\n\n  public print(text: string, options = {}) {\n    const width = this.world!.width;\n    const _options: Shape = Common.extend(\n      {\n        shape: 'label',\n        value: `${text}`,\n        created: this.getTimeStamp(),\n        move: (body, time: number) => {\n          const px = width - 100 * (time - body['created']) * 0.003;\n          Matter.Body.setPosition(body, { x: px, y: body.position.y });\n          if (px < -1) {\n            World.remove(this.engine!.world, body);\n          }\n        },\n      },\n      options\n    );\n    const x = this.world!.width;\n    const y = this.world!.height * (Math.random() * 0.9 + 0.05);\n    this.new_(this.vars['Label'], x, y, _options);\n  }\n\n  public trace(log: {}) {\n    console.log(log);\n    // this.settings.trace(log);\n  }\n\n  /* operator */\n\n  public listAdd(x: [], y: []) {\n    return x.concat(y);\n  }\n\n  public anyMul(x, y) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: [any]) {\n    return a.indexOf(x) >= 0;\n  }\n\n  /* built-in */\n\n  public int(x: any) {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      return Number.parseInt(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public float(x: any) {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      return Number.parseFloat(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public str(x: any) {\n    if (typeof x === 'boolean') {\n      return x ? 'True' : 'False';\n    }\n    if (Array.isArray(x)) {\n      return '[' + x.map(x => this.str(x)).join(', ') + ']';\n    }\n    return `${x}`;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public getindex(a: any, index: number) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substr(x, y - x);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: []) {\n    return x.length;\n  }\n\n  public map(func: any, lst: number[]) {\n    return Array.from(lst, func); // func\n  }\n\n  /* Matter.Body */\n\n  public setPosition(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setPosition(body, { x, y });\n  }\n\n  public applyForce(\n    body: Matter.Body,\n    x: number,\n    y: number,\n    fx: number,\n    fy: number\n  ) {\n    Matter.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: Matter.Body, angle: number, _x?: number, _y?: number) {\n    Matter.Body.rotate(body, angle);\n  }\n\n  public scale(\n    body: Matter.Body,\n    sx: number,\n    sy: number,\n    _x?: number,\n    _y?: number\n  ) {\n    Matter.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: Matter.Body, angle: number) {\n    Matter.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: Matter.Body, velocity: number) {\n    Matter.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: Matter.Body, density: number) {\n    Matter.Body.setDensity(body, density);\n  }\n\n  public setMass(body: Matter.Body, mass: number) {\n    Matter.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: Matter.Body, flag: boolean) {\n    Matter.Body.setStatic(body, flag);\n  }\n}\n\n/* puppy controller */\n\nlet puppy_settings = {\n  canvas: 'puppy-screen',\n  ftrace: (_log: {}) => {},\n};\n\nexport const initPuppy = (settings?: PuppySettings) => {\n  if (settings) {\n    puppy_settings = settings;\n  }\n};\n\nexport const runPuppy = (\n  puppy: Puppy | null,\n  code: PuppyCode,\n  alwaysRun: boolean,\n  waitStart = false\n) => {\n  if (puppy != null) {\n    if (!alwaysRun && code) {\n      // if (puppy.getCode().hash === code.hash) {\n      //   return puppy;\n      // }\n      if (puppy.isRunning()) {\n        // console.log(`lives ${code.lives}`);\n        // console.log(`diff ${code.diff}`);\n        // if (puppy.updateLiveCode(code)) {\n        //   return puppy;\n        // }\n      }\n    }\n  }\n  if (code) {\n    if (puppy != null) {\n      puppy.dispose();\n    }\n    const newpuppy = new Puppy(puppy_settings, code, waitStart);\n    newpuppy.runCode();\n    return newpuppy;\n  }\n  return null;\n};\n","// \n// punk\n\n// https://ja.stackoverflow.com/questions/4445/matter-js\n\nimport { PATH_PREFIX } from '../env';\n\nexport const myRender = render => {\n  const _getTexture = (render, imagePath: string) => {\n    let image = render.textures[imagePath];\n    if (image) {\n      return image;\n    }\n    image = render.textures[imagePath] = new Image();\n    if (\n      imagePath.startsWith('http://') ||\n      imagePath.startsWith('https://') ||\n      imagePath.startsWith('data:') ||\n      imagePath.startsWith('/')\n    ) {\n      image.src = imagePath;\n    } else {\n      image.src = `${PATH_PREFIX}/image/${imagePath}`;\n    }\n    return image;\n  };\n\n  render['bodies'] = function(render, bodies, context) {\n    const c = context;\n    const options = render.options;\n    // const wireframes = options.wireframes;\n    const showInternalEdges = options.showInternalEdges || !options.wireframes;\n    const defaultFont = options.font || \"bold 60px 'Arial'\";\n    const defaultFontColor = options.fontColor || 'gray';\n\n    for (let i = 0; i < bodies.length; i += 1) {\n      const body = bodies[i];\n      if (!body.visible) {\n        continue;\n      }\n      // handle compound parts\n      for (\n        let k = body.parts.length > 1 ? 1 : 0;\n        k < body.parts.length;\n        k += 1\n      ) {\n        const part = body.parts[k];\n        if (!part.visible) {\n          continue;\n        }\n        if (part.opacity !== 1) {\n          c.globalAlpha = part.opacity;\n        }\n\n        if (part.image) {\n          const texture = _getTexture(render, part.image);\n          c.translate(part.position.x, part.position.y);\n          c.rotate(part.angle);\n          c.drawImage(\n            texture,\n            part.width * -0.5,\n            part.height * -0.5,\n            part.width,\n            part.height\n          );\n          c.rotate(-part.angle);\n          c.translate(-part.position.x, -part.position.y);\n        } else {\n          // part polygon\n          if (part.circleRadius) {\n            c.beginPath();\n            c.arc(\n              part.position.x,\n              part.position.y,\n              part.circleRadius,\n              0,\n              2 * Math.PI\n            );\n          } else {\n            c.beginPath();\n            c.moveTo(part.vertices[0].x, part.vertices[0].y);\n            for (let j = 1; j < part.vertices.length; j += 1) {\n              if (!part.vertices[j - 1].isInternal || showInternalEdges) {\n                c.lineTo(part.vertices[j].x, part.vertices[j].y);\n              } else {\n                c.moveTo(part.vertices[j].x, part.vertices[j].y);\n              }\n              if (part.vertices[j].isInternal && !showInternalEdges) {\n                c.moveTo(\n                  part.vertices[(j + 1) % part.vertices.length].x,\n                  part.vertices[(j + 1) % part.vertices.length].y\n                );\n              }\n            }\n            c.lineTo(part.vertices[0].x, part.vertices[0].y);\n            c.closePath();\n          }\n          if (!options.wireframes) {\n            c.fillStyle = part.fillStyle;\n            if (part.lineWidth) {\n              c.lineWidth = part.lineWidth;\n              c.strokeStyle = part.strokeStyle;\n              c.stroke();\n            }\n            c.fill();\n          } else {\n            c.lineWidth = 1;\n            c.strokeStyle = '#bbb';\n            c.stroke();\n          }\n        }\n\n        if (part.value !== undefined) {\n          // Make to show null and 0.\n          if (part.ref) {\n            part.value = part.ref();\n          }\n          c.save();\n          c.font = part.font || defaultFont;\n          c.fillStyle = part.fontColor || defaultFontColor;\n          c.textAlign = part.textAlign || 'center';\n          if (part.shadowColor) {\n            c.shadowColor = part.shadowColor; // \n            c.shadowBlur = c.shadowBlur || 0; // \n            c.shadowOffsetX = c.shadowOffsetX || 2; // 3px\n            c.shadowOffsetY = c.shadowOffsetY || 2; // 1px\n          }\n          c.fillText(`${part.value}`, part.position.x, part.position.y + 10);\n          c.restore();\n        }\n        c.globalAlpha = 1;\n      }\n    }\n  };\n  return render;\n};\n","import { Action } from 'redux';\n\nenum VersionActionTypes {\n  SET_VERSION_SHOW = 'SET_VERSION_SHOW',\n}\n\ninterface SetShowAction extends Action {\n  type: VersionActionTypes.SET_VERSION_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: VersionActionTypes.SET_VERSION_SHOW,\n  payload: {\n    show,\n  },\n});\n\nexport type VersionActions = SetShowAction;\n\nexport type VersionState = {\n  show: boolean;\n};\n\nconst initialState: VersionState = {\n  show: false,\n};\n\nconst VersionReducer = (state = initialState, action: VersionActions) => {\n  switch (action.type) {\n    case VersionActionTypes.SET_VERSION_SHOW:\n      return { ...state, show: action.payload.show };\n    default:\n      return state;\n  }\n};\n\nexport default VersionReducer;\n","import { Action, createStore, combineReducers } from 'redux';\nimport editor, { EditorState, EditorActions } from './modules/editor';\nimport course, { CourseState, CourseActions } from './modules/course';\nimport puppy, { PuppyState, PuppyActions } from './modules/puppy';\nimport input, { InputState, InputActions } from './modules/input';\nimport version, { VersionState, VersionActions } from './modules/version';\n\nconst allReducers = combineReducers({\n  editor,\n  course,\n  puppy,\n  input,\n  version,\n});\n\nexport const store = createStore(allReducers);\n\nexport type ReduxState = {\n  editor: EditorState;\n  course: CourseState;\n  puppy: PuppyState;\n  input: InputState;\n  version: VersionState;\n};\n\nexport type ReduxActions =\n  | PuppyActions\n  | EditorActions\n  | CourseActions\n  | InputActions\n  | VersionActions\n  | Action;\n\nexport default store;\n","export class ParseTree {\n  public tag: string;\n  public urn: any;\n  public inputs: string;\n  public spos: number;\n  public epos: number;\n  public nodes: [string, ParseTree][];\n\n  public constructor(tag: string, spos: number, epos: number, child: any) {\n    this.tag = tag;\n    this.urn = child;\n    this.inputs = '';\n    this.spos = spos;\n    this.epos = epos;\n    this.nodes = ParseTree.empties;\n  }\n\n  static empties: [string, ParseTree][] = [];\n\n  protected setup(urn: string, inputs: string) {\n    if (this.urn !== null) {\n      const nodes: [string, ParseTree][] = [];\n      var entry: Merge = this.urn;\n      while (entry !== null) {\n        nodes.push([entry.edge, entry.child.setup(urn, inputs)]);\n        entry = entry.prev;\n      }\n      this.nodes = nodes.reverse();\n    }\n    this.urn = urn;\n    this.inputs = inputs;\n    var t: any = this;\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      t[i] = this.nodes[i][1];\n      if (this.nodes[i][0] !== '') {\n        t[this.nodes[i][0]] = this.nodes[i][1];\n      }\n    }\n    return this;\n  }\n\n  public is(tag: string) {\n    return this.tag === tag;\n  }\n\n  public isError() {\n    return this.tag === 'err';\n  }\n\n  public subs(): ParseTree[] {\n    const subs: ParseTree[] = [];\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      subs.push(this.nodes[i][1]);\n    }\n    return subs;\n  }\n\n  public size() {\n    return this.nodes.length;\n  }\n\n  public contains(edge: string) {\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      if (this.nodes[i][0] === edge) return true;\n    }\n    return false;\n  }\n\n  public get(index: any) {\n    return (this as any)[index];\n  }\n\n  public tokenize(index?: any, defstr?: string) {\n    if (index === undefined) {\n      return this.inputs.substring(this.spos, this.epos);\n    }\n    const child = (this as any)[index];\n    if (child === undefined) {\n      return defstr || '';\n    }\n    return child.tokenize();\n  }\n\n  private pos(pos: number) {\n    const s = this.inputs;\n    pos = Math.min(pos, s.length);\n    var row = 0;\n    var col = 0;\n    for (var i = 0; i <= pos; i += 1) {\n      if (s.charCodeAt(i) == 10) {\n        row += 1;\n        col = 0;\n      } else {\n        col += 1;\n      }\n    }\n    return [pos, row, col];\n  }\n\n  public begin() {\n    return this.pos(this.spos);\n  }\n\n  public end() {\n    return this.pos(this.spos);\n  }\n\n  public length() {\n    return this.epos - this.spos;\n  }\n\n  public toString() {\n    const sb: string[] = [];\n    this.strOut(sb);\n    return sb.join('');\n  }\n\n  protected strOut(sb: string[]) {\n    sb.push('[#');\n    sb.push(this.tag);\n    for (const node of this.nodes) {\n      sb.push(node[0] === '' ? ' ' : ` ${node[0]}=`);\n      node[1].strOut(sb);\n    }\n    if (this.nodes.length == 0) {\n      const s = this.inputs.substring(this.spos, this.epos);\n      sb.push(\" '\");\n      sb.push(s);\n      sb.push(\"'\");\n    }\n    sb.push(']');\n  }\n}\n\nclass Merge {\n  public prev: any;\n  public edge: string;\n  public child: ParseTree;\n\n  public constructor(prev: any, edge: string, child: ParseTree) {\n    this.prev = prev;\n    this.edge = edge;\n    this.child = child;\n  }\n}\n\nclass ParserContext {\n  public urn: string;\n  public inputs: String;\n  public pos: number;\n  public epos: number;\n  public head_pos: number;\n  public ast: any;\n  public state: State | null;\n  public memos: Memo[];\n  public constructor(urn: string, inputs: string, pos: number, epos: number) {\n    this.urn = urn;\n    this.inputs = inputs;\n    this.pos = pos;\n    this.epos = epos;\n    this.head_pos = pos;\n    this.ast = null;\n    this.state = null;\n    this.memos = [];\n    for (var i = 0; i < 1789; i++) {\n      this.memos.push(new Memo());\n    }\n  }\n}\n\nconst EMPTY = (px: ParserContext) => {\n  return true;\n};\n\nconst pEmpty = () => {\n  return EMPTY;\n};\n\nconst ANY = (px: ParserContext) => {\n  if (px.pos < px.epos) {\n    px.pos += 1;\n    return true;\n  }\n  return false;\n};\n\nconst pAny = () => {\n  return ANY;\n};\n\nconst pChar = (text: string) => {\n  const text_length = text.length;\n\n  return (px: ParserContext) => {\n    if (px.inputs.startsWith(text, px.pos)) {\n      px.pos += text_length;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst find_codemax = (chars: string, ranges: string[]) => {\n  var code = 0;\n  for (var i = 0; i < chars.length; i += 1) {\n    code = Math.max(chars.charCodeAt(i), code);\n  }\n  for (const range of ranges) {\n    code = Math.max(range.charCodeAt(0), code);\n    code = Math.max(range.charCodeAt(1), code);\n  }\n  return code;\n};\n\nconst set_bitmap = (bitmap: Uint8Array, c: number) => {\n  const n = (c / 8) | 0;\n  const mask = 1 << (c % 8 | 0);\n  //console.log(n);\n  //console.log(bitmap[n])\n  bitmap[n] |= mask;\n  //console.log(bitmap);\n};\n\nconst pRange = (chars: string, ranges: string[]) => {\n  const codemax = find_codemax(chars, ranges) + 1;\n  const bitmap = new Uint8Array(((codemax / 8) | 0) + 1);\n  bitmap[0] = 2;\n  for (var i = 0; i < chars.length; i += 1) {\n    set_bitmap(bitmap, chars.charCodeAt(i));\n  }\n  for (const range of ranges) {\n    for (var c = range.charCodeAt(0); c <= range.charCodeAt(1); c += 1) {\n      set_bitmap(bitmap, c);\n    }\n  }\n  //console.log(`bitmap ${ bitmap.length } `)\n  return (px: ParserContext) => {\n    if (px.pos < px.epos) {\n      const c = px.inputs.charCodeAt(px.pos);\n      const n = (c / 8) | 0;\n      const mask = 1 << (c % 8 | 0);\n      if (n < bitmap.length && (bitmap[n] & mask) === mask) {\n        px.pos += 1;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pMany = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    var pos = px.pos;\n    var ast = px.ast;\n    while (match(px) && px.pos > pos) {\n      pos = px.pos;\n      ast = px.ast;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return true;\n  };\n};\n\nconst pMany1 = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    if (match(px)) {\n      var pos = px.pos;\n      var ast = px.ast;\n      while (match(px) && px.pos > pos) {\n        pos = px.pos;\n        ast = px.ast;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAnd = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pNot = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return false;\n    }\n    return true;\n  };\n};\n\nconst pOption = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (!match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return true;\n  };\n};\n\nconst pSeq = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    for (const match of matches) {\n      if (!match(px)) {\n        return false;\n      }\n    }\n    return true;\n  };\n};\n\nconst pSeq2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px);\n  };\n};\n\nconst pSeq3 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean,\n  match3: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px) && match3(px);\n  };\n};\n\nconst pOre = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    for (const match of matches) {\n      if (match(px)) {\n        return true;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return false;\n  };\n};\n\nconst pOre2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      return true;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return match2(px);\n  };\n};\n\nconst pRef = (peg: any, name: string) => {\n  if (peg[name]) {\n    return peg[name];\n  }\n  return (px: ParserContext) => {\n    return peg[name](px);\n  };\n};\n\nclass Memo {\n  public key: number;\n  public constructor() {\n    this.key = -1;\n  }\n}\n\nconst pNode = (\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = null;\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\n//def Merge(prev, edge, child):\n//return (prev, edge, child)\n\nconst pEdge = (edge: string, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = new Merge(ast, edge, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pFold = (\n  edge: string,\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = new Merge(null, edge, px.ast);\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAbs = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pSkipErr = () => {\n  return (px: ParserContext) => {\n    px.pos = Math.min(px.head_pos, px.epos);\n    return true;\n  };\n};\n\nclass State {\n  public sid: number;\n  public value: any;\n  public prev: State | null;\n  public constructor(sid: number, value: any, prev: State | null) {\n    this.sid = sid;\n    this.value = value;\n    this.prev = prev;\n  }\n}\n\nconst getstate = (state: State | null, sid: number) => {\n  while (state !== null) {\n    if (state.sid === sid) {\n      return state;\n    }\n    state = state.prev;\n  }\n  return null;\n};\n\nconst pSymbol = (sid: number, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.state = new State(sid, px.inputs.substring(pos, px.pos), px.state);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pExists = (sid: number) => {\n  return (px: ParserContext) => {\n    return getstate(px.state, sid) !== null;\n  };\n};\n\nconst pMatch = (sid: number) => {\n  return (px: ParserContext) => {\n    const state = getstate(px.state, sid);\n    if (state !== null) {\n      if (px.inputs.startsWith(state.value, px.pos)) {\n        px.pos += (state.value as string).length;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pScope = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const state = px.state;\n    const res = match(px);\n    px.state = state;\n    return res;\n  };\n};\n\nexport const generate = (start: string) => {\n  const match = grammar(start);\n  if (match === undefined) {\n    console.log(`undefined ${start}`);\n    console.log(peg);\n  }\n  return (inputs: string, options?: any) => {\n    const op = options === undefined ? {} : options;\n    const pos = 0;\n    const px = new ParserContext(\n      op['urn'] || '(unknown source)',\n      inputs,\n      0,\n      inputs.length\n    );\n    if (match(px)) {\n      if (px.ast === null) {\n        px.ast = new ParseTree('', pos, px.pos, null);\n      }\n    } else {\n      px.ast = new ParseTree('err', px.head_pos, px.head_pos + 1, null);\n    }\n    return px.ast.setup(px.urn, inputs);\n  };\n};\n\nlet peg: any = null;\n\nconst grammar = (start: string) => {\n  if (peg === null) {\n    peg = {};\n    peg['Source'] = pSeq3(\n      pOption(pRef(peg, 'EOL')),\n      pNode(\n        pMany(pSeq2(pEdge('', pRef(peg, 'Statement')), pRef(peg, 'EOL'))),\n        'Source',\n        0\n      ),\n      pRef(peg, 'EOF')\n    );\n    peg['Block'] = pNode(\n      pScope(\n        pSeq3(\n          pSymbol(0, pRef(peg, 'INDENT')),\n          pOre2(\n            pSeq3(\n              pEdge('', pRef(peg, 'Statement')),\n              pMany(pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))),\n              pOption(pRef(peg, '\";\"'))\n            ),\n            pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n          ),\n          pMany(\n            pSeq2(\n              pMatch(0),\n              pOre2(\n                pSeq3(\n                  pEdge('', pRef(peg, 'Statement')),\n                  pMany(\n                    pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))\n                  ),\n                  pOption(pRef(peg, '\";\"'))\n                ),\n                pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n              )\n            )\n          )\n        )\n      ),\n      'Block',\n      0\n    );\n    peg['Statement'] = pOre(\n      pRef(peg, 'ClassDecl'),\n      pRef(peg, 'ImportDecl'),\n      pRef(peg, 'FuncDecl'),\n      pRef(peg, 'IfStmt'),\n      pRef(peg, 'ForStmt'),\n      pRef(peg, 'WhileStmt'),\n      pRef(peg, 'Return'),\n      pRef(peg, 'Yield'),\n      pRef(peg, 'Break'),\n      pRef(peg, 'Continue'),\n      pRef(peg, 'VarDecl'),\n      pRef(peg, 'Expression')\n    );\n    peg['ImportDecl'] = pOre2(\n      pNode(\n        pSeq3(\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pOption(\n            pSeq2(\n              pSeq2(pChar('as'), pRef(peg, 'S')),\n              pEdge('alias', pRef(peg, 'Name'))\n            )\n          )\n        ),\n        'ImportDecl',\n        0\n      ),\n      pNode(\n        pSeq(\n          pSeq2(pChar('from'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge(\n            'names',\n            pOre2(\n              pNode(\n                pSeq2(\n                  pEdge('', pRef(peg, 'Name')),\n                  pMany(\n                    pSeq3(\n                      pChar(','),\n                      pRef(peg, '_'),\n                      pEdge('', pRef(peg, 'Name'))\n                    )\n                  )\n                ),\n                '',\n                0\n              ),\n              pNode(pSeq2(pChar('*'), pRef(peg, '_')), '', 0)\n            )\n          )\n        ),\n        'FromDecl',\n        0\n      )\n    );\n    peg['ClassDecl'] = pNode(\n      pSeq(\n        pChar('class'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq(\n            pChar('('),\n            pRef(peg, '_'),\n            pEdge('extends', pRef(peg, 'Name')),\n            pChar(')'),\n            pRef(peg, '_')\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pOre2(pEdge('', pRef(peg, 'Block')), pEdge('', pRef(peg, 'Statement')))\n      ),\n      'ClassDecl',\n      0\n    );\n    peg['FuncDecl'] = pNode(\n      pSeq(\n        pChar('def'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pEdge('params', pRef(peg, 'FuncParams')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncDecl',\n      0\n    );\n    peg['FuncParams'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pOption(pEdge('', pRef(peg, 'FuncParam'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'FuncParam')))),\n        pRef(peg, '\")\"')\n      ),\n      'FuncParam',\n      0\n    );\n    peg['FuncParam'] = pNode(\n      pSeq2(\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq3(pChar(':'), pRef(peg, '_'), pEdge('type', pRef(peg, 'Name')))\n        )\n      ),\n      'Param',\n      0\n    );\n    peg['Lambda'] = pNode(\n      pSeq(\n        pChar('lambda'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('params', pRef(peg, 'LambdaParams'))\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncExpr',\n      0\n    );\n    peg['LambdaParams'] = pNode(\n      pSeq2(\n        pOption(pEdge('', pRef(peg, 'Name'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Name'))))\n      ),\n      'Param',\n      0\n    );\n    peg['Return'] = pNode(\n      pSeq2(\n        pChar('return'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('expr', pRef(peg, 'Expression'))\n          )\n        )\n      ),\n      'Return',\n      0\n    );\n    peg['Yield'] = pNode(pSeq2(pChar('yield'), pRef(peg, '_')), 'Yield', 0);\n    peg['Pass'] = pNode(pSeq2(pChar('pass'), pRef(peg, '_')), 'Pass', 0);\n    peg['Break'] = pNode(pSeq2(pChar('break'), pRef(peg, '_')), 'Break', 0);\n    peg['Continue'] = pNode(\n      pSeq2(pChar('continue'), pRef(peg, '_')),\n      'Continue',\n      0\n    );\n    peg['IfStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('if'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement'))),\n        pOption(pEdge('elif', pRef(peg, 'ElifBlock'))),\n        pOption(\n          pSeq(\n            pOre2(pMatch(0), pRef(peg, 'NL')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pChar(':'),\n            pRef(peg, '_'),\n            pEdge('else', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n          )\n        )\n      ),\n      'IfStmt',\n      0\n    );\n    peg['ElifBlock'] = pNode(pMany1(pEdge('', pRef(peg, 'ElifStmt'))), '', 0);\n    peg['ElifStmt'] = pNode(\n      pSeq(\n        pOre2(pMatch(0), pRef(peg, 'NL')),\n        pSeq2(pChar('elif'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ElifStmt',\n      0\n    );\n    peg['ForStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('for'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('each', pRef(peg, 'Name')),\n        pSeq2(pChar('in'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('list', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ForStmt',\n      0\n    );\n    peg['WhileStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('while'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'WhileStmt',\n      0\n    );\n    peg['VarDecl'] = pOre2(\n      pNode(\n        pSeq(\n          pEdge('left', pRef(peg, 'LeftHand')),\n          pChar('='),\n          pRef(peg, '_'),\n          pEdge('right', pRef(peg, 'Expression'))\n        ),\n        'VarDecl',\n        0\n      ),\n      pRef(peg, 'SelfAssign')\n    );\n    peg['LeftHand'] = pSeq2(\n      pRef(peg, 'Name'),\n      pMany(\n        pOre2(\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['SelfAssign'] = pNode(\n      pSeq3(\n        pEdge('left', pRef(peg, 'LeftHand')),\n        pEdge('name', pRef(peg, 'SelfAssignOp')),\n        pEdge('right', pRef(peg, 'Expression'))\n      ),\n      'SelfAssign',\n      0\n    );\n    peg['SelfAssignOp'] = pSeq2(\n      pNode(\n        pSeq2(\n          pOre(\n            pChar('<<'),\n            pChar('>>'),\n            pChar('**'),\n            pChar('//'),\n            pRange('+=*@/%&|^', [])\n          ),\n          pChar('=')\n        ),\n        '',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Expression'] = pSeq2(\n      pRef(peg, 'Operator'),\n      pOption(\n        pFold(\n          'then',\n          pSeq(\n            pChar('if'),\n            pRef(peg, '_'),\n            pEdge('cond', pRef(peg, 'Expression')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pEdge('else', pRef(peg, 'Expression'))\n          ),\n          'IfExpr',\n          0\n        )\n      )\n    );\n    peg['Operator'] = pSeq2(\n      pRef(peg, 'AndExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'OR'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'AndExpr'))\n          ),\n          'Or',\n          0\n        )\n      )\n    );\n    peg['OR'] = pOre2(pChar('or'), pChar('||'));\n    peg['AndExpr'] = pSeq2(\n      pRef(peg, 'NotExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'AND'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'NotExpr'))\n          ),\n          'And',\n          0\n        )\n      )\n    );\n    peg['AND'] = pOre2(pChar('and'), pChar('&&'));\n    peg['NotExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pRef(peg, 'NOT'),\n          pRef(peg, '_'),\n          pEdge('', pRef(peg, 'NotExpr'))\n        ),\n        'Not',\n        0\n      ),\n      pRef(peg, 'EqExpr')\n    );\n    peg['NOT'] = pOre2(pSeq2(pChar('not'), pRef(peg, 'S')), pChar('!'));\n    peg['EqExpr'] = pSeq2(\n      pRef(peg, 'SumExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'EQ'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'SumExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['EQ'] = pOre(\n      pSeq2(pChar('=='), pNot(pChar('='))),\n      pSeq2(pChar('!='), pNot(pChar('='))),\n      pSeq2(pChar('<='), pNot(pChar('='))),\n      pSeq2(pChar('>='), pNot(pChar('='))),\n      pSeq2(pChar('<'), pNot(pChar('<'))),\n      pSeq2(pChar('>'), pNot(pChar('>'))),\n      pSeq2(pChar('in'), pRef(peg, 'S')),\n      pSeq2(pChar('is'), pRef(peg, 'S')),\n      pSeq2(pChar('is not'), pRef(peg, 'S'))\n    );\n    peg['SumExpr'] = pSeq2(\n      pRef(peg, 'ProdExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'SUM'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'ProdExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['SUM'] = pRange('+-|', []);\n    peg['ProdExpr'] = pSeq2(\n      pRef(peg, 'PowExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'PROD'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'PowExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['PROD'] = pOre(\n      pChar('//'),\n      pChar('<<'),\n      pChar('>>'),\n      pRange('*/%^&', [])\n    );\n    peg['PowExpr'] = pSeq2(\n      pRef(peg, 'UnaryExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pChar('**'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'UnaryExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['UnaryExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pEdge('name', pNode(pRef(peg, 'PRE'), 'Name', 0)),\n          pRef(peg, '_'),\n          pEdge('expr', pRef(peg, 'UnaryExpr'))\n        ),\n        'Unary',\n        0\n      ),\n      pRef(peg, 'SuffixExpr')\n    );\n    peg['PRE'] = pRange('+-~', []);\n    peg['SuffixExpr'] = pSeq2(\n      pRef(peg, 'Primary'),\n      pMany(\n        pOre(\n          pFold(\n            'recv',\n            pSeq(\n              pChar('.'),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name')),\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'MethodExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'name',\n            pSeq(\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'ApplyExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq(\n              pRef(peg, '\"[\"'),\n              pOption(pEdge('left', pRef(peg, 'Expression'))),\n              pChar(':'),\n              pRef(peg, '_'),\n              pOption(pEdge('right', pRef(peg, 'Expression'))),\n              pRef(peg, '\"]\"')\n            ),\n            'Slice',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['Arguments'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pEdge('', pRef(peg, 'Expression')), pNot(pChar('=')))),\n        pMany(\n          pSeq(\n            pChar(','),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'Expression')),\n            pNot(pChar('='))\n          )\n        ),\n        pOption(pEdge('', pRef(peg, 'KeywordArgument')))\n      ),\n      'Arguments',\n      0\n    );\n    peg['KeywordArgument'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pChar(','), pRef(peg, '__'))),\n        pEdge('', pRef(peg, 'Argument')),\n        pMany(\n          pSeq3(pChar(','), pRef(peg, '__'), pEdge('', pRef(peg, 'Argument')))\n        )\n      ),\n      'Data',\n      0\n    );\n    peg['Argument'] = pNode(\n      pSeq(\n        pEdge('name', pRef(peg, 'Name')),\n        pChar('='),\n        pRef(peg, '_'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Primary'] = pOre(\n      pRef(peg, 'GroupExpr'),\n      pRef(peg, 'ListExpr'),\n      pRef(peg, 'DataExpr'),\n      pRef(peg, 'Lambda'),\n      pRef(peg, 'Constant'),\n      pRef(peg, 'Name')\n    );\n    peg['GroupExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pEdge('', pRef(peg, 'Expression')),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression')))),\n        pRef(peg, '__'),\n        pRef(peg, '\")\"')\n      ),\n      'Tuple',\n      0\n    );\n    peg['ListExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"[\"'),\n        pOption(\n          pSeq2(\n            pEdge('', pRef(peg, 'Expression')),\n            pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression'))))\n          )\n        ),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"]\"')\n      ),\n      'List',\n      0\n    );\n    peg['DataExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"{\"'),\n        pEdge('', pRef(peg, 'KeyValue')),\n        pMany(pSeq2(pMany(pRef(peg, '\",\"')), pEdge('', pRef(peg, 'KeyValue')))),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"}\"')\n      ),\n      'Data',\n      0\n    );\n    peg['KeyValue'] = pNode(\n      pSeq3(\n        pEdge(\n          'name',\n          pOre(\n            pRef(peg, 'Name'),\n            pRef(peg, 'StringExpr'),\n            pRef(peg, 'CharExpr')\n          )\n        ),\n        pRef(peg, '\":\"'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Name'] = pOre2(pRef(peg, 'Identifier'), pRef(peg, 'NLPSymbol'));\n    peg['Identifier'] = pSeq2(\n      pNode(\n        pSeq2(pRange('', ['AZ', 'az']), pMany(pRange('_', ['AZ', 'az', '09']))),\n        'Name',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['NLPSymbol'] = pSeq2(\n      pNode(\n        pMany1(pOre(pRef(peg, 'HIRA'), pRef(peg, 'KATA'), pRef(peg, 'KANJI'))),\n        'NLPSymbol',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Constant'] = pOre(\n      pRef(peg, 'FormatString'),\n      pRef(peg, 'LongString'),\n      pRef(peg, 'StringExpr'),\n      pRef(peg, 'CharExpr'),\n      pRef(peg, 'Number'),\n      pRef(peg, 'TrueExpr'),\n      pRef(peg, 'FalseExpr'),\n      pRef(peg, 'NullExpr')\n    );\n    peg['FormatString'] = pSeq3(\n      pRange('Ff', []),\n      pOre(\n        pSeq3(\n          pChar(\"'''\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3'))), 'Format', 0),\n          pChar(\"'''\")\n        ),\n        pSeq3(\n          pChar(\"'\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1'))), 'Format', 0),\n          pChar(\"'\")\n        ),\n        pSeq3(\n          pChar('\"\"\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3D'))), 'Format', 0),\n          pChar('\"\"\"')\n        ),\n        pSeq3(\n          pChar('\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1D'))), 'Format', 0),\n          pChar('\"')\n        )\n      ),\n      pRef(peg, '_')\n    );\n    peg['FormatContent3'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'''\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent3D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"\"\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['LongString'] = pOre2(\n      pSeq(\n        pChar(\"''\"),\n        pNode(\n          pSeq3(\n            pChar(\"'\"),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange(\"\\\\'\", [])), pAny()),\n                pSeq2(pNot(pChar(\"'''\")), pChar(\"'\"))\n              )\n            ),\n            pChar(\"'\")\n          ),\n          'MultiString',\n          0\n        ),\n        pChar(\"''\"),\n        pRef(peg, '_')\n      ),\n      pSeq(\n        pChar('\"\"'),\n        pNode(\n          pSeq3(\n            pChar('\"'),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange('\\\\\"', [])), pAny()),\n                pSeq2(pNot(pChar('\"\"\"')), pChar('\"'))\n              )\n            ),\n            pChar('\"')\n          ),\n          'MultiString',\n          0\n        ),\n        pChar('\"\"'),\n        pRef(peg, '_')\n      )\n    );\n    peg['StringExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar('\"'), pMany(pRef(peg, 'STRING_CONTENT')), pChar('\"')),\n        'String',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['CharExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar(\"'\"), pMany(pRef(peg, 'CHAR_CONTENT')), pChar(\"'\")),\n        'Char',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['STRING_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange('\"\\n\\\\', [])), pAny())\n    );\n    peg['CHAR_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange(\"'\\n\\\\\", [])), pAny())\n    );\n    peg['ESCAPE'] = pOre(\n      pSeq2(pChar('\\\\'), pRange('\\'\"\\\\bfnrt', [])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('', ['03']),\n        pRange('', ['07']),\n        pRange('', ['07'])\n      ),\n      pSeq3(pChar('\\\\'), pRange('', ['07']), pRange('', ['07'])),\n      pSeq2(pChar('\\\\'), pRange('', ['07'])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('uU', []),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX')\n      )\n    );\n    peg['IntExpr'] = pSeq2(\n      pNode(\n        pOre(\n          pRef(peg, 'DECIMAL'),\n          pRef(peg, 'HEXADECIMAL'),\n          pRef(peg, 'BINARY'),\n          pRef(peg, 'OCTAL')\n        ),\n        'Int',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['DECIMAL'] = pOre2(\n      pSeq2(pChar('0'), pNot(pRange('bBxX_', ['09']))),\n      pSeq2(\n        pRange('', ['19']),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      )\n    );\n    peg['HEXADECIMAL'] = pSeq(\n      pChar('0'),\n      pRange('xX', []),\n      pRef(peg, 'HEX'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'HEX')))\n    );\n    peg['BINARY'] = pSeq(\n      pChar('0'),\n      pRange('bB', []),\n      pRange('01', []),\n      pMany(pSeq2(pMany(pChar('_')), pRange('01', [])))\n    );\n    peg['OCTAL'] = pSeq2(\n      pChar('0'),\n      pMany(pSeq2(pMany(pChar('_')), pRange('', ['07'])))\n    );\n    peg['DIGIT'] = pRange('', ['09']);\n    peg['HEX'] = pRange('', ['af', 'AF', '09']);\n    peg['LONG_SUFFIX'] = pRange('lL', []);\n    peg['FloatExpr'] = pSeq2(\n      pNode(pRef(peg, 'FLOAT'), 'Double', 0),\n      pRef(peg, '_')\n    );\n    peg['FLOAT'] = pOre2(\n      pSeq2(pRef(peg, 'FRACTION'), pOption(pRef(peg, 'EXPONENT'))),\n      pSeq2(pMany1(pRef(peg, 'DIGIT')), pRef(peg, 'EXPONENT'))\n    );\n    peg['FRACTION'] = pOre2(\n      pSeq(\n        pNot(pChar('_')),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      ),\n      pSeq(\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pNot(pChar('.'))\n      )\n    );\n    peg['EXPONENT'] = pSeq(\n      pRange('eE', []),\n      pOption(pRange('+-', [])),\n      pRef(peg, 'DIGIT'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n    );\n    peg['Number'] = pOre2(pRef(peg, 'FloatExpr'), pRef(peg, 'IntExpr'));\n    peg['TrueExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Tt', []), pChar('rue')), 'TrueExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['FalseExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Ff', []), pChar('alse')), 'FalseExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['NullExpr'] = pSeq2(\n      pNode(pOre2(pChar('None'), pChar('null')), 'Null', 0),\n      pRef(peg, '_')\n    );\n    peg['EOF'] = pNot(pAny());\n    peg['NL'] = pOre2(pChar('\\n'), pRef(peg, 'EOF'));\n    peg['S'] = pRange(' \\t\\r\\u3000', []);\n    peg['_'] = pMany(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['__'] = pMany(\n      pOre(\n        pRef(peg, 'S'),\n        pChar('\\n'),\n        pRef(peg, 'BLOCKCOMMENT'),\n        pRef(peg, 'LINECOMMENT')\n      )\n    );\n    peg['SPC'] = pMany1(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['BLOCKCOMMENT'] = pOre2(\n      pSeq3(pChar('/*'), pMany(pSeq2(pNot(pChar('*/')), pAny())), pChar('*/')),\n      pSeq3(pChar('(*'), pMany(pSeq2(pNot(pChar('*)')), pAny())), pChar('*)'))\n    );\n    peg['LINECOMMENT'] = pSeq2(\n      pChar('#'),\n      pMany(pSeq2(pNot(pRef(peg, 'NL')), pAny()))\n    );\n    peg['EOL'] = pSeq3(\n      pRef(peg, '_'),\n      pRef(peg, 'NL'),\n      pMany(pSeq2(pRef(peg, '_'), pRef(peg, 'NL')))\n    );\n    peg['INDENT'] = pSeq2(pChar('\\n'), pMany1(pRange(' \\t', [])));\n    peg['C'] = pOre(\n      pRef(peg, 'HIRA'),\n      pRef(peg, 'KATA'),\n      pRef(peg, 'KANJI'),\n      pRef(peg, 'MARK'),\n      pRange('', ['', '', ''])\n    );\n    peg['HIRA'] = pRange('', ['']);\n    peg['KATA'] = pRange('', ['']);\n    peg['KANJI'] = pRange('', ['', '']);\n    peg['MARK'] = pRange('', []);\n    peg['W'] = pRange('', ['', '', '', '']);\n    peg['\"{\"'] = pSeq2(pRange('{', []), pRef(peg, '__'));\n    peg['\"}\"'] = pSeq2(pRange('}', []), pRef(peg, '_'));\n    peg['\"[\"'] = pSeq2(pRange('[', []), pRef(peg, '__'));\n    peg['\"]\"'] = pSeq2(pRange(']', []), pRef(peg, '_'));\n    peg['\"(\"'] = pSeq2(pRange('(', []), pRef(peg, '__'));\n    peg['\")\"'] = pSeq2(pRange(')', []), pRef(peg, '_'));\n    peg['\"=\"'] = pSeq3(\n      pRange('=', []),\n      pNot(pRange('=', [])),\n      pRef(peg, '_')\n    );\n    peg['\".\"'] = pSeq2(pRange('.', []), pRef(peg, '_'));\n    peg['\",\"'] = pSeq2(pRange(',', []), pRef(peg, '_'));\n    peg['\";\"'] = pMany1(pSeq2(pRange(';', []), pRef(peg, '_')));\n    peg['\":\"'] = pSeq2(pRange(':', []), pRef(peg, '_'));\n  }\n  return peg[start];\n};\n\nconst example = (start: string, sample?: string) => {\n  const parser = generate(start);\n  const t = parser(sample || 'abc');\n  console.log(`${start} ${sample}`);\n  console.log(t.toString());\n};\n\n// example('Source',\"from puppy import *\\ndef cat_clicked(cat): print('Meaw')\\ncat = Circle(500, 500, clicked=cat_clicked)\\n\")\n// example('ClassDecl','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('Statement','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('FuncDecl','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Statement','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Lambda','lambda: print(1)')\n// example('Lambda','lambda x: print(x)')\n// example('Lambda','lambda x,y: print(x,y)')\n// example('Statement','if A == 1 :\\n    print(A)\\n    #hoge\\n    print(A, B)\\n    A = Ball()\\nelse:\\n    print(A, B)\\n\\n    A = 2\\n')\n// example('Statement','if A :\\n    pass\\nelif B :\\n    pass\\nelif C :\\n    pass\\nelse :\\n    pass\\n')\n// example('Statement','for x in [1,2,3]:\\n    print(x)\\n    print(x+1)\\n')\n// example('VarDecl','A = 1')\n// example('Statement','A = 1')\n// example('VarDecl','A += 1')\n// example('Statement','A += 1')\n// example('Expression','not 1 == 2')\n// example('Expression','not 1 == 2 and 1 > 3')\n// example('Expression','a[1:2]')\n// example('Expression','a[1:]')\n// example('Expression','a[:2]')\n// example('Expression','Circle(500, 500)')\n// example('Expression','Circle(500, 500, clicked=cat_clicked)')\n// example('Expression','Circle(clicked=1, move=1)')\n// example('Primary','(1,2) //')\n// example('Expression','(1,2) //')\n// example('Primary','(1)')\n// example('Expression','(1)')\n// example('Primary','[1,2,3]')\n// example('Expression','[1,2,3]')\n// example('Primary',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"f'{a}+{1}'\")\n// example('Expression','world(\\n    hoge=1,\\n    hoge=1*2**2*3\\n)\\n')\n\n// pegpy nezcc -g math.tpeg parser.ts > math.ts\n// npx ts-node math.ts\n","import { generate, ParseTree } from './puppy-parser';\n\nconst INDENT = '\\t';\n\n/* Type System */\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(ty: Type, update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any): Type {\n    return this;\n  }\n}\n\nclass BaseType extends Type {\n  private name: string;\n\n  constructor(name: string, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.name = name;\n  }\n\n  public toString() {\n    return this.name;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof BaseType) {\n      return this.name === v.name;\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public hasAlpha(): boolean {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ty = map[this.name];\n      if (ty === undefined) {\n        map[this.name] = new VarType(map.env, map.t);\n      }\n      return map[this.name];\n    }\n    return this;\n  }\n}\n\nclass VoidType extends BaseType {\n  constructor() {\n    super('void', false);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VarType) {\n      v.must(this, update);\n    }\n    return true;\n  }\n}\n\nclass AnyType extends BaseType {\n  constructor(isOptional?: any) {\n    super('any', isOptional);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VoidType) {\n      return false;\n    }\n    return true;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha() {\n    return true;\n  }\n\n  public toVarType(map: any) {\n    return new VarType(map.env, map.t);\n  }\n}\n\nclass FuncType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss = ['('];\n    for (var i = 1; i < this.types.length; i += 1) {\n      if (i > 1) {\n        ss.push(',');\n      }\n      ss.push(this.types[i].toString());\n    }\n    ss.push(')->');\n    ss.push(this.types[0].toString());\n    return ss.join('');\n  }\n\n  public rtype() {\n    return this.types[0];\n  }\n  public psize() {\n    return this.types.length - 1;\n  }\n  public ptype(index: number) {\n    return this.types[index + 1];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof FuncType && this.psize() == v.psize()) {\n      for (var i = 0; i < this.types.length; i += 1) {\n        if (!this.types[i].accept(v.types[i], update)) {\n          return false;\n        }\n        return true;\n      }\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    for (const ty of this.types) {\n      if (ty.isPattern()) return true;\n    }\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) return true;\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const v: Type[] = [];\n      for (const ty of this.types) {\n        v.push(ty.toVarType(map));\n      }\n      return new FuncType(...v);\n    }\n    return this;\n  }\n}\n\nclass ListType extends Type {\n  private param: Type;\n  constructor(param: Type, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.param = param;\n  }\n\n  public toString() {\n    return `List[${this.param.toString()}]`;\n  }\n\n  public psize() {\n    return 1;\n  }\n  public ptype(index: number) {\n    return this.param;\n  }\n\n  public realType(): Type {\n    const p = this.param.realType();\n    if (p !== this.param) {\n      return new ListType(p);\n    }\n    return this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof ListType) {\n      if (this.param == tAny) {\n        return true;\n      }\n      return this.param.accept(v.param, update);\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.param.isPattern();\n  }\n\n  public hasAlpha(): boolean {\n    return this.param.hasAlpha();\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      return new ListType(this.param.toVarType(map));\n    }\n    return this;\n  }\n}\n\nclass UnionType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss: string[] = [];\n    for (var i = 0; i < this.types.length; i += 1) {\n      if (i > 0) {\n        ss.push('|');\n      }\n      ss.push(this.types[i].toString());\n    }\n    return ss.join('');\n  }\n  public psize() {\n    return this.types.length;\n  }\n\n  public ptype(index: number) {\n    return this.types[index];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    for (const ty0 of this.types) {\n      if (ty0.accept(ty, false)) {\n        return true;\n      }\n    }\n    console.log(`FAIL ${ty} ${this.toString()}`);\n    return false;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ts: Type[] = [];\n      for (const ty of this.types) {\n        ts.push(ty.toVarType(map));\n      }\n      return new UnionType(...ts);\n    }\n    return this;\n  }\n}\n\nconst union = (...types: Type[]) => {\n  if (types.length === 1) {\n    return types[0];\n  }\n  return new UnionType(...types);\n};\n\nconst tAny = new AnyType();\nconst tVoid = new VoidType();\nconst tBool = new BaseType('Bool');\nconst tInt = new BaseType('Number');\nconst tInt_ = new BaseType('Number', true);\nconst tFloat = tInt;\nconst tFloat_ = tInt_;\nconst tString = new BaseType('String');\nconst tString_ = new BaseType('String', true);\nconst tA = new BaseType('a');\nconst tListA = new ListType(tA);\nconst tListInt = new ListType(tInt);\nconst tListAny = new ListType(tAny);\nconst tMatter = new BaseType('Object');\nconst tObject = tMatter;\nconst tVec = new BaseType('Vec');\n\n//const tUndefined = new BaseType('undefined');\n\nconst EmptyNumberSet: number[] = [];\n\nconst unionSet = (a: number[], b: number[], c?: number[]) => {\n  const A: number[] = [];\n  for (const id of a) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  for (const id of b) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  if (c !== undefined) {\n    for (const id of b) {\n      if (A.indexOf(id) === -1) {\n        A.push(id);\n      }\n    }\n  }\n  return A;\n};\n\nclass VarType extends Type {\n  private varMap: (Type | number[])[];\n  private varid: number;\n  private ref: ParseTree | null;\n\n  constructor(env: Env, ref: ParseTree) {\n    super(false);\n    this.varMap = env.getroot('@varmap');\n    this.varid = this.varMap.length;\n    this.varMap.push(EmptyNumberSet);\n    this.ref = ref;\n  }\n\n  public toString() {\n    const v = this.varMap[this.varid];\n    if (v instanceof Type) {\n      return v.toString();\n    }\n    return 'any';\n  }\n\n  public realType(): Type {\n    const v = this.varMap[this.varid];\n    return v instanceof Type ? v : this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    var v = this.varMap[this.varid];\n    if (v instanceof Type && v !== this) {\n      return v.accept(ty, update);\n    }\n    return this.must(ty.realType(), update);\n  }\n\n  public must(ty: Type, update: boolean): boolean {\n    const v1 = ty.realType();\n    if (update) {\n      if (v1 instanceof VarType) {\n        if (v1.varid === this.varid) {\n          return true;\n        }\n        const u = unionSet(\n          this.varMap[this.varid] as number[],\n          this.varMap[v1.varid] as number[],\n          [v1.varid, this.varid]\n        );\n        for (const id of u) {\n          this.varMap[id] = u;\n        }\n        return true;\n      }\n      if (!v1.isPattern()) {\n        const u = this.varMap[this.varid] as number[];\n        for (const id of u) {\n          this.varMap[id] = v1;\n        }\n        this.varMap[this.varid] = v1;\n      }\n    }\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n}\n\nclass OptionType extends Type {\n  public options: any;\n  constructor(options: any) {\n    super(false);\n    this.options = options;\n  }\n\n  public toString() {\n    return JSON.stringify(this.options);\n  }\n\n  public accept(ty: Type): boolean {\n    const v = ty.realType();\n    if (v instanceof OptionType) {\n      return true;\n    }\n    return false;\n  }\n\n  public equals(ty: Type, update: boolean): boolean {\n    return this.accept(ty);\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any) {\n    return this;\n  }\n}\n\nclass Symbol {\n  public code: string;\n  public ty: Type;\n  public isMatter: boolean = false;\n  public isMutable: boolean = false;\n  public constructor(code: string, ty: Type, options?: any) {\n    this.code = code;\n    this.ty = ty.realType();\n    if (options !== undefined) {\n      this.isMatter = options.isMatter === undefined ? false : options.isMatter;\n      this.isMutable =\n        options.isMutable == undefined ? false : options.isMutable;\n    }\n  }\n  public isGlobal() {\n    return this.code.indexOf('vars[') == 0;\n  }\n}\n\nconst tColor = new UnionType(tString, tInt);\nconst tOption = new OptionType({});\nconst tFuncFloatFloat = new FuncType(tFloat, tFloat);\nconst tFuncFloatFloatFloat = new FuncType(tFloat, tFloat, tFloat);\nconst tFuncShape = new FuncType(tMatter, tInt, tInt, tOption);\n\nconst import_math = {\n  pi: new Symbol('3.14159', tFloat),\n  sin: new Symbol('Math.sin', tFuncFloatFloat),\n  cos: new Symbol('Math.cos', tFuncFloatFloat),\n  tan: new Symbol('Math.tan', tFuncFloatFloat),\n  sqrt: new Symbol('Math.sqrt', tFuncFloatFloat),\n  log: new Symbol('Math.log', tFuncFloatFloat),\n  log10: new Symbol('Math.log10', tFuncFloatFloat),\n\n  pow: new Symbol('Math.pow', tFuncFloatFloatFloat),\n  hypot: new Symbol('Math.hypot', tFuncFloatFloatFloat),\n  gcd: new Symbol('puppy.gcd', tFuncFloatFloatFloat),\n};\n\nconst import_python = {\n  // 'math.': IMPORT_MATH,\n  // 'random.': IMPORT_RANDOM,\n  input: new Symbol('await puppy.input', new FuncType(tString, tString_)),\n  print: new Symbol('puppy.print', new FuncType(tVoid, tAny, tOption), {\n    isMatter: true,\n  }),\n\n  //# , ..None \n  len: new Symbol('lib.len', new FuncType(tInt, union(tString, tListA))),\n  //\n  range: new Symbol('lib.range', new FuncType(tListInt, tInt, tInt_, tInt_)),\n  //append\n  '.append': new Symbol('lib.append', new FuncType(tVoid, tListA, tA)),\n\n  // \n  int: new Symbol('lib.int', new FuncType(tInt, union(tBool, tString, tInt))),\n  float: new Symbol(\n    'lib.float',\n    new FuncType(tFloat, union(tBool, tString, tInt))\n  ),\n  str: new Symbol('lib.str', new FuncType(tString, tAny)),\n  //'random': new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_random = {\n  random: new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_matterjs = {\n  // # \n  World: new Symbol('puppy.World', tFuncShape, { isMatter: true }),\n  Circle: new Symbol('puppy.Circle', tFuncShape, { isMatter: true }),\n  Rectangle: new Symbol('puppy.Rectangle', tFuncShape, { isMatter: true }),\n  Polygon: new Symbol('puppy.Polygon', tFuncShape, { isMatter: true }),\n  Label: new Symbol('puppy.Label', tFuncShape, { isMatter: true }),\n  // 'Ball': new Symbol('puppy.Circle', tFuncShape),\n  // 'Block': new Symbol('puppy.Ball', tFuncShape),\n\n  // # \n  '.setPosition': new Symbol(\n    'lib.setPosition',\n    new FuncType(tVoid, tMatter, tInt, tInt)\n  ),\n  '.applyForce': new Symbol(\n    'lib.applyForce',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt, tInt)\n  ),\n  '.rotate': new Symbol(\n    'lib.rotate',\n    new FuncType(tVoid, tMatter, tInt, tInt_, tInt_)\n  ),\n  '.scale': new Symbol(\n    'lib.scale',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt_, tInt_)\n  ),\n  '.setAngle': new Symbol('lib.setAngle', new FuncType(tVoid, tMatter, tInt)),\n  '.setAngularVelocity': new Symbol(\n    'lib.setAngularVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setDensity': new Symbol(\n    'lib.setDensity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setMass': new Symbol('lib.setMass', new FuncType(tVoid, tMatter, tInt)),\n  '.setStatic': new Symbol(\n    'lib.setStatic',\n    new FuncType(tVoid, tMatter, tBool)\n  ),\n  '.setVelocity': new Symbol(\n    'lib.setVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n};\n\nconst modules: any = {\n  math: import_math,\n  random: import_random,\n  matterjs: import_matterjs,\n};\n\nconst symbolPackageMap: any = {};\n\nconst checkSymbolNames = () => {\n  for (const pkgname of Object.keys(modules)) {\n    for (const name of Object.keys(modules[pkgname])) {\n      symbolPackageMap[name] = pkgname;\n    }\n  }\n};\ncheckSymbolNames();\n\nconst KEYTYPES = {\n  width: tInt,\n  height: tInt,\n  x: tInt,\n  y: tInt,\n  image: tString,\n  strokeStyle: tColor,\n  lineWidth: tInt,\n  fillStyle: tColor,\n  restitution: tFloat,\n  angle: tFloat,\n  position: tVec,\n  mass: tInt,\n  density: tInt,\n  area: tInt,\n  friction: tFloat,\n  frictionStatic: tFloat,\n  airFriction: tFloat,\n  torque: tFloat,\n  stiffness: tFloat,\n  isSensor: tBool,\n  isStatic: tBool,\n  damping: tFloat,\n  in: new FuncType(tVoid, tMatter, tMatter),\n  out: new FuncType(tVoid, tMatter, tMatter),\n  over: new FuncType(tVoid, tMatter, tMatter),\n  clicked: new FuncType(tVoid, tMatter),\n  font: tString,\n  fontColor: tColor,\n  textAlign: tString,\n  value: tInt,\n  message: tString,\n};\n\n//const ty1 = this.check(tleft(op), env, t['left'], out1);\n//const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n//return tbinary(env, t, ty1, out1.join(''), ty2, out1.join(''), out);\nconst tCompr = union(tInt, tString);\n\nconst opset: any = {\n  and: '&&',\n  or: '||',\n  not: '!',\n  '+=': '+',\n  '-=': '-',\n  '*=': '*',\n  '//=': '//',\n  '/=': '/',\n  '<<=': '<<',\n  '>>=': '>>',\n  '|=': '|',\n  '&=': '&',\n  '^=': '^',\n};\n\nconst operator = (op: string) => {\n  const op2 = opset[op];\n  if (op2 !== undefined) {\n    return op2;\n  }\n  return op;\n};\n\nconst tleftMap = {\n  '+': union(tInt, tString, tListAny),\n  '-': tInt,\n  '**': tInt,\n  '*': union(tInt, tString, tListAny),\n  '/': tInt,\n  '//': tInt,\n  '%': tInt,\n  '==': tAny,\n  '!=': tAny,\n  in: tAny,\n  '<': tCompr,\n  '<=': tCompr,\n  '>': tCompr,\n  '>=': tCompr,\n  '^': tInt,\n  '|': tInt,\n  '&': tInt,\n  '<<': tInt,\n  '>>': tInt,\n};\n\nconst tleft = (op: string) => {\n  const ty = (tleftMap as any)[op];\n  if (ty === undefined) {\n    console.log(`FIXME undefined '${op}'`);\n    return tAny;\n  }\n  return ty;\n};\n\nconst tright = (op: string, ty: Type) => {\n  if (op == 'in') {\n    return union(new ListType(ty), tString);\n  }\n  const ty2 = (tleftMap as any)[op];\n  if (ty2 === tAny || ty2 === tInt || op === '*') {\n    return ty2;\n  }\n  return ty; // \n};\n\ntype ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nconst setpos = (s: string, pos: number, elog: ErrorLog) => {\n  const max = Math.min(pos + 1, s.length);\n  var r = 1;\n  var c = 0;\n  for (var i = 0; i < max; i += 1) {\n    if (s.charCodeAt(i) == 10) {\n      r += 1;\n      c = 0;\n    }\n    c += 1;\n  }\n  elog.pos = pos;\n  elog.row = r;\n  elog.col = c;\n  return elog;\n};\n\nclass Env {\n  private root: Env;\n  private parent: Env | null;\n  private vars: any;\n\n  public constructor(env?: Env) {\n    this.vars = {};\n    if (env === undefined) {\n      this.root = this;\n      this.parent = null;\n      this.vars['@varmap'] = [];\n      this.vars['@logs'] = [];\n      this.vars['@trace'] = [];\n      this.vars['@indent'] = INDENT;\n    } else {\n      this.root = env.root;\n      this.parent = env;\n    }\n  }\n\n  public get(key: string, value?: any) {\n    var e: Env | null = this;\n    while (e !== null) {\n      const v = e.vars[key];\n      if (v !== undefined) {\n        return v;\n      }\n      e = e.parent;\n    }\n    return value;\n  }\n\n  public has(key: string) {\n    return this.get(key) !== undefined;\n  }\n\n  public set(key: string, value: any) {\n    this.vars[key] = value;\n    return value;\n  }\n\n  public getroot(key: string, value?: any) {\n    return this.root.vars[key] || value;\n  }\n\n  public setroot(key: string, value: any) {\n    this.root.vars[key] = value;\n    return value;\n  }\n\n  public from_import(pkg: any, list?: string[]) {\n    for (const name of Object.keys(pkg)) {\n      //console.log(name);\n      if (list === undefined || list.indexOf(name) !== -1) {\n        this.vars[name] = pkg[name];\n      }\n    }\n  }\n\n  public setModule(name: string, options: any) {\n    this.set(name, new Symbol('undefined', new OptionType(options)));\n  }\n\n  public isModule(name: string) {\n    const s = this.get(name) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public getModule(pkgname: string, name: string) {\n    const s = this.get(pkgname) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      const options = (s.ty as OptionType).options;\n      return options[name];\n    }\n    return undefined;\n  }\n\n  public perror(t: ParseTree, elog: ErrorLog) {\n    const logs = this.root.vars['@logs'];\n    if (elog.type === undefined) {\n      elog.type = 'error';\n    }\n    if (elog.pos === undefined) {\n      const pos = t.begin();\n      elog.pos = pos[0];\n      elog.row = pos[1];\n      elog.col = pos[2];\n    }\n    if (elog.len === undefined) {\n      elog.len = t.epos - t.spos;\n    }\n    logs.push(elog);\n  }\n\n  public trace(t: ParseTree) {\n    const trace: number[][] = this.getroot('@trace');\n    const id = trace.length;\n    const pos = t.begin();\n    trace.push([pos[0], pos[1], pos[2], t.epos - t.spos]);\n    return `,puppy,${id}`;\n  }\n\n  public setInLoop() {\n    this.set('@inloop', true);\n    return true;\n  }\n\n  public inLoop() {\n    return this.get('@inloop') === true;\n  }\n\n  public setFunc(data: any) {\n    this.set('@func', data);\n    return data;\n  }\n\n  public inFunc() {\n    return this.get('@func') !== undefined;\n  }\n\n  public foundFunc(t: ParseTree, symbol: Symbol) {\n    if (symbol.isMatter) {\n      const data = this.get('@func');\n      if (data !== undefined) {\n        data['isMatter'] = true;\n      } else {\n        const pos = setpos(t.inputs, t.spos, { type: '', key: '' });\n        this.setroot('@yeild', pos.row);\n      }\n    }\n  }\n\n  private isUtf8Name(s: string) {\n    for (var i = 0; i < s.length; i += 1) {\n      if (s.charCodeAt(i) > 128) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private local(s: string): string {\n    if (this.isUtf8Name(s)) {\n      const map = this.getroot('@utf8map');\n      if (map === undefined) {\n        this.setroot('@utf8map', {});\n        return this.local(s);\n      }\n      var vname = map[name];\n      if (vname === undefined) {\n        const id = Object.keys(map).length;\n        vname = `_v${id}`;\n        map[name] = vname;\n      }\n      return vname as string;\n    }\n    return s;\n  }\n\n  public declVar(name: string, ty: Type) {\n    var code =\n      this.inFunc() || this.inLoop() ? this.local(name) : `vars['${name}']`;\n    const symbol = new Symbol(code, ty);\n    symbol.isMutable = true;\n    return this.set(name, symbol) as Symbol;\n  }\n\n  public emitAutoYield(out: string[]) {\n    const yieldparam = this.getroot('@yeild');\n    if (yieldparam !== undefined && !this.inFunc()) {\n      out.push(`; yield ${yieldparam};\\n`);\n      this.setroot('@yeild', undefined);\n    } else {\n      out.push('\\n');\n    }\n  }\n}\n\nclass PuppyError {\n  public constructor() {}\n}\n\nconst FIXME_subs = (t: any) => {\n  return t instanceof ParseTree ? t.subs() : ([] as ParseTree[]);\n};\n\nclass Transpiler {\n  public constructor() {}\n\n  public conv(env: Env, t: ParseTree, out: string[]) {\n    // console.log(t.toString());\n    // console.log((this as any)[t.tag]);\n    try {\n      return (this as any)[t.tag](env, t, out);\n    } catch (e) {\n      if (e instanceof PuppyError) {\n        throw e;\n      }\n      if ((this as any)[t.tag] === undefined) {\n        //console.log(e);\n        env.perror(t, {\n          type: 'error',\n          key: 'UndefinedParseTree',\n          subject: t.toString(),\n        });\n        return this.skip(env, t, out);\n      }\n      throw e;\n    }\n  }\n\n  public skip(env: Env, t: ParseTree, out: string[]): Type {\n    throw new PuppyError();\n    // out.push('undefined');\n    // return tAny;\n  }\n\n  public check(\n    req: Type,\n    env: Env,\n    t: ParseTree,\n    out: string[],\n    elog?: ErrorLog\n  ) {\n    const ty = this.conv(env, t, out);\n    if (req.accept(ty, true)) {\n      return ty;\n    }\n    if (elog === undefined) {\n      elog = {\n        type: 'error',\n        key: 'TypeError',\n      };\n    }\n    elog.request = req;\n    elog.given = ty;\n    env.perror(t, elog);\n    return this.skip(env, t, out);\n  }\n\n  private checkBinary(\n    env: Env,\n    t: any,\n    op: string,\n    ty1: Type,\n    left: string,\n    ty2: Type,\n    right: string,\n    out: string[]\n  ) {\n    if (op === '==' || op === '!=') {\n      out.push(`${left} ${op}= ${right}`);\n      return tBool;\n    }\n    ty1 = ty1.realType();\n    ty2 = ty2.realType();\n    if (op === '+') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} + ${right})`);\n        return tInt;\n      }\n      if (ty1.accept(ty2, true)) {\n        out.push(`lib.anyAdd(${left},${right})`);\n        return ty1;\n      }\n      env.perror(t, {\n        key: 'BinaryTypeError',\n        subject: op,\n        request: ty1,\n        given: ty2,\n      });\n      return this.skip(env, t, out);\n    }\n    if (op === '*') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} * ${right})`);\n        return tInt;\n      }\n      out.push(`lib.anyMul(${left},${right})`);\n      if (ty1 === tInt || tListAny.accept(ty2, false)) return ty2;\n      if (ty2 === tInt || tListAny.accept(ty1, false)) return ty1;\n      return ty1;\n    }\n    if (op === '//') {\n      out.push(`((${left}/${right})|0)`);\n      return tInt;\n    }\n    if (op === '**') {\n      out.push(`Math.pow(${left},${right})`);\n      return tInt;\n    }\n    if (ty1.accept(ty2, true)) {\n      out.push(`(${left} ${op} ${right})`);\n      if ((tleftMap as any)[op] === tCompr) {\n        return tBool;\n      }\n      return ty1;\n    }\n    env.perror(t, {\n      key: 'BinaryTypeError',\n      subject: op,\n      request: ty1,\n      given: ty2,\n    });\n    return this.skip(env, t, out);\n  }\n\n  public err(env: Env, t: ParseTree, out: string[]) {\n    env.perror(t, {\n      type: 'error',\n      key: 'SyntaxError',\n    });\n    return tVoid;\n  }\n\n  public FromDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.from_import(pkg); // FIXME\n    return tVoid;\n  }\n\n  public ImportDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const alias = t.tokenize('alias', name);\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.setModule(alias, pkg);\n    return tVoid;\n  }\n\n  public Source(env: Env, t: ParseTree, out: string[]) {\n    for (const subtree of FIXME_subs(t)) {\n      try {\n        const out2: string[] = [];\n        out2.push(env.get('@indent'));\n        this.conv(env, subtree, out2);\n        env.emitAutoYield(out2);\n        out.push(out2.join(''));\n      } catch (e) {\n        if (!(e instanceof PuppyError)) {\n          throw e;\n        }\n      }\n    }\n    return tVoid;\n  }\n\n  public Block(penv: Env, t: ParseTree, out: string[]) {\n    const indent = penv.get('@indent');\n    const nested = INDENT + indent;\n    const env = new Env(penv);\n    env.set('@indent', nested);\n    out.push('{\\n');\n    for (const subtree of FIXME_subs(t)) {\n      out.push(env.get('@indent'));\n      this.conv(env, subtree, out);\n      env.emitAutoYield(out);\n    }\n    out.push(indent + '}');\n    return tVoid;\n  }\n\n  public IfExpr(env: Env, t: any, out: string[]) {\n    out.push('((');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ? (');\n    const ty = this.conv(env, t['then'], out);\n    out.push(') : (');\n    this.check(ty, env, t['else'], out);\n    out.push('))');\n    return ty;\n  }\n\n  public IfStmt(env: Env, t: any, out: string[]) {\n    out.push('if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    if (t['elif'] !== undefined) {\n      for (const stmt of t['elif'].subs()) {\n        this.conv(env, stmt, out);\n      }\n    }\n    if (t['else'] !== undefined) {\n      out.push('else ');\n      this.conv(env, t['else'], out);\n    }\n    return tVoid;\n  }\n\n  public ElifStmt(env: Env, t: any, out: string[]) {\n    out.push('else if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    return tVoid;\n  }\n\n  public ForStmt(env: Env, t: any, out: string[]) {\n    // if (t['each'].tag !== 'Name') {\n    //   env.perror(t['each'], {\n    //     type: 'error', key: 'RequiredIdentifier',\n    //   });\n    //   return tVoid;\n    // }\n    const name = t['each'].tokenize();\n    const ty = new VarType(env, t['each']);\n    out.push(`for (let ${name} of `);\n    this.check(new ListType(ty), env, t['list'], out);\n    out.push(')');\n    const lenv = new Env(env);\n    lenv.setInLoop();\n    lenv.declVar(name, ty);\n    this.conv(lenv, t['body'], out);\n    return tVoid;\n  }\n\n  public FuncDecl(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    const types = [new VarType(env, t['name'])];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      name: name,\n      return: types[0],\n      hasReturn: false,\n      isMatter: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    const symbol = env.declVar(name, funcType);\n    const defun = symbol.isGlobal() ? '' : 'var ';\n    out.push(`${defun}${symbol.code} = (${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    symbol.isMatter = funcData['isMatter'];\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    console.log(`DEFINED ${name} :: ${funcType}`);\n    return tVoid;\n  }\n\n  public FuncExpr(env: Env, t: any, out: string[]) {\n    const types = [new VarType(env, t)];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      return: types[0],\n      hasReturn: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    out.push(`(${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    return funcType;\n  }\n\n  public Return(env: Env, t: any, out: string[]) {\n    if (!env.inFunc()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInFunction',\n        subject: 'return',\n      });\n      return tVoid;\n    }\n    const funcData = env.get('@func');\n    funcData['hasReturn'] = true;\n    if (t['expr'] !== undefined) {\n      out.push('return ');\n      this.check(funcData['return'], env, t['expr'], out);\n    } else {\n      out.push('return');\n    }\n    return tVoid;\n  }\n\n  public Continue(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'continue',\n      });\n      return tVoid;\n    }\n    out.push('continue');\n    return tVoid;\n  }\n\n  public Break(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'break',\n      });\n      return tVoid;\n    }\n    out.push('break');\n    return tVoid;\n  }\n\n  public Pass(env: Env, t: any, out: string[]) {\n    return tVoid;\n  }\n\n  public VarDecl(env: Env, t: any, out: string[]) {\n    const left = t['left'] as ParseTree;\n    if (left.tag === 'Name') {\n      const name = left.tokenize();\n      var symbol = env.get(name) as Symbol;\n      if (symbol === undefined || (env.inFunc() && symbol.isGlobal())) {\n        const ty = new VarType(env, left);\n        const out1: string[] = [];\n        this.check(ty, env, t['right'], out1);\n        symbol = env.declVar(name, ty);\n        const qual = symbol.isGlobal() ? '' : 'var ';\n        out.push(`${qual}${symbol.code} = ${out1.join('')}`);\n        return tVoid;\n      }\n    }\n    t['left'].tag = `Set${t['left'].tag}`;\n    const ty = this.conv(env, t['left'], out);\n    out.push(' = ');\n    this.check(ty, env, t['right'], out);\n    return tVoid;\n  }\n\n  public Name(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public SetName(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    if (!symbol.isMutable) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public And(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' && ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Or(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' || ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Not(env: Env, t: any, out: string[]) {\n    out.push('!(');\n    this.check(tBool, env, t[0], out);\n    out.push(')');\n    return tBool;\n  }\n\n  public Infix(env: Env, t: any, out: string[]) {\n    const op = operator(t.tokenize('name'));\n    const out1: string[] = [];\n    const out2: string[] = [];\n    const ty1 = this.check(tleft(op), env, t['left'], out1);\n    const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n    return this.checkBinary(\n      env,\n      t,\n      op,\n      ty1,\n      out1.join(''),\n      ty2,\n      out2.join(''),\n      out\n    );\n  }\n\n  public Unary(env: Env, t: any, out: string[]) {\n    const op = t.tokenize('name');\n    if (op === '!' || op === 'not') {\n      out.push(`${op}(`);\n      this.check(tBool, env, t['expr'], out);\n      out.push(')');\n      return tBool;\n    } else {\n      out.push(`${op}(`);\n      this.check(tInt, env, t['expr'], out);\n      out.push(')');\n      return tInt;\n    }\n  }\n\n  public ApplyExpr(env: Env, t: any, out: string[]): Type {\n    const name = t.tokenize('name');\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      const pkgname = symbolPackageMap[name];\n      if (pkgname !== undefined) {\n        console.log(`importing ${pkgname} ...`);\n        env.from_import(modules[pkgname]);\n        env.perror(t['name'], {\n          type: 'info',\n          key: 'InferredPackage',\n          subject: pkgname,\n          code: `from ${pkgname} import *`,\n        });\n        return this.ApplySymbolExpr(\n          env,\n          t,\n          env.get(name) as Symbol,\n          undefined,\n          out\n        ); // Again\n      }\n    }\n    return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n  }\n\n  private ApplySymbolExpr(\n    env: Env,\n    t: any,\n    symbol: Symbol,\n    recv: ParseTree | undefined,\n    out: string[]\n  ): Type {\n    if (symbol === undefined) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'UnknownName',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    out.push('(');\n    const args = t['params'].subs();\n    if (recv !== undefined) {\n      args.unshift(recv);\n    }\n    var funcType = symbol.ty;\n    if (!(funcType instanceof FuncType)) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'NotFunction',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    if (funcType.hasAlpha()) {\n      funcType = funcType.toVarType({ env, ref: t });\n      //console.log(funcType.toString());\n    }\n\n    for (var i = 0; i < args.length; i += 1) {\n      if (!(i < funcType.psize())) {\n        env.perror(args[i], {\n          type: 'warning',\n          key: 'TooManyArguments',\n          subject: args[i],\n        });\n        break;\n      }\n      if (i > 0) {\n        out.push(',');\n      }\n      const ty = funcType.ptype(i);\n      this.check(ty, env, args[i], out);\n    }\n    if (args.length < funcType.psize()) {\n      if (!funcType.ptype(args.length)) {\n        env.perror(\n          t['name'],\n          setpos(t.inputs, t['params'].epos, {\n            type: 'error',\n            key: 'RequiredArguments',\n          })\n        );\n      }\n    }\n    out.push(')');\n    env.foundFunc(t, symbol);\n    return funcType.rtype();\n  }\n\n  public MethodExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n    }\n    const methodname = `.${t.tokenize('name')}`;\n    const symbol = env.get(methodname);\n    return this.ApplySymbolExpr(env, t, symbol, t['recv'], out);\n  }\n\n  //\"[#SelfAssign left=[#Name 'a'] name=[# '+='] right=[#Int '1']]\"\n  public SelfAssign(env: Env, t: any, out: string[]) {\n    const tag = t['left'].tag;\n    t['left'].tag = `Set${tag}`;\n    this.conv(env, t['left'], out);\n    out.push(' = ');\n    t['left'].tag = tag;\n    this.Infix(env, t, out);\n    return tVoid;\n  }\n\n  public GetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      out.push(symbol.code);\n      return symbol.ty;\n    }\n    out.push('lib.get(');\n    this.check(tMatter, env, t['recv'], out);\n    const name = t.tokenize('name');\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    out.push(`,'${name}'${env.trace(t['name'])})`);\n    return ty;\n  }\n\n  public SetGetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: t.tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    const name = t.tokenize('name');\n    this.check(tMatter, env, t['recv'], out);\n    out.push(`.${name}`);\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    return ty instanceof UnionType ? ty.ptype(0) : ty;\n  }\n\n  public IndexExpr(env: Env, t: any, out: string[]) {\n    out.push('lib.index(');\n    const ty = this.check(\n      union(new ListType(new VarType(env, t)), tString),\n      env,\n      t['recv'],\n      out\n    );\n    out.push(',');\n    this.check(tInt, env, t['index'], out);\n    out.push(`${env.trace(t['index'])})`);\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public SetIndexExpr(env: Env, t: any, out: string[]) {\n    const ty = this.check(tListAny, env, t['recv'], out);\n    out.push('[');\n    this.check(tInt, env, t['index'], out);\n    out.push(']');\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public Data(env: Env, t: ParseTree, out: string[]) {\n    out.push('{');\n    for (const sub of FIXME_subs(t)) {\n      this.conv(env, sub, out);\n      out.push(',');\n    }\n    out.push('}');\n    return tOption;\n  }\n\n  public KeyValue(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    out.push(`'${name}': `);\n    const ty = (KEYTYPES as any)[name];\n    if (ty === undefined) {\n      env.perror(t['name'], {\n        type: 'warning',\n        key: 'UnknownName',\n        subject: name,\n      });\n      this.conv(env, t['value'], out);\n    } else {\n      this.check(ty, env, t['value'], out);\n    }\n    return tVoid;\n  }\n\n  public Tuple(env: Env, t: ParseTree, out: string[]) {\n    const subs = FIXME_subs(t);\n    if (subs.length > 2) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'ListSyntaxError', //[ ]\n      });\n      return this.List(env, t, out);\n    }\n    if (subs.length == 1) {\n      out.push('(');\n      const ty = this.conv(env, subs[0], out);\n      out.push(')');\n      return ty;\n    }\n    out.push('{ x: ');\n    this.check(tInt, env, subs[0], out);\n    out.push(', y: ');\n    this.check(tInt, env, subs[1], out);\n    out.push('}');\n    return tVec;\n  }\n\n  public List(env: Env, t: ParseTree, out: string[]) {\n    var ty = new VarType(env, t);\n    out.push('[');\n    for (const sub of FIXME_subs(t)) {\n      ty = this.check(ty, env, sub, out, {\n        type: 'error',\n        key: 'AllTypeAsSame', //\n      });\n      out.push(',');\n    }\n    out.push(']');\n    return new ListType(ty);\n  }\n\n  public Format(env: Env, t: ParseTree, out: string[]) {\n    var c = 0;\n    out.push('(');\n    for (const e of FIXME_subs(t)) {\n      if (c > 0) {\n        out.push('+');\n      }\n      if (e.tag === 'StringPart') {\n        out.push(`'${e.tokenize()}'`);\n      } else {\n        const out2: string[] = [];\n        const ty = this.conv(env, e, out2);\n        if (ty === tString) {\n          out.push(out2.join(''));\n        } else {\n          out.push(`lib.str(${out2.join('')})`);\n        }\n      }\n      c++;\n    }\n    out.push(')');\n    return tString;\n  }\n\n  public TrueExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('true');\n    return tBool;\n  }\n\n  public FalseExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('false');\n    return tBool;\n  }\n\n  public Int(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tInt;\n  }\n\n  public Float(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public Double(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public String(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public Char(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public MultiString(env: Env, t: ParseTree, out: string[]) {\n    out.push(JSON.stringify(JSON.parse(t.tokenize())));\n    return tString;\n  }\n}\n\nconst parser = generate('Source');\n\nconst transpile = (s: string) => {\n  const t = parser(s);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  //console.log('DEBUG: ERROR LOGS')\n  //console.log(JSON.stringify(env.get('@logs')));\n  console.log(env.get('@logs'));\n  return out.join('');\n};\n\nexport type Source = {\n  source: string;\n  lang?: string;\n};\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\nexport const compile = (s: Source): PuppyCode => {\n  //const start = performance.now();\n  const t = parser(s.source);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  const jscode = out.join('');\n  const main = `\nreturn {\n  main: async function*(puppy) {\n\\tconst lib = puppy.lib;\n\\tconst vars = puppy.vars;\n${jscode}\n  },\n}`;\n  var code: any = {};\n  try {\n    code = new Function(main)();\n  } catch (e) {\n    env.perror(t, {\n      type: 'error',\n      key: 'CompileError',\n      subject: e.toString(),\n    });\n  }\n  //const end = performance.now();\n  code['world'] = {};\n  code['tree'] = t; //\n  code['code'] = jscode;\n  code['errors'] = env.get('@logs');\n  //code['time'] = end - start;\n  return code as PuppyCode;\n};\n\nexport const utest = (s: string) => {\n  const src = { source: s };\n  const code = compile(src);\n  if (code.errors.length > 0) {\n    return code.errors[0].key;\n  }\n  const ss = code.code.split('\\n');\n  if (ss.length > 1) {\n    const s = ss[ss.length - 2].trim();\n    return s === '}' ? ss[ss.length - 3].trim() : s;\n  }\n  return '';\n};\n\n// console.log(transpile(`\n// '''\n// This is a apple.\n// I'm from Chiba.\n// '''\n// `));\n\nconsole.log(\n  transpile(`\nif True :\n  1\nelif True :\n  2\nelif True :\n  3\nelse :\n  4\n`)\n);\n\nconsole.log(\n  transpile(`\nfor x in range(1,2):\n  for y in range(x,2):\n    x+y\n`)\n);\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x*y;\n// `));\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x//y;\n// `));\n","import { setTheme, setCode, setMarker, setDecoration } from './editor';\nimport { CourseShape, setCourse, setContent, setCources } from './course';\nimport { setPuppy } from './puppy';\nimport { setPlaceholder, setShow } from './input';\nimport { PuppyCode, Puppy, runPuppy, ErrorLog } from '../vm/vm';\nimport store, { ReduxActions } from '../store';\nimport { compile } from '../puppy-transpiler/puppy';\n\nimport { Range } from 'monaco-editor';\n\nimport { PATH_PREFIX } from '../env';\n\nconst checkError = (\n  dispatch: (action: ReduxActions) => void,\n  code: PuppyCode\n) => {\n  let error_count = 0;\n  const annos: ErrorLog[] = [];\n  // editor.getSession().clearAnnotations();\n  for (const e of code.errors) {\n    if (e.type === 'error') {\n      error_count += 1;\n    }\n    // ignore info\n    if (e.type === 'info') {\n      continue;\n    }\n    annos.push(e);\n    // editor.getSession().setAnnotations(annos);\n  }\n  dispatch(setMarker(annos));\n  if (error_count === 0) {\n    dispatch(setTheme('vs'));\n    return false;\n  }\n  dispatch(setTheme('error'));\n  // editorPanel.style.backgroundColor = 'rgba(254,244,244,0.7)';\n  return true;\n};\n\nlet new_puppy: Puppy | null = null;\n\nexport const trancepile = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  source: string,\n  alwaysRun: boolean,\n  waitStart = false,\n  _isLive = false\n): Puppy | null => {\n  const code = compile({ source }) as PuppyCode; // Eval javascript code\n  console.log(code);\n  if (!checkError(dispatch, code)) {\n    // if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n    //   return puppy;\n    // }\n    if (new_puppy) {\n      new_puppy.dispose();\n    }\n    new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n    dispatch(setPuppy(new_puppy));\n  }\n  return new_puppy;\n};\n\n// export const trancepile = (dispatch: (action: ReduxActions) => void) => (\n//   puppy: Puppy | null,\n//   source: string,\n//   alwaysRun: boolean,\n//   waitStart = false,\n//   isLive = false\n// ): Promise<Puppy | null> =>\n//   fetch('/api/compile', {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/text; charset=utf-8',\n//     },\n//     body: source,\n//   })\n//     .then((res: Response) => {\n//       if (res.ok) {\n//         return res.text();\n//       }\n//       throw new Error(res.statusText);\n//     })\n//     .then((js: string) => {\n//       try {\n//         const code = Function(js)(); // Eval javascript code\n//         if (!checkError(dispatch, code)) {\n//           if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n//             return puppy;\n//           }\n//           if (new_puppy) {\n//             new_puppy.dispose();\n//           }\n//           new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n//           dispatch(setPuppy(new_puppy));\n//         }\n//         return new_puppy;\n//       } catch (e) {\n//         // alert(` ${e}`);\n//         // editorPanel.style.backgroundColor = 'rgba(244,244,254,0.7)';\n//         console.log(js);\n//         console.log(`FAIL TO TRANSCOMPILE ${e}`);\n//         console.log(e);\n//         return null;\n//       }\n//     })\n//     .catch((msg: string) => {\n//       alert(`Puppy is down!! ${msg}`);\n//       return null;\n//     });\n\nconst loadFile: (path: string) => Promise<string> = path => {\n  return fetch(path, {\n    method: 'GET',\n  })\n    .then((res: Response) => {\n      if (res.ok) {\n        return res.text();\n      }\n      throw new Error(res.statusText);\n    })\n    .then((sample: string) => {\n      return sample;\n    });\n};\n\nexport const fetchSetting = (dispatch: (action: ReduxActions) => void) => (\n  path: string\n): Promise<void> =>\n  loadFile(`${PATH_PREFIX}/course/${path}/setting.json`)\n    .then((s: string) => {\n      return JSON.parse(s);\n    })\n    .then((course: CourseShape) => {\n      dispatch(setCourse(course));\n    })\n    .catch((msg: string) => {\n      console.log(`ERR ${msg}`);\n    });\n\nexport const fetchContent = (dispatch: (action: ReduxActions) => void) => (\n  coursePath: string,\n  path: string\n): Promise<void> =>\n  loadFile(`${PATH_PREFIX}/course/${coursePath}/${path}/index.md`).then(\n    (content: string) => dispatch(setContent(content))\n  );\n\nexport const fetchSample = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  coursePath: string,\n  page: number,\n  path: string\n): void => {\n  const sample = window.sessionStorage.getItem(\n    `${PATH_PREFIX}/course/${coursePath}/${path}/sample.py`\n  );\n  if (sample) {\n    dispatch(setCode(sample));\n    trancepile(dispatch)(puppy, sample, false);\n  } else {\n    loadFile(`${PATH_PREFIX}/course/${coursePath}/${path}/sample.py`).then(\n      (sample: string) => {\n        dispatch(setCode(sample));\n        trancepile(dispatch)(puppy, sample, false);\n      }\n    );\n  }\n};\n\nexport const getInputValue = async (msg: string) => {\n  const awaitForClick = target => {\n    return new Promise(resolve => {\n      target.addEventListener('submit', resolve, { once: true });\n    });\n  };\n  store.dispatch(setShow(true));\n  store.dispatch(setPlaceholder(msg));\n  await awaitForClick(document.getElementById('puppy-input-form'));\n  return store.getState().input.value;\n};\n\nexport const getIsLive = () => store.getState().puppy.isLive;\n\nexport const getDiffStartLineNumber = () => {\n  const num = store.getState().editor.diffStartLineNumber;\n  return num === null ? 0 : num;\n};\n\nexport const setCodeHighlight = (startLineNum: number, endLineNum: number) => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(\n    setDecoration(\n      codeEditor.deltaDecorations(decoration, [\n        {\n          range: new Range(startLineNum, 1, endLineNum, 1),\n          options: { isWholeLine: true, className: 'code-highlight' },\n        },\n      ])\n    )\n  );\n};\n\nexport const resetCodeHighlight = () => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(setDecoration(codeEditor.deltaDecorations(decoration, [])));\n};\n\nexport const fetchCourses = (\n  dispatch: (action: ReduxActions) => void\n) => (): void => {\n  const courses: { [path: string]: CourseShape } = {};\n  const get_course: Promise<void>[] = [];\n  ['Puppy', 'PuppyCourse', 'LIVE2019'].forEach(path => {\n    get_course.push(\n      loadFile(`${PATH_PREFIX}/course/${path}/setting.json`)\n        .then((s: string) => {\n          return JSON.parse(s);\n        })\n        .then((course: CourseShape) => {\n          courses[path] = course;\n        })\n    );\n  });\n  Promise.all(get_course).then(() => dispatch(setCources(courses)));\n  // fetch('/api/courses')\n  //   .then((res: Response) => {\n  //     if (res.ok) {\n  //       return res.json();\n  //     }\n  //     throw new Error(res.statusText);\n  //   })\n  //   .then((json: { [path: string]: CourseShape }) => {\n  //     dispatch(setCources(json));\n  //   });\n};\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Header from '../components/Header/Header';\nimport { fetchCourses } from '../modules/operations';\nimport { setShow } from '../modules/version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  course: state.course.course,\n  courses: state.course.courses,\n});\n\nconst mapDispatchToProps = (dispathch: (action: ReduxActions) => void) => ({\n  fetchCourses: fetchCourses(dispathch),\n  setShow: (show: boolean) => dispathch(setShow(show)),\n});\n\nconst HeaderContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Header);\n\nexport default HeaderContainer;\n","import React, { useEffect } from 'react';\nimport MonacoEditor from 'react-monaco-editor';\nimport * as monacoEditor from 'monaco-editor';\nimport './Editor.css';\nimport { Puppy } from '../../vm/vm';\n\nimport { Button, Spinner } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faMinus, faPlay } from '@fortawesome/free-solid-svg-icons';\n\nimport { CodeEditor } from '../../modules/editor';\n\nmonacoEditor.editor.defineTheme('error', {\n  base: 'vs',\n  inherit: true,\n  rules: [],\n  colors: {\n    'editor.background': '#ffEEEE',\n  },\n});\n\nmonacoEditor.languages.registerCompletionItemProvider('python', {\n  provideCompletionItems: (\n    model: monacoEditor.editor.ITextModel,\n    position: monacoEditor.Position,\n    context: monacoEditor.languages.CompletionContext,\n    _token\n  ) => {\n    const wordInfo = model.getWordUntilPosition(position);\n    const range = new monacoEditor.Range(\n      position.lineNumber,\n      wordInfo.startColumn,\n      position.lineNumber,\n      wordInfo.endColumn\n    );\n    const math = [\n      'pi',\n      'sin',\n      'cos',\n      'tan',\n      'sqrt',\n      'log',\n      'log10',\n      'pow',\n      'hypot',\n      'gcd',\n    ];\n    const python = ['input', 'print', 'len', 'range', 'int', 'float', 'str'];\n    const random = ['random'];\n    const matter = ['World', 'Circle', 'Rectangle', 'Polygon', 'Label'];\n    const parameters = [\n      'width',\n      'height',\n      'isStatic',\n      'restitution',\n      'fillStyle',\n      'image',\n      'strokeStyle',\n      'lineWidth',\n    ];\n\n    const suggestions: monacoEditor.languages.CompletionItem[] = [];\n\n    math.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    python.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    random.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    matter.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Constructor,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    parameters.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Property,\n        insertText: `${label}=`,\n        range,\n      });\n    });\n    return { suggestions: suggestions };\n  },\n});\n\nconst zenkaku =\n  '[' +\n  '' +\n  '' +\n  '' +\n  ']';\n\ntype EditorFooterProps = {\n  setFontSize: (fontSize: number) => void;\n  fontSize: number;\n  setIsLive: (isLive: boolean) => void;\n  isLive: boolean;\n};\n\nconst EditorFooter: React.FC<EditorFooterProps> = (\n  props: EditorFooterProps\n) => {\n  const fontPlus = () => {\n    props.setFontSize(props.fontSize + 3);\n  };\n  const fontMinus = () => {\n    props.setFontSize(Math.max(12, props.fontSize - 3));\n  };\n  return (\n    <div id=\"editor-footer\">\n      <Button onClick={() => props.setIsLive(!props.isLive)}>\n        {props.isLive ? (\n          <Spinner animation=\"grow\" variant=\"light\" size=\"sm\" />\n        ) : (\n          <FontAwesomeIcon icon={faPlay} />\n        )}\n        {' LIVE'}\n      </Button>\n      <Button onClick={fontPlus}>\n        <FontAwesomeIcon icon={faPlus} />\n      </Button>\n      <Button onClick={fontMinus}>\n        <FontAwesomeIcon icon={faMinus} />\n      </Button>\n    </div>\n  );\n};\n\nexport type EditorProps = {\n  width: number;\n  height: number;\n  codeEditor: CodeEditor | null;\n  decoration: string[];\n  fontSize: number;\n  theme: string;\n  code: string;\n  diffStartLineNumber: number | null;\n  puppy: Puppy | null;\n  isLive: boolean;\n  coursePath: string;\n  page: number;\n  setCode: (code: string) => void;\n  setSize: (width: number, height: number) => void;\n  setCodeEditor: (codeEditor: CodeEditor | null) => void;\n  setDecoration: (decoration: string[]) => void;\n  setFontSize: (fontSize: number) => void;\n  setDiffStartLineNumber: (startLineNumber: number | null) => void;\n  setIsLive: (isLive: boolean) => void;\n  trancepile: (\n    puppy: Puppy | null,\n    code: string,\n    alwaysRun: boolean,\n    waitStart?: boolean,\n    isLive?: boolean\n  ) => Puppy | null;\n};\n\nlet resizeTimer: NodeJS.Timeout;\nlet trancepileTimer: NodeJS.Timeout | null;\nlet startTimer: NodeJS.Timeout | null;\n\nconst Editor: React.FC<EditorProps> = (props: EditorProps) => {\n  const editorOptions = {\n    selectOnLineNumbers: true,\n    fontSize: props.fontSize,\n    wordWrap: 'on' as 'on',\n  };\n\n  addEventListener('resize', () => {\n    clearTimeout(resizeTimer!);\n    resizeTimer = setTimeout(function() {\n      props.setSize(\n        document.getElementById('right-col')!.clientWidth,\n        document.getElementById('right-col')!.clientHeight\n      );\n    }, 300);\n  });\n\n  useEffect(() => {\n    props.setSize(\n      document.getElementById('right-col')!.clientWidth,\n      document.getElementById('right-col')!.clientHeight\n    );\n  }, []);\n\n  const checkZenkaku = (codeEditor: CodeEditor) => {\n    const zenkakuRanges = codeEditor\n      .getModel()!\n      .findMatches(zenkaku, true, true, false, null, false);\n    const decos: monacoEditor.editor.IModelDeltaDecoration[] = zenkakuRanges.map(\n      (match: monacoEditor.editor.FindMatch) => ({\n        range: match.range,\n        options: { inlineClassName: 'zenkakuClass' },\n      })\n    );\n    props.setDecoration(codeEditor.deltaDecorations(props.decoration, decos));\n  };\n\n  const codeOnChange = (\n    new_code: string,\n    event: monacoEditor.editor.IModelContentChangedEvent\n  ) => {\n    let startNumber = props.diffStartLineNumber;\n    event.changes.map(change => {\n      startNumber =\n        startNumber === null\n          ? change.range.startLineNumber\n          : Math.min(startNumber, change.range.startLineNumber);\n    });\n    if (startNumber !== null) {\n      props.setDiffStartLineNumber(startNumber);\n    }\n    props.setCode(new_code);\n    if (props.codeEditor) {\n      checkZenkaku(props.codeEditor);\n    }\n    if (props.isLive) {\n      if (trancepileTimer) {\n        clearTimeout(trancepileTimer);\n        trancepileTimer = null;\n      }\n      // trancepileTimer = setTimeout(() => {\n      //   props.trancepile(props.puppy, new_code, false);\n      //   window.sessionStorage.setItem(\n      //     `/api/sample/${props.coursePath}/${props.page}`,\n      //     new_code\n      //   );\n      // }, 1500);\n      trancepileTimer = setTimeout(() => {\n        (puppy => {\n          if (startTimer) {\n            clearTimeout(startTimer);\n            startTimer = null;\n          }\n          startTimer = setTimeout(() => {\n            if (puppy) {\n              puppy.start();\n            }\n            props.setDiffStartLineNumber(null);\n          }, 1500);\n        })(props.trancepile(props.puppy, new_code, false, true, true));\n        window.sessionStorage.setItem(\n          `/api/sample/${props.coursePath}/${props.page}`,\n          new_code\n        );\n      }, 100);\n    }\n  };\n  const hoge: string = 'piyo';\n\n  hoge.startsWith('hoge');\n\n  const editorDidMount = (editor: CodeEditor) => {\n    props.setCodeEditor(editor);\n  };\n\n  return (\n    <div id=\"puppy-editor\">\n      <MonacoEditor\n        width={props.width}\n        height={props.height}\n        language=\"python\"\n        theme={props.theme}\n        value={props.code}\n        options={editorOptions}\n        onChange={codeOnChange}\n        editorDidMount={editorDidMount}\n      />\n      <EditorFooter\n        setFontSize={props.setFontSize}\n        fontSize={props.fontSize}\n        setIsLive={props.setIsLive}\n        isLive={props.isLive}\n      />\n    </div>\n  );\n};\n\nexport default Editor;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Editor from '../components/Editor/Editor';\nimport { trancepile } from '../modules/operations';\nimport {\n  setCode,\n  setSize,\n  setCodeEditor,\n  setDecoration,\n  setFontSize,\n  setDiffStartLineNumber,\n  CodeEditor,\n} from '../modules/editor';\nimport { setIsLive } from '../modules/puppy';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  width: state.editor.width,\n  height: state.editor.height,\n  codeEditor: state.editor.codeEditor,\n  decoration: state.editor.decoration,\n  theme: state.editor.theme,\n  fontSize: state.editor.fontSize,\n  code: state.editor.code,\n  diffStartLineNumber: state.editor.diffStartLineNumber,\n  puppy: state.puppy.puppy,\n  isLive: state.puppy.isLive,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setCode: (code: string) => dispatch(setCode(code)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  setCodeEditor: (codeEditor: CodeEditor | null) =>\n    dispatch(setCodeEditor(codeEditor)),\n  setDecoration: (decoration: string[]) => dispatch(setDecoration(decoration)),\n  setFontSize: (fontSize: number) => dispatch(setFontSize(fontSize)),\n  setDiffStartLineNumber: (LineNumber: number | null) =>\n    dispatch(setDiffStartLineNumber(LineNumber)),\n  setIsLive: (isLive: boolean) => dispatch(setIsLive(isLive)),\n  trancepile: trancepile(dispatch),\n});\n\nexport const EditorContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Editor);\n\nexport default EditorContainer;\n","import React from 'react';\nimport { Puppy } from '../../vm/vm';\nimport { Button } from 'react-bootstrap';\nimport './PuppyScreen.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faPlay,\n  faExpand,\n  faBookOpen,\n  faBook,\n} from '@fortawesome/free-solid-svg-icons';\n\ntype PuppyFooterProps = {\n  isCourseVisible: boolean;\n  setIsCourseVisible: (visible: boolean) => void;\n  code: string;\n  puppy: Puppy | null;\n  trancepile: (puppy: Puppy | null, code: string, alwaysRun: boolean) => void;\n};\n\nconst PuppyFooter: React.FC<PuppyFooterProps> = (props: PuppyFooterProps) => {\n  const fullscreen = () => {\n    if (props.puppy != null) {\n      const canvas = props.puppy.getCanvas();\n      if (canvas) {\n        // FIXME\n        if (canvas['webkitRequestFullscreen']) {\n          canvas['webkitRequestFullscreen'](); // Chrome15+, Safari5.1+, Opera15+\n        } else if (canvas['mozRequestFullScreen']) {\n          canvas['mozRequestFullScreen'](); // FF10+\n        } else if (canvas['msRequestFullscreen']) {\n          canvas['msRequestFullscreen'](); // IE11+\n        } else if (canvas['requestFullscreen']) {\n          canvas['requestFullscreen'](); // HTML5 Fullscreen API\n        } else {\n          // alert('');\n          return;\n        }\n      }\n    }\n  };\n  return (\n    <div id=\"puppy-footer\">\n      <Button onClick={() => props.trancepile(props.puppy, props.code, true)}>\n        <FontAwesomeIcon icon={faPlay} />\n        {' Play'}\n      </Button>\n      <Button onClick={fullscreen}>\n        <FontAwesomeIcon icon={faExpand} />\n      </Button>\n      <Button onClick={() => props.setIsCourseVisible(!props.isCourseVisible)}>\n        <FontAwesomeIcon icon={props.isCourseVisible ? faBookOpen : faBook} />\n      </Button>\n    </div>\n  );\n};\n\nexport type PuppyScreenProps = PuppyFooterProps & {\n  setSize: (width: number, height: number) => void;\n};\n\nlet timer: NodeJS.Timeout | null = null;\n\nconst PuppyScreen: React.FC<PuppyScreenProps> = (props: PuppyScreenProps) => {\n  addEventListener('resize', () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    timer = setTimeout(function() {\n      const w = document.getElementById('puppy-screen')!.clientWidth;\n      const h = document.getElementById('puppy-screen')!.clientHeight;\n      props.setSize(w, h);\n    }, 300);\n  });\n\n  return (\n    <>\n      <div id=\"puppy-screen\"></div>\n      <PuppyFooter\n        isCourseVisible={props.isCourseVisible}\n        setIsCourseVisible={props.setIsCourseVisible}\n        code={props.code}\n        puppy={props.puppy}\n        trancepile={props.trancepile}\n      />\n    </>\n  );\n};\n\nexport default PuppyScreen;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setVisible } from '../modules/course';\nimport { setSize } from '../modules/puppy';\nimport { trancepile } from '../modules/operations';\nimport PuppyScreen from '../components/PuppyScreen/PuppyScreen';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  isCourseVisible: state.course.visible,\n  code: state.editor.code,\n  puppy: state.puppy.puppy,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setIsCourseVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  trancepile: trancepile(dispatch),\n});\n\nconst PuppyScreenContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PuppyScreen);\n\nexport default PuppyScreenContainer;\n","import React, { useEffect } from 'react';\nimport * as marked from 'marked';\nimport { Card, Col, Row } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChevronRight,\n  faChevronLeft,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { Puppy } from '../../vm/vm';\n\nimport { CourseShape } from '../../modules/course';\n\nimport './Course.css';\nimport './github-markdown.css';\n\ntype CourseProps = {\n  course: CourseShape;\n  coursePath: string;\n  puppy: Puppy | null;\n  page: number;\n  content: string;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n  setCode: (code: string) => void;\n  setContent: (content: string) => void;\n  setCourse: (course: CourseShape) => void;\n  fetchContent: (coursePath: string, path: string) => void;\n  fetchSample: (\n    puppy: Puppy | null,\n    coursePath: string,\n    page: number,\n    path: string\n  ) => void;\n  fetchSetting: (coursePath: string) => void;\n};\n\nconst Course: React.FC<CourseProps> = (props: CourseProps) => {\n  useEffect(() => {\n    if (props.course.list.length !== 0) {\n      props.fetchContent(props.coursePath, props.course.list[props.page].path);\n      props.fetchSample(\n        props.puppy,\n        props.coursePath,\n        props.page,\n        props.course.list[props.page].path\n      );\n    }\n  }, [props.page, props.coursePath, props.course]);\n\n  useEffect(() => {\n    props.fetchSetting(props.coursePath);\n  }, [props.coursePath]);\n\n  return (\n    <div\n      id=\"puppy-course\"\n      style={{ visibility: props.visible ? 'visible' : 'hidden' }}\n    >\n      <Card className=\"course-all\">\n        <Card.Header className=\"course-header\">\n          <Row>\n            <button\n              className=\"close-button\"\n              onClick={() => props.setVisible(false)}\n            >\n              <FontAwesomeIcon icon={faTimes} />\n            </button>\n          </Row>\n          <Row>\n            <Col className=\"card-header-left\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== 0 ? (\n                <a href={`#${props.page - 1}`}>\n                  <FontAwesomeIcon icon={faChevronLeft} />\n                  {` ${props.course.list[props.page - 1].title}`}\n                </a>\n              ) : null}\n            </Col>\n            <Col className=\"card-header-right\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== props.course.list.length - 1 ? (\n                <a href={`#${props.page + 1}`}>\n                  {`${props.course.list[props.page + 1].title} `}\n                  <FontAwesomeIcon icon={faChevronRight} />\n                </a>\n              ) : null}\n            </Col>\n          </Row>\n        </Card.Header>\n        <Card.Body className=\"course-body\">\n          <div\n            className=\"markdown-body\"\n            dangerouslySetInnerHTML={{\n              __html: marked(props.content),\n            }}\n          ></div>\n        </Card.Body>\n      </Card>\n    </div>\n  );\n};\n\nexport default Course;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Course from '../components/Course/Course';\nimport {\n  setContent,\n  setCourse,\n  CourseShape,\n  setVisible,\n} from '../modules/course';\nimport { setCode } from '../modules/editor';\nimport { fetchContent, fetchSample, fetchSetting } from '../modules/operations';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  course: state.course.course,\n  puppy: state.puppy.puppy,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n  content: state.course.content,\n  visible: state.course.visible,\n});\n\nconst mapDispathToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setContent: (content: string) => dispatch(setContent(content)),\n  setCourse: (course: CourseShape) => dispatch(setCourse(course)),\n  setCode: (code: string) => dispatch(setCode(code)),\n  setVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  fetchContent: fetchContent(dispatch),\n  fetchSample: fetchSample(dispatch),\n  fetchSetting: fetchSetting(dispatch),\n});\n\nconst CourseContainer = connect(\n  mapStateToProps,\n  mapDispathToProps\n)(Course);\n\nexport default CourseContainer;\n","import React from 'react';\nimport { Modal, Button, InputGroup, FormControl, Form } from 'react-bootstrap';\n\nexport type InputState = {\n  show: boolean;\n  value: string;\n  placeholder: string;\n};\n\nexport type InputHandler = {\n  setShow: (show: boolean) => void;\n  setValue: (value: string) => void;\n};\n\nexport type InputProps = InputState & InputHandler;\n\nconst Input: React.FC<InputProps> = (props: InputProps) => {\n  return (\n    <Modal size=\"lg\" show={props.show} centered>\n      <Modal.Body>\n        <Form id=\"puppy-input-form\" onSubmit={() => props.setShow(false)}>\n          <InputGroup className=\"mb-3\">\n            <FormControl\n              placeholder={props.placeholder}\n              value={props.value}\n              onChange={e => props.setValue(e.target.value)}\n            />\n            <InputGroup.Append>\n              <Button type=\"submit\"></Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Input;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow, setValue } from '../modules/input';\nimport Input, { InputState, InputHandler } from '../components/Input/Input';\n\nconst mapStateToProps = (state: ReduxState): InputState => ({\n  show: state.input.show,\n  value: state.input.value,\n  placeholder: state.input.placeholder,\n});\n\nconst mapDispatchToProps = (\n  dispatch: (action: ReduxActions) => void\n): InputHandler => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n  setValue: (value: string) => dispatch(setValue(value)),\n});\n\nconst InputContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Input);\n\nexport default InputContainer;\n","import React from 'react';\nimport { Modal, Button } from 'react-bootstrap';\n\ntype VersionProps = {\n  show: boolean;\n  setShow: (show: boolean) => void;\n};\n\nconst Version: React.FC<VersionProps> = (props: VersionProps) => {\n  return (\n    <>\n      <Modal show={props.show} onHide={() => props.setShow(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Modal heading</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {\"Woohoo, you're reading this text in a modal!\"}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => props.setShow(false)}>\n            Close\n          </Button>\n          <Button variant=\"primary\" onClick={() => props.setShow(false)}>\n            Save Changes\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\n// render(<Example />);\n\nexport default Version;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow } from '../modules/version';\nimport Version from '../components/Version/Version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  show: state.version.show,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n});\n\nconst VersionContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Version);\n\nexport default VersionContainer;\n","import React from 'react';\nimport './App.css';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport Header from './containers/Header';\nimport Editor from './containers/Editor';\nimport PuppyScreen from './containers/PuppyScreen';\nimport Course from './containers/Course';\nimport Input from './containers/Input';\nimport Version from './containers/Version';\nimport { QueryParams } from './index';\n\ntype AppProps = { qs: QueryParams; hash: string };\n\nconst App: React.FC<AppProps> = (props: AppProps) => {\n  const coursePath = props.qs.course ? props.qs.course : 'LIVE2019';\n  const page = props.hash !== '' ? parseInt(props.hash.substr(1)) : 0;\n  return (\n    <div className=\"App\">\n      <Container className=\"container\">\n        <Header />\n        <Input />\n        <Version />\n        <Row id=\"main-row\">\n          <Col id=\"left-col\" xs={6}>\n            <Course coursePath={coursePath} page={page} />\n            <PuppyScreen />\n          </Col>\n          <Col id=\"right-col\" xs={6}>\n            <Editor coursePath={coursePath} page={page} />\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { store } from './store';\n\nexport type QueryParams = {\n  course?: string;\n};\n\nconst queryParser = (query: string) =>\n  query\n    .substr(1)\n    .split('&')\n    .reduce((obj, v) => {\n      const pair = v.split('=');\n      obj[pair[0]] = pair[1];\n      return obj;\n    }, {});\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <Route\n        render={props => (\n          <App\n            qs={queryParser(props.location.search)}\n            hash={props.location.hash}\n          />\n        )}\n      />\n    </Router>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}