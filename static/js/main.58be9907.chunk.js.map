{"version":3,"sources":["modules/editor.ts","components/Header/Header.tsx","modules/course.ts","modules/puppy.ts","modules/input.ts","modules/version.ts","vm/shape.ts","vm/color.ts","vm/vm.ts","vm/render.ts","store.ts","puppy-transpiler/puppy-parser.ts","puppy-transpiler/puppy.ts","modules/operations.ts","containers/Header.ts","components/Editor/Editor.tsx","containers/Editor.ts","components/PuppyScreen/PuppyScreen.tsx","containers/PuppyScreen.ts","components/Course/Course.tsx","containers/Course.ts","components/Input/Input.tsx","containers/Input.ts","components/Version/Version.tsx","containers/Version.ts","App.tsx","index.tsx"],"names":["EditorActionTypes","Header","props","useEffect","fetchCourses","react_default","a","createElement","className","id","Navbar","bg","variant","expand","Brand","onClick","setShow","src","width","height","Nav","NavDropdown","title","course","Object","keys","courses","map","course_path","concat","drop","key","list","page","i","Item","href","CourseActionTypes","setCode","code","type","SET_CODE","payload","setDecoration","decoration","SET_DECORATION","type2severity","monacoEditor","Error","Info","Warning","Hint","setTheme","theme","SET_THEME","initialState","codeEditor","fontSize","markers","diffStartLineNumber","editorReducer","state","arguments","length","undefined","action","SET_SIZE","_objectSpread","SET_CODEEDITOR","SET_FONTSIZE","value","SET_MARKER","setModelMarkers","getModel","SET_DIFFSTARTLINENUMBER","startLineNumber","PuppyActionTypes","setContent","content","SET_CONTENT","setCourse","SET_COURSE","setVisible","visible","SET_VISIBLE","coursePath","courseReducer","course_objectSpread","SET_COURSES","InputActionTypes","puppy","isLive","puppyReducer","resize","puppy_objectSpread","SET_PUPPY","SET_ISLIVE","VersionActionTypes","show","SET_SHOW","placeholder","InputReducer","SET_VALUE","input_objectSpread","SET_PLACEHOLDER","Bodies","Matter","Composite","Common","PropertyMap","radius","options","base","fillStyle","color","Array","isArray","choose","world","colorScheme","convColor","setShapeProperty","checkShapeProperty","circle","assign","position","x","y","rectangle","isStatic","polygon","sides","label","isSensor","collisionFilter","category","mask","group","created","getTimeStamp","pendulum","column","viewWidth","size","xx","yy","newtonsCradle","create","_options","inertia","interia","Infinity","restitution","friction","frictionAir","slop","constraint","pointA","bodyB","render","lineWidth","strokeStyle","console","log","PuppyColorScheme","pop","cute","dynamic","gorgeous","casual","psychedelic","bright","fairytale","heavy","impact","street","cool","elegant","fresh","warm","soft","man","woman","boy","girl","smart","light","stylish","natural","spring","summer","fall","winter","japan","euro","nordic","asian","chooseColorScheme","cs","targets","document","getElementsByClassName","style","backgroundColor","borderColor","Engine","Runner","Render","_getTexture","imagePath","image","textures","Image","startsWith","bodies","context","c","showInternalEdges","wireframes","defaultFont","font","defaultFontColor","fontColor","body","k","parts","part","opacity","globalAlpha","texture","translate","rotate","angle","drawImage","circleRadius","beginPath","arc","Math","PI","moveTo","vertices","j","isInternal","lineTo","closePath","stroke","fill","ref","save","textAlign","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","fillText","restore","myRender","Constraint","MouseConstraint","Mouse","World","Bounds","Vertices","Detector","Puppy","settings","_this","this","waitStart","classCallCheck","interval","waitRestart","isExecuting","runner","engine","canvas","vars","new_","cons","add","Circle","Rectangle","Polygon","Label","viewHeight","pos","view","min","max","createClass","vwidth","vheight","background","gravity","density","airFriction","frictionStatic","motion","_this2","window","addEventListener","event","orientation","clamp","gamma","beta","on","time","timing","timestamp","eachUpdate","allBodies","pairs","pair","bodyA","isFixed","getElementById","render_width","clientWidth","render_height","clientHeight","element","mouse","constraintOptions","pointB","stiffness","mouseConstraint","sourcebody","contains","bounds","canCollide","Drop","Pendulum","run","clear","stop","remove","w","h","setAttribute","toString","_wait","asyncToGenerator","regenerator_default","mark","_callee","msec","wrap","_context","prev","next","Promise","resolve","setTimeout","_x2","apply","_waitForRun","_callee2","_context2","wait","enabled","_x3","_execute_main","_callee3","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","_value","lineNumber","_context3","getDiffStartLineNumber","asyncIterator","main","sent","done","getIsLive","delta","update","setCodeHighlight","waitForRun","t0","return","finish","resetCodeHighlight","initCode","dispose","startCode","execute_main","n","lines","_input","_callee4","msg","_context4","getInputValue","abrupt","_x4","_input2","_callee6","awaitForClick","text","f","_context6","target","listener","once","_ref","_callee5","Text","_context5","querySelector","onclick","display","_x5","_this3","extend","shape","move","px","setPosition","random","s","indexOf","Number","parseInt","parseFloat","_this4","str","join","z","start","end","step","xs","push","index","charAt","substr","slice","sub","func","lst","from","fx","fy","applyForce","_x","_y","sx","sy","scale","setAngle","setVelocity","velocity","setAngularVelocity","setDensity","mass","setMass","flag","setStatic","puppy_settings","ftrace","_log","SET_VERSION_SHOW","VersionReducer","version_objectSpread","allReducers","combineReducers","editor","input","version","store","createStore","ParseTree","tag","spos","epos","child","urn","inputs","nodes","empties","entry","edge","setup","reverse","subs","defstr","substring","tokenize","row","col","charCodeAt","sb","strOut","Symbol","iterator","node","err","Merge","ParserContext","head_pos","ast","memos","Memo","ANY","pAny","pChar","text_length","set_bitmap","bitmap","pRange","chars","ranges","codemax","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","range","find_codemax","Uint8Array","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","pMany","match","pMany1","pAnd","pNot","pOption","pSeq","_len","matches","_key","_i","_matches","pSeq2","match2","pSeq3","match3","pOre","_len2","_key2","_i2","_matches2","pOre2","pRef","peg","name","pNode","shift","pEdge","pFold","State","sid","getstate","pMatch","generate","grammar","res","pScope","INDENT","Type","isOptional","ty","BaseType","possibleConstructorReturn","getPrototypeOf","call","v","realType","VarType","must","hasAlpha","env","t","VoidType","AnyType","FuncType","types","ss","psize","accept","puppy_Symbol","isPattern","toVarType","construct","ListType","param","p","tAny","UnionType","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","ts","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","union","_len3","_key3","tVoid","tBool","tInt","tInt_","tFloat","tString","tString_","tA","tListA","tListInt","tListAny","tMatter","tVec","EmptyNumberSet","_this5","varMap","varid","getroot","v1","u","b","A","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","unionSet","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","OptionType","_this6","JSON","stringify","isMatter","isMutable","tColor","tOption","tFuncFloatFloat","tFuncFloatFloatFloat","tFuncShape","import_math","pi","sin","cos","tan","sqrt","log10","pow","hypot","gcd","import_python","print","len",".append","int","float","modules","math","matterjs",".setPosition",".applyForce",".rotate",".scale",".setAngle",".setAngularVelocity",".setDensity",".setMass",".setStatic",".setVelocity","symbolPackageMap","_Object$keys","pkgname","_Object$keys2","checkSymbolNames","KEYTYPES","area","torque","damping","in","out","over","clicked","message","tCompr","opset","and","or","not","+=","-=","*=","//=","/=","<<=",">>=","|=","&=","^=","tleftMap","+","-","**","*","/","//","%","==","!=","<","<=",">",">=","^","|","&","<<",">>","setpos","elog","r","Env","root","parent","e","get","pkg","_i3","_Object$keys3","set","logs","begin","trace","data","symbol","setroot","isUtf8Name","local","vname","inFunc","inLoop","yieldparam","PuppyError","FIXME_subs","Transpiler","perror","subject","skip","req","conv","request","given","op","ty1","left","ty2","right","from_import","alias","setModule","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","_iterator12","subtree","out2","emitAutoYield","penv","indent","nested","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_step13","_iterator13","check","_iteratorNormalCompletion14","_didIteratorError14","_iteratorError14","_step14","_iterator14","stmt","lenv","setInLoop","declVar","names","funcData","setFunc","hasReturn","_iteratorNormalCompletion15","_didIteratorError15","_iteratorError15","_step15","_iterator15","pname","ptype","funcType","defun","isGlobal","_iteratorNormalCompletion16","_didIteratorError16","_iteratorError16","_step16","_iterator16","out1","qual","op2","operator","tleft","tright","checkBinary","ApplySymbolExpr","recv","args","unshift","foundFunc","rtype","isModule","getModule","methodname","Infix","_iteratorNormalCompletion17","_didIteratorError17","_iteratorError17","_step17","_iterator17","List","_iteratorNormalCompletion18","_didIteratorError18","_iteratorError18","_step18","_iterator18","_iteratorNormalCompletion19","_didIteratorError19","_iteratorError19","_step19","_iterator19","parse","parser","transpile","compile","source","jscode","Function","checkError","dispatch","error_count","annos","errors","marker","severity","startColumn","endLineNumber","endColumn","new_puppy","trancepile","alwaysRun","isRunning","newpuppy","runCode","runPuppy","setPuppy","loadFile","path","fetch","method","then","ok","statusText","sample","fetchSetting","catch","fetchContent","fetchSample","sessionStorage","getItem","getState","num","startLineNum","endLineNum","deltaDecorations","Range","isWholeLine","get_course","forEach","all","setCources","HeaderContainer","connect","dispathch","defineTheme","inherit","rules","colors","editor.background","resizeTimer","trancepileTimer","startTimer","EditorFooter","Button","setIsLive","Spinner","animation","index_es","icon","faPlay","setFontSize","faPlus","faMinus","Editor","editorOptions","selectOnLineNumbers","wordWrap","clearTimeout","setSize","lib_default","language","onChange","new_code","startNumber","changes","change","setDiffStartLineNumber","decos","findMatches","inlineClassName","checkZenkaku","setItem","editorDidMount","setCodeEditor","Editor_EditorFooter","EditorContainer","ownProps","LineNumber","PuppyFooter","getCanvas","faExpand","setIsCourseVisible","isCourseVisible","faBook","faBookOpen","timer","PuppyScreen","Fragment","PuppyScreen_PuppyFooter","PuppyScreenContainer","Course","visibility","Card","Row","faTimes","Col","faChevronLeft","faChevronRight","Body","dangerouslySetInnerHTML","__html","marked","CourseContainer","Input","Modal","centered","Form","onSubmit","InputGroup","FormControl","setValue","Append","InputContainer","Version","onHide","closeButton","Title","Footer","VersionContainer","App","qs","hash","Container","containers_Header","containers_Input","containers_Version","containers_Course","containers_PuppyScreen","containers_Editor","ReactDOM","es","react_router_dom","react_router","src_App_0","query","location","search","split","reduce","obj"],"mappings":"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,CACfjE,SAAS,EACT8B,UAAWL,GAAOS,OAAO3B,EAAM4B,MAAOC,aACtC8B,QAAStC,EAAQuC,SAAWC,IAC5BC,YAAazC,EAAQyC,aAAe,EACpCC,SAAU1C,EAAQ0C,UAAY,EAC9BC,YAAa3C,EAAQ2C,aAAe,KACpCC,KAAM5C,EAAQ4C,MAAQ,GAElBhC,EAASjB,SAAciB,OAC3BqB,EAAK9G,GA/BU,IA+BL6G,GACVE,EAAK9H,EACL4H,EACAK,GAEIQ,EAAalD,aAAkByC,OAAO,CAC1CU,OAAQ,CACN/B,EAAGkB,EAAK9G,GAtCK,IAsCA6G,GACbhB,EAAGkB,GAELa,MAAOnC,EACPoC,OAAQ,CACN5E,SAAS,EACT6E,UAAgC,EAArBjD,EAAQiD,UACnBC,YAAalD,EAAQkD,aAAe,UAGxCtD,GAAS,QAAYuC,EAAevB,GACpChB,GAAS,cAAkBuC,EAAeU,GAI5C,OAFAM,QAAQC,IAAIjB,GACZgB,QAAQC,IAAIjB,EAAa,OAClBA,GCtTHtC,GAASF,SAET0D,GAAmB,CACvBC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,SAAU,CACR,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,YAAa,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,UAAW,CACT,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAISC,GAAoB,SAACtK,GA2ChC,IA1CA,IAAMuK,GACJvK,KAAOqI,GACHA,GAAiBrI,GACjBqI,GACExD,GAAOS,OAAO,CACZ,MACA,OACA,UACA,WACA,SACA,cACA,SACA,YACA,QACA,SACA,SACA,OACA,UACA,QACA,OACA,OACA,MACA,QACA,MACA,OACA,QACA,QACA,UACA,UACA,SACA,SACA,OACA,SACA,QACA,OACA,SACA,YAGJkF,EACJC,SAASC,uBAAuB,OAEzBvK,EAAI,EAAGA,EAAIqK,EAAQxI,OAAQ7B,GAAK,EACvCqK,EAAQrK,GAAGwK,MAAMC,gBAAkBL,EAAGpK,EAAIoK,EAAGvI,QAC7CwI,EAAQrK,GAAGwK,MAAME,YAAcN,EAAGpK,EAAIoK,EAAGvI,QAE3C,OAAOuI,GCzeHO,GAASnG,SACToG,GAASpG,SACTqG,GCVkB,SAAAhD,GACtB,IAAMiD,EAAc,SAACjD,EAAQkD,GAC3B,IAAIC,EAAQnD,EAAOoD,SAASF,GAC5B,OAAIC,IAGJA,EAAQnD,EAAOoD,SAASF,GAAa,IAAIG,MAEvCH,EAAUI,WAAW,YACrBJ,EAAUI,WAAW,aACrBJ,EAAUI,WAAW,UACrBJ,EAAUI,WAAW,KAErBH,EAAMjM,IAAMgM,EAEZC,EAAMjM,IAAN,UAAAY,OAAsBoL,GAEjBC,IA8GT,OA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","file":"static/js/main.58be9907.chunk.js","sourcesContent":["import { Action } from 'redux';\nimport * as monacoEditor from 'monaco-editor';\nexport type CodeEditor = monacoEditor.editor.IStandaloneCodeEditor;\nimport { ErrorLog } from '../vm/vm';\n\nenum EditorActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_CODE = 'SET_CODE',\n  SET_CODEEDITOR = 'SET_CODEEDITOR',\n  SET_FONTSIZE = 'SET_FONTSIZE',\n  SET_DECORATION = 'SET_DECORATION',\n  SET_MARKER = 'SET_MARKER',\n  SET_THEME = 'SETTHEME',\n  SET_DIFFSTARTLINENUMBER = 'SET_DIFFSTARTLINENUMBER',\n}\n\ninterface SetSizeAction extends Action {\n  type: EditorActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number): SetSizeAction => ({\n  type: EditorActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetCodeAction extends Action {\n  type: EditorActionTypes.SET_CODE;\n  payload: {\n    code: string;\n  };\n}\n\nexport const setCode = (code: string): SetCodeAction => ({\n  type: EditorActionTypes.SET_CODE,\n  payload: {\n    code,\n  },\n});\n\ninterface SetCodeEditorAction extends Action {\n  type: EditorActionTypes.SET_CODEEDITOR;\n  payload: {\n    codeEditor: CodeEditor | null;\n  };\n}\n\nexport const setCodeEditor = (\n  codeEditor: CodeEditor | null\n): SetCodeEditorAction => ({\n  type: EditorActionTypes.SET_CODEEDITOR,\n  payload: {\n    codeEditor,\n  },\n});\n\ninterface SetFontSizeAction extends Action {\n  type: EditorActionTypes.SET_FONTSIZE;\n  payload: {\n    value: number;\n  };\n}\n\nexport const setFontSize = (value: number): SetFontSizeAction => ({\n  type: EditorActionTypes.SET_FONTSIZE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetDecorationAction extends Action {\n  type: EditorActionTypes.SET_DECORATION;\n  payload: {\n    decoration: string[];\n  };\n}\n\nexport const setDecoration = (decoration: string[]): SetDecorationAction => ({\n  type: EditorActionTypes.SET_DECORATION,\n  payload: {\n    decoration,\n  },\n});\n\ninterface SetMarkerAction extends Action {\n  type: EditorActionTypes.SET_MARKER;\n  payload: {\n    markers: monacoEditor.editor.IMarkerData[];\n  };\n}\n\nconst type2severity = (type: 'error' | 'info' | 'warning' | 'hint') => {\n  switch (type) {\n    case 'error':\n      return monacoEditor.MarkerSeverity.Error;\n    case 'info':\n      return monacoEditor.MarkerSeverity.Info;\n    case 'warning':\n      return monacoEditor.MarkerSeverity.Warning;\n    case 'hint':\n      return monacoEditor.MarkerSeverity.Hint;\n  }\n};\n\nexport const setMarker = (markers: ErrorLog[]): SetMarkerAction => ({\n  type: EditorActionTypes.SET_MARKER,\n  payload: {\n    markers: markers.map(marker => ({\n      severity: type2severity(marker.type as\n        | 'error'\n        | 'info'\n        | 'warning'\n        | 'hint'),\n      startLineNumber: marker.row! + 1,\n      startColumn: marker.col!,\n      endLineNumber: marker.row! + 1,\n      endColumn: marker.col! + marker.len!,\n      message: marker.key,\n    })),\n  },\n});\n\ninterface SetThemeAction extends Action {\n  type: EditorActionTypes.SET_THEME;\n  payload: {\n    theme: string;\n  };\n}\n\nexport const setTheme = (theme: string): SetThemeAction => ({\n  type: EditorActionTypes.SET_THEME,\n  payload: {\n    theme,\n  },\n});\n\ninterface SetDiffStartLineNumber extends Action {\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER;\n  payload: {\n    startLineNumber: number | null;\n  };\n}\n\nexport const setDiffStartLineNumber = (startLineNumber: number | null) => ({\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER,\n  payload: {\n    startLineNumber,\n  },\n});\n\nexport type EditorActions =\n  | SetCodeAction\n  | SetSizeAction\n  | SetCodeEditorAction\n  | SetFontSizeAction\n  | SetDecorationAction\n  | SetMarkerAction\n  | SetThemeAction\n  | SetDiffStartLineNumber;\n\nexport type EditorState = {\n  width: number;\n  height: number;\n  code: string;\n  codeEditor: CodeEditor | null;\n  theme: string;\n  fontSize: number;\n  decoration: string[];\n  markers: monacoEditor.editor.IMarkerData[];\n  diffStartLineNumber: number | null;\n};\n\nconst initialState: EditorState = {\n  width: 500,\n  height: 500,\n  code: '',\n  codeEditor: null,\n  theme: 'vs',\n  fontSize: 30,\n  decoration: [],\n  markers: [],\n  diffStartLineNumber: null,\n};\n\nexport const editorReducer = (state = initialState, action: EditorActions) => {\n  switch (action.type) {\n    case EditorActionTypes.SET_SIZE:\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case EditorActionTypes.SET_CODE:\n      return { ...state, code: action.payload.code };\n    case EditorActionTypes.SET_CODEEDITOR:\n      return { ...state, codeEditor: action.payload.codeEditor };\n    case EditorActionTypes.SET_FONTSIZE:\n      return { ...state, fontSize: action.payload.value };\n    case EditorActionTypes.SET_DECORATION:\n      return { ...state, decoration: action.payload.decoration };\n    case EditorActionTypes.SET_MARKER:\n      monacoEditor.editor.setModelMarkers(\n        state.codeEditor!.getModel()!,\n        'puppy',\n        action.payload.markers\n      );\n      return {\n        ...state,\n        codeEditor: state.codeEditor,\n        markers: action.payload.markers,\n      };\n    case EditorActionTypes.SET_THEME:\n      return { ...state, theme: action.payload.theme };\n    case EditorActionTypes.SET_DIFFSTARTLINENUMBER:\n      return { ...state, diffStartLineNumber: action.payload.startLineNumber };\n    default:\n      return state;\n  }\n};\n\nexport default editorReducer;\n","import React, { useEffect } from 'react';\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\nimport { CourseShape } from '../../modules/course';\nimport './Header.css';\n\nexport type HeaderProps = {\n  course: CourseShape;\n  courses: { [path: string]: CourseShape };\n  fetchCourses: () => void;\n  setShow: (show: boolean) => void;\n};\n\nconst Header: React.FC<HeaderProps> = (props: HeaderProps) => {\n  useEffect(() => {\n    props.fetchCourses();\n  }, []);\n  return (\n    <div className=\"Header\" id=\"puppy-header\">\n      <Navbar bg=\"white\" variant=\"light\" expand=\"lg\">\n        <Navbar.Brand onClick={() => props.setShow(true)}>\n          <img\n            src=\"./image/logo.png\"\n            width=\"25\"\n            height=\"25\"\n            className=\"d-inline-block align-top\"\n          />\n          {' Puppy'}\n        </Navbar.Brand>\n        <Nav className=\"mr-auto\">\n          <NavDropdown title={props.course.title} id=\"nav-dropdown-courses\">\n            {Object.keys(props.courses).map(course_path => {\n              const course = props.courses[course_path];\n              return (\n                <NavDropdown\n                  title={course.title}\n                  id={`nav-dropdown-pages-${course.title}`}\n                  drop=\"right\"\n                  key={course.title}\n                >\n                  {course.list.map(\n                    (page: { path: string; title: string }, i: number) => (\n                      <NavDropdown.Item\n                        href={`?course=${course_path}#${i}`}\n                        key={i}\n                      >\n                        {page.title}\n                      </NavDropdown.Item>\n                    )\n                  )}\n                </NavDropdown>\n              );\n            })}\n          </NavDropdown>\n        </Nav>\n      </Navbar>\n    </div>\n  );\n};\n\nexport default Header;\n","import { Action } from 'redux';\n\nexport type CourseShape = {\n  title: string;\n  list: {\n    path: string;\n    title: string;\n  }[];\n};\n\nenum CourseActionTypes {\n  SET_CONTENT = 'SET_CONTENT',\n  SET_COURSES = 'SET_COURCES',\n  SET_COURSE = 'SET_COURSE',\n  SET_VISIBLE = 'SET_VISIBLE',\n}\n\ninterface SetContentAction extends Action {\n  type: CourseActionTypes.SET_CONTENT;\n  payload: {\n    content: string;\n  };\n}\n\nexport const setContent = (content: string): SetContentAction => ({\n  type: CourseActionTypes.SET_CONTENT,\n  payload: {\n    content,\n  },\n});\n\ninterface SetCoursesAction extends Action {\n  type: CourseActionTypes.SET_COURSES;\n  payload: {\n    courses: { [path: string]: CourseShape };\n  };\n}\n\nexport const setCources = (courses: {\n  [path: string]: CourseShape;\n}): SetCoursesAction => ({\n  type: CourseActionTypes.SET_COURSES,\n  payload: {\n    courses,\n  },\n});\n\ninterface SetCourseAction extends Action {\n  type: CourseActionTypes.SET_COURSE;\n  payload: {\n    course: CourseShape;\n  };\n}\n\nexport const setCourse = (course: CourseShape): SetCourseAction => ({\n  type: CourseActionTypes.SET_COURSE,\n  payload: {\n    course,\n  },\n});\n\ninterface SetVisibleAction extends Action {\n  type: CourseActionTypes.SET_VISIBLE;\n  payload: {\n    visible: boolean;\n  };\n}\n\nexport const setVisible = (visible: boolean): SetVisibleAction => ({\n  type: CourseActionTypes.SET_VISIBLE,\n  payload: {\n    visible,\n  },\n});\n\nexport type CourseActions =\n  | SetContentAction\n  | SetCoursesAction\n  | SetCourseAction\n  | SetVisibleAction;\n\nexport type CourseState = {\n  content: string;\n  courses: { [path: string]: CourseShape };\n  course: CourseShape;\n  coursePath: string;\n  page: number;\n  visible: boolean;\n};\n\nconst initialState: CourseState = {\n  content: '# Hello World \\n\\n Rendered by **marked**',\n  courses: {},\n  course: { title: '', list: [] },\n  coursePath: '',\n  page: 0,\n  visible: true,\n};\n\nconst courseReducer = (state = initialState, action: CourseActions) => {\n  switch (action.type) {\n    case CourseActionTypes.SET_CONTENT:\n      return { ...state, content: action.payload.content };\n    case CourseActionTypes.SET_COURSES:\n      return { ...state, courses: action.payload.courses };\n    case CourseActionTypes.SET_COURSE:\n      return { ...state, course: action.payload.course };\n    case CourseActionTypes.SET_VISIBLE:\n      return { ...state, visible: action.payload.visible };\n    default:\n      return state;\n  }\n};\n\nexport default courseReducer;\n","import { Action } from 'redux';\nimport { Puppy } from '../vm/vm';\n\nenum PuppyActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_PUPPY = 'SET_PUPPY',\n  SET_ISLIVE = 'SET_ISLIVE',\n}\n\ninterface SetSizeAction extends Action {\n  type: PuppyActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number) => ({\n  type: PuppyActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetPuppyAction extends Action {\n  type: PuppyActionTypes.SET_PUPPY;\n  payload: {\n    puppy: Puppy | null;\n  };\n}\n\nexport const setPuppy = (puppy: Puppy | null) => ({\n  type: PuppyActionTypes.SET_PUPPY,\n  payload: {\n    puppy,\n  },\n});\n\ninterface SetIsLiveAction extends Action {\n  type: PuppyActionTypes.SET_ISLIVE;\n  payload: {\n    isLive: boolean;\n  };\n}\n\nexport const setIsLive = (isLive: boolean) => ({\n  type: PuppyActionTypes.SET_ISLIVE,\n  payload: {\n    isLive,\n  },\n});\n\nexport type PuppyActions = SetSizeAction | SetPuppyAction | SetIsLiveAction;\n\nexport type PuppyState = {\n  width: number;\n  height: number;\n  puppy: Puppy | null;\n  isLive: boolean;\n};\n\nconst initialState: PuppyState = {\n  width: 500,\n  height: 500,\n  puppy: null,\n  isLive: true,\n};\n\nexport const puppyReducer = (state = initialState, action: PuppyActions) => {\n  switch (action.type) {\n    case PuppyActionTypes.SET_SIZE:\n      if (state.puppy) {\n        state.puppy.resize(action.payload.width, action.payload.height);\n      }\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case PuppyActionTypes.SET_PUPPY:\n      return { ...state, puppy: action.payload.puppy };\n    case PuppyActionTypes.SET_ISLIVE:\n      return { ...state, isLive: action.payload.isLive };\n    default:\n      return state;\n  }\n};\n\nexport default puppyReducer;\n","import { Action } from 'redux';\n\nenum InputActionTypes {\n  SET_VALUE = 'SET_VALUE',\n  SET_SHOW = 'SET_SHOW',\n  SET_PLACEHOLDER = 'SET_PLACEHOLDER',\n}\n\ninterface SetValueAction extends Action {\n  type: InputActionTypes.SET_VALUE;\n  payload: {\n    value: string;\n  };\n}\n\nexport const setValue = (value: string): SetValueAction => ({\n  type: InputActionTypes.SET_VALUE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetShowAction extends Action {\n  type: InputActionTypes.SET_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: InputActionTypes.SET_SHOW,\n  payload: {\n    show,\n  },\n});\n\ninterface SetPlaceholderAction extends Action {\n  type: InputActionTypes.SET_PLACEHOLDER;\n  payload: {\n    placeholder: string;\n  };\n}\n\nexport const setPlaceholder = (placeholder: string): SetPlaceholderAction => ({\n  type: InputActionTypes.SET_PLACEHOLDER,\n  payload: {\n    placeholder,\n  },\n});\n\nexport type InputActions =\n  | SetValueAction\n  | SetShowAction\n  | SetPlaceholderAction;\n\nexport type InputState = {\n  value: string;\n  show: boolean;\n  placeholder: string;\n};\n\nconst initialState: InputState = {\n  value: '',\n  show: false,\n  placeholder: '',\n};\n\nconst InputReducer = (state = initialState, action: InputActions) => {\n  switch (action.type) {\n    case InputActionTypes.SET_VALUE:\n      return { ...state, value: action.payload.value };\n    case InputActionTypes.SET_SHOW:\n      if (action.payload.show) {\n        return { value: '', show: action.payload.show, placeholder: '' };\n      } else {\n        return { ...state, show: action.payload.show };\n      }\n    case InputActionTypes.SET_PLACEHOLDER:\n      return { ...state, placeholder: action.payload.placeholder };\n    default:\n      return state;\n  }\n};\n\nexport default InputReducer;\n","import { Action } from 'redux';\n\nenum VersionActionTypes {\n  SET_VERSION_SHOW = 'SET_VERSION_SHOW',\n}\n\ninterface SetShowAction extends Action {\n  type: VersionActionTypes.SET_VERSION_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: VersionActionTypes.SET_VERSION_SHOW,\n  payload: {\n    show,\n  },\n});\n\nexport type VersionActions = SetShowAction;\n\nexport type VersionState = {\n  show: boolean;\n};\n\nconst initialState: VersionState = {\n  show: false,\n};\n\nconst VersionReducer = (state = initialState, action: VersionActions) => {\n  switch (action.type) {\n    case VersionActionTypes.SET_VERSION_SHOW:\n      return { ...state, show: action.payload.show };\n    default:\n      return state;\n  }\n};\n\nexport default VersionReducer;\n","import * as Matter from 'matter-js';\n\nconst Bodies = Matter.Bodies;\nconst Composite = Matter.Composite;\nconst Common = Matter['Common'];\n\nimport { Puppy } from './vm'; // eslint-disable-line no-unused-vars\n\nexport type PuppyShape =\n  | 'circle'\n  | 'rectangle'\n  | 'trapezoid'\n  | 'polygon'\n  | 'label';\nexport type CollisionFunc = (obj1: {}, obj2: {}) => void;\nexport type ClickedFunc = (obj: {}) => void;\n\nexport type PuppyConstructor = (puppy: Puppy, options: Shape) => Matter.Body;\n\nexport type Shape = {\n  position?: {\n    x: number;\n    y: number;\n  };\n  isSensor?: boolean;\n  isStatic?: boolean;\n  width?: number;\n  height?: number;\n\n  angle?: number;\n  interia?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n};\n\n// const flatten = part => {\n//   console.log(part);\n//   Object.keys(part.render).forEach(key => {\n//     if (!(key in part)) {\n//       console.log(`key ${key}`);\n//       part[key] = part.render[key];\n//     }\n//   });\n// };\n\nconst convColor = (puppy: Puppy, color: any) => {\n  if (Array.isArray(color)) {\n    color = Common.choose(color);\n  }\n  if (typeof color === 'number') {\n    const list: [string] = puppy.world!.colorScheme;\n    return list[color % list.length];\n  }\n  return color;\n};\n\nexport const PropertyMap: {} = {\n  radius: (puppy: Puppy, options: Shape, value: any) => {\n    options.radius = value;\n    if (options.base === 'circle') {\n      options.width = value * 2;\n      options.height = value * 2;\n    }\n  },\n  width: (puppy: Puppy, options: Shape, value: any) => {\n    options.width = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.height = value;\n    }\n  },\n  height: (puppy: Puppy, options: Shape, value: any) => {\n    options.height = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.width = value;\n    }\n  },\n  fillStyle: (puppy: Puppy, options: Shape, value: any) => {\n    options.fillStyle = convColor(puppy, value);\n  },\n};\n\nexport const setShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value: any\n) => {\n  if (key in PropertyMap) {\n    PropertyMap[key](puppy, options, value);\n  } else {\n    options[key] = value;\n  }\n  return value;\n};\n\nconst checkShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value?: any\n) => {\n  if (options[key]) {\n    return setShapeProperty(puppy, options, key, options[key]);\n  }\n  if (value) {\n    return setShapeProperty(puppy, options, key, value);\n  }\n  return undefined;\n};\n\n/* constructor functions */\n\nconst circle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst rectangle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'width', 100);\n  checkShapeProperty(puppy, options, 'height', 100);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    options.isStatic ? 'black' : Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst polygon = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'polygon',\n    visible: true,\n  });\n  const sides = checkShapeProperty(puppy, options, 'sides', 5);\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  return Bodies.polygon(\n    options.position!.x,\n    options.position!.y,\n    sides,\n    options.radius!,\n    options\n  );\n};\n\nconst label = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n  });\n  checkShapeProperty(puppy, options, 'width', 10);\n  checkShapeProperty(puppy, options, 'height', 10);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fontColor',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  checkShapeProperty(puppy, options, 'fillStyle', 'rgba(255, 255, 255, 0)');\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst drop = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n    created: puppy.getTimeStamp(),\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 10);\n  checkShapeProperty(puppy, options, 'fillStyle', 0);\n  checkShapeProperty(puppy, options, 'opacity', 0.8);\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst pendulum = (puppy: Puppy, options: Shape) => {\n  const separation = 1.9;\n  const column = checkShapeProperty(puppy, options, 'column', 5);\n  const width = checkShapeProperty(\n    puppy,\n    options,\n    'width',\n    puppy.world!.viewWidth / 2\n  );\n  const height = checkShapeProperty(\n    puppy,\n    options,\n    'height',\n    puppy.world!.viewWidth / 2\n  );\n  const size = width / (column * 2);\n  const xx = options.position!.x - width / 2;\n  const yy = options.position!.y - height / 2;\n  const newtonsCradle = Matter.Composite.create({\n    label: 'Newtons Cradle',\n  });\n  for (let i = 0; i < column; i += 1) {\n    const _options = {\n      visible: true,\n      fillStyle: Common.choose(puppy.world!.colorScheme),\n      inertia: options.interia || Infinity,\n      restitution: options.restitution || 1,\n      friction: options.friction || 0,\n      frictionAir: options.frictionAir || 0.0001,\n      slop: options.slop || 1,\n    };\n    const circle = Matter.Bodies.circle(\n      xx + i * (size * separation),\n      yy + height,\n      size,\n      _options\n    );\n    const constraint = Matter.Constraint.create({\n      pointA: {\n        x: xx + i * (size * separation),\n        y: yy,\n      },\n      bodyB: circle,\n      render: {\n        visible: true,\n        lineWidth: options.lineWidth! | 1,\n        strokeStyle: options.strokeStyle || 'gray',\n      },\n    });\n    Composite['addBody'](newtonsCradle, circle);\n    Composite['addConstraint'](newtonsCradle, constraint);\n  }\n  console.log(newtonsCradle);\n  console.log(newtonsCradle['parts']);\n  return newtonsCradle;\n};\n\nexport const initVars = (vars: {}) => {\n  Object.assign(vars, {\n    Circle: circle,\n    Rectangle: rectangle,\n    Polygon: polygon,\n    Label: label,\n    Drop: drop,\n    Pendulum: pendulum,\n  });\n  return vars;\n};\n\n/* shapeFunc  */\n\nexport type ShapeOptions = {\n  // Matter Options\n  id?: number;\n  type?: string;\n  label?: string;\n  parts?: [];\n  plugin?: {};\n  angle?: number;\n  interia?: number;\n  position: {\n    x: number;\n    y: number;\n  };\n  width?: number;\n  height?: number;\n  force?: {\n    x: number;\n    y: number;\n  };\n  torque?: number;\n  positionImpulse?: { x?: number; y?: number };\n  constraintImpulse?: { x?: number; y?: number; angle?: number };\n  totalContacts?: number;\n  speed?: number;\n  angularSpeed?: number;\n  velocity?: { x: number; y: number };\n  angularVelocity?: number;\n  isSensor?: boolean;\n  isStatic?: boolean;\n  isSleeping?: boolean;\n  motion?: number;\n  sleepThreshold?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  sprite?: {\n    xScale?: number;\n    yScale?: number;\n    xOffset?: number;\n    yOffset?: number;\n  };\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n  collisionStart?: CollisionFunc;\n  collisionEnd?: CollisionFunc;\n  collisionActive?: CollisionFunc;\n  clicked?: ClickedFunc;\n};\n\n// export const isShapeOptions = (obj: {}) => ('shape' in obj) && ('position' in obj) && ('x' in obj['position']) && ('y' in obj['position']);\n\nexport class PuppyShapeBase implements ShapeOptions {\n  shape: PuppyShape = 'circle';\n  position: {\n    x: number;\n    y: number;\n  };\n\n  constructor(x: number, y: number, options = {}) {\n    Object.assign(this, options);\n    this.position = { x, y };\n  }\n}\n\nexport class Circle extends PuppyShapeBase {\n  shape: PuppyShape = 'circle';\n}\n\nexport class Rectangle extends PuppyShapeBase {\n  shape: PuppyShape = 'rectangle';\n}\n\nexport class Polygon extends PuppyShapeBase {\n  shape: PuppyShape = 'polygon';\n}\n\nexport class Trapezoid extends PuppyShapeBase {\n  shape: PuppyShape = 'trapezoid';\n}\n\nexport class Label extends PuppyShapeBase {\n  shape: PuppyShape = 'label';\n}\n\nexport const shapeFuncMap: {\n  [key in PuppyShape]: (world: {}, options: ShapeOptions) => Matter.Body;\n} = {\n  circle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      radius: _options.width\n        ? _options.width / 2\n        : _options.height\n        ? _options.height / 2\n        : 25,\n      fillStyle: Common.choose(world['colorScheme']),\n      visible: true,\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    // width, height texture \n    if (!options.width) {\n      options.width = options.radius * 2;\n    }\n    if (!options.height) {\n      options.height = options.radius * 2;\n    }\n    return Bodies.circle(\n      options.position.x,\n      options.position.y,\n      options.radius,\n      options\n    );\n  },\n  rectangle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'black'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n  polygon(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      sides: 5,\n      radius: 25,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend(\n      {},\n      defaultOptions,\n      { radius: _options.width ? _options.width / 2 : defaultOptions.radius },\n      _options\n    );\n    return Bodies.polygon(\n      options.position.x,\n      options.position.y,\n      options.sides,\n      options.radius,\n      options\n    );\n  },\n  trapezoid(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      slope: 0.5,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.trapezoid(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options.slope,\n      options\n    );\n  },\n  label(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      isSensor: true,\n      isStatic: true,\n      fillStyle: 'rgba(255, 255, 255, 0)',\n      fontColor: Common.choose(world['colorScheme']),\n      visible: true,\n      collisionFilter: {\n        category: 0x0001,\n        mask: 0x00000000,\n        group: 3,\n      },\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n};\n","import * as Matter from 'matter-js';\n\nconst Common = Matter['Common'];\n\nconst PuppyColorScheme = {\n  pop: [\n    '#de9610',\n    '#c93a40',\n    '#fff001',\n    '#d06d8c',\n    '#65ace4',\n    '#a0c238',\n    '#56a764',\n    '#d16b16',\n    '#cc528b',\n    '#9460a0',\n    '#f2cf01',\n    '#0074bf',\n  ],\n  cute: [\n    '#e2b2c0',\n    '#fff353',\n    '#a5d1f4',\n    '#e4ad6d',\n    '#d685b0',\n    '#dbe159',\n    '#7fc2ef',\n    '#c4a6ca',\n    '#eabf4c',\n    '#f9e697',\n    '#b3d3ac',\n    '#eac7cd',\n  ],\n  dynamic: [\n    '#b80117',\n    '#222584',\n    '#00904a',\n    '#edc600',\n    '#261e1c',\n    '#6d1782',\n    '#8f253b',\n    '#a0c238',\n    '#d16b16',\n    '#0168b3',\n    '#b88b26',\n    '#c30068',\n  ],\n  gorgeous: [\n    '#7d0f80',\n    '#b08829',\n    '#a03c44',\n    '#018a9a',\n    '#ab045c',\n    '#391d2b',\n    '#d5a417',\n    '#546474',\n    '#0f5ca0',\n    '#d0b98d',\n    '#d4c91f',\n    '#c1541c',\n  ],\n  casual: [\n    '#7b9ad0',\n    '#f8e352',\n    '#c8d627',\n    '#d5848b',\n    '#e5ab47',\n    '#e1cea3',\n    '#51a1a2',\n    '#b1d7e4',\n    '#66b7ec',\n    '#c08e47',\n    '#ae8dbc',\n    '#c3cfa9',\n  ],\n  psychedelic: [\n    '#b7007c',\n    '#009b85',\n    '#382284',\n    '#e2c80f',\n    '#009dc6',\n    '#c4c829',\n    '#95007e',\n    '#d685b0',\n    '#eee800',\n    '#bf5116',\n    '#b80e3b',\n    '#0178bc',\n  ],\n  bright: [\n    '#fff001',\n    '#cb5393',\n    '#a0c238',\n    '#d78114',\n    '#00a5e7',\n    '#cd5638',\n    '#0168b3',\n    '#d685b0',\n    '#00984b',\n    '#f2cf01',\n    '#6bb6bb',\n    '#a563a0',\n  ],\n  fairytale: [\n    '#cca9ca',\n    '#9bcad0',\n    '#dd9dbf',\n    '#edef9c',\n    '#aabade',\n    '#f2dae8',\n    '#c7ddae',\n    '#a199c8',\n    '#faede5',\n    '#d5a87f',\n    '#f7f06e',\n    '#95bfe7',\n  ],\n  heavy: [\n    '#000000',\n    '#998c69',\n    '#5c002f',\n    '#244765',\n    '#814523',\n    '#5e2a58',\n    '#1a653c',\n    '#6a6a68',\n    '#bf7220',\n    '#5f556e',\n    '#84762f',\n    '#872226',\n  ],\n  impact: [\n    '#c60019',\n    '#fff001',\n    '#1d4293',\n    '#00984b',\n    '#019fe6',\n    '#c2007b',\n    '#261e1c',\n    '#7d0f80',\n    '#dc9610',\n    '#dbdf19',\n    '#d685b0',\n    '#a0c238',\n  ],\n  street: [\n    '#33476a',\n    '#211917',\n    '#6c7822',\n    '#c2007b',\n    '#44aeea',\n    '#5e3032',\n    '#d16b16',\n    '#c8d627',\n    '#9193a0',\n    '#816945',\n    '#c50030',\n    '#0080c9',\n  ],\n  cool: [\n    '#b0d7f4',\n    '#c0cbe9',\n    '#eef0b1',\n    '#44aeea',\n    '#85beab',\n    '#c4a6ca',\n    '#f7f06e',\n    '#c8d627',\n    '#bcccd9',\n    '#e4f0fc',\n    '#f2dae8',\n    '#6490cd',\n  ],\n  elegant: [\n    '#ae8dbc',\n    '#e3b3cd',\n    '#d6ddf0',\n    '#e5d57d',\n    '#82c0cd',\n    '#afc7a7',\n    '#834e62',\n    '#6a9176',\n    '#7f7eb8',\n    '#a04e90',\n    '#dbbc86',\n    '#c4c829',\n  ],\n  fresh: [\n    '#70b062',\n    '#c8d85b',\n    '#f8e133',\n    '#dbdf19',\n    '#e3ab30',\n    '#dd9dbf',\n    '#a979ad',\n    '#cd5638',\n    '#399548',\n    '#6bb6bb',\n    '#f7f39c',\n    '#9acce3',\n  ],\n  warm: [\n    '#c59f22',\n    '#dd9b9d',\n    '#ebcc00',\n    '#d6d11d',\n    '#8d4f42',\n    '#d8836e',\n    '#f8e469',\n    '#cbb586',\n    '#e4aa01',\n    '#eac287',\n    '#f2d8bf',\n    '#a6658d',\n  ],\n  soft: [\n    '#f8e469',\n    '#e7e0aa',\n    '#d9de84',\n    '#e4bd60',\n    '#9ac29f',\n    '#e3be87',\n    '#edef9c',\n    '#dd9b9d',\n    '#b2d6d4',\n    '#f5dfa6',\n    '#ebeddf',\n    '#e1d4e6',\n  ],\n  man: [\n    '#23466e',\n    '#4d639f',\n    '#dfe0d8',\n    '#1d695f',\n    '#9aadbe',\n    '#844f30',\n    '#934e61',\n    '#7e9895',\n    '#77aad7',\n    '#848a96',\n    '#a76535',\n    '#7e8639',\n  ],\n  woman: [\n    '#7b0050',\n    '#a8006d',\n    '#bea620',\n    '#a26c54',\n    '#949b34',\n    '#614983',\n    '#cba777',\n    '#de9610',\n    '#bd8683',\n    '#be87a6',\n    '#bf5346',\n    '#e1d0b4',\n  ],\n  boy: [\n    '#0168b3',\n    '#66b7ec',\n    '#afd0ef',\n    '#88b83e',\n    '#b8b2d6',\n    '#6bb6bb',\n    '#5e4694',\n    '#f2cf01',\n    '#c6e2f8',\n    '#d5dbcf',\n    '#7a8bc3',\n    '#e8e6f3',\n  ],\n  girl: [\n    '#d06da3',\n    '#c2d3ed',\n    '#be91bc',\n    '#c73576',\n    '#f8e352',\n    '#c8d627',\n    '#e3b3cd',\n    '#c6e0d5',\n    '#e4ab5a',\n    '#cb6c58',\n    '#845d9e',\n    '#82c0cd',\n  ],\n  smart: [\n    '#4d639f',\n    '#356c92',\n    '#c9ced1',\n    '#dfd4be',\n    '#92a1a6',\n    '#a67b2d',\n    '#bda5bb',\n    '#2c4b79',\n    '#d6d680',\n    '#babea5',\n    '#ebc175',\n    '#3a614f',\n  ],\n  light: [\n    '#44aeea',\n    '#b4cb32',\n    '#b2b6db',\n    '#b2d6d4',\n    '#ebe9ae',\n    '#0080c9',\n    '#71b174',\n    '#e4c4db',\n    '#7da8db',\n    '#eac39a',\n    '#dbe585',\n    '#6db5a9',\n  ],\n  stylish: [\n    '#58656e',\n    '#bac1c7',\n    '#487ca3',\n    '#dfd4be',\n    '#004679',\n    '#c0542d',\n    '#a44682',\n    '#9599b2',\n    '#d6d680',\n    '#8eb4d9',\n    '#6c5776',\n    '#499475',\n  ],\n  natural: [\n    '#ba9648',\n    '#87643e',\n    '#c2b5d1',\n    '#ba7d8c',\n    '#b8ac60',\n    '#797c85',\n    '#f9ebd1',\n    '#9cb1c2',\n    '#81a47a',\n    '#acb130',\n    '#8b342a',\n    '#acae98',\n  ],\n  spring: [\n    '#dd9cb4',\n    '#eeea55',\n    '#ebc061',\n    '#b2d6d4',\n    '#f2dae8',\n    '#c9d744',\n    '#b8b2d6',\n    '#afd0ef',\n    '#d7847e',\n    '#f8e352',\n    '#b3ce5b',\n    '#cbacbe',\n  ],\n  summer: [\n    '#174e9e',\n    '#68b8dd',\n    '#d16b16',\n    '#88b83e',\n    '#f2cf01',\n    '#019fe6',\n    '#c60019',\n    '#019c96',\n    '#b0d7f4',\n    '#fff001',\n    '#0074bf',\n    '#c83955',\n  ],\n  fall: [\n    '#ae3c22',\n    '#902342',\n    '#c59f22',\n    '#7e8639',\n    '#eabd00',\n    '#a49e2e',\n    '#ac5238',\n    '#9f832f',\n    '#ba7c6f',\n    '#875f3b',\n    '#bba929',\n    '#786b4b',\n  ],\n  winter: [\n    '#a5aad4',\n    '#6591b6',\n    '#623d82',\n    '#5f897b',\n    '#858aa0',\n    '#eff3f6',\n    '#c2d3dd',\n    '#4f616f',\n    '#7f7073',\n    '#42629f',\n    '#674c51',\n    '#b38da4',\n  ],\n  japan: [\n    '#c3003a',\n    '#3a546b',\n    '#d5a02e',\n    '#918d43',\n    '#787cac',\n    '#604439',\n    '#6f2757',\n    '#c1541c',\n    '#565d63',\n    '#afc9ca',\n    '#baaa52',\n    '#e2b2c0',\n  ],\n  euro: [\n    '#bf541c',\n    '#25a4b7',\n    '#e4aa01',\n    '#b2bfe1',\n    '#ad438e',\n    '#1d4293',\n    '#b71232',\n    '#e8e2be',\n    '#b0bf30',\n    '#6aa43e',\n    '#6276b5',\n    '#d7832d',\n  ],\n  nordic: [\n    '#149bdf',\n    '#dbdf19',\n    '#c97a2b',\n    '#945141',\n    '#9abca4',\n    '#a5a79a',\n    '#e6d9b9',\n    '#eabd00',\n    '#bf545e',\n    '#86b070',\n    '#665e51',\n    '#b59a4d',\n  ],\n  asian: [\n    '#946761',\n    '#b80040',\n    '#4eacb8',\n    '#7f1f69',\n    '#c8b568',\n    '#147472',\n    '#1d518b',\n    '#b1623b',\n    '#95a578',\n    '#b9b327',\n    '#af508a',\n    '#dab100',\n  ],\n};\n\nexport const chooseColorScheme = (key: string) => {\n  const cs =\n    key in PuppyColorScheme\n      ? PuppyColorScheme[key]\n      : PuppyColorScheme[\n          Common.choose([\n            'pop',\n            'cute',\n            'dynamic',\n            'gorgeous',\n            'casual',\n            'psychedelic',\n            'bright',\n            'fairytale',\n            'heavy',\n            'impact',\n            'street',\n            'cool',\n            'elegant',\n            'fresh',\n            'warm',\n            'soft',\n            'man',\n            'woman',\n            'boy',\n            'girl',\n            'smart',\n            'light',\n            'stylish',\n            'natural',\n            'spring',\n            'summer',\n            'fall',\n            'winter',\n            'japan',\n            'euro',\n            'nordic',\n            'asian',\n          ])\n        ];\n  const targets = <HTMLCollectionOf<HTMLElement>>(\n    document.getElementsByClassName('btn')\n  );\n  for (let i = 0; i < targets.length; i += 1) {\n    targets[i].style.backgroundColor = cs[i % cs.length];\n    targets[i].style.borderColor = cs[i % cs.length];\n  }\n  return cs;\n};\n","import * as Matter from 'matter-js';\nimport { myRender } from './render';\nimport { initVars, Shape, PuppyConstructor } from './shape';\nimport {\n  getInputValue,\n  getDiffStartLineNumber,\n  setCodeHighlight,\n  resetCodeHighlight,\n  getIsLive,\n} from '../modules/operations';\nimport { chooseColorScheme } from './color';\n\n// const Bodies = Matter.Bodies;\nconst Engine = Matter.Engine;\nconst Runner = Matter.Runner;\nconst Render = myRender(Matter.Render);\nconst Constraint = Matter.Constraint;\nconst MouseConstraint = Matter.MouseConstraint;\nconst Mouse = Matter.Mouse;\nconst World = Matter.World;\nconst Bounds = Matter.Bounds;\nconst Vertices = Matter.Vertices;\nconst Detector = Matter['Detector'];\nconst Common = Matter['Common'];\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\n// export type ErrorShape = {\n//   type: 'error' | 'info' | 'warning' | 'hint';\n//   row: number;\n//   col: number;\n//   len: number;\n//   text: string;\n// };\n\nexport type ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(_index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(_ty: Type, _update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(_map: any): Type {\n    return this;\n  }\n}\n\nexport type PuppySettings = {\n  canvas: string;\n  ftrace: (log: {}) => void;\n  eachUpdate?: (time: number) => void;\n};\n\ntype PuppyWorld = {\n  background: string;\n  width: number;\n  height: number;\n  viewWidth: number;\n  viewHeight: number;\n  view: { min: Matter.Vector; max: Matter.Vector };\n  colorScheme: [string];\n\n  opacity: number /* Default 1.0 */;\n\n  font: string;\n  gravity: Matter.Vector;\n  density: number /* Default: 0.001 */;\n  friction: number /* Default: 0.1 */;\n  airFriction: number /* Default: 0.01 */;\n  frictionStatic: number /* Default: 0.5 */;\n  motion: number /* Default: 0 */;\n  restitution: number /* 0 */;\n};\n\n// (Puppy, {}) -> (number, number, number) -> any\nexport class Puppy {\n  private settings: PuppySettings;\n  public code: any;\n  public world: PuppyWorld | null;\n\n  public interval: number;\n  public waitRestart: boolean;\n  public isExecuting: boolean;\n\n  private runner: Matter.Runner | null;\n  private engine: Matter.Engine | null;\n  private render: Matter.Render | null;\n  private canvas: HTMLCanvasElement | null;\n\n  // private debug_mode: boolean;\n\n  private vars: {};\n\n  // new puppy\n  public constructor(settings: PuppySettings, code: any, waitStart = false) {\n    this.settings = settings;\n    this.code = code;\n    this.world = null;\n    this.interval = 500;\n    this.waitRestart = waitStart;\n    this.isExecuting = false;\n    this.runner = null;\n    this.engine = null;\n    this.render = null;\n    this.canvas = null;\n    this.vars = {};\n  }\n\n  private initCode() {\n    const code = this.code;\n    const width = code.world['width'] || 1000;\n    const height = code.world['height'] || 1000;\n    const vwidth = code.world['viewWidth'] || width;\n    const vheight = code.world['viewHeight'] || height;\n    const pos: Matter.Vector = code.world['position'] || { x: 0, y: 0 };\n    this.code = code;\n    this.world = {\n      width,\n      height,\n      viewWidth: vwidth,\n      viewHeight: vheight,\n      background: code.world['background'] || 'white',\n      gravity: code.world['gravitiy'] || { x: 0.0, y: 1.0 },\n      colorScheme: chooseColorScheme(code.world['colorScheme'] || ''),\n      opacity: code.world['opacity'] || 1.0,\n      font: code.world['font'] || \"bold 60px 'Arial'\",\n      view: code.world['view'] || {\n        min: pos,\n        max: { x: pos.x + vwidth, y: pos.y + vheight },\n      },\n      density: code.world['density'] || 0.001,\n      friction: code.world['friction'] || 0.1,\n      airFriction: code.world['airFriction'] || 0.01,\n      frictionStatic: code.world['frictionStatic'] || 0.5,\n      motion: code.world['motion'] || 0,\n      restitution: code.world['restitution'] || 0,\n    };\n  }\n\n  private startCode() {\n    this.engine = Engine.create();\n\n    if (this.world!.gravity) {\n      const engine = this.engine;\n      window.addEventListener('deviceorientation', event => {\n        const orientation = window.orientation || 0;\n        const gravity = engine.world.gravity;\n        if (orientation === 0) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.beta!, -90, 90) / 90;\n        } else if (orientation === 180) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.beta!, -90, 90) / 90;\n        } else if (orientation === 90) {\n          gravity.x = Common.clamp(event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.gamma!, -90, 90) / 90;\n        } else if (orientation === -90) {\n          gravity.x = Common.clamp(-event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.gamma!, -90, 90) / 90;\n        }\n      });\n    }\n    Matter.Events.on(this.engine, 'beforeUpdate', () => {\n      const time = this.engine!.timing.timestamp;\n      if (this.settings.eachUpdate) {\n        this.settings.eachUpdate(time);\n      }\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        const body: Matter.Body = bodies[i];\n        if (body['move']) {\n          body['move'](body, time);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionActive', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionActive']) {\n          pair.bodyA['collisionActive'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionActive']) {\n          pair.bodyB['collisionActive'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionStart', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionStart']) {\n          pair.bodyA['collisionStart'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionStart']) {\n          pair.bodyB['collisionStart'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionEnd', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionEnd']) {\n          pair.bodyA['collisionEnd'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionEnd']) {\n          pair.bodyB['collisionEnd'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    this.runner = Runner.create({ isFixed: false });\n    // render\n    const canvas = document.getElementById(this.settings.canvas);\n    let render_width = canvas!.clientWidth;\n    let render_height =\n      (canvas!.clientWidth * this.world!.height) / this.world!.width;\n    if (render_height > canvas!.clientHeight) {\n      render_height = canvas!.clientHeight;\n      render_width =\n        (canvas!.clientHeight * this.world!.width) / this.world!.height;\n    }\n    const render = {\n      /* Matter.js  canvas   */\n      // element: document.getElementById('canvas'),\n      element: canvas,\n      engine: this.engine,\n      options: {\n        /*  */\n        width: render_width,\n        height: render_height,\n        background: this.world!.background,\n        font: this.world!.font,\n        wireframes: false,\n      },\n    };\n    this.render = Render.create(render);\n    this.canvas = this.render!.canvas;\n    /* / */\n    Render['lookAt'](this.render, this.world!.view);\n    /*  */\n    const mouse = Mouse.create(this.render!.canvas);\n    const constraintOptions = {\n      pointA: { x: 0, y: 0 },\n      pointB: { x: 0, y: 0 },\n      stiffness: this.world!['mouseStiffness'] || 0.2 /*  */,\n    };\n    constraintOptions['render'] = {\n      visible: false,\n    };\n    const mouseConstraint = MouseConstraint.create(this.engine, {\n      mouse,\n      constraint: Constraint.create(constraintOptions),\n    });\n    World.add(this.engine.world, mouseConstraint);\n    this.render!['mouse'] = mouse;\n\n    // an example of using mouse events on a mouse\n    // const mouse = Mouse.create(this.element);\n    // this.element.addEventListener('click', () => {\n    //   const query = Query.point(Composite.allBodies(world), mouse.position)\n    //   console.log(mouse.position);\n    //   console.log(query);\n    // });\n    Matter.Events.on(mouseConstraint, 'mousedown', event => {\n      const mouse = event.mouse;\n      let body = event.sourcebody;\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        body = bodies[i];\n        if (\n          Bounds.contains(body.bounds, mouse.position) &&\n          Detector.canCollide(\n            body.collisionFilter,\n            mouseConstraint.collisionFilter\n          )\n        ) {\n          for (\n            let j = body.parts.length > 1 ? 1 : 0;\n            j < body.parts.length;\n            j += 1\n          ) {\n            const part = body.parts[j];\n            if (\n              part['clicked'] &&\n              Vertices.contains(part.vertices, mouse.position)\n            ) {\n              part['clicked'](part);\n              break;\n            }\n          }\n        }\n      }\n    });\n    //\n    this.vars = initVars({});\n    // this.main = code.main || (function* (Matter: any, puppy: Puppy) { });\n\n    Runner.run(this.runner, this.engine); /* */\n    Render.run(this.render); /*  */\n    // this.runner.enabled = false; /* */\n  }\n\n  public dispose() {\n    if (this.engine) {\n      World.clear(this.engine.world, false);\n      Engine.clear(this.engine);\n    }\n    /* engine */\n    if (this.runner) {\n      Runner.stop(this.runner);\n    }\n    if (this.render) {\n      Render.stop(this.render);\n      this.render.canvas.remove();\n      // this.render!.canvas = null;\n      // this.render!.context = null;\n      this.render.textures = {};\n    }\n  }\n\n  // private DefaultRenderOptions: () => Matter.IRenderDefinition;\n\n  public getCode() {\n    return this.code;\n  }\n\n  public getCanvas() {\n    return this.canvas;\n  }\n\n  public resize(width: number, height: number) {\n    // console.log(`'resize width ${width} ${this.canvas.clientWidth} height ${height} ${this.canvas.clientHeight}`);\n    let w = width;\n    let h = (width * this.world!.viewHeight) / this.world!.viewWidth;\n    if (h > height) {\n      h = height;\n      w = (height * this.world!.viewWidth) / this.world!.viewHeight;\n    }\n    this.canvas!.setAttribute('width', w.toString());\n    this.canvas!.setAttribute('height', h.toString());\n    // console.log('resize width {this.render.options.width} => {w} height {this.render.options.height} => {h}');\n    this.render!.options.width = w;\n    this.render!.options.height = h;\n  }\n\n  public async wait(msec) {\n    await new Promise(resolve => setTimeout(resolve, msec));\n  }\n\n  public async waitForRun(interval) {\n    while (this.waitRestart) {\n      await this.wait(interval);\n    }\n    this.runner!.enabled = true;\n  }\n\n  public async execute_main() {\n    const diffStartLineNumber = getDiffStartLineNumber();\n    this.isExecuting = true;\n    for await (const lineNumber of this.code.main(this)) {\n      if (lineNumber < diffStartLineNumber && getIsLive()) {\n        for (let i = 0; i < this.interval / this.runner!.delta; i += 1) {\n          this.engine = Engine.update(this.engine!, undefined, undefined);\n        }\n      } else {\n        setCodeHighlight(lineNumber, lineNumber);\n        await this.waitForRun(1000);\n        await this.wait(this.interval);\n      }\n    }\n    this.isExecuting = false;\n    resetCodeHighlight();\n    // editor NG\n    // let prevline = 0;\n    // const lines: [string] = editor.getSession().getDocument().getAllLines();\n    // for await (const linenum of this.main(Matter, this)) {\n    //   if (prevline == 0 || prevline >= linenum || lines[prevline] == '') {\n    //     selectLine(linenum - 1, linenum);\n    //   }\n    //   else {\n    //     selectLine(prevline, linenum);\n    //   }\n    //   prevline = linenum;\n    //   if (this.isStep) {\n    //     this.runner.enabled = false;\n    //     this.isStep = false;\n    //   } else {\n    //     await this.wait(0.5);\n    //   }\n    //   await this.waitForRun(1);\n    // }\n    // removeLine();\n    // if (this.isStep) {\n    //   this.runner.enabled = true;\n    //   this.isStep = false;\n    // }\n  }\n\n  public isRunning() {\n    return this.runner && this.runner.enabled;\n  }\n\n  public runCode() {\n    this.initCode();\n    this.dispose();\n    this.startCode();\n    this.runner!.enabled = !this.waitRestart;\n    this.execute_main();\n  }\n\n  // public updateLiveCode(code: PuppyCode) {\n  //   this.code = code;\n  //   if (this.runner!.enabled) {\n  //     if (code.diff) {\n  //       this.initCode();\n  //       console.log(`live diff now ${code.diff}`);\n  //       code.diff(this);\n  //       return true;\n  //     }\n  //     if (code.lives && code.lives.length > 0) {\n  //       this.initCode();\n  //       const bodies = Matter.Composite.allBodies(this.engine!.world);\n  //       for (const body of bodies) {\n  //         for (const live of code.lives) {\n  //           if (body['oid'] === live[0]) {\n  //             console.log(body);\n  //             console.log(live);\n  //             const name = live[1];\n  //             console.log(`change ${name} ${body[name]} ${live[2]} ${live[3]}`);\n  //             // if (body[name] === live[3] || live[3] == null) {\n  //             setShapeProperty(this, body as Shape, name, live[2]);\n  //             // }\n  //           }\n  //         }\n  //       }\n  //       return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n\n  public pause() {\n    this.waitRestart = true;\n    this.runner!.enabled = false;\n  }\n\n  public start() {\n    if (this.isExecuting) {\n      this.waitRestart = false;\n    } else {\n      this.runner!.enabled = true;\n    }\n  }\n\n  public getTimeStamp() {\n    return this.engine!.timing.timestamp;\n  }\n\n  // lives\n\n  public ln(n: number) {\n    return this.code.lines[n];\n  }\n\n  // Puppy APIs\n\n  public new_ = (\n    cons: PuppyConstructor,\n    x: number,\n    y: number,\n    options: Shape\n  ) => {\n    if (!options.position) {\n      options.position = { x, y };\n    }\n    const body: Matter.Body = cons(this, options);\n    World.add(this.engine!.world, [body]);\n    return body;\n  };\n\n  public Circle = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Circle'], x, y, options);\n  };\n\n  public Rectangle = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Rectangle'], x, y, options);\n  };\n\n  public Polygon = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Polygon'], x, y, options);\n  };\n\n  public Label = (x: number, y: number, options: Shape) => {\n    return this.new_(this.vars['Label'], x, y, options);\n  };\n\n  public World = (x: number, y: number, options: Partial<PuppyWorld>) => {\n    if (this.engine && this.world) {\n      this.world.viewWidth = x;\n      this.world.viewHeight = y;\n      const pos = this.world.view.min;\n      this.world.view = {\n        min: pos,\n        max: { x: pos.x + x, y: pos.y + y },\n      };\n      this.resize(this.render!.options.width!, this.render!.options.height!);\n      Render['lookAt'](this.render, this.world!.view);\n      if (options) {\n        Object.keys(options).map((key: string) => {\n          if (this.world && key in this.world) {\n            if (key == 'background') {\n              this.render!.options['background'] = options['background'];\n            }\n            this.world[key] = options[key];\n          }\n          if (this.engine && key in this.engine.world) {\n            this.engine.world[key] = options[key];\n          }\n        });\n      }\n    }\n  };\n\n  public async input(msg?: string) {\n    this.runner!.enabled = false;\n    const x = await getInputValue(msg ? msg : '');\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    console.log(`input ${x}`);\n    return x;\n  }\n\n  public async input0(console?: string) {\n    this.runner!.enabled = false;\n    const awaitForClick = target => {\n      return new Promise(resolve => {\n        // A\n        const listener = resolve; // B\n        target.addEventListener('click', listener, { once: true }); // C\n      });\n    };\n    const text = document.getElementById('inputtext') as HTMLInputElement;\n    const f = async () => {\n      const target = document.querySelector('#submitInput');\n      let Text = '';\n      document.getElementById('submitInput')!.onclick = () => {\n        document.getElementById('myOverlay')!.style.display = 'none';\n        Text = text.value;\n        text.value = '';\n      };\n      await awaitForClick(target);\n      return Text;\n    };\n\n    text.placeholder = console ? console : 'Input here';\n    document.getElementById('myOverlay')!.style.display = 'block';\n    const x = await f();\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    return x;\n  }\n\n  public print(text: string, options = {}) {\n    const width = this.world!.width;\n    const _options: Shape = Common.extend(\n      {\n        shape: 'label',\n        value: `${text}`,\n        created: this.getTimeStamp(),\n        move: (body, time: number) => {\n          const px = width - 100 * (time - body['created']) * 0.003;\n          Matter.Body.setPosition(body, { x: px, y: body.position.y });\n          if (px < -1) {\n            World.remove(this.engine!.world, body);\n          }\n        },\n      },\n      options\n    );\n    const x = this.world!.width;\n    const y = this.world!.height * (Math.random() * 0.9 + 0.05);\n    this.new_(this.vars['Label'], x, y, _options);\n  }\n\n  public trace(log: {}) {\n    console.log(log);\n    // this.settings.trace(log);\n  }\n\n  /* operator */\n\n  public listAdd(x: [], y: []) {\n    return x.concat(y);\n  }\n\n  public anyMul(x, y) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: [any]) {\n    return a.indexOf(x) >= 0;\n  }\n\n  /* built-in */\n\n  public int(x: any) {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      return Number.parseInt(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public float(x: any) {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      return Number.parseFloat(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public str(x: any) {\n    if (typeof x === 'boolean') {\n      return x ? 'True' : 'False';\n    }\n    if (Array.isArray(x)) {\n      return '[' + x.map(x => this.str(x)).join(', ') + ']';\n    }\n    return `${x}`;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public getindex(a: any, index: number) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substr(x, y - x);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: []) {\n    return x.length;\n  }\n\n  public map(func: any, lst: number[]) {\n    return Array.from(lst, func); // func\n  }\n\n  /* Matter.Body */\n\n  public setPosition(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setPosition(body, { x, y });\n  }\n\n  public applyForce(\n    body: Matter.Body,\n    x: number,\n    y: number,\n    fx: number,\n    fy: number\n  ) {\n    Matter.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: Matter.Body, angle: number, _x?: number, _y?: number) {\n    Matter.Body.rotate(body, angle);\n  }\n\n  public scale(\n    body: Matter.Body,\n    sx: number,\n    sy: number,\n    _x?: number,\n    _y?: number\n  ) {\n    Matter.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: Matter.Body, angle: number) {\n    Matter.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: Matter.Body, velocity: number) {\n    Matter.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: Matter.Body, density: number) {\n    Matter.Body.setDensity(body, density);\n  }\n\n  public setMass(body: Matter.Body, mass: number) {\n    Matter.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: Matter.Body, flag: boolean) {\n    Matter.Body.setStatic(body, flag);\n  }\n}\n\n/* puppy controller */\n\nlet puppy_settings = {\n  canvas: 'puppy-screen',\n  ftrace: (_log: {}) => {},\n};\n\nexport const initPuppy = (settings?: PuppySettings) => {\n  if (settings) {\n    puppy_settings = settings;\n  }\n};\n\nexport const runPuppy = (\n  puppy: Puppy | null,\n  code: PuppyCode,\n  alwaysRun: boolean,\n  waitStart = false\n) => {\n  if (puppy != null) {\n    if (!alwaysRun && code) {\n      // if (puppy.getCode().hash === code.hash) {\n      //   return puppy;\n      // }\n      if (puppy.isRunning()) {\n        // console.log(`lives ${code.lives}`);\n        // console.log(`diff ${code.diff}`);\n        // if (puppy.updateLiveCode(code)) {\n        //   return puppy;\n        // }\n      }\n    }\n  }\n  if (code) {\n    if (puppy != null) {\n      puppy.dispose();\n    }\n    const newpuppy = new Puppy(puppy_settings, code, waitStart);\n    newpuppy.runCode();\n    return newpuppy;\n  }\n  return null;\n};\n","// \n// punk\n\n// https://ja.stackoverflow.com/questions/4445/matter-js\n\nexport const myRender = render => {\n  const _getTexture = (render, imagePath: string) => {\n    let image = render.textures[imagePath];\n    if (image) {\n      return image;\n    }\n    image = render.textures[imagePath] = new Image();\n    if (\n      imagePath.startsWith('http://') ||\n      imagePath.startsWith('https://') ||\n      imagePath.startsWith('data:') ||\n      imagePath.startsWith('/')\n    ) {\n      image.src = imagePath;\n    } else {\n      image.src = `/image/${imagePath}`;\n    }\n    return image;\n  };\n\n  render['bodies'] = function(render, bodies, context) {\n    const c = context;\n    const options = render.options;\n    // const wireframes = options.wireframes;\n    const showInternalEdges = options.showInternalEdges || !options.wireframes;\n    const defaultFont = options.font || \"bold 60px 'Arial'\";\n    const defaultFontColor = options.fontColor || 'gray';\n\n    for (let i = 0; i < bodies.length; i += 1) {\n      const body = bodies[i];\n      if (!body.visible) {\n        continue;\n      }\n      // handle compound parts\n      for (\n        let k = body.parts.length > 1 ? 1 : 0;\n        k < body.parts.length;\n        k += 1\n      ) {\n        const part = body.parts[k];\n        if (!part.visible) {\n          continue;\n        }\n        if (part.opacity !== 1) {\n          c.globalAlpha = part.opacity;\n        }\n\n        if (part.image) {\n          const texture = _getTexture(render, part.image);\n          c.translate(part.position.x, part.position.y);\n          c.rotate(part.angle);\n          c.drawImage(\n            texture,\n            part.width * -0.5,\n            part.height * -0.5,\n            part.width,\n            part.height\n          );\n          c.rotate(-part.angle);\n          c.translate(-part.position.x, -part.position.y);\n        } else {\n          // part polygon\n          if (part.circleRadius) {\n            c.beginPath();\n            c.arc(\n              part.position.x,\n              part.position.y,\n              part.circleRadius,\n              0,\n              2 * Math.PI\n            );\n          } else {\n            c.beginPath();\n            c.moveTo(part.vertices[0].x, part.vertices[0].y);\n            for (let j = 1; j < part.vertices.length; j += 1) {\n              if (!part.vertices[j - 1].isInternal || showInternalEdges) {\n                c.lineTo(part.vertices[j].x, part.vertices[j].y);\n              } else {\n                c.moveTo(part.vertices[j].x, part.vertices[j].y);\n              }\n              if (part.vertices[j].isInternal && !showInternalEdges) {\n                c.moveTo(\n                  part.vertices[(j + 1) % part.vertices.length].x,\n                  part.vertices[(j + 1) % part.vertices.length].y\n                );\n              }\n            }\n            c.lineTo(part.vertices[0].x, part.vertices[0].y);\n            c.closePath();\n          }\n          if (!options.wireframes) {\n            c.fillStyle = part.fillStyle;\n            if (part.lineWidth) {\n              c.lineWidth = part.lineWidth;\n              c.strokeStyle = part.strokeStyle;\n              c.stroke();\n            }\n            c.fill();\n          } else {\n            c.lineWidth = 1;\n            c.strokeStyle = '#bbb';\n            c.stroke();\n          }\n        }\n\n        if (part.value !== undefined) {\n          // Make to show null and 0.\n          if (part.ref) {\n            part.value = part.ref();\n          }\n          c.save();\n          c.font = part.font || defaultFont;\n          c.fillStyle = part.fontColor || defaultFontColor;\n          c.textAlign = part.textAlign || 'center';\n          if (part.shadowColor) {\n            c.shadowColor = part.shadowColor; // \n            c.shadowBlur = c.shadowBlur || 0; // \n            c.shadowOffsetX = c.shadowOffsetX || 2; // 3px\n            c.shadowOffsetY = c.shadowOffsetY || 2; // 1px\n          }\n          c.fillText(`${part.value}`, part.position.x, part.position.y + 10);\n          c.restore();\n        }\n        c.globalAlpha = 1;\n      }\n    }\n  };\n  return render;\n};\n","import { Action, createStore, combineReducers } from 'redux';\nimport editor, { EditorState, EditorActions } from './modules/editor';\nimport course, { CourseState, CourseActions } from './modules/course';\nimport puppy, { PuppyState, PuppyActions } from './modules/puppy';\nimport input, { InputState, InputActions } from './modules/input';\nimport version, { VersionState, VersionActions } from './modules/version';\n\nconst allReducers = combineReducers({\n  editor,\n  course,\n  puppy,\n  input,\n  version,\n});\n\nexport const store = createStore(allReducers);\n\nexport type ReduxState = {\n  editor: EditorState;\n  course: CourseState;\n  puppy: PuppyState;\n  input: InputState;\n  version: VersionState;\n};\n\nexport type ReduxActions =\n  | PuppyActions\n  | EditorActions\n  | CourseActions\n  | InputActions\n  | VersionActions\n  | Action;\n\nexport default store;\n","export class ParseTree {\n  public tag: string;\n  public urn: any;\n  public inputs: string;\n  public spos: number;\n  public epos: number;\n  public nodes: [string, ParseTree][];\n\n  public constructor(tag: string, spos: number, epos: number, child: any) {\n    this.tag = tag;\n    this.urn = child;\n    this.inputs = '';\n    this.spos = spos;\n    this.epos = epos;\n    this.nodes = ParseTree.empties;\n  }\n\n  static empties: [string, ParseTree][] = [];\n\n  protected setup(urn: string, inputs: string) {\n    if (this.urn !== null) {\n      const nodes: [string, ParseTree][] = [];\n      var entry: Merge = this.urn;\n      while (entry !== null) {\n        nodes.push([entry.edge, entry.child.setup(urn, inputs)]);\n        entry = entry.prev;\n      }\n      this.nodes = nodes.reverse();\n    }\n    this.urn = urn;\n    this.inputs = inputs;\n    var t: any = this;\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      t[i] = this.nodes[i][1];\n      if (this.nodes[i][0] !== '') {\n        t[this.nodes[i][0]] = this.nodes[i][1];\n      }\n    }\n    return this;\n  }\n\n  public is(tag: string) {\n    return this.tag === tag;\n  }\n\n  public isError() {\n    return this.tag === 'err';\n  }\n\n  public subs(): ParseTree[] {\n    const subs: ParseTree[] = [];\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      subs.push(this.nodes[i][1]);\n    }\n    return subs;\n  }\n\n  public size() {\n    return this.nodes.length;\n  }\n\n  public contains(edge: string) {\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      if (this.nodes[i][0] === edge) return true;\n    }\n    return false;\n  }\n\n  public get(index: any) {\n    return (this as any)[index];\n  }\n\n  public tokenize(index?: any, defstr?: string) {\n    if (index === undefined) {\n      return this.inputs.substring(this.spos, this.epos);\n    }\n    const child = (this as any)[index];\n    if (child === undefined) {\n      return defstr || '';\n    }\n    return child.tokenize();\n  }\n\n  private pos(pos: number) {\n    const s = this.inputs;\n    pos = Math.min(pos, s.length);\n    var row = 0;\n    var col = 0;\n    for (var i = 0; i <= pos; i += 1) {\n      if (s.charCodeAt(i) == 10) {\n        row += 1;\n        col = 0;\n      } else {\n        col += 1;\n      }\n    }\n    return [pos, row, col];\n  }\n\n  public begin() {\n    return this.pos(this.spos);\n  }\n\n  public end() {\n    return this.pos(this.spos);\n  }\n\n  public length() {\n    return this.epos - this.spos;\n  }\n\n  public toString() {\n    const sb: string[] = [];\n    this.strOut(sb);\n    return sb.join('');\n  }\n\n  protected strOut(sb: string[]) {\n    sb.push('[#');\n    sb.push(this.tag);\n    for (const node of this.nodes) {\n      sb.push(node[0] === '' ? ' ' : ` ${node[0]}=`);\n      node[1].strOut(sb);\n    }\n    if (this.nodes.length == 0) {\n      const s = this.inputs.substring(this.spos, this.epos);\n      sb.push(\" '\");\n      sb.push(s);\n      sb.push(\"'\");\n    }\n    sb.push(']');\n  }\n}\n\nclass Merge {\n  public prev: any;\n  public edge: string;\n  public child: ParseTree;\n\n  public constructor(prev: any, edge: string, child: ParseTree) {\n    this.prev = prev;\n    this.edge = edge;\n    this.child = child;\n  }\n}\n\nclass ParserContext {\n  public urn: string;\n  public inputs: String;\n  public pos: number;\n  public epos: number;\n  public head_pos: number;\n  public ast: any;\n  public state: State | null;\n  public memos: Memo[];\n  public constructor(urn: string, inputs: string, pos: number, epos: number) {\n    this.urn = urn;\n    this.inputs = inputs;\n    this.pos = pos;\n    this.epos = epos;\n    this.head_pos = pos;\n    this.ast = null;\n    this.state = null;\n    this.memos = [];\n    for (var i = 0; i < 1789; i++) {\n      this.memos.push(new Memo());\n    }\n  }\n}\n\nconst EMPTY = (px: ParserContext) => {\n  return true;\n};\n\nconst pEmpty = () => {\n  return EMPTY;\n};\n\nconst ANY = (px: ParserContext) => {\n  if (px.pos < px.epos) {\n    px.pos += 1;\n    return true;\n  }\n  return false;\n};\n\nconst pAny = () => {\n  return ANY;\n};\n\nconst pChar = (text: string) => {\n  const text_length = text.length;\n\n  return (px: ParserContext) => {\n    if (px.inputs.startsWith(text, px.pos)) {\n      px.pos += text_length;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst find_codemax = (chars: string, ranges: string[]) => {\n  var code = 0;\n  for (var i = 0; i < chars.length; i += 1) {\n    code = Math.max(chars.charCodeAt(i), code);\n  }\n  for (const range of ranges) {\n    code = Math.max(range.charCodeAt(0), code);\n    code = Math.max(range.charCodeAt(1), code);\n  }\n  return code;\n};\n\nconst set_bitmap = (bitmap: Uint8Array, c: number) => {\n  const n = (c / 8) | 0;\n  const mask = 1 << (c % 8 | 0);\n  //console.log(n);\n  //console.log(bitmap[n])\n  bitmap[n] |= mask;\n  //console.log(bitmap);\n};\n\nconst pRange = (chars: string, ranges: string[]) => {\n  const codemax = find_codemax(chars, ranges) + 1;\n  const bitmap = new Uint8Array(((codemax / 8) | 0) + 1);\n  bitmap[0] = 2;\n  for (var i = 0; i < chars.length; i += 1) {\n    set_bitmap(bitmap, chars.charCodeAt(i));\n  }\n  for (const range of ranges) {\n    for (var c = range.charCodeAt(0); c <= range.charCodeAt(1); c += 1) {\n      set_bitmap(bitmap, c);\n    }\n  }\n  //console.log(`bitmap ${ bitmap.length } `)\n  return (px: ParserContext) => {\n    if (px.pos < px.epos) {\n      const c = px.inputs.charCodeAt(px.pos);\n      const n = (c / 8) | 0;\n      const mask = 1 << (c % 8 | 0);\n      if (n < bitmap.length && (bitmap[n] & mask) === mask) {\n        px.pos += 1;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pMany = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    var pos = px.pos;\n    var ast = px.ast;\n    while (match(px) && px.pos > pos) {\n      pos = px.pos;\n      ast = px.ast;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return true;\n  };\n};\n\nconst pMany1 = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    if (match(px)) {\n      var pos = px.pos;\n      var ast = px.ast;\n      while (match(px) && px.pos > pos) {\n        pos = px.pos;\n        ast = px.ast;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAnd = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pNot = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return false;\n    }\n    return true;\n  };\n};\n\nconst pOption = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (!match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return true;\n  };\n};\n\nconst pSeq = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    for (const match of matches) {\n      if (!match(px)) {\n        return false;\n      }\n    }\n    return true;\n  };\n};\n\nconst pSeq2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px);\n  };\n};\n\nconst pSeq3 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean,\n  match3: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px) && match3(px);\n  };\n};\n\nconst pOre = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    for (const match of matches) {\n      if (match(px)) {\n        return true;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return false;\n  };\n};\n\nconst pOre2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      return true;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return match2(px);\n  };\n};\n\nconst pRef = (peg: any, name: string) => {\n  if (peg[name]) {\n    return peg[name];\n  }\n  return (px: ParserContext) => {\n    return peg[name](px);\n  };\n};\n\nclass Memo {\n  public key: number;\n  public constructor() {\n    this.key = -1;\n  }\n}\n\nconst pNode = (\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = null;\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\n//def Merge(prev, edge, child):\n//return (prev, edge, child)\n\nconst pEdge = (edge: string, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = new Merge(ast, edge, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pFold = (\n  edge: string,\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = new Merge(null, edge, px.ast);\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAbs = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pSkipErr = () => {\n  return (px: ParserContext) => {\n    px.pos = Math.min(px.head_pos, px.epos);\n    return true;\n  };\n};\n\nclass State {\n  public sid: number;\n  public value: any;\n  public prev: State | null;\n  public constructor(sid: number, value: any, prev: State | null) {\n    this.sid = sid;\n    this.value = value;\n    this.prev = prev;\n  }\n}\n\nconst getstate = (state: State | null, sid: number) => {\n  while (state !== null) {\n    if (state.sid === sid) {\n      return state;\n    }\n    state = state.prev;\n  }\n  return null;\n};\n\nconst pSymbol = (sid: number, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.state = new State(sid, px.inputs.substring(pos, px.pos), px.state);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pExists = (sid: number) => {\n  return (px: ParserContext) => {\n    return getstate(px.state, sid) !== null;\n  };\n};\n\nconst pMatch = (sid: number) => {\n  return (px: ParserContext) => {\n    const state = getstate(px.state, sid);\n    if (state !== null) {\n      if (px.inputs.startsWith(state.value, px.pos)) {\n        px.pos += (state.value as string).length;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pScope = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const state = px.state;\n    const res = match(px);\n    px.state = state;\n    return res;\n  };\n};\n\nexport const generate = (start: string) => {\n  const match = grammar(start);\n  if (match === undefined) {\n    console.log(`undefined ${start}`);\n    console.log(peg);\n  }\n  return (inputs: string, options?: any) => {\n    const op = options === undefined ? {} : options;\n    const pos = 0;\n    const px = new ParserContext(\n      op['urn'] || '(unknown source)',\n      inputs,\n      0,\n      inputs.length\n    );\n    if (match(px)) {\n      if (px.ast === null) {\n        px.ast = new ParseTree('', pos, px.pos, null);\n      }\n    } else {\n      px.ast = new ParseTree('err', px.head_pos, px.head_pos + 1, null);\n    }\n    return px.ast.setup(px.urn, inputs);\n  };\n};\n\nlet peg: any = null;\n\nconst grammar = (start: string) => {\n  if (peg === null) {\n    peg = {};\n    peg['Source'] = pSeq3(\n      pOption(pRef(peg, 'EOL')),\n      pNode(\n        pMany(pSeq2(pEdge('', pRef(peg, 'Statement')), pRef(peg, 'EOL'))),\n        'Source',\n        0\n      ),\n      pRef(peg, 'EOF')\n    );\n    peg['Block'] = pNode(\n      pScope(\n        pSeq3(\n          pSymbol(0, pRef(peg, 'INDENT')),\n          pOre2(\n            pSeq3(\n              pEdge('', pRef(peg, 'Statement')),\n              pMany(pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))),\n              pOption(pRef(peg, '\";\"'))\n            ),\n            pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n          ),\n          pMany(\n            pSeq2(\n              pMatch(0),\n              pOre2(\n                pSeq3(\n                  pEdge('', pRef(peg, 'Statement')),\n                  pMany(\n                    pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))\n                  ),\n                  pOption(pRef(peg, '\";\"'))\n                ),\n                pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n              )\n            )\n          )\n        )\n      ),\n      'Block',\n      0\n    );\n    peg['Statement'] = pOre(\n      pRef(peg, 'ClassDecl'),\n      pRef(peg, 'ImportDecl'),\n      pRef(peg, 'FuncDecl'),\n      pRef(peg, 'IfStmt'),\n      pRef(peg, 'ForStmt'),\n      pRef(peg, 'WhileStmt'),\n      pRef(peg, 'Return'),\n      pRef(peg, 'Yield'),\n      pRef(peg, 'Break'),\n      pRef(peg, 'Continue'),\n      pRef(peg, 'VarDecl'),\n      pRef(peg, 'Expression')\n    );\n    peg['ImportDecl'] = pOre2(\n      pNode(\n        pSeq3(\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pOption(\n            pSeq2(\n              pSeq2(pChar('as'), pRef(peg, 'S')),\n              pEdge('alias', pRef(peg, 'Name'))\n            )\n          )\n        ),\n        'ImportDecl',\n        0\n      ),\n      pNode(\n        pSeq(\n          pSeq2(pChar('from'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge(\n            'names',\n            pOre2(\n              pNode(\n                pSeq2(\n                  pEdge('', pRef(peg, 'Name')),\n                  pMany(\n                    pSeq3(\n                      pChar(','),\n                      pRef(peg, '_'),\n                      pEdge('', pRef(peg, 'Name'))\n                    )\n                  )\n                ),\n                '',\n                0\n              ),\n              pNode(pSeq2(pChar('*'), pRef(peg, '_')), '', 0)\n            )\n          )\n        ),\n        'FromDecl',\n        0\n      )\n    );\n    peg['ClassDecl'] = pNode(\n      pSeq(\n        pChar('class'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq(\n            pChar('('),\n            pRef(peg, '_'),\n            pEdge('extends', pRef(peg, 'Name')),\n            pChar(')'),\n            pRef(peg, '_')\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pOre2(pEdge('', pRef(peg, 'Block')), pEdge('', pRef(peg, 'Statement')))\n      ),\n      'ClassDecl',\n      0\n    );\n    peg['FuncDecl'] = pNode(\n      pSeq(\n        pChar('def'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pEdge('params', pRef(peg, 'FuncParams')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncDecl',\n      0\n    );\n    peg['FuncParams'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pOption(pEdge('', pRef(peg, 'FuncParam'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'FuncParam')))),\n        pRef(peg, '\")\"')\n      ),\n      'FuncParam',\n      0\n    );\n    peg['FuncParam'] = pNode(\n      pSeq2(\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq3(pChar(':'), pRef(peg, '_'), pEdge('type', pRef(peg, 'Name')))\n        )\n      ),\n      'Param',\n      0\n    );\n    peg['Lambda'] = pNode(\n      pSeq(\n        pChar('lambda'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('params', pRef(peg, 'LambdaParams'))\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncExpr',\n      0\n    );\n    peg['LambdaParams'] = pNode(\n      pSeq2(\n        pOption(pEdge('', pRef(peg, 'Name'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Name'))))\n      ),\n      'Param',\n      0\n    );\n    peg['Return'] = pNode(\n      pSeq2(\n        pChar('return'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('expr', pRef(peg, 'Expression'))\n          )\n        )\n      ),\n      'Return',\n      0\n    );\n    peg['Yield'] = pNode(pSeq2(pChar('yield'), pRef(peg, '_')), 'Yield', 0);\n    peg['Pass'] = pNode(pSeq2(pChar('pass'), pRef(peg, '_')), 'Pass', 0);\n    peg['Break'] = pNode(pSeq2(pChar('break'), pRef(peg, '_')), 'Break', 0);\n    peg['Continue'] = pNode(\n      pSeq2(pChar('continue'), pRef(peg, '_')),\n      'Continue',\n      0\n    );\n    peg['IfStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('if'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement'))),\n        pOption(pEdge('elif', pRef(peg, 'ElifBlock'))),\n        pOption(\n          pSeq(\n            pOre2(pMatch(0), pRef(peg, 'NL')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pChar(':'),\n            pRef(peg, '_'),\n            pEdge('else', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n          )\n        )\n      ),\n      'IfStmt',\n      0\n    );\n    peg['ElifBlock'] = pNode(pMany1(pEdge('', pRef(peg, 'ElifStmt'))), '', 0);\n    peg['ElifStmt'] = pNode(\n      pSeq(\n        pOre2(pMatch(0), pRef(peg, 'NL')),\n        pSeq2(pChar('elif'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ElifStmt',\n      0\n    );\n    peg['ForStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('for'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('each', pRef(peg, 'Name')),\n        pSeq2(pChar('in'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('list', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ForStmt',\n      0\n    );\n    peg['WhileStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('while'), pRef(peg, 'S')),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'WhileStmt',\n      0\n    );\n    peg['VarDecl'] = pOre2(\n      pNode(\n        pSeq(\n          pEdge('left', pRef(peg, 'LeftHand')),\n          pChar('='),\n          pRef(peg, '_'),\n          pEdge('right', pRef(peg, 'Expression'))\n        ),\n        'VarDecl',\n        0\n      ),\n      pRef(peg, 'SelfAssign')\n    );\n    peg['LeftHand'] = pSeq2(\n      pRef(peg, 'Name'),\n      pMany(\n        pOre2(\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['SelfAssign'] = pNode(\n      pSeq3(\n        pEdge('left', pRef(peg, 'LeftHand')),\n        pEdge('name', pRef(peg, 'SelfAssignOp')),\n        pEdge('right', pRef(peg, 'Expression'))\n      ),\n      'SelfAssign',\n      0\n    );\n    peg['SelfAssignOp'] = pSeq2(\n      pNode(\n        pSeq2(\n          pOre(\n            pChar('<<'),\n            pChar('>>'),\n            pChar('**'),\n            pChar('//'),\n            pRange('+=*@/%&|^', [])\n          ),\n          pChar('=')\n        ),\n        '',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Expression'] = pSeq2(\n      pRef(peg, 'Operator'),\n      pOption(\n        pFold(\n          'then',\n          pSeq(\n            pChar('if'),\n            pRef(peg, '_'),\n            pEdge('cond', pRef(peg, 'Expression')),\n            pChar('else'),\n            pRef(peg, '_'),\n            pEdge('else', pRef(peg, 'Expression'))\n          ),\n          'IfExpr',\n          0\n        )\n      )\n    );\n    peg['Operator'] = pSeq2(\n      pRef(peg, 'AndExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'OR'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'AndExpr'))\n          ),\n          'Or',\n          0\n        )\n      )\n    );\n    peg['OR'] = pOre2(pChar('or'), pChar('||'));\n    peg['AndExpr'] = pSeq2(\n      pRef(peg, 'NotExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'AND'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'NotExpr'))\n          ),\n          'And',\n          0\n        )\n      )\n    );\n    peg['AND'] = pOre2(pChar('and'), pChar('&&'));\n    peg['NotExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pRef(peg, 'NOT'),\n          pRef(peg, '_'),\n          pEdge('', pRef(peg, 'NotExpr'))\n        ),\n        'Not',\n        0\n      ),\n      pRef(peg, 'EqExpr')\n    );\n    peg['NOT'] = pOre2(pSeq2(pChar('not'), pRef(peg, 'S')), pChar('!'));\n    peg['EqExpr'] = pSeq2(\n      pRef(peg, 'SumExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'EQ'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'SumExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['EQ'] = pOre(\n      pSeq2(pChar('=='), pNot(pChar('='))),\n      pSeq2(pChar('!='), pNot(pChar('='))),\n      pSeq2(pChar('<='), pNot(pChar('='))),\n      pSeq2(pChar('>='), pNot(pChar('='))),\n      pSeq2(pChar('<'), pNot(pChar('<'))),\n      pSeq2(pChar('>'), pNot(pChar('>'))),\n      pSeq2(pChar('in'), pRef(peg, 'S')),\n      pSeq2(pChar('is'), pRef(peg, 'S')),\n      pSeq2(pChar('is not'), pRef(peg, 'S'))\n    );\n    peg['SumExpr'] = pSeq2(\n      pRef(peg, 'ProdExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'SUM'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'ProdExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['SUM'] = pRange('+-|', []);\n    peg['ProdExpr'] = pSeq2(\n      pRef(peg, 'PowExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'PROD'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'PowExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['PROD'] = pOre(\n      pChar('//'),\n      pChar('<<'),\n      pChar('>>'),\n      pRange('*/%^&', [])\n    );\n    peg['PowExpr'] = pSeq2(\n      pRef(peg, 'UnaryExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pChar('**'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'UnaryExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['UnaryExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pEdge('name', pNode(pRef(peg, 'PRE'), 'Name', 0)),\n          pRef(peg, '_'),\n          pEdge('expr', pRef(peg, 'UnaryExpr'))\n        ),\n        'Unary',\n        0\n      ),\n      pRef(peg, 'SuffixExpr')\n    );\n    peg['PRE'] = pRange('+-~', []);\n    peg['SuffixExpr'] = pSeq2(\n      pRef(peg, 'Primary'),\n      pMany(\n        pOre(\n          pFold(\n            'recv',\n            pSeq(\n              pChar('.'),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name')),\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'MethodExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRange('.', []),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name'))\n            ),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'name',\n            pSeq(\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'ApplyExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq(\n              pRef(peg, '\"[\"'),\n              pOption(pEdge('left', pRef(peg, 'Expression'))),\n              pChar(':'),\n              pRef(peg, '_'),\n              pOption(pEdge('right', pRef(peg, 'Expression'))),\n              pRef(peg, '\"]\"')\n            ),\n            'Slice',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['Arguments'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pEdge('', pRef(peg, 'Expression')), pNot(pChar('=')))),\n        pMany(\n          pSeq(\n            pChar(','),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'Expression')),\n            pNot(pChar('='))\n          )\n        ),\n        pOption(pEdge('', pRef(peg, 'KeywordArgument')))\n      ),\n      'Arguments',\n      0\n    );\n    peg['KeywordArgument'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pChar(','), pRef(peg, '__'))),\n        pEdge('', pRef(peg, 'Argument')),\n        pMany(\n          pSeq3(pChar(','), pRef(peg, '__'), pEdge('', pRef(peg, 'Argument')))\n        )\n      ),\n      'Data',\n      0\n    );\n    peg['Argument'] = pNode(\n      pSeq(\n        pEdge('name', pRef(peg, 'Name')),\n        pChar('='),\n        pRef(peg, '_'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Primary'] = pOre(\n      pRef(peg, 'GroupExpr'),\n      pRef(peg, 'ListExpr'),\n      pRef(peg, 'DataExpr'),\n      pRef(peg, 'Lambda'),\n      pRef(peg, 'Constant'),\n      pRef(peg, 'Name')\n    );\n    peg['GroupExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pEdge('', pRef(peg, 'Expression')),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression')))),\n        pRef(peg, '__'),\n        pRef(peg, '\")\"')\n      ),\n      'Tuple',\n      0\n    );\n    peg['ListExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"[\"'),\n        pOption(\n          pSeq2(\n            pEdge('', pRef(peg, 'Expression')),\n            pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Expression'))))\n          )\n        ),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"]\"')\n      ),\n      'List',\n      0\n    );\n    peg['DataExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"{\"'),\n        pEdge('', pRef(peg, 'KeyValue')),\n        pMany(pSeq2(pMany(pRef(peg, '\",\"')), pEdge('', pRef(peg, 'KeyValue')))),\n        pMany(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"}\"')\n      ),\n      'Data',\n      0\n    );\n    peg['KeyValue'] = pNode(\n      pSeq3(\n        pEdge(\n          'name',\n          pOre(\n            pRef(peg, 'Name'),\n            pRef(peg, 'StringExpr'),\n            pRef(peg, 'CharExpr')\n          )\n        ),\n        pRef(peg, '\":\"'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Name'] = pOre2(pRef(peg, 'Identifier'), pRef(peg, 'NLPSymbol'));\n    peg['Identifier'] = pSeq2(\n      pNode(\n        pSeq2(pRange('', ['AZ', 'az']), pMany(pRange('_', ['AZ', 'az', '09']))),\n        'Name',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['NLPSymbol'] = pSeq2(\n      pNode(\n        pMany1(pOre(pRef(peg, 'HIRA'), pRef(peg, 'KATA'), pRef(peg, 'KANJI'))),\n        'NLPSymbol',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Constant'] = pOre(\n      pRef(peg, 'FormatString'),\n      pRef(peg, 'LongString'),\n      pRef(peg, 'StringExpr'),\n      pRef(peg, 'CharExpr'),\n      pRef(peg, 'Number'),\n      pRef(peg, 'TrueExpr'),\n      pRef(peg, 'FalseExpr'),\n      pRef(peg, 'NullExpr')\n    );\n    peg['FormatString'] = pSeq3(\n      pRange('Ff', []),\n      pOre(\n        pSeq3(\n          pChar(\"'''\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3'))), 'Format', 0),\n          pChar(\"'''\")\n        ),\n        pSeq3(\n          pChar(\"'\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1'))), 'Format', 0),\n          pChar(\"'\")\n        ),\n        pSeq3(\n          pChar('\"\"\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3D'))), 'Format', 0),\n          pChar('\"\"\"')\n        ),\n        pSeq3(\n          pChar('\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1D'))), 'Format', 0),\n          pChar('\"')\n        )\n      ),\n      pRef(peg, '_')\n    );\n    peg['FormatContent3'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'''\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent3D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"\"\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['LongString'] = pOre2(\n      pSeq(\n        pChar(\"''\"),\n        pNode(\n          pSeq3(\n            pChar(\"'\"),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange(\"\\\\'\", [])), pAny()),\n                pSeq2(pNot(pChar(\"'''\")), pChar(\"'\"))\n              )\n            ),\n            pChar(\"'\")\n          ),\n          'MultiString',\n          0\n        ),\n        pChar(\"''\"),\n        pRef(peg, '_')\n      ),\n      pSeq(\n        pChar('\"\"'),\n        pNode(\n          pSeq3(\n            pChar('\"'),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange('\\\\\"', [])), pAny()),\n                pSeq2(pNot(pChar('\"\"\"')), pChar('\"'))\n              )\n            ),\n            pChar('\"')\n          ),\n          'MultiString',\n          0\n        ),\n        pChar('\"\"'),\n        pRef(peg, '_')\n      )\n    );\n    peg['StringExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar('\"'), pMany(pRef(peg, 'STRING_CONTENT')), pChar('\"')),\n        'String',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['CharExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar(\"'\"), pMany(pRef(peg, 'CHAR_CONTENT')), pChar(\"'\")),\n        'Char',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['STRING_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange('\"\\n\\\\', [])), pAny())\n    );\n    peg['CHAR_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange(\"'\\n\\\\\", [])), pAny())\n    );\n    peg['ESCAPE'] = pOre(\n      pSeq2(pChar('\\\\'), pRange('\\'\"\\\\bfnrt', [])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('', ['03']),\n        pRange('', ['07']),\n        pRange('', ['07'])\n      ),\n      pSeq3(pChar('\\\\'), pRange('', ['07']), pRange('', ['07'])),\n      pSeq2(pChar('\\\\'), pRange('', ['07'])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('uU', []),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX')\n      )\n    );\n    peg['IntExpr'] = pSeq2(\n      pNode(\n        pOre(\n          pRef(peg, 'DECIMAL'),\n          pRef(peg, 'HEXADECIMAL'),\n          pRef(peg, 'BINARY'),\n          pRef(peg, 'OCTAL')\n        ),\n        'Int',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['DECIMAL'] = pOre2(\n      pSeq2(pChar('0'), pNot(pRange('bBxX_', ['09']))),\n      pSeq2(\n        pRange('', ['19']),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      )\n    );\n    peg['HEXADECIMAL'] = pSeq(\n      pChar('0'),\n      pRange('xX', []),\n      pRef(peg, 'HEX'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'HEX')))\n    );\n    peg['BINARY'] = pSeq(\n      pChar('0'),\n      pRange('bB', []),\n      pRange('01', []),\n      pMany(pSeq2(pMany(pChar('_')), pRange('01', [])))\n    );\n    peg['OCTAL'] = pSeq2(\n      pChar('0'),\n      pMany(pSeq2(pMany(pChar('_')), pRange('', ['07'])))\n    );\n    peg['DIGIT'] = pRange('', ['09']);\n    peg['HEX'] = pRange('', ['af', 'AF', '09']);\n    peg['LONG_SUFFIX'] = pRange('lL', []);\n    peg['FloatExpr'] = pSeq2(\n      pNode(pRef(peg, 'FLOAT'), 'Double', 0),\n      pRef(peg, '_')\n    );\n    peg['FLOAT'] = pOre2(\n      pSeq2(pRef(peg, 'FRACTION'), pOption(pRef(peg, 'EXPONENT'))),\n      pSeq2(pMany1(pRef(peg, 'DIGIT')), pRef(peg, 'EXPONENT'))\n    );\n    peg['FRACTION'] = pOre2(\n      pSeq(\n        pNot(pChar('_')),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      ),\n      pSeq(\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pNot(pChar('.'))\n      )\n    );\n    peg['EXPONENT'] = pSeq(\n      pRange('eE', []),\n      pOption(pRange('+-', [])),\n      pRef(peg, 'DIGIT'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n    );\n    peg['Number'] = pOre2(pRef(peg, 'FloatExpr'), pRef(peg, 'IntExpr'));\n    peg['TrueExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Tt', []), pChar('rue')), 'TrueExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['FalseExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Ff', []), pChar('alse')), 'FalseExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['NullExpr'] = pSeq2(\n      pNode(pOre2(pChar('None'), pChar('null')), 'Null', 0),\n      pRef(peg, '_')\n    );\n    peg['EOF'] = pNot(pAny());\n    peg['NL'] = pOre2(pChar('\\n'), pRef(peg, 'EOF'));\n    peg['S'] = pRange(' \\t\\r\\u3000', []);\n    peg['_'] = pMany(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['__'] = pMany(\n      pOre(\n        pRef(peg, 'S'),\n        pChar('\\n'),\n        pRef(peg, 'BLOCKCOMMENT'),\n        pRef(peg, 'LINECOMMENT')\n      )\n    );\n    peg['SPC'] = pMany1(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['BLOCKCOMMENT'] = pOre2(\n      pSeq3(pChar('/*'), pMany(pSeq2(pNot(pChar('*/')), pAny())), pChar('*/')),\n      pSeq3(pChar('(*'), pMany(pSeq2(pNot(pChar('*)')), pAny())), pChar('*)'))\n    );\n    peg['LINECOMMENT'] = pSeq2(\n      pChar('#'),\n      pMany(pSeq2(pNot(pRef(peg, 'NL')), pAny()))\n    );\n    peg['EOL'] = pSeq3(\n      pRef(peg, '_'),\n      pRef(peg, 'NL'),\n      pMany(pSeq2(pRef(peg, '_'), pRef(peg, 'NL')))\n    );\n    peg['INDENT'] = pSeq2(pChar('\\n'), pMany1(pRange(' \\t', [])));\n    peg['C'] = pOre(\n      pRef(peg, 'HIRA'),\n      pRef(peg, 'KATA'),\n      pRef(peg, 'KANJI'),\n      pRef(peg, 'MARK'),\n      pRange('', ['', '', ''])\n    );\n    peg['HIRA'] = pRange('', ['']);\n    peg['KATA'] = pRange('', ['']);\n    peg['KANJI'] = pRange('', ['', '']);\n    peg['MARK'] = pRange('', []);\n    peg['W'] = pRange('', ['', '', '', '']);\n    peg['\"{\"'] = pSeq2(pRange('{', []), pRef(peg, '__'));\n    peg['\"}\"'] = pSeq2(pRange('}', []), pRef(peg, '_'));\n    peg['\"[\"'] = pSeq2(pRange('[', []), pRef(peg, '__'));\n    peg['\"]\"'] = pSeq2(pRange(']', []), pRef(peg, '_'));\n    peg['\"(\"'] = pSeq2(pRange('(', []), pRef(peg, '__'));\n    peg['\")\"'] = pSeq2(pRange(')', []), pRef(peg, '_'));\n    peg['\"=\"'] = pSeq3(\n      pRange('=', []),\n      pNot(pRange('=', [])),\n      pRef(peg, '_')\n    );\n    peg['\".\"'] = pSeq2(pRange('.', []), pRef(peg, '_'));\n    peg['\",\"'] = pSeq2(pRange(',', []), pRef(peg, '_'));\n    peg['\";\"'] = pMany1(pSeq2(pRange(';', []), pRef(peg, '_')));\n    peg['\":\"'] = pSeq2(pRange(':', []), pRef(peg, '_'));\n  }\n  return peg[start];\n};\n\nconst example = (start: string, sample?: string) => {\n  const parser = generate(start);\n  const t = parser(sample || 'abc');\n  console.log(`${start} ${sample}`);\n  console.log(t.toString());\n};\n\n// example('Source',\"from puppy import *\\ndef cat_clicked(cat): print('Meaw')\\ncat = Circle(500, 500, clicked=cat_clicked)\\n\")\n// example('ClassDecl','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('Statement','class Ball(Circle):\\n    width = 80\\n    heigh = 80\\n')\n// example('FuncDecl','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Statement','def succ(x):\\n    #hoge\\n    return x+1\\n')\n// example('Lambda','lambda: print(1)')\n// example('Lambda','lambda x: print(x)')\n// example('Lambda','lambda x,y: print(x,y)')\n// example('Statement','if A == 1 :\\n    print(A)\\n    #hoge\\n    print(A, B)\\n    A = Ball()\\nelse:\\n    print(A, B)\\n\\n    A = 2\\n')\n// example('Statement','if A :\\n    pass\\nelif B :\\n    pass\\nelif C :\\n    pass\\nelse :\\n    pass\\n')\n// example('Statement','for x in [1,2,3]:\\n    print(x)\\n    print(x+1)\\n')\n// example('VarDecl','A = 1')\n// example('Statement','A = 1')\n// example('VarDecl','A += 1')\n// example('Statement','A += 1')\n// example('Expression','not 1 == 2')\n// example('Expression','not 1 == 2 and 1 > 3')\n// example('Expression','a[1:2]')\n// example('Expression','a[1:]')\n// example('Expression','a[:2]')\n// example('Expression','Circle(500, 500)')\n// example('Expression','Circle(500, 500, clicked=cat_clicked)')\n// example('Expression','Circle(clicked=1, move=1)')\n// example('Primary','(1,2) //')\n// example('Expression','(1,2) //')\n// example('Primary','(1)')\n// example('Expression','(1)')\n// example('Primary','[1,2,3]')\n// example('Expression','[1,2,3]')\n// example('Primary',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"{ name: 'naruto', age: 17 }\")\n// example('Expression',\"f'{a}+{1}'\")\n// example('Expression','world(\\n    hoge=1,\\n    hoge=1*2**2*3\\n)\\n')\n\n// pegpy nezcc -g math.tpeg parser.ts > math.ts\n// npx ts-node math.ts\n","import { generate, ParseTree } from './puppy-parser';\n\nconst INDENT = '\\t';\n\n/* Type System */\n\nclass Type {\n  public isOptional: boolean;\n  public constructor(isOptional: boolean) {\n    this.isOptional = isOptional;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(ty: Type, update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any): Type {\n    return this;\n  }\n}\n\nclass BaseType extends Type {\n  private name: string;\n\n  constructor(name: string, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.name = name;\n  }\n\n  public toString() {\n    return this.name;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof BaseType) {\n      return this.name === v.name;\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public hasAlpha(): boolean {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ty = map[this.name];\n      if (ty === undefined) {\n        map[this.name] = new VarType(map.env, map.t);\n      }\n      return map[this.name];\n    }\n    return this;\n  }\n}\n\nclass VoidType extends BaseType {\n  constructor() {\n    super('void', false);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VarType) {\n      v.must(this, update);\n    }\n    return true;\n  }\n}\n\nclass AnyType extends BaseType {\n  constructor(isOptional?: any) {\n    super('any', isOptional);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VoidType) {\n      return false;\n    }\n    return true;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha() {\n    return true;\n  }\n\n  public toVarType(map: any) {\n    return new VarType(map.env, map.t);\n  }\n}\n\nclass FuncType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss = ['('];\n    for (var i = 1; i < this.types.length; i += 1) {\n      if (i > 1) {\n        ss.push(',');\n      }\n      ss.push(this.types[i].toString());\n    }\n    ss.push(')->');\n    ss.push(this.types[0].toString());\n    return ss.join('');\n  }\n\n  public rtype() {\n    return this.types[0];\n  }\n  public psize() {\n    return this.types.length - 1;\n  }\n  public ptype(index: number) {\n    return this.types[index + 1];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof FuncType && this.psize() == v.psize()) {\n      for (var i = 0; i < this.types.length; i += 1) {\n        if (!this.types[i].accept(v.types[i], update)) {\n          return false;\n        }\n        return true;\n      }\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    for (const ty of this.types) {\n      if (ty.isPattern()) return true;\n    }\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) return true;\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const v: Type[] = [];\n      for (const ty of this.types) {\n        v.push(ty.toVarType(map));\n      }\n      return new FuncType(...v);\n    }\n    return this;\n  }\n}\n\nclass ListType extends Type {\n  private param: Type;\n  constructor(param: Type, isOptional?: any) {\n    super(isOptional !== undefined);\n    this.param = param;\n  }\n\n  public toString() {\n    return `List[${this.param.toString()}]`;\n  }\n\n  public psize() {\n    return 1;\n  }\n  public ptype(index: number) {\n    return this.param;\n  }\n\n  public realType(): Type {\n    const p = this.param.realType();\n    if (p !== this.param) {\n      return new ListType(p);\n    }\n    return this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof ListType) {\n      if (this.param == tAny) {\n        return true;\n      }\n      return this.param.accept(v.param, update);\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.param.isPattern();\n  }\n\n  public hasAlpha(): boolean {\n    return this.param.hasAlpha();\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      return new ListType(this.param.toVarType(map));\n    }\n    return this;\n  }\n}\n\nclass UnionType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(false);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss: string[] = [];\n    for (var i = 0; i < this.types.length; i += 1) {\n      if (i > 0) {\n        ss.push('|');\n      }\n      ss.push(this.types[i].toString());\n    }\n    return ss.join('');\n  }\n  public psize() {\n    return this.types.length;\n  }\n\n  public ptype(index: number) {\n    return this.types[index];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    for (const ty0 of this.types) {\n      if (ty0.accept(ty, false)) {\n        return true;\n      }\n    }\n    console.log(`FAIL ${ty} ${this.toString()}`);\n    return false;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ts: Type[] = [];\n      for (const ty of this.types) {\n        ts.push(ty.toVarType(map));\n      }\n      return new UnionType(...ts);\n    }\n    return this;\n  }\n}\n\nconst union = (...types: Type[]) => {\n  if (types.length === 1) {\n    return types[0];\n  }\n  return new UnionType(...types);\n};\n\nconst tAny = new AnyType();\nconst tVoid = new VoidType();\nconst tBool = new BaseType('Bool');\nconst tInt = new BaseType('Number');\nconst tInt_ = new BaseType('Number', true);\nconst tFloat = tInt;\nconst tFloat_ = tInt_;\nconst tString = new BaseType('String');\nconst tString_ = new BaseType('String', true);\nconst tA = new BaseType('a');\nconst tListA = new ListType(tA);\nconst tListInt = new ListType(tInt);\nconst tListAny = new ListType(tAny);\nconst tMatter = new BaseType('Object');\nconst tObject = tMatter;\nconst tVec = new BaseType('Vec');\n\n//const tUndefined = new BaseType('undefined');\n\nconst EmptyNumberSet: number[] = [];\n\nconst unionSet = (a: number[], b: number[], c?: number[]) => {\n  const A: number[] = [];\n  for (const id of a) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  for (const id of b) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  if (c !== undefined) {\n    for (const id of b) {\n      if (A.indexOf(id) === -1) {\n        A.push(id);\n      }\n    }\n  }\n  return A;\n};\n\nclass VarType extends Type {\n  private varMap: (Type | number[])[];\n  private varid: number;\n  private ref: ParseTree | null;\n\n  constructor(env: Env, ref: ParseTree) {\n    super(false);\n    this.varMap = env.getroot('@varmap');\n    this.varid = this.varMap.length;\n    this.varMap.push(EmptyNumberSet);\n    this.ref = ref;\n  }\n\n  public toString() {\n    const v = this.varMap[this.varid];\n    if (v instanceof Type) {\n      return v.toString();\n    }\n    return 'any';\n  }\n\n  public realType(): Type {\n    const v = this.varMap[this.varid];\n    return v instanceof Type ? v : this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    var v = this.varMap[this.varid];\n    if (v instanceof Type && v !== this) {\n      return v.accept(ty, update);\n    }\n    return this.must(ty.realType(), update);\n  }\n\n  public must(ty: Type, update: boolean): boolean {\n    const v1 = ty.realType();\n    if (update) {\n      if (v1 instanceof VarType) {\n        if (v1.varid === this.varid) {\n          return true;\n        }\n        const u = unionSet(\n          this.varMap[this.varid] as number[],\n          this.varMap[v1.varid] as number[],\n          [v1.varid, this.varid]\n        );\n        for (const id of u) {\n          this.varMap[id] = u;\n        }\n        return true;\n      }\n      if (!v1.isPattern()) {\n        const u = this.varMap[this.varid] as number[];\n        for (const id of u) {\n          this.varMap[id] = v1;\n        }\n        this.varMap[this.varid] = v1;\n      }\n    }\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n}\n\nclass OptionType extends Type {\n  public options: any;\n  constructor(options: any) {\n    super(false);\n    this.options = options;\n  }\n\n  public toString() {\n    return JSON.stringify(this.options);\n  }\n\n  public accept(ty: Type): boolean {\n    const v = ty.realType();\n    if (v instanceof OptionType) {\n      return true;\n    }\n    return false;\n  }\n\n  public equals(ty: Type, update: boolean): boolean {\n    return this.accept(ty);\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any) {\n    return this;\n  }\n}\n\nclass Symbol {\n  public code: string;\n  public ty: Type;\n  public isMatter: boolean = false;\n  public isMutable: boolean = false;\n  public constructor(code: string, ty: Type, options?: any) {\n    this.code = code;\n    this.ty = ty.realType();\n    if (options !== undefined) {\n      this.isMatter = options.isMatter === undefined ? false : options.isMatter;\n      this.isMutable =\n        options.isMutable == undefined ? false : options.isMutable;\n    }\n  }\n  public isGlobal() {\n    return this.code.indexOf('vars[') == 0;\n  }\n}\n\nconst tColor = new UnionType(tString, tInt);\nconst tOption = new OptionType({});\nconst tFuncFloatFloat = new FuncType(tFloat, tFloat);\nconst tFuncFloatFloatFloat = new FuncType(tFloat, tFloat, tFloat);\nconst tFuncShape = new FuncType(tMatter, tInt, tInt, tOption);\n\nconst import_math = {\n  pi: new Symbol('3.14159', tFloat),\n  sin: new Symbol('Math.sin', tFuncFloatFloat),\n  cos: new Symbol('Math.cos', tFuncFloatFloat),\n  tan: new Symbol('Math.tan', tFuncFloatFloat),\n  sqrt: new Symbol('Math.sqrt', tFuncFloatFloat),\n  log: new Symbol('Math.log', tFuncFloatFloat),\n  log10: new Symbol('Math.log10', tFuncFloatFloat),\n\n  pow: new Symbol('Math.pow', tFuncFloatFloatFloat),\n  hypot: new Symbol('Math.hypot', tFuncFloatFloatFloat),\n  gcd: new Symbol('puppy.gcd', tFuncFloatFloatFloat),\n};\n\nconst import_python = {\n  // 'math.': IMPORT_MATH,\n  // 'random.': IMPORT_RANDOM,\n  input: new Symbol('await puppy.input', new FuncType(tString, tString_)),\n  print: new Symbol('puppy.print', new FuncType(tVoid, tAny, tOption), {\n    isMatter: true,\n  }),\n\n  //# , ..None \n  len: new Symbol('lib.len', new FuncType(tInt, union(tString, tListA))),\n  //\n  range: new Symbol('lib.range', new FuncType(tListInt, tInt, tInt_, tInt_)),\n  //append\n  '.append': new Symbol('lib.append', new FuncType(tVoid, tListA, tA)),\n\n  // \n  int: new Symbol('lib.int', new FuncType(tInt, union(tBool, tString, tInt))),\n  float: new Symbol(\n    'lib.float',\n    new FuncType(tFloat, union(tBool, tString, tInt))\n  ),\n  str: new Symbol('lib.str', new FuncType(tString, tAny)),\n  //'random': new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_random = {\n  random: new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_matterjs = {\n  // # \n  World: new Symbol('puppy.World', tFuncShape, { isMatter: true }),\n  Circle: new Symbol('puppy.Circle', tFuncShape, { isMatter: true }),\n  Rectangle: new Symbol('puppy.Rectangle', tFuncShape, { isMatter: true }),\n  Polygon: new Symbol('puppy.Polygon', tFuncShape, { isMatter: true }),\n  Label: new Symbol('puppy.Label', tFuncShape, { isMatter: true }),\n  // 'Ball': new Symbol('puppy.Circle', tFuncShape),\n  // 'Block': new Symbol('puppy.Ball', tFuncShape),\n\n  // # \n  '.setPosition': new Symbol(\n    'lib.setPosition',\n    new FuncType(tVoid, tMatter, tInt, tInt)\n  ),\n  '.applyForce': new Symbol(\n    'lib.applyForce',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt, tInt)\n  ),\n  '.rotate': new Symbol(\n    'lib.rotate',\n    new FuncType(tVoid, tMatter, tInt, tInt_, tInt_)\n  ),\n  '.scale': new Symbol(\n    'lib.scale',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt_, tInt_)\n  ),\n  '.setAngle': new Symbol('lib.setAngle', new FuncType(tVoid, tMatter, tInt)),\n  '.setAngularVelocity': new Symbol(\n    'lib.setAngularVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setDensity': new Symbol(\n    'lib.setDensity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setMass': new Symbol('lib.setMass', new FuncType(tVoid, tMatter, tInt)),\n  '.setStatic': new Symbol(\n    'lib.setStatic',\n    new FuncType(tVoid, tMatter, tBool)\n  ),\n  '.setVelocity': new Symbol(\n    'lib.setVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n};\n\nconst modules: any = {\n  math: import_math,\n  random: import_random,\n  matterjs: import_matterjs,\n};\n\nconst symbolPackageMap: any = {};\n\nconst checkSymbolNames = () => {\n  for (const pkgname of Object.keys(modules)) {\n    for (const name of Object.keys(modules[pkgname])) {\n      symbolPackageMap[name] = pkgname;\n    }\n  }\n};\ncheckSymbolNames();\n\nconst KEYTYPES = {\n  width: tInt,\n  height: tInt,\n  x: tInt,\n  y: tInt,\n  image: tString,\n  strokeStyle: tColor,\n  lineWidth: tInt,\n  fillStyle: tColor,\n  restitution: tFloat,\n  angle: tFloat,\n  position: tVec,\n  mass: tInt,\n  density: tInt,\n  area: tInt,\n  friction: tFloat,\n  frictionStatic: tFloat,\n  airFriction: tFloat,\n  torque: tFloat,\n  stiffness: tFloat,\n  isSensor: tBool,\n  isStatic: tBool,\n  damping: tFloat,\n  in: new FuncType(tVoid, tMatter, tMatter),\n  out: new FuncType(tVoid, tMatter, tMatter),\n  over: new FuncType(tVoid, tMatter, tMatter),\n  clicked: new FuncType(tVoid, tMatter),\n  font: tString,\n  fontColor: tColor,\n  textAlign: tString,\n  value: tInt,\n  message: tString,\n};\n\n//const ty1 = this.check(tleft(op), env, t['left'], out1);\n//const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n//return tbinary(env, t, ty1, out1.join(''), ty2, out1.join(''), out);\nconst tCompr = union(tInt, tString);\n\nconst opset: any = {\n  and: '&&',\n  or: '||',\n  not: '!',\n  '+=': '+',\n  '-=': '-',\n  '*=': '*',\n  '//=': '//',\n  '/=': '/',\n  '<<=': '<<',\n  '>>=': '>>',\n  '|=': '|',\n  '&=': '&',\n  '^=': '^',\n};\n\nconst operator = (op: string) => {\n  const op2 = opset[op];\n  if (op2 !== undefined) {\n    return op2;\n  }\n  return op;\n};\n\nconst tleftMap = {\n  '+': union(tInt, tString, tListAny),\n  '-': tInt,\n  '**': tInt,\n  '*': union(tInt, tString, tListAny),\n  '/': tInt,\n  '//': tInt,\n  '%': tInt,\n  '==': tAny,\n  '!=': tAny,\n  in: tAny,\n  '<': tCompr,\n  '<=': tCompr,\n  '>': tCompr,\n  '>=': tCompr,\n  '^': tInt,\n  '|': tInt,\n  '&': tInt,\n  '<<': tInt,\n  '>>': tInt,\n};\n\nconst tleft = (op: string) => {\n  const ty = (tleftMap as any)[op];\n  if (ty === undefined) {\n    console.log(`FIXME undefined '${op}'`);\n    return tAny;\n  }\n  return ty;\n};\n\nconst tright = (op: string, ty: Type) => {\n  if (op == 'in') {\n    return union(new ListType(ty), tString);\n  }\n  const ty2 = (tleftMap as any)[op];\n  if (ty2 === tAny || ty2 === tInt || op === '*') {\n    return ty2;\n  }\n  return ty; // \n};\n\ntype ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nconst setpos = (s: string, pos: number, elog: ErrorLog) => {\n  const max = Math.min(pos + 1, s.length);\n  var r = 1;\n  var c = 0;\n  for (var i = 0; i < max; i += 1) {\n    if (s.charCodeAt(i) == 10) {\n      r += 1;\n      c = 0;\n    }\n    c += 1;\n  }\n  elog.pos = pos;\n  elog.row = r;\n  elog.col = c;\n  return elog;\n};\n\nclass Env {\n  private root: Env;\n  private parent: Env | null;\n  private vars: any;\n\n  public constructor(env?: Env) {\n    this.vars = {};\n    if (env === undefined) {\n      this.root = this;\n      this.parent = null;\n      this.vars['@varmap'] = [];\n      this.vars['@logs'] = [];\n      this.vars['@trace'] = [];\n      this.vars['@indent'] = INDENT;\n    } else {\n      this.root = env.root;\n      this.parent = env;\n    }\n  }\n\n  public get(key: string, value?: any) {\n    var e: Env | null = this;\n    while (e !== null) {\n      const v = e.vars[key];\n      if (v !== undefined) {\n        return v;\n      }\n      e = e.parent;\n    }\n    return value;\n  }\n\n  public has(key: string) {\n    return this.get(key) !== undefined;\n  }\n\n  public set(key: string, value: any) {\n    this.vars[key] = value;\n    return value;\n  }\n\n  public getroot(key: string, value?: any) {\n    return this.root.vars[key] || value;\n  }\n\n  public setroot(key: string, value: any) {\n    this.root.vars[key] = value;\n    return value;\n  }\n\n  public from_import(pkg: any, list?: string[]) {\n    for (const name of Object.keys(pkg)) {\n      //console.log(name);\n      if (list === undefined || list.indexOf(name) !== -1) {\n        this.vars[name] = pkg[name];\n      }\n    }\n  }\n\n  public setModule(name: string, options: any) {\n    this.set(name, new Symbol('undefined', new OptionType(options)));\n  }\n\n  public isModule(name: string) {\n    const s = this.get(name) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public getModule(pkgname: string, name: string) {\n    const s = this.get(pkgname) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      const options = (s.ty as OptionType).options;\n      return options[name];\n    }\n    return undefined;\n  }\n\n  public perror(t: ParseTree, elog: ErrorLog) {\n    const logs = this.root.vars['@logs'];\n    if (elog.type === undefined) {\n      elog.type = 'error';\n    }\n    if (elog.pos === undefined) {\n      const pos = t.begin();\n      elog.pos = pos[0];\n      elog.row = pos[1];\n      elog.col = pos[2];\n    }\n    if (elog.len === undefined) {\n      elog.len = t.epos - t.spos;\n    }\n    logs.push(elog);\n  }\n\n  public trace(t: ParseTree) {\n    const trace: number[][] = this.getroot('@trace');\n    const id = trace.length;\n    const pos = t.begin();\n    trace.push([pos[0], pos[1], pos[2], t.epos - t.spos]);\n    return `,puppy,${id}`;\n  }\n\n  public setInLoop() {\n    this.set('@inloop', true);\n    return true;\n  }\n\n  public inLoop() {\n    return this.get('@inloop') === true;\n  }\n\n  public setFunc(data: any) {\n    this.set('@func', data);\n    return data;\n  }\n\n  public inFunc() {\n    return this.get('@func') !== undefined;\n  }\n\n  public foundFunc(t: ParseTree, symbol: Symbol) {\n    if (symbol.isMatter) {\n      const data = this.get('@func');\n      if (data !== undefined) {\n        data['isMatter'] = true;\n      } else {\n        const pos = setpos(t.inputs, t.spos, { type: '', key: '' });\n        this.setroot('@yeild', pos.row);\n      }\n    }\n  }\n\n  private isUtf8Name(s: string) {\n    for (var i = 0; i < s.length; i += 1) {\n      if (s.charCodeAt(i) > 128) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private local(s: string): string {\n    if (this.isUtf8Name(s)) {\n      const map = this.getroot('@utf8map');\n      if (map === undefined) {\n        this.setroot('@utf8map', {});\n        return this.local(s);\n      }\n      var vname = map[name];\n      if (vname === undefined) {\n        const id = Object.keys(map).length;\n        vname = `_v${id}`;\n        map[name] = vname;\n      }\n      return vname as string;\n    }\n    return s;\n  }\n\n  public declVar(name: string, ty: Type) {\n    var code =\n      this.inFunc() || this.inLoop() ? this.local(name) : `vars['${name}']`;\n    const symbol = new Symbol(code, ty);\n    symbol.isMutable = true;\n    return this.set(name, symbol) as Symbol;\n  }\n\n  public emitAutoYield(out: string[]) {\n    const yieldparam = this.getroot('@yeild');\n    if (yieldparam !== undefined && !this.inFunc()) {\n      out.push(`; yield ${yieldparam};\\n`);\n      this.setroot('@yeild', undefined);\n    } else {\n      out.push('\\n');\n    }\n  }\n}\n\nclass PuppyError {\n  public constructor() {}\n}\n\nconst FIXME_subs = (t: any) => {\n  return t instanceof ParseTree ? t.subs() : ([] as ParseTree[]);\n};\n\nclass Transpiler {\n  public constructor() {}\n\n  public conv(env: Env, t: ParseTree, out: string[]) {\n    console.log(t.toString());\n    try {\n      return (this as any)[t.tag](env, t, out);\n    } catch (e) {\n      if (e instanceof PuppyError) {\n        throw e;\n      }\n      if ((this as any)[t.tag] === undefined) {\n        //console.log(e);\n        env.perror(t, {\n          type: 'error',\n          key: 'UndefinedParseTree',\n          subject: t.toString(),\n        });\n        return this.skip(env, t, out);\n      }\n      throw e;\n    }\n  }\n\n  public skip(env: Env, t: ParseTree, out: string[]): Type {\n    throw new PuppyError();\n    // out.push('undefined');\n    // return tAny;\n  }\n\n  public check(\n    req: Type,\n    env: Env,\n    t: ParseTree,\n    out: string[],\n    elog?: ErrorLog\n  ) {\n    const ty = this.conv(env, t, out);\n    if (req.accept(ty, true)) {\n      return ty;\n    }\n    if (elog === undefined) {\n      elog = {\n        type: 'error',\n        key: 'TypeError',\n      };\n    }\n    elog.request = req;\n    elog.given = ty;\n    env.perror(t, elog);\n    return this.skip(env, t, out);\n  }\n\n  private checkBinary(\n    env: Env,\n    t: any,\n    op: string,\n    ty1: Type,\n    left: string,\n    ty2: Type,\n    right: string,\n    out: string[]\n  ) {\n    if (op === '==' || op === '!=') {\n      out.push(`${left} ${op}= ${right}`);\n      return tBool;\n    }\n    ty1 = ty1.realType();\n    ty2 = ty2.realType();\n    if (op === '+') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} + ${right})`);\n        return tInt;\n      }\n      if (ty1.accept(ty2, true)) {\n        out.push(`lib.anyAdd(${left},${right})`);\n        return ty1;\n      }\n      env.perror(t, {\n        key: 'BinaryTypeError',\n        subject: op,\n        request: ty1,\n        given: ty2,\n      });\n      return this.skip(env, t, out);\n    }\n    if (op === '*') {\n      if (ty1 === tInt && ty2 === tInt) {\n        out.push(`(${left} * ${right})`);\n        return tInt;\n      }\n      out.push(`lib.anyMul(${left},${right})`);\n      if (ty1 === tInt || tListAny.accept(ty2, false)) return ty2;\n      if (ty2 === tInt || tListAny.accept(ty1, false)) return ty1;\n      return ty1;\n    }\n    if (op === '//') {\n      out.push(`((${left}/${right})|0)`);\n      return tInt;\n    }\n    if (op === '**') {\n      out.push(`Math.pow(${left},${right})`);\n      return tInt;\n    }\n    if (ty1.accept(ty2, true)) {\n      out.push(`(${left} ${op} ${right})`);\n      if ((tleftMap as any)[op] === tCompr) {\n        return tBool;\n      }\n      return ty1;\n    }\n    env.perror(t, {\n      key: 'BinaryTypeError',\n      subject: op,\n      request: ty1,\n      given: ty2,\n    });\n    return this.skip(env, t, out);\n  }\n\n  public err(env: Env, t: ParseTree, out: string[]) {\n    env.perror(t, {\n      type: 'error',\n      key: 'SyntaxError',\n    });\n    return tVoid;\n  }\n\n  public FromDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.from_import(pkg); // FIXME\n    return tVoid;\n  }\n\n  public ImportDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const alias = t.tokenize('alias', name);\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'error',\n        key: 'UnknownPackageName',\n      });\n      return this.skip(env, t, out);\n    }\n    env.setModule(alias, pkg);\n    return tVoid;\n  }\n\n  public Source(env: Env, t: ParseTree, out: string[]) {\n    for (const subtree of FIXME_subs(t)) {\n      try {\n        const out2: string[] = [];\n        out2.push(env.get('@indent'));\n        this.conv(env, subtree, out2);\n        env.emitAutoYield(out2);\n        out.push(out2.join(''));\n      } catch (e) {\n        if (!(e instanceof PuppyError)) {\n          throw e;\n        }\n      }\n    }\n    return tVoid;\n  }\n\n  public Block(penv: Env, t: ParseTree, out: string[]) {\n    const indent = penv.get('@indent');\n    const nested = INDENT + indent;\n    const env = new Env(penv);\n    env.set('@indent', nested);\n    out.push('{\\n');\n    for (const subtree of FIXME_subs(t)) {\n      out.push(env.get('@indent'));\n      this.conv(env, subtree, out);\n      env.emitAutoYield(out);\n    }\n    out.push(indent + '}');\n    return tVoid;\n  }\n\n  public IfExpr(env: Env, t: any, out: string[]) {\n    out.push('((');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ? (');\n    const ty = this.conv(env, t['then'], out);\n    out.push(') : (');\n    this.check(ty, env, t['else'], out);\n    out.push('))');\n    return ty;\n  }\n\n  public IfStmt(env: Env, t: any, out: string[]) {\n    out.push('if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    if (t['elif'] !== undefined) {\n      for (const stmt of t['elif'].subs()) {\n        this.conv(env, stmt, out);\n      }\n    }\n    if (t['else'] !== undefined) {\n      out.push('else ');\n      this.conv(env, t['else'], out);\n    }\n    return tVoid;\n  }\n\n  public ElifStmt(env: Env, t: any, out: string[]) {\n    out.push('else if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    return tVoid;\n  }\n\n  public ForStmt(env: Env, t: any, out: string[]) {\n    // if (t['each'].tag !== 'Name') {\n    //   env.perror(t['each'], {\n    //     type: 'error', key: 'RequiredIdentifier',\n    //   });\n    //   return tVoid;\n    // }\n    const name = t['each'].tokenize();\n    const ty = new VarType(env, t['each']);\n    out.push(`for (let ${name} of `);\n    this.check(new ListType(ty), env, t['list'], out);\n    out.push(')');\n    const lenv = new Env(env);\n    lenv.setInLoop();\n    lenv.declVar(name, ty);\n    this.conv(lenv, t['body'], out);\n    return tVoid;\n  }\n\n  public FuncDecl(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    const types = [new VarType(env, t['name'])];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      name: name,\n      return: types[0],\n      hasReturn: false,\n      isMatter: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    const symbol = env.declVar(name, funcType);\n    const defun = symbol.isGlobal() ? '' : 'var ';\n    out.push(`${defun}${symbol.code} = (${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    symbol.isMatter = funcData['isMatter'];\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    console.log(`DEFINED ${name} :: ${funcType}`);\n    return tVoid;\n  }\n\n  public FuncExpr(env: Env, t: any, out: string[]) {\n    const types = [new VarType(env, t)];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      return: types[0],\n      hasReturn: false,\n    });\n    for (const p of t['params'].subs()) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    out.push(`(${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    return funcType;\n  }\n\n  public Return(env: Env, t: any, out: string[]) {\n    if (!env.inFunc()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInFunction',\n        subject: 'return',\n      });\n      return tVoid;\n    }\n    const funcData = env.get('@func');\n    funcData['hasReturn'] = true;\n    if (t['expr'] !== undefined) {\n      out.push('return ');\n      this.check(funcData['return'], env, t['expr'], out);\n    } else {\n      out.push('return');\n    }\n    return tVoid;\n  }\n\n  public Continue(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'continue',\n      });\n      return tVoid;\n    }\n    out.push('continue');\n    return tVoid;\n  }\n\n  public Break(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'break',\n      });\n      return tVoid;\n    }\n    out.push('break');\n    return tVoid;\n  }\n\n  public Pass(env: Env, t: any, out: string[]) {\n    return tVoid;\n  }\n\n  public VarDecl(env: Env, t: any, out: string[]) {\n    const left = t['left'] as ParseTree;\n    if (left.tag === 'Name') {\n      const name = left.tokenize();\n      var symbol = env.get(name) as Symbol;\n      if (symbol === undefined || (env.inFunc() && symbol.isGlobal())) {\n        const ty = new VarType(env, left);\n        const out1: string[] = [];\n        this.check(ty, env, t['right'], out1);\n        symbol = env.declVar(name, ty);\n        const qual = symbol.isGlobal() ? '' : 'var ';\n        out.push(`${qual}${symbol.code} = ${out1.join('')}`);\n        return tVoid;\n      }\n    }\n    t['left'].tag = `Set${t['left'].tag}`;\n    const ty = this.conv(env, t['left'], out);\n    out.push(' = ');\n    this.check(ty, env, t['right'], out);\n    return tVoid;\n  }\n\n  public Name(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public SetName(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    if (!symbol.isMutable) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public And(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' && ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Or(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' || ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Not(env: Env, t: any, out: string[]) {\n    out.push('!(');\n    this.check(tBool, env, t[0], out);\n    out.push(')');\n    return tBool;\n  }\n\n  public Infix(env: Env, t: any, out: string[]) {\n    const op = operator(t.tokenize('name'));\n    const out1: string[] = [];\n    const out2: string[] = [];\n    const ty1 = this.check(tleft(op), env, t['left'], out1);\n    const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n    return this.checkBinary(\n      env,\n      t,\n      op,\n      ty1,\n      out1.join(''),\n      ty2,\n      out2.join(''),\n      out\n    );\n  }\n\n  public Unary(env: Env, t: any, out: string[]) {\n    const op = t.tokenize('name');\n    if (op === '!' || op === 'not') {\n      out.push(`${op}(`);\n      this.check(tBool, env, t['expr'], out);\n      out.push(')');\n      return tBool;\n    } else {\n      out.push(`${op}(`);\n      this.check(tInt, env, t['expr'], out);\n      out.push(')');\n      return tInt;\n    }\n  }\n\n  public ApplyExpr(env: Env, t: any, out: string[]): Type {\n    const name = t.tokenize('name');\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      const pkgname = symbolPackageMap[name];\n      if (pkgname !== undefined) {\n        console.log(`importing ${pkgname} ...`);\n        env.from_import(modules[pkgname]);\n        env.perror(t['name'], {\n          type: 'info',\n          key: 'InferredPackage',\n          subject: pkgname,\n          code: `from ${pkgname} import *`,\n        });\n        return this.ApplySymbolExpr(\n          env,\n          t,\n          env.get(name) as Symbol,\n          undefined,\n          out\n        ); // Again\n      }\n    }\n    return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n  }\n\n  private ApplySymbolExpr(\n    env: Env,\n    t: any,\n    symbol: Symbol,\n    recv: ParseTree | undefined,\n    out: string[]\n  ): Type {\n    if (symbol === undefined) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'UnknownName',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    out.push('(');\n    const args = t['params'].subs();\n    if (recv !== undefined) {\n      args.unshift(recv);\n    }\n    var funcType = symbol.ty;\n    if (!(funcType instanceof FuncType)) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'NotFunction',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    if (funcType.hasAlpha()) {\n      funcType = funcType.toVarType({ env, ref: t });\n      //console.log(funcType.toString());\n    }\n\n    for (var i = 0; i < args.length; i += 1) {\n      if (!(i < funcType.psize())) {\n        env.perror(args[i], {\n          type: 'warning',\n          key: 'TooManyArguments',\n          subject: args[i],\n        });\n        break;\n      }\n      if (i > 0) {\n        out.push(',');\n      }\n      const ty = funcType.ptype(i);\n      this.check(ty, env, args[i], out);\n    }\n    if (args.length < funcType.psize()) {\n      if (!funcType.ptype(args.length)) {\n        env.perror(\n          t['name'],\n          setpos(t.inputs, t['params'].epos, {\n            type: 'error',\n            key: 'RequiredArguments',\n          })\n        );\n      }\n    }\n    out.push(')');\n    env.foundFunc(t, symbol);\n    return funcType.rtype();\n  }\n\n  public MethodExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n    }\n    const methodname = `.${t.tokenize('name')}`;\n    const symbol = env.get(methodname);\n    return this.ApplySymbolExpr(env, t, symbol, t['recv'], out);\n  }\n\n  //\"[#SelfAssign left=[#Name 'a'] name=[# '+='] right=[#Int '1']]\"\n  public SelfAssign(env: Env, t: any, out: string[]) {\n    const tag = t['left'].tag;\n    t['left'].tag = `Set${tag}`;\n    this.conv(env, t['left'], out);\n    out.push(' = ');\n    t['left'].tag = tag;\n    this.Infix(env, t, out);\n    return tVoid;\n  }\n\n  public GetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      out.push(symbol.code);\n      return symbol.ty;\n    }\n    out.push('lib.get(');\n    this.check(tMatter, env, t['recv'], out);\n    const name = t.tokenize('name');\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    out.push(`,'${name}'${env.trace(t['name'])})`);\n    return ty;\n  }\n\n  public SetGetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: t.tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    const name = t.tokenize('name');\n    this.check(tMatter, env, t['recv'], out);\n    out.push(`.${name}`);\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    return ty instanceof UnionType ? ty.ptype(0) : ty;\n  }\n\n  public IndexExpr(env: Env, t: any, out: string[]) {\n    out.push('lib.index(');\n    const ty = this.check(\n      union(new ListType(new VarType(env, t)), tString),\n      env,\n      t['recv'],\n      out\n    );\n    out.push(',');\n    this.check(tInt, env, t['index'], out);\n    out.push(`${env.trace(t['index'])})`);\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public SetIndexExpr(env: Env, t: any, out: string[]) {\n    const ty = this.check(tListAny, env, t['recv'], out);\n    out.push('[');\n    this.check(tInt, env, t['index'], out);\n    out.push(']');\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public Data(env: Env, t: ParseTree, out: string[]) {\n    out.push('{');\n    for (const sub of FIXME_subs(t)) {\n      this.conv(env, sub, out);\n      out.push(',');\n    }\n    out.push('}');\n    return tOption;\n  }\n\n  public KeyValue(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    out.push(`'${name}': `);\n    const ty = (KEYTYPES as any)[name];\n    if (ty === undefined) {\n      env.perror(t['name'], {\n        type: 'warning',\n        key: 'UnknownName',\n        subject: name,\n      });\n      this.conv(env, t['value'], out);\n    } else {\n      this.check(ty, env, t['value'], out);\n    }\n    return tVoid;\n  }\n\n  public Tuple(env: Env, t: ParseTree, out: string[]) {\n    const subs = FIXME_subs(t);\n    if (subs.length > 2) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'ListSyntaxError', //[ ]\n      });\n      return this.List(env, t, out);\n    }\n    if (subs.length == 1) {\n      out.push('(');\n      const ty = this.conv(env, subs[0], out);\n      out.push(')');\n      return ty;\n    }\n    out.push('{ x: ');\n    this.check(tInt, env, subs[0], out);\n    out.push(', y: ');\n    this.check(tInt, env, subs[1], out);\n    out.push('}');\n    return tVec;\n  }\n\n  public List(env: Env, t: ParseTree, out: string[]) {\n    var ty = new VarType(env, t);\n    out.push('[');\n    for (const sub of FIXME_subs(t)) {\n      ty = this.check(ty, env, sub, out, {\n        type: 'error',\n        key: 'AllTypeAsSame', //\n      });\n      out.push(',');\n    }\n    out.push(']');\n    return new ListType(ty);\n  }\n\n  public Format(env: Env, t: ParseTree, out: string[]) {\n    var c = 0;\n    out.push('(');\n    for (const e of FIXME_subs(t)) {\n      if (c > 0) {\n        out.push('+');\n      }\n      if (e.tag === 'StringPart') {\n        out.push(`'${e.tokenize()}'`);\n      } else {\n        const out2: string[] = [];\n        const ty = this.conv(env, e, out2);\n        if (ty === tString) {\n          out.push(out2.join(''));\n        } else {\n          out.push(`lib.str(${out2.join('')})`);\n        }\n      }\n      c++;\n    }\n    out.push(')');\n    return tString;\n  }\n\n  public TrueExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('true');\n    return tBool;\n  }\n\n  public FalseExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('false');\n    return tBool;\n  }\n\n  public Int(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tInt;\n  }\n\n  public Float(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public Double(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public String(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public Char(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public MultiString(env: Env, t: ParseTree, out: string[]) {\n    out.push(JSON.stringify(JSON.parse(t.tokenize())));\n    return tString;\n  }\n}\n\nconst parser = generate('Source');\n\nconst transpile = (s: string) => {\n  const t = parser(s);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  //console.log('DEBUG: ERROR LOGS')\n  //console.log(JSON.stringify(env.get('@logs')));\n  console.log(env.get('@logs'));\n  return out.join('');\n};\n\nexport type Source = {\n  source: string;\n  lang?: string;\n};\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\nexport const compile = (s: Source): PuppyCode => {\n  //const start = performance.now();\n  const t = parser(s.source);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  const jscode = out.join('');\n  const main = `\nreturn {\n  main: async function*(puppy) {\n\\tconst lib = puppy.lib;\n\\tconst vars = puppy.vars;\n${jscode}\n  },\n}`;\n  var code: any = {};\n  try {\n    code = new Function(main)();\n  } catch (e) {\n    env.perror(t, {\n      type: 'error',\n      key: 'CompileError',\n      subject: e.toString(),\n    });\n  }\n  //const end = performance.now();\n  code['world'] = {};\n  code['tree'] = t; //\n  code['code'] = jscode;\n  code['errors'] = env.get('@logs');\n  //code['time'] = end - start;\n  return code as PuppyCode;\n};\n\nexport const utest = (s: string) => {\n  const src = { source: s };\n  const code = compile(src);\n  if (code.errors.length > 0) {\n    return code.errors[0].key;\n  }\n  const ss = code.code.split('\\n');\n  if (ss.length > 1) {\n    const s = ss[ss.length - 2].trim();\n    return s === '}' ? ss[ss.length - 3].trim() : s;\n  }\n  return '';\n};\n\n// console.log(transpile(`\n// '''\n// This is a apple.\n// I'm from Chiba.\n// '''\n// `));\n\nconsole.log(\n  transpile(`\nif True :\n  1\nelif True :\n  2\nelif True :\n  3\nelse :\n  4\n`)\n);\n\nconsole.log(\n  transpile(`\nfor x in range(1,2):\n  for y in range(x,2):\n    x+y\n`)\n);\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x*y;\n// `));\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x//y;\n// `));\n","import { setTheme, setCode, setMarker, setDecoration } from './editor';\nimport { CourseShape, setCourse, setContent, setCources } from './course';\nimport { setPuppy } from './puppy';\nimport { setPlaceholder, setShow } from './input';\nimport { PuppyCode, Puppy, runPuppy, ErrorLog } from '../vm/vm';\nimport store, { ReduxActions } from '../store';\nimport { compile } from '../puppy-transpiler/puppy';\n\nimport { Range } from 'monaco-editor';\n\nconst checkError = (\n  dispatch: (action: ReduxActions) => void,\n  code: PuppyCode\n) => {\n  let error_count = 0;\n  const annos: ErrorLog[] = [];\n  // editor.getSession().clearAnnotations();\n  for (const e of code.errors) {\n    if (e.type === 'error') {\n      error_count += 1;\n    }\n    annos.push(e);\n    // editor.getSession().setAnnotations(annos);\n  }\n  dispatch(setMarker(annos));\n  if (error_count === 0) {\n    dispatch(setTheme('vs'));\n    return false;\n  }\n  dispatch(setTheme('error'));\n  // editorPanel.style.backgroundColor = 'rgba(254,244,244,0.7)';\n  return true;\n};\n\nlet new_puppy: Puppy | null = null;\n\nexport const trancepile = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  source: string,\n  alwaysRun: boolean,\n  waitStart = false,\n  _isLive = false\n): Puppy | null => {\n  const code = compile({ source }) as PuppyCode; // Eval javascript code\n  console.log(code);\n  if (!checkError(dispatch, code)) {\n    // if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n    //   return puppy;\n    // }\n    if (new_puppy) {\n      new_puppy.dispose();\n    }\n    new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n    dispatch(setPuppy(new_puppy));\n  }\n  return new_puppy;\n};\n\n// export const trancepile = (dispatch: (action: ReduxActions) => void) => (\n//   puppy: Puppy | null,\n//   source: string,\n//   alwaysRun: boolean,\n//   waitStart = false,\n//   isLive = false\n// ): Promise<Puppy | null> =>\n//   fetch('/api/compile', {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/text; charset=utf-8',\n//     },\n//     body: source,\n//   })\n//     .then((res: Response) => {\n//       if (res.ok) {\n//         return res.text();\n//       }\n//       throw new Error(res.statusText);\n//     })\n//     .then((js: string) => {\n//       try {\n//         const code = Function(js)(); // Eval javascript code\n//         if (!checkError(dispatch, code)) {\n//           if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n//             return puppy;\n//           }\n//           if (new_puppy) {\n//             new_puppy.dispose();\n//           }\n//           new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n//           dispatch(setPuppy(new_puppy));\n//         }\n//         return new_puppy;\n//       } catch (e) {\n//         // alert(` ${e}`);\n//         // editorPanel.style.backgroundColor = 'rgba(244,244,254,0.7)';\n//         console.log(js);\n//         console.log(`FAIL TO TRANSCOMPILE ${e}`);\n//         console.log(e);\n//         return null;\n//       }\n//     })\n//     .catch((msg: string) => {\n//       alert(`Puppy is down!! ${msg}`);\n//       return null;\n//     });\n\nconst loadFile: (path: string) => Promise<string> = path => {\n  return fetch(path, {\n    method: 'GET',\n  })\n    .then((res: Response) => {\n      if (res.ok) {\n        return res.text();\n      }\n      throw new Error(res.statusText);\n    })\n    .then((sample: string) => {\n      return sample;\n    });\n};\n\nexport const fetchSetting = (dispatch: (action: ReduxActions) => void) => (\n  path: string\n): Promise<void> =>\n  loadFile(`/LIVE2019/course/${path}/setting.json`)\n    .then((s: string) => {\n      return JSON.parse(s);\n    })\n    .then((course: CourseShape) => {\n      dispatch(setCourse(course));\n    })\n    .catch((msg: string) => {\n      console.log(`ERR ${msg}`);\n    });\n\nexport const fetchContent = (dispatch: (action: ReduxActions) => void) => (\n  coursePath: string,\n  path: string\n): Promise<void> =>\n  loadFile(`/LIVE2019/course/${coursePath}/${path}/index.md`).then(\n    (content: string) => dispatch(setContent(content))\n  );\n\nexport const fetchSample = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  coursePath: string,\n  page: number,\n  path: string\n): void => {\n  const sample = window.sessionStorage.getItem(\n    `/LIVE2019/course/${coursePath}/${path}/sample.py`\n  );\n  if (sample) {\n    dispatch(setCode(sample));\n    trancepile(dispatch)(puppy, sample, false);\n  } else {\n    loadFile(`/LIVE2019/course/${coursePath}/${path}/sample.py`).then(\n      (sample: string) => {\n        dispatch(setCode(sample));\n        trancepile(dispatch)(puppy, sample, false);\n      }\n    );\n  }\n};\n\nexport const getInputValue = async (msg: string) => {\n  const awaitForClick = target => {\n    return new Promise(resolve => {\n      target.addEventListener('submit', resolve, { once: true });\n    });\n  };\n  store.dispatch(setShow(true));\n  store.dispatch(setPlaceholder(msg));\n  await awaitForClick(document.getElementById('puppy-input-form'));\n  return store.getState().input.value;\n};\n\nexport const getIsLive = () => store.getState().puppy.isLive;\n\nexport const getDiffStartLineNumber = () => {\n  const num = store.getState().editor.diffStartLineNumber;\n  return num === null ? 0 : num;\n};\n\nexport const setCodeHighlight = (startLineNum: number, endLineNum: number) => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(\n    setDecoration(\n      codeEditor.deltaDecorations(decoration, [\n        {\n          range: new Range(startLineNum, 1, endLineNum, 1),\n          options: { isWholeLine: true, className: 'code-highlight' },\n        },\n      ])\n    )\n  );\n};\n\nexport const resetCodeHighlight = () => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(setDecoration(codeEditor.deltaDecorations(decoration, [])));\n};\n\nexport const fetchCourses = (\n  dispatch: (action: ReduxActions) => void\n) => (): void => {\n  const courses: { [path: string]: CourseShape } = {};\n  const get_course: Promise<void>[] = [];\n  ['Puppy', 'PuppyCourse', 'LIVE2019'].forEach(path => {\n    get_course.push(\n      loadFile(`/LIVE2019/course/${path}/setting.json`)\n        .then((s: string) => {\n          return JSON.parse(s);\n        })\n        .then((course: CourseShape) => {\n          courses[path] = course;\n        })\n    );\n  });\n  Promise.all(get_course).then(() => dispatch(setCources(courses)));\n  // fetch('/api/courses')\n  //   .then((res: Response) => {\n  //     if (res.ok) {\n  //       return res.json();\n  //     }\n  //     throw new Error(res.statusText);\n  //   })\n  //   .then((json: { [path: string]: CourseShape }) => {\n  //     dispatch(setCources(json));\n  //   });\n};\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Header from '../components/Header/Header';\nimport { fetchCourses } from '../modules/operations';\nimport { setShow } from '../modules/version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  course: state.course.course,\n  courses: state.course.courses,\n});\n\nconst mapDispatchToProps = (dispathch: (action: ReduxActions) => void) => ({\n  fetchCourses: fetchCourses(dispathch),\n  setShow: (show: boolean) => dispathch(setShow(show)),\n});\n\nconst HeaderContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Header);\n\nexport default HeaderContainer;\n","import React, { useEffect } from 'react';\nimport MonacoEditor from 'react-monaco-editor';\nimport * as monacoEditor from 'monaco-editor';\nimport './Editor.css';\nimport { Puppy } from '../../vm/vm';\n\nimport { Button, Spinner } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faMinus, faPlay } from '@fortawesome/free-solid-svg-icons';\n\nimport { CodeEditor } from '../../modules/editor';\n\nmonacoEditor.editor.defineTheme('error', {\n  base: 'vs',\n  inherit: true,\n  rules: [],\n  colors: {\n    'editor.background': '#ffb7b7',\n  },\n});\n\nconst zenkaku =\n  '[' +\n  '' +\n  '' +\n  '' +\n  ']';\n\ntype EditorFooterProps = {\n  setFontSize: (fontSize: number) => void;\n  fontSize: number;\n  setIsLive: (isLive: boolean) => void;\n  isLive: boolean;\n};\n\nconst EditorFooter: React.FC<EditorFooterProps> = (\n  props: EditorFooterProps\n) => {\n  const fontPlus = () => {\n    props.setFontSize(props.fontSize + 3);\n  };\n  const fontMinus = () => {\n    props.setFontSize(Math.max(12, props.fontSize - 3));\n  };\n  return (\n    <div id=\"editor-footer\">\n      <Button onClick={() => props.setIsLive(!props.isLive)}>\n        {props.isLive ? (\n          <Spinner animation=\"grow\" variant=\"light\" size=\"sm\" />\n        ) : (\n          <FontAwesomeIcon icon={faPlay} />\n        )}\n        {' LIVE'}\n      </Button>\n      <Button onClick={fontPlus}>\n        <FontAwesomeIcon icon={faPlus} />\n      </Button>\n      <Button onClick={fontMinus}>\n        <FontAwesomeIcon icon={faMinus} />\n      </Button>\n    </div>\n  );\n};\n\nexport type EditorProps = {\n  width: number;\n  height: number;\n  codeEditor: CodeEditor | null;\n  decoration: string[];\n  fontSize: number;\n  theme: string;\n  code: string;\n  diffStartLineNumber: number | null;\n  puppy: Puppy | null;\n  isLive: boolean;\n  coursePath: string;\n  page: number;\n  setCode: (code: string) => void;\n  setSize: (width: number, height: number) => void;\n  setCodeEditor: (codeEditor: CodeEditor | null) => void;\n  setDecoration: (decoration: string[]) => void;\n  setFontSize: (fontSize: number) => void;\n  setDiffStartLineNumber: (startLineNumber: number | null) => void;\n  setIsLive: (isLive: boolean) => void;\n  trancepile: (\n    puppy: Puppy | null,\n    code: string,\n    alwaysRun: boolean,\n    waitStart?: boolean,\n    isLive?: boolean\n  ) => Puppy | null;\n};\n\nlet resizeTimer: NodeJS.Timeout;\nlet trancepileTimer: NodeJS.Timeout | null;\nlet startTimer: NodeJS.Timeout | null;\n\nconst Editor: React.FC<EditorProps> = (props: EditorProps) => {\n  const editorOptions = {\n    selectOnLineNumbers: true,\n    fontSize: props.fontSize,\n    wordWrap: 'on' as 'on',\n  };\n\n  addEventListener('resize', () => {\n    clearTimeout(resizeTimer!);\n    resizeTimer = setTimeout(function() {\n      props.setSize(\n        document.getElementById('right-col')!.clientWidth,\n        document.getElementById('right-col')!.clientHeight\n      );\n    }, 300);\n  });\n\n  useEffect(() => {\n    props.setSize(\n      document.getElementById('right-col')!.clientWidth,\n      document.getElementById('right-col')!.clientHeight\n    );\n  }, []);\n\n  const checkZenkaku = (codeEditor: CodeEditor) => {\n    const zenkakuRanges = codeEditor\n      .getModel()!\n      .findMatches(zenkaku, true, true, false, null, false);\n    const decos: monacoEditor.editor.IModelDeltaDecoration[] = zenkakuRanges.map(\n      (match: monacoEditor.editor.FindMatch) => ({\n        range: match.range,\n        options: { inlineClassName: 'zenkakuClass' },\n      })\n    );\n    props.setDecoration(codeEditor.deltaDecorations(props.decoration, decos));\n  };\n\n  const codeOnChange = (\n    new_code: string,\n    event: monacoEditor.editor.IModelContentChangedEvent\n  ) => {\n    let startNumber = props.diffStartLineNumber;\n    event.changes.map(change => {\n      startNumber =\n        startNumber === null\n          ? change.range.startLineNumber\n          : Math.min(startNumber, change.range.startLineNumber);\n    });\n    if (startNumber !== null) {\n      props.setDiffStartLineNumber(startNumber);\n    }\n    props.setCode(new_code);\n    if (props.codeEditor) {\n      checkZenkaku(props.codeEditor);\n    }\n    if (props.isLive) {\n      if (trancepileTimer) {\n        clearTimeout(trancepileTimer);\n        trancepileTimer = null;\n      }\n      // trancepileTimer = setTimeout(() => {\n      //   props.trancepile(props.puppy, new_code, false);\n      //   window.sessionStorage.setItem(\n      //     `/api/sample/${props.coursePath}/${props.page}`,\n      //     new_code\n      //   );\n      // }, 1500);\n      trancepileTimer = setTimeout(() => {\n        (puppy => {\n          if (startTimer) {\n            clearTimeout(startTimer);\n            startTimer = null;\n          }\n          startTimer = setTimeout(() => {\n            if (puppy) {\n              puppy.start();\n            }\n            props.setDiffStartLineNumber(null);\n          }, 1500);\n        })(props.trancepile(props.puppy, new_code, false, true, true));\n        window.sessionStorage.setItem(\n          `/api/sample/${props.coursePath}/${props.page}`,\n          new_code\n        );\n      }, 100);\n    }\n  };\n  const hoge: string = 'piyo';\n\n  hoge.startsWith('hoge');\n\n  const editorDidMount = (editor: CodeEditor) => {\n    props.setCodeEditor(editor);\n  };\n\n  return (\n    <div id=\"puppy-editor\">\n      <MonacoEditor\n        width={props.width}\n        height={props.height}\n        language=\"python\"\n        theme={props.theme}\n        value={props.code}\n        options={editorOptions}\n        onChange={codeOnChange}\n        editorDidMount={editorDidMount}\n      />\n      <EditorFooter\n        setFontSize={props.setFontSize}\n        fontSize={props.fontSize}\n        setIsLive={props.setIsLive}\n        isLive={props.isLive}\n      />\n    </div>\n  );\n};\n\nexport default Editor;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Editor from '../components/Editor/Editor';\nimport { trancepile } from '../modules/operations';\nimport {\n  setCode,\n  setSize,\n  setCodeEditor,\n  setDecoration,\n  setFontSize,\n  setDiffStartLineNumber,\n  CodeEditor,\n} from '../modules/editor';\nimport { setIsLive } from '../modules/puppy';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  width: state.editor.width,\n  height: state.editor.height,\n  codeEditor: state.editor.codeEditor,\n  decoration: state.editor.decoration,\n  theme: state.editor.theme,\n  fontSize: state.editor.fontSize,\n  code: state.editor.code,\n  diffStartLineNumber: state.editor.diffStartLineNumber,\n  puppy: state.puppy.puppy,\n  isLive: state.puppy.isLive,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setCode: (code: string) => dispatch(setCode(code)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  setCodeEditor: (codeEditor: CodeEditor | null) =>\n    dispatch(setCodeEditor(codeEditor)),\n  setDecoration: (decoration: string[]) => dispatch(setDecoration(decoration)),\n  setFontSize: (fontSize: number) => dispatch(setFontSize(fontSize)),\n  setDiffStartLineNumber: (LineNumber: number | null) =>\n    dispatch(setDiffStartLineNumber(LineNumber)),\n  setIsLive: (isLive: boolean) => dispatch(setIsLive(isLive)),\n  trancepile: trancepile(dispatch),\n});\n\nexport const EditorContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Editor);\n\nexport default EditorContainer;\n","import React from 'react';\nimport { Puppy } from '../../vm/vm';\nimport { Button } from 'react-bootstrap';\nimport './PuppyScreen.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faPlay,\n  faExpand,\n  faBookOpen,\n  faBook,\n} from '@fortawesome/free-solid-svg-icons';\n\ntype PuppyFooterProps = {\n  isCourseVisible: boolean;\n  setIsCourseVisible: (visible: boolean) => void;\n  code: string;\n  puppy: Puppy | null;\n  trancepile: (puppy: Puppy | null, code: string, alwaysRun: boolean) => void;\n};\n\nconst PuppyFooter: React.FC<PuppyFooterProps> = (props: PuppyFooterProps) => {\n  const fullscreen = () => {\n    if (props.puppy != null) {\n      const canvas = props.puppy.getCanvas();\n      if (canvas) {\n        // FIXME\n        if (canvas['webkitRequestFullscreen']) {\n          canvas['webkitRequestFullscreen'](); // Chrome15+, Safari5.1+, Opera15+\n        } else if (canvas['mozRequestFullScreen']) {\n          canvas['mozRequestFullScreen'](); // FF10+\n        } else if (canvas['msRequestFullscreen']) {\n          canvas['msRequestFullscreen'](); // IE11+\n        } else if (canvas['requestFullscreen']) {\n          canvas['requestFullscreen'](); // HTML5 Fullscreen API\n        } else {\n          // alert('');\n          return;\n        }\n      }\n    }\n  };\n  return (\n    <div id=\"puppy-footer\">\n      <Button onClick={() => props.trancepile(props.puppy, props.code, true)}>\n        <FontAwesomeIcon icon={faPlay} />\n        {' Play'}\n      </Button>\n      <Button onClick={fullscreen}>\n        <FontAwesomeIcon icon={faExpand} />\n      </Button>\n      <Button onClick={() => props.setIsCourseVisible(!props.isCourseVisible)}>\n        <FontAwesomeIcon icon={props.isCourseVisible ? faBook : faBookOpen} />\n      </Button>\n    </div>\n  );\n};\n\nexport type PuppyScreenProps = PuppyFooterProps & {\n  setSize: (width: number, height: number) => void;\n};\n\nlet timer: NodeJS.Timeout | null = null;\n\nconst PuppyScreen: React.FC<PuppyScreenProps> = (props: PuppyScreenProps) => {\n  addEventListener('resize', () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    timer = setTimeout(function() {\n      const w = document.getElementById('puppy-screen')!.clientWidth;\n      const h = document.getElementById('puppy-screen')!.clientHeight;\n      props.setSize(w, h);\n    }, 300);\n  });\n\n  return (\n    <>\n      <div id=\"puppy-screen\"></div>\n      <PuppyFooter\n        isCourseVisible={props.isCourseVisible}\n        setIsCourseVisible={props.setIsCourseVisible}\n        code={props.code}\n        puppy={props.puppy}\n        trancepile={props.trancepile}\n      />\n    </>\n  );\n};\n\nexport default PuppyScreen;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setVisible } from '../modules/course';\nimport { setSize } from '../modules/puppy';\nimport { trancepile } from '../modules/operations';\nimport PuppyScreen from '../components/PuppyScreen/PuppyScreen';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  isCourseVisible: state.course.visible,\n  code: state.editor.code,\n  puppy: state.puppy.puppy,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setIsCourseVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  trancepile: trancepile(dispatch),\n});\n\nconst PuppyScreenContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PuppyScreen);\n\nexport default PuppyScreenContainer;\n","import React, { useEffect } from 'react';\nimport * as marked from 'marked';\nimport { Card, Col, Row } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChevronRight,\n  faChevronLeft,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { Puppy } from '../../vm/vm';\n\nimport { CourseShape } from '../../modules/course';\n\nimport './Course.css';\nimport './github-markdown.css';\n\ntype CourseProps = {\n  course: CourseShape;\n  coursePath: string;\n  puppy: Puppy | null;\n  page: number;\n  content: string;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n  setCode: (code: string) => void;\n  setContent: (content: string) => void;\n  setCourse: (course: CourseShape) => void;\n  fetchContent: (coursePath: string, path: string) => void;\n  fetchSample: (\n    puppy: Puppy | null,\n    coursePath: string,\n    page: number,\n    path: string\n  ) => void;\n  fetchSetting: (coursePath: string) => void;\n};\n\nconst Course: React.FC<CourseProps> = (props: CourseProps) => {\n  useEffect(() => {\n    if (props.course.list.length !== 0) {\n      props.fetchContent(props.coursePath, props.course.list[props.page].path);\n      props.fetchSample(\n        props.puppy,\n        props.coursePath,\n        props.page,\n        props.course.list[props.page].path\n      );\n    }\n  }, [props.page, props.coursePath, props.course]);\n\n  useEffect(() => {\n    props.fetchSetting(props.coursePath);\n  }, [props.coursePath]);\n\n  return (\n    <div\n      id=\"puppy-course\"\n      style={{ visibility: props.visible ? 'visible' : 'hidden' }}\n    >\n      <Card className=\"course-all\">\n        <Card.Header className=\"course-header\">\n          <Row>\n            <button\n              className=\"close-button\"\n              onClick={() => props.setVisible(false)}\n            >\n              <FontAwesomeIcon icon={faTimes} />\n            </button>\n          </Row>\n          <Row>\n            <Col className=\"card-header-left\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== 0 ? (\n                <a href={`#${props.page - 1}`}>\n                  <FontAwesomeIcon icon={faChevronLeft} />\n                  {` ${props.course.list[props.page - 1].title}`}\n                </a>\n              ) : null}\n            </Col>\n            <Col className=\"card-header-right\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== props.course.list.length - 1 ? (\n                <a href={`#${props.page + 1}`}>\n                  {`${props.course.list[props.page + 1].title} `}\n                  <FontAwesomeIcon icon={faChevronRight} />\n                </a>\n              ) : null}\n            </Col>\n          </Row>\n        </Card.Header>\n        <Card.Body className=\"course-body\">\n          <div\n            className=\"markdown-body\"\n            dangerouslySetInnerHTML={{\n              __html: marked(props.content),\n            }}\n          ></div>\n        </Card.Body>\n      </Card>\n    </div>\n  );\n};\n\nexport default Course;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Course from '../components/Course/Course';\nimport {\n  setContent,\n  setCourse,\n  CourseShape,\n  setVisible,\n} from '../modules/course';\nimport { setCode } from '../modules/editor';\nimport { fetchContent, fetchSample, fetchSetting } from '../modules/operations';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  course: state.course.course,\n  puppy: state.puppy.puppy,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n  content: state.course.content,\n  visible: state.course.visible,\n});\n\nconst mapDispathToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setContent: (content: string) => dispatch(setContent(content)),\n  setCourse: (course: CourseShape) => dispatch(setCourse(course)),\n  setCode: (code: string) => dispatch(setCode(code)),\n  setVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  fetchContent: fetchContent(dispatch),\n  fetchSample: fetchSample(dispatch),\n  fetchSetting: fetchSetting(dispatch),\n});\n\nconst CourseContainer = connect(\n  mapStateToProps,\n  mapDispathToProps\n)(Course);\n\nexport default CourseContainer;\n","import React from 'react';\nimport { Modal, Button, InputGroup, FormControl, Form } from 'react-bootstrap';\n\nexport type InputState = {\n  show: boolean;\n  value: string;\n  placeholder: string;\n};\n\nexport type InputHandler = {\n  setShow: (show: boolean) => void;\n  setValue: (value: string) => void;\n};\n\nexport type InputProps = InputState & InputHandler;\n\nconst Input: React.FC<InputProps> = (props: InputProps) => {\n  return (\n    <Modal size=\"lg\" show={props.show} centered>\n      <Modal.Body>\n        <Form id=\"puppy-input-form\" onSubmit={() => props.setShow(false)}>\n          <InputGroup className=\"mb-3\">\n            <FormControl\n              placeholder={props.placeholder}\n              value={props.value}\n              onChange={e => props.setValue(e.target.value)}\n            />\n            <InputGroup.Append>\n              <Button type=\"submit\"></Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Input;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow, setValue } from '../modules/input';\nimport Input, { InputState, InputHandler } from '../components/Input/Input';\n\nconst mapStateToProps = (state: ReduxState): InputState => ({\n  show: state.input.show,\n  value: state.input.value,\n  placeholder: state.input.placeholder,\n});\n\nconst mapDispatchToProps = (\n  dispatch: (action: ReduxActions) => void\n): InputHandler => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n  setValue: (value: string) => dispatch(setValue(value)),\n});\n\nconst InputContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Input);\n\nexport default InputContainer;\n","import React from 'react';\nimport { Modal, Button } from 'react-bootstrap';\n\ntype VersionProps = {\n  show: boolean;\n  setShow: (show: boolean) => void;\n};\n\nconst Version: React.FC<VersionProps> = (props: VersionProps) => {\n  return (\n    <>\n      <Modal show={props.show} onHide={() => props.setShow(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Modal heading</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {\"Woohoo, you're reading this text in a modal!\"}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => props.setShow(false)}>\n            Close\n          </Button>\n          <Button variant=\"primary\" onClick={() => props.setShow(false)}>\n            Save Changes\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\n// render(<Example />);\n\nexport default Version;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow } from '../modules/version';\nimport Version from '../components/Version/Version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  show: state.version.show,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n});\n\nconst VersionContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Version);\n\nexport default VersionContainer;\n","import React from 'react';\nimport './App.css';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport Header from './containers/Header';\nimport Editor from './containers/Editor';\nimport PuppyScreen from './containers/PuppyScreen';\nimport Course from './containers/Course';\nimport Input from './containers/Input';\nimport Version from './containers/Version';\nimport { QueryParams } from './index';\n\ntype AppProps = { qs: QueryParams; hash: string };\n\nconst App: React.FC<AppProps> = (props: AppProps) => {\n  const coursePath = props.qs.course ? props.qs.course : 'LIVE2019';\n  const page = props.hash !== '' ? parseInt(props.hash.substr(1)) : 0;\n  return (\n    <div className=\"App\">\n      <Container className=\"container\">\n        <Header />\n        <Input />\n        <Version />\n        <Row id=\"main-row\">\n          <Col id=\"left-col\" xs={6}>\n            <Course coursePath={coursePath} page={page} />\n            <PuppyScreen />\n          </Col>\n          <Col id=\"right-col\" xs={6}>\n            <Editor coursePath={coursePath} page={page} />\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { store } from './store';\n\nexport type QueryParams = {\n  course?: string;\n};\n\nconst queryParser = (query: string) =>\n  query\n    .substr(1)\n    .split('&')\n    .reduce((obj, v) => {\n      const pair = v.split('=');\n      obj[pair[0]] = pair[1];\n      return obj;\n    }, {});\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <Route\n        render={props => (\n          <App\n            qs={queryParser(props.location.search)}\n            hash={props.location.hash}\n          />\n        )}\n      />\n    </Router>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}