{"version":3,"sources":["components/Header/Header.tsx","puppy-transpiler/puppy-message.ts","modules/editor.ts","modules/course.ts","modules/puppy.ts","modules/input.ts","env.ts","vm/shape.ts","vm/color.ts","puppy-transpiler/puppy-lib.ts","vm/vm.ts","vm/render.ts","modules/version.ts","store.ts","puppy-transpiler/puppy-parser.ts","puppy-transpiler/puppy.ts","modules/operations.ts","containers/Header.ts","components/Editor/Editor.tsx","containers/Editor.ts","components/PuppyScreen/PuppyScreen.tsx","containers/PuppyScreen.ts","components/Course/Course.tsx","containers/Course.ts","components/Input/Input.tsx","containers/Input.ts","components/Version/Version.tsx","containers/Version.ts","App.tsx","index.tsx"],"names":["Header","props","useEffect","fetchCourses","react_default","a","createElement","className","id","__source","fileName","_jsxFileName","lineNumber","__self","undefined","Navbar","bg","variant","expand","Brand","onClick","setShow","src","width","height","Nav","NavDropdown","title","course","Object","keys","courses","map","course_path","concat","drop","key","list","page","i","Item","href","enMessage","UndefinedParseTree","log","subject","TypeError","given","request","BinaryTypeError","SyntaxError","_log","UnknownPackageName","OnlyInFunction","OnlyInLoop","UndefinedName","Immutable","InferredPackage","UnknownName","NotFunction","TooManyArguments","RequiredArguments","CompileError","EditorActionTypes","setCode","code","type","SET_CODE","payload","setDecoration","decoration","SET_DECORATION","type2severity","monacoEditor","Error","Info","Warning","Hint","setTheme","theme","SET_THEME","initialState","codeEditor","fontSize","markers","diffStartLineNumber","editorReducer","CourseActionTypes","state","action","SET_SIZE","_objectSpread","SET_CODEEDITOR","SET_FONTSIZE","value","SET_MARKER","setModelMarkers","getModel","SET_DIFFSTARTLINENUMBER","startLineNumber","setContent","content","SET_CONTENT","setCourse","SET_COURSE","setVisible","visible","SET_VISIBLE","coursePath","courseReducer","PuppyActionTypes","course_objectSpread","SET_COURSES","puppy","isLive","puppyReducer","InputActionTypes","resize","puppy_objectSpread","SET_PUPPY","SET_ISLIVE","show","SET_SHOW","placeholder","InputReducer","SET_VALUE","input_objectSpread","SET_PLACEHOLDER","Bodies","Matter","Composite","Common","PropertyMap","radius","options","base","fillStyle","color","Array","isArray","choose","world","colorScheme","length","convColor","setShapeProperty","checkShapeProperty","circle","assign","position","x","y","rectangle","isStatic","polygon","sides","label","isSensor","collisionFilter","category","mask","group","created","getTimeStamp","pendulum","column","viewWidth","size","xx","yy","newtonsCradle","create","_options","inertia","interia","Infinity","restitution","friction","frictionAir","slop","constraint","pointA","bodyB","render","lineWidth","strokeStyle","console","initVars","vars","Circle","Rectangle","Polygon","Label","Drop","Pendulum","PuppyColorScheme","pop","cute","dynamic","gorgeous","casual","psychedelic","bright","fairytale","heavy","impact","street","cool","elegant","fresh","warm","soft","man","woman","boy","girl","smart","light","stylish","natural","spring","summer","fall","winter","japan","euro","nordic","asian","chooseColorScheme","cs","targets","document","getElementsByClassName","style","backgroundColor","borderColor","Lib","constructor","this","Body","Constraint","int","radix","v","Number","parseInt","isNaN","float","parseFloat","str","obj","repr","join","text","indexOf","anyAdd","anyMul","s","anyIn","range","z","start","end","step","xs","push","get","name","ref","index","charAt","slice","substring","find","sub","append","len","vec","setPosition","body","translate","applyForce","fx","fy","rotate","angle","_x","_y","scale","sx","sy","setAngle","setVelocity","setAngularVelocity","velocity","setDensity","density","setMass","mass","setStatic","flag","newComosite","addBody","parent","addConstraint","Engine","Runner","Render","_getTexture","imagePath","image","textures","Image","startsWith","bodies","context","c","showInternalEdges","wireframes","defaultFont","font","defaultFontColor","fontColor","k","parts","part","opacity","globalAlpha","texture","drawImage","circleRadius","beginPath","arc","Math","PI","moveTo","vertices","j","isInternal","lineTo","closePath","stroke","fill","save","textAlign","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","fillText","restore","myRender","MouseConstraint","Mouse","World","Bounds","Vertices","Detector","Puppy","settings","waitStart","interval","waitRestart","isExecuting","runner","engine","canvas","lib","new_","cons","add","viewHeight","pos","view","min","max","initCode","vwidth","vheight","background","gravity","airFriction","frictionStatic","motion","startCode","window","addEventListener","event","orientation","clamp","gamma","beta","on","time","timing","timestamp","eachUpdate","allBodies","pairs","pair","bodyA","isFixed","getElementById","render_width","clientWidth","render_height","clientHeight","element","mouse","constraintOptions","pointB","stiffness","mouseConstraint","sourcebody","contains","bounds","canCollide","run","dispose","clear","stop","remove","getCode","getCanvas","w","h","setAttribute","toString","[object Object]","msec","Promise","resolve","setTimeout","wait","enabled","getDiffStartLineNumber","main","getIsLive","delta","update","setCodeHighlight","waitForRun","resetCodeHighlight","isRunning","runCode","execute_main","pause","ln","n","lines","msg","getInputValue","display","async","target","querySelector","Text","onclick","listener","once","awaitForClick","f","print","extend","shape","move","px","random","trace","listAdd","getindex","substr","func","lst","from","puppy_settings","ftrace","VersionActionTypes","SET_VERSION_SHOW","VersionReducer","version_objectSpread","allReducers","combineReducers","editor","input","version","store","createStore","ParseTree","tag","spos","epos","child","urn","inputs","nodes","empties","setup","entry","edge","prev","reverse","is","isError","subs","tokenize","defstr","row","col","charCodeAt","begin","sb","strOut","node","Merge","ParserContext","head_pos","ast","memos","Memo","ANY","pAny","pChar","text_length","set_bitmap","bitmap","pRange","chars","ranges","codemax","find_codemax","Uint8Array","pMany","match","pMany1","pAnd","pNot","pOption","pSeq","matches","pSeq2","match2","pSeq3","match3","pOre","pOre2","pRef","peg","pNode","shift","pEdge","pFold","State","sid","getstate","pMatch","generate","grammar","res","pScope","pSymbol","INDENT","MUST","Type","isOptional","getValue","rtype","psize","ptype","accept","ty","realType","isPattern","hasAlpha","toVarType","BaseType","super","VarType","must","env","t","VoidType","FuncType","types","ss","ListType","param","p","tAny","UnionType","ty0","ts","union","tVoid","tBool","tInt","tInt_","tFloat","tInt0","tFloat0","tString","tString_","tA","tListA","tListInt","tListAny","tStringOrList","tMatter","tVec","tVec0","EmptyNumberSet","unionSet","b","A","varMap","varid","getroot","v1","u","OptionType","JSON","stringify","equals","Symbol","isMatter","isMutable","isGlobal","tOption","tFuncFloatFloat","tFuncFloatFloatFloat","tFuncShape","import_math","pi","sin","cos","tan","sqrt","log10","pow","hypot","gcd","import_python",".append","modules","math","matterjs",".setPosition",".applyForce",".rotate",".scale",".setAngle",".setAngularVelocity",".setDensity",".setMass",".setStatic",".setVelocity","symbolPackageMap","pkgname","checkSymbolNames","KEYTYPES","area","torque","damping","in","out","over","clicked","valueOfType","tCompr","opset","and","or","not","+=","-=","*=","//=","/=","<<=",">>=","|=","&=","^=","operator","op","op2","tleftMap","+","-","**","*","/","//","%","==","!=","<","<=",">",">=","^","|","&","<<",">>","tleft","tright","ty2","setpos","elog","r","Env","root","e","has","set","setroot","from_import","pkg","setModule","isModule","getModule","inferSymbolType","perror","logs","setInLoop","inLoop","setFunc","data","inFunc","foundFunc","symbol","isUtf8Name","local","vname","declVar","emitAutoYield","yieldparam","PuppyError","FIXME_subs","Transpiler","conv","skip","check","req","checkBinary","ty1","left","right","err","FromDecl","ImportDecl","alias","Source","subtree","out2","Block","penv","indent","nested","IfExpr","IfStmt","stmt","ElifStmt","ForStmt","lenv","FuncDecl","names","funcData","return","hasReturn","pname","funcType","defun","FuncExpr","Return","Continue","Break","Pass","VarDecl","out1","qual","Name","SetName","And","Or","Not","Infix","Unary","ApplyExpr","ApplySymbolExpr","recv","args","unshift","MethodExpr","methodname","SelfAssign","GetExpr","SetGetExpr","IndexExpr","SetIndexExpr","Slice","Data","KeyValue","fix","Tuple","List","Format","TrueExpr","FalseExpr","Int","Float","Double","String","Char","MultiString","parse","parser","transpile","compile","source","jscode","Function","checkError","dispatch","error_count","annos","errors","marker","severity","startColumn","endLineNumber","endColumn","message","setMarker","new_puppy","trancepile","alwaysRun","_isLive","newpuppy","runPuppy","setPuppy","loadFile","path","fetch","method","then","ok","statusText","sample","fetchSetting","catch","fetchContent","fetchSample","sessionStorage","getItem","setPlaceholder","getState","num","startLineNum","endLineNum","deltaDecorations","Range","isWholeLine","get_course","forEach","all","setCources","HeaderContainer","connect","dispathch","defineTheme","inherit","rules","colors","editor.background","registerCompletionItemProvider","provideCompletionItems","model","_token","wordInfo","getWordUntilPosition","suggestions","kind","CompletionItemKind","insertText","insertTextRules","CompletionItemInsertTextRule","InsertAsSnippet","Constructor","Property","EditorFooter","Editor_jsxFileName","Button","setIsLive","Spinner","animation","index_es","icon","faPlay","setFontSize","faPlus","faMinus","resizeTimer","trancepileTimer","startTimer","Editor","editorOptions","selectOnLineNumbers","wordWrap","lightbulb","clearTimeout","setSize","lib_default","language","onChange","new_code","startNumber","changes","change","setDiffStartLineNumber","decos","findMatches","inlineClassName","checkZenkaku","setItem","editorDidMount","setCodeEditor","EditorContainer","ownProps","LineNumber","PuppyFooter","PuppyScreen_jsxFileName","faExpand","setIsCourseVisible","isCourseVisible","faBookOpen","faBook","timer","PuppyScreen","Fragment","PuppyScreenContainer","Course","visibility","Course_jsxFileName","Card","Row","faTimes","Col","faChevronLeft","faChevronRight","dangerouslySetInnerHTML","__html","marked","CourseContainer","Input","Modal","centered","Input_jsxFileName","Form","onSubmit","InputGroup","FormControl","setValue","Append","InputContainer","Version","onHide","Version_jsxFileName","closeButton","Title","Footer","VersionContainer","App","qs","hash","App_jsxFileName","Container","containers_Header","containers_Input","containers_Version","containers_Course","containers_PuppyScreen","containers_Editor","queryParser","query","split","reduce","ReactDOM","es","src_jsxFileName","react_router_dom","react_router","src_App","location","search"],"mappings":"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QAASrC,GACTsC,MAAOpC,GACPqC,KAAM9J,GACN+J,SAAU9B,KAELwB,GAgHF,MClbDzD,GAASF,SAETkE,GAAmB,CACvBC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,SAAU,CACR,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,YAAa,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,UAAW,CACT,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,IAAK,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,QAAS,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,KAAM,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,OAAQ,CACN,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEFC,MAAO,CACL,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAISC,GAAqBhM,IAChC,MAAMiM,EACJjM,KAAO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","file":"static/js/main.b10ed55f.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap';\nimport { CourseShape } from '../../modules/course';\nimport './Header.css';\n\nexport type HeaderProps = {\n  course: CourseShape;\n  courses: { [path: string]: CourseShape };\n  fetchCourses: () => void;\n  setShow: (show: boolean) => void;\n};\n\nconst Header: React.FC<HeaderProps> = (props: HeaderProps) => {\n  useEffect(() => {\n    props.fetchCourses();\n  }, []);\n  return (\n    <div className=\"Header\" id=\"puppy-header\">\n      <Navbar bg=\"white\" variant=\"light\" expand=\"lg\">\n        <Navbar.Brand onClick={() => props.setShow(true)}>\n          <img\n            src=\"./image/logo.png\"\n            width=\"25\"\n            height=\"25\"\n            className=\"d-inline-block align-top\"\n          />\n          {' Puppy'}\n        </Navbar.Brand>\n        <Nav className=\"mr-auto\">\n          <NavDropdown title={props.course.title} id=\"nav-dropdown-courses\">\n            {Object.keys(props.courses).map(course_path => {\n              const course = props.courses[course_path];\n              return (\n                <NavDropdown\n                  title={course.title}\n                  id={`nav-dropdown-pages-${course.title}`}\n                  drop=\"right\"\n                  key={course.title}\n                >\n                  {course.list.map(\n                    (page: { path: string; title: string }, i: number) => (\n                      <NavDropdown.Item\n                        href={`?course=${course_path}#${i}`}\n                        key={i}\n                      >\n                        {page.title}\n                      </NavDropdown.Item>\n                    )\n                  )}\n                </NavDropdown>\n              );\n            })}\n          </NavDropdown>\n        </Nav>\n      </Navbar>\n    </div>\n  );\n};\n\nexport default Header;\n","import { ErrorLog } from './puppy';\n\nexport const enMessage: { [key: string]: (log: ErrorLog) => string } = {\n  UndefinedParseTree: (log: ErrorLog) => `UndefinedParseTree: ${log.subject}`,\n  TypeError: (log: ErrorLog) => {\n    if (log.subject) {\n      return `TypeError: type ${log.subject} or compatible its type is required`;\n    } else {\n      return `TypeError: type ${log.given} is not assignable to type ${log.request}`; // from TypeScript\n    }\n  },\n  BinaryTypeError: (log: ErrorLog) =>\n    `BinaryTypeError: invalid operands to binary expression ${log.subject} (${log.request} and ${log.given})`, // from Clang\n  SyntaxError: (_log: ErrorLog) => 'SyntaxError',\n  UnknownPackageName: (_log: ErrorLog) =>\n    'UnknownPackageName: package not found',\n  OnlyInFunction: (log: ErrorLog) =>\n    `OnlyInFunction: ${log.subject} outside function`, // from Python\n  OnlyInLoop: (log: ErrorLog) => `OnlyInLoop: ${log.subject} outside loop`, // from Python\n  UndefinedName: (log: ErrorLog) =>\n    `UndefinedName: use of undeclared identifier ${log.subject}`, // from Clang\n  Immutable: (log: ErrorLog) => `Immutable: ${log.subject} is immutable value`,\n  InferredPackage: (log: ErrorLog) =>\n    `InferredPackage: ${log.subject} imported automatically`,\n  UnknownName: (log: ErrorLog) =>\n    `UnknownName: use of undeclared identifier ${log.subject}`, // from Clang\n  NotFunction: (log: ErrorLog) =>\n    `NotFunction: ${log.subject} is not a function`, // from Clang\n  TooManyArguments: (_log: ErrorLog) =>\n    `TooManyArguments: arguments are too many`,\n  RequiredArguments: (_log: ErrorLog) =>\n    `RequiredArguments: arguments are required`,\n  CompileError: (log: ErrorLog) => `CompileError: ${log.subject}`,\n};\n","import { Action } from 'redux';\nimport * as monacoEditor from 'monaco-editor';\nexport type CodeEditor = monacoEditor.editor.IStandaloneCodeEditor;\nimport { ErrorLog } from '../vm/vm';\nimport { enMessage } from '../puppy-transpiler/puppy-message';\n\nenum EditorActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_CODE = 'SET_CODE',\n  SET_CODEEDITOR = 'SET_CODEEDITOR',\n  SET_FONTSIZE = 'SET_FONTSIZE',\n  SET_DECORATION = 'SET_DECORATION',\n  SET_MARKER = 'SET_MARKER',\n  SET_THEME = 'SETTHEME',\n  SET_DIFFSTARTLINENUMBER = 'SET_DIFFSTARTLINENUMBER',\n}\n\ninterface SetSizeAction extends Action {\n  type: EditorActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number): SetSizeAction => ({\n  type: EditorActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetCodeAction extends Action {\n  type: EditorActionTypes.SET_CODE;\n  payload: {\n    code: string;\n  };\n}\n\nexport const setCode = (code: string): SetCodeAction => ({\n  type: EditorActionTypes.SET_CODE,\n  payload: {\n    code,\n  },\n});\n\ninterface SetCodeEditorAction extends Action {\n  type: EditorActionTypes.SET_CODEEDITOR;\n  payload: {\n    codeEditor: CodeEditor | null;\n  };\n}\n\nexport const setCodeEditor = (\n  codeEditor: CodeEditor | null\n): SetCodeEditorAction => ({\n  type: EditorActionTypes.SET_CODEEDITOR,\n  payload: {\n    codeEditor,\n  },\n});\n\ninterface SetFontSizeAction extends Action {\n  type: EditorActionTypes.SET_FONTSIZE;\n  payload: {\n    value: number;\n  };\n}\n\nexport const setFontSize = (value: number): SetFontSizeAction => ({\n  type: EditorActionTypes.SET_FONTSIZE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetDecorationAction extends Action {\n  type: EditorActionTypes.SET_DECORATION;\n  payload: {\n    decoration: string[];\n  };\n}\n\nexport const setDecoration = (decoration: string[]): SetDecorationAction => ({\n  type: EditorActionTypes.SET_DECORATION,\n  payload: {\n    decoration,\n  },\n});\n\ninterface SetMarkerAction extends Action {\n  type: EditorActionTypes.SET_MARKER;\n  payload: {\n    markers: monacoEditor.editor.IMarkerData[];\n  };\n}\n\nconst type2severity = (type: 'error' | 'info' | 'warning' | 'hint') => {\n  switch (type) {\n    case 'error':\n      return monacoEditor.MarkerSeverity.Error;\n    case 'info':\n      return monacoEditor.MarkerSeverity.Info;\n    case 'warning':\n      return monacoEditor.MarkerSeverity.Warning;\n    case 'hint':\n      return monacoEditor.MarkerSeverity.Hint;\n  }\n};\n\nexport const setMarker = (markers: ErrorLog[]): SetMarkerAction => ({\n  type: EditorActionTypes.SET_MARKER,\n  payload: {\n    markers: markers.map(marker => ({\n      severity: type2severity(marker.type as\n        | 'error'\n        | 'info'\n        | 'warning'\n        | 'hint'),\n      startLineNumber: marker.row! + 1,\n      startColumn: marker.col!,\n      endLineNumber: marker.row! + 1,\n      endColumn: marker.col! + marker.len!,\n      message: enMessage[marker.key](marker),\n    })),\n  },\n});\n\ninterface SetThemeAction extends Action {\n  type: EditorActionTypes.SET_THEME;\n  payload: {\n    theme: string;\n  };\n}\n\nexport const setTheme = (theme: string): SetThemeAction => ({\n  type: EditorActionTypes.SET_THEME,\n  payload: {\n    theme,\n  },\n});\n\ninterface SetDiffStartLineNumber extends Action {\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER;\n  payload: {\n    startLineNumber: number | null;\n  };\n}\n\nexport const setDiffStartLineNumber = (startLineNumber: number | null) => ({\n  type: EditorActionTypes.SET_DIFFSTARTLINENUMBER,\n  payload: {\n    startLineNumber,\n  },\n});\n\nexport type EditorActions =\n  | SetCodeAction\n  | SetSizeAction\n  | SetCodeEditorAction\n  | SetFontSizeAction\n  | SetDecorationAction\n  | SetMarkerAction\n  | SetThemeAction\n  | SetDiffStartLineNumber;\n\nexport type EditorState = {\n  width: number;\n  height: number;\n  code: string;\n  codeEditor: CodeEditor | null;\n  theme: string;\n  fontSize: number;\n  decoration: string[];\n  markers: monacoEditor.editor.IMarkerData[];\n  diffStartLineNumber: number | null;\n};\n\nconst initialState: EditorState = {\n  width: 500,\n  height: 500,\n  code: '',\n  codeEditor: null,\n  theme: 'vs',\n  fontSize: 24,\n  decoration: [],\n  markers: [],\n  diffStartLineNumber: null,\n};\n\nexport const editorReducer = (state = initialState, action: EditorActions) => {\n  switch (action.type) {\n    case EditorActionTypes.SET_SIZE:\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case EditorActionTypes.SET_CODE:\n      return { ...state, code: action.payload.code };\n    case EditorActionTypes.SET_CODEEDITOR:\n      return { ...state, codeEditor: action.payload.codeEditor };\n    case EditorActionTypes.SET_FONTSIZE:\n      return { ...state, fontSize: action.payload.value };\n    case EditorActionTypes.SET_DECORATION:\n      return { ...state, decoration: action.payload.decoration };\n    case EditorActionTypes.SET_MARKER:\n      monacoEditor.editor.setModelMarkers(\n        state.codeEditor!.getModel()!,\n        'puppy',\n        action.payload.markers\n      );\n      return {\n        ...state,\n        codeEditor: state.codeEditor,\n        markers: action.payload.markers,\n      };\n    case EditorActionTypes.SET_THEME:\n      return { ...state, theme: action.payload.theme };\n    case EditorActionTypes.SET_DIFFSTARTLINENUMBER:\n      return { ...state, diffStartLineNumber: action.payload.startLineNumber };\n    default:\n      return state;\n  }\n};\n\nexport default editorReducer;\n","import { Action } from 'redux';\n\nexport type CourseShape = {\n  title: string;\n  list: {\n    path: string;\n    title: string;\n  }[];\n};\n\nenum CourseActionTypes {\n  SET_CONTENT = 'SET_CONTENT',\n  SET_COURSES = 'SET_COURCES',\n  SET_COURSE = 'SET_COURSE',\n  SET_VISIBLE = 'SET_VISIBLE',\n}\n\ninterface SetContentAction extends Action {\n  type: CourseActionTypes.SET_CONTENT;\n  payload: {\n    content: string;\n  };\n}\n\nexport const setContent = (content: string): SetContentAction => ({\n  type: CourseActionTypes.SET_CONTENT,\n  payload: {\n    content,\n  },\n});\n\ninterface SetCoursesAction extends Action {\n  type: CourseActionTypes.SET_COURSES;\n  payload: {\n    courses: { [path: string]: CourseShape };\n  };\n}\n\nexport const setCources = (courses: {\n  [path: string]: CourseShape;\n}): SetCoursesAction => ({\n  type: CourseActionTypes.SET_COURSES,\n  payload: {\n    courses,\n  },\n});\n\ninterface SetCourseAction extends Action {\n  type: CourseActionTypes.SET_COURSE;\n  payload: {\n    course: CourseShape;\n  };\n}\n\nexport const setCourse = (course: CourseShape): SetCourseAction => ({\n  type: CourseActionTypes.SET_COURSE,\n  payload: {\n    course,\n  },\n});\n\ninterface SetVisibleAction extends Action {\n  type: CourseActionTypes.SET_VISIBLE;\n  payload: {\n    visible: boolean;\n  };\n}\n\nexport const setVisible = (visible: boolean): SetVisibleAction => ({\n  type: CourseActionTypes.SET_VISIBLE,\n  payload: {\n    visible,\n  },\n});\n\nexport type CourseActions =\n  | SetContentAction\n  | SetCoursesAction\n  | SetCourseAction\n  | SetVisibleAction;\n\nexport type CourseState = {\n  content: string;\n  courses: { [path: string]: CourseShape };\n  course: CourseShape;\n  coursePath: string;\n  page: number;\n  visible: boolean;\n};\n\nconst initialState: CourseState = {\n  content: '# Hello World \\n\\n Rendered by **marked**',\n  courses: {},\n  course: { title: '', list: [] },\n  coursePath: '',\n  page: 0,\n  visible: true,\n};\n\nconst courseReducer = (state = initialState, action: CourseActions) => {\n  switch (action.type) {\n    case CourseActionTypes.SET_CONTENT:\n      return { ...state, content: action.payload.content };\n    case CourseActionTypes.SET_COURSES:\n      return { ...state, courses: action.payload.courses };\n    case CourseActionTypes.SET_COURSE:\n      return { ...state, course: action.payload.course };\n    case CourseActionTypes.SET_VISIBLE:\n      return { ...state, visible: action.payload.visible };\n    default:\n      return state;\n  }\n};\n\nexport default courseReducer;\n","import { Action } from 'redux';\nimport { Puppy } from '../vm/vm';\n\nenum PuppyActionTypes {\n  SET_SIZE = 'SET_SIZE',\n  SET_PUPPY = 'SET_PUPPY',\n  SET_ISLIVE = 'SET_ISLIVE',\n}\n\ninterface SetSizeAction extends Action {\n  type: PuppyActionTypes.SET_SIZE;\n  payload: {\n    width: number;\n    height: number;\n  };\n}\n\nexport const setSize = (width: number, height: number) => ({\n  type: PuppyActionTypes.SET_SIZE,\n  payload: {\n    width,\n    height,\n  },\n});\n\ninterface SetPuppyAction extends Action {\n  type: PuppyActionTypes.SET_PUPPY;\n  payload: {\n    puppy: Puppy | null;\n  };\n}\n\nexport const setPuppy = (puppy: Puppy | null) => ({\n  type: PuppyActionTypes.SET_PUPPY,\n  payload: {\n    puppy,\n  },\n});\n\ninterface SetIsLiveAction extends Action {\n  type: PuppyActionTypes.SET_ISLIVE;\n  payload: {\n    isLive: boolean;\n  };\n}\n\nexport const setIsLive = (isLive: boolean) => ({\n  type: PuppyActionTypes.SET_ISLIVE,\n  payload: {\n    isLive,\n  },\n});\n\nexport type PuppyActions = SetSizeAction | SetPuppyAction | SetIsLiveAction;\n\nexport type PuppyState = {\n  width: number;\n  height: number;\n  puppy: Puppy | null;\n  isLive: boolean;\n};\n\nconst initialState: PuppyState = {\n  width: 500,\n  height: 500,\n  puppy: null,\n  isLive: true,\n};\n\nexport const puppyReducer = (state = initialState, action: PuppyActions) => {\n  switch (action.type) {\n    case PuppyActionTypes.SET_SIZE:\n      if (state.puppy) {\n        state.puppy.resize(action.payload.width, action.payload.height);\n      }\n      return {\n        ...state,\n        width: action.payload.width,\n        height: action.payload.height,\n      };\n    case PuppyActionTypes.SET_PUPPY:\n      return { ...state, puppy: action.payload.puppy };\n    case PuppyActionTypes.SET_ISLIVE:\n      return { ...state, isLive: action.payload.isLive };\n    default:\n      return state;\n  }\n};\n\nexport default puppyReducer;\n","import { Action } from 'redux';\n\nenum InputActionTypes {\n  SET_VALUE = 'SET_VALUE',\n  SET_SHOW = 'SET_SHOW',\n  SET_PLACEHOLDER = 'SET_PLACEHOLDER',\n}\n\ninterface SetValueAction extends Action {\n  type: InputActionTypes.SET_VALUE;\n  payload: {\n    value: string;\n  };\n}\n\nexport const setValue = (value: string): SetValueAction => ({\n  type: InputActionTypes.SET_VALUE,\n  payload: {\n    value,\n  },\n});\n\ninterface SetShowAction extends Action {\n  type: InputActionTypes.SET_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: InputActionTypes.SET_SHOW,\n  payload: {\n    show,\n  },\n});\n\ninterface SetPlaceholderAction extends Action {\n  type: InputActionTypes.SET_PLACEHOLDER;\n  payload: {\n    placeholder: string;\n  };\n}\n\nexport const setPlaceholder = (placeholder: string): SetPlaceholderAction => ({\n  type: InputActionTypes.SET_PLACEHOLDER,\n  payload: {\n    placeholder,\n  },\n});\n\nexport type InputActions =\n  | SetValueAction\n  | SetShowAction\n  | SetPlaceholderAction;\n\nexport type InputState = {\n  value: string;\n  show: boolean;\n  placeholder: string;\n};\n\nconst initialState: InputState = {\n  value: '',\n  show: false,\n  placeholder: '',\n};\n\nconst InputReducer = (state = initialState, action: InputActions) => {\n  switch (action.type) {\n    case InputActionTypes.SET_VALUE:\n      return { ...state, value: action.payload.value };\n    case InputActionTypes.SET_SHOW:\n      if (action.payload.show) {\n        return { value: '', show: action.payload.show, placeholder: '' };\n      } else {\n        return { ...state, show: action.payload.show };\n      }\n    case InputActionTypes.SET_PLACEHOLDER:\n      return { ...state, placeholder: action.payload.placeholder };\n    default:\n      return state;\n  }\n};\n\nexport default InputReducer;\n","export const PATH_PREFIX = '/LIVE2019';\n// export const PATH_PREFIX = '';\n","import * as Matter from 'matter-js';\n\nconst Bodies = Matter.Bodies;\nconst Composite = Matter.Composite;\nconst Common = Matter['Common'];\n\nimport { Puppy } from './vm'; // eslint-disable-line no-unused-vars\n\nexport type PuppyShape =\n  | 'circle'\n  | 'rectangle'\n  | 'trapezoid'\n  | 'polygon'\n  | 'label';\nexport type CollisionFunc = (obj1: {}, obj2: {}) => void;\nexport type ClickedFunc = (obj: {}) => void;\n\nexport type PuppyConstructor = (puppy: Puppy, options: Shape) => Matter.Body;\n\nexport type Shape = {\n  position?: {\n    x: number;\n    y: number;\n  };\n  isSensor?: boolean;\n  isStatic?: boolean;\n  width?: number;\n  height?: number;\n\n  angle?: number;\n  interia?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n};\n\n// const flatten = part => {\n//   console.log(part);\n//   Object.keys(part.render).forEach(key => {\n//     if (!(key in part)) {\n//       console.log(`key ${key}`);\n//       part[key] = part.render[key];\n//     }\n//   });\n// };\n\nconst convColor = (puppy: Puppy, color: any) => {\n  if (Array.isArray(color)) {\n    color = Common.choose(color);\n  }\n  if (typeof color === 'number') {\n    const list: [string] = puppy.world!.colorScheme;\n    return list[color % list.length];\n  }\n  return color;\n};\n\nexport const PropertyMap: {} = {\n  radius: (puppy: Puppy, options: Shape, value: any) => {\n    options.radius = value;\n    if (options.base === 'circle') {\n      options.width = value * 2;\n      options.height = value * 2;\n    }\n  },\n  width: (puppy: Puppy, options: Shape, value: any) => {\n    options.width = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.height = value;\n    }\n  },\n  height: (puppy: Puppy, options: Shape, value: any) => {\n    options.height = value;\n    if (options.base === 'circle') {\n      options.radius = value / 2;\n      options.width = value;\n    }\n  },\n  fillStyle: (puppy: Puppy, options: Shape, value: any) => {\n    options.fillStyle = convColor(puppy, value);\n  },\n};\n\nexport const setShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value: any\n) => {\n  if (key in PropertyMap) {\n    PropertyMap[key](puppy, options, value);\n  } else {\n    options[key] = value;\n  }\n  return value;\n};\n\nconst checkShapeProperty = (\n  puppy: Puppy,\n  options: Shape,\n  key: string,\n  value?: any\n) => {\n  if (options[key]) {\n    return setShapeProperty(puppy, options, key, options[key]);\n  }\n  if (value) {\n    return setShapeProperty(puppy, options, key, value);\n  }\n  return undefined;\n};\n\n/* constructor functions */\n\nconst circle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst rectangle = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    visible: true,\n  });\n  checkShapeProperty(puppy, options, 'width', 100);\n  checkShapeProperty(puppy, options, 'height', 100);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fillStyle',\n    options.isStatic ? 'black' : Common.choose(puppy.world!.colorScheme)\n  );\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst polygon = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'polygon',\n    visible: true,\n  });\n  const sides = checkShapeProperty(puppy, options, 'sides', 5);\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 25);\n  return Bodies.polygon(\n    options.position!.x,\n    options.position!.y,\n    sides,\n    options.radius!,\n    options\n  );\n};\n\nconst label = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'rectangle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n  });\n  checkShapeProperty(puppy, options, 'width', 10);\n  checkShapeProperty(puppy, options, 'height', 10);\n  checkShapeProperty(\n    puppy,\n    options,\n    'fontColor',\n    Common.choose(puppy.world!.colorScheme)\n  );\n  checkShapeProperty(puppy, options, 'fillStyle', 'rgba(255, 255, 255, 0)');\n  return Bodies.rectangle(\n    options.position!.x,\n    options.position!.y,\n    options.width!,\n    options.height!,\n    options\n  );\n};\n\nconst drop = (puppy: Puppy, options: Shape) => {\n  Object.assign(options, {\n    base: 'circle',\n    isSensor: true,\n    isStatic: true,\n    visible: true,\n    collisionFilter: {\n      category: 0x0001,\n      mask: 0x00000000,\n      group: 3,\n    },\n    created: puppy.getTimeStamp(),\n  });\n  checkShapeProperty(puppy, options, 'height');\n  checkShapeProperty(puppy, options, 'width');\n  checkShapeProperty(puppy, options, 'radius', 10);\n  checkShapeProperty(puppy, options, 'fillStyle', 0);\n  checkShapeProperty(puppy, options, 'opacity', 0.8);\n  return Bodies.circle(\n    options.position!.x,\n    options.position!.y,\n    options.radius!,\n    options\n  );\n};\n\nconst pendulum = (puppy: Puppy, options: Shape) => {\n  const separation = 1.9;\n  const column = checkShapeProperty(puppy, options, 'column', 5);\n  const width = checkShapeProperty(\n    puppy,\n    options,\n    'width',\n    puppy.world!.viewWidth / 2\n  );\n  const height = checkShapeProperty(\n    puppy,\n    options,\n    'height',\n    puppy.world!.viewWidth / 2\n  );\n  const size = width / (column * 2);\n  const xx = options.position!.x - width / 2;\n  const yy = options.position!.y - height / 2;\n  const newtonsCradle = Matter.Composite.create({\n    label: 'Newtons Cradle',\n  });\n  for (let i = 0; i < column; i += 1) {\n    const _options = {\n      visible: true,\n      fillStyle: Common.choose(puppy.world!.colorScheme),\n      inertia: options.interia || Infinity,\n      restitution: options.restitution || 1,\n      friction: options.friction || 0,\n      frictionAir: options.frictionAir || 0.0001,\n      slop: options.slop || 1,\n    };\n    const circle = Matter.Bodies.circle(\n      xx + i * (size * separation),\n      yy + height,\n      size,\n      _options\n    );\n    const constraint = Matter.Constraint.create({\n      pointA: {\n        x: xx + i * (size * separation),\n        y: yy,\n      },\n      bodyB: circle,\n      render: {\n        visible: true,\n        lineWidth: options.lineWidth! | 1,\n        strokeStyle: options.strokeStyle || 'gray',\n      },\n    });\n    Composite['addBody'](newtonsCradle, circle);\n    Composite['addConstraint'](newtonsCradle, constraint);\n  }\n  console.log(newtonsCradle);\n  console.log(newtonsCradle['parts']);\n  return newtonsCradle;\n};\n\nexport const initVars = (vars: {}) => {\n  Object.assign(vars, {\n    Circle: circle,\n    Rectangle: rectangle,\n    Polygon: polygon,\n    Label: label,\n    Drop: drop,\n    Pendulum: pendulum,\n  });\n  return vars;\n};\n\n/* shapeFunc 物体の形状から物体を生成する関数 */\n\nexport type ShapeOptions = {\n  // Matter Options\n  id?: number;\n  type?: string;\n  label?: string;\n  parts?: [];\n  plugin?: {};\n  angle?: number;\n  interia?: number;\n  position: {\n    x: number;\n    y: number;\n  };\n  width?: number;\n  height?: number;\n  force?: {\n    x: number;\n    y: number;\n  };\n  torque?: number;\n  positionImpulse?: { x?: number; y?: number };\n  constraintImpulse?: { x?: number; y?: number; angle?: number };\n  totalContacts?: number;\n  speed?: number;\n  angularSpeed?: number;\n  velocity?: { x: number; y: number };\n  angularVelocity?: number;\n  isSensor?: boolean;\n  isStatic?: boolean;\n  isSleeping?: boolean;\n  motion?: number;\n  sleepThreshold?: number;\n  density?: number;\n  restitution?: number;\n  friction?: number;\n  frictionStatic?: number;\n  frictionAir?: number;\n  collisionFilter?: {\n    category: number;\n    mask: number;\n    group: number;\n  };\n  slop?: number;\n  timeScale?: number;\n  visible?: boolean;\n  fillStyle?: string;\n  opacity?: number;\n  sprite?: {\n    xScale?: number;\n    yScale?: number;\n    xOffset?: number;\n    yOffset?: number;\n  };\n  lineWidth?: number;\n  strokeStyle?: string;\n\n  // Puppy Options\n  base?: string;\n  shape?: PuppyShape;\n  column?: number;\n  row?: number;\n  radius?: number;\n  slope?: number;\n  sides?: number;\n  image?: string;\n  created?: number;\n  collisionStart?: CollisionFunc;\n  collisionEnd?: CollisionFunc;\n  collisionActive?: CollisionFunc;\n  clicked?: ClickedFunc;\n};\n\n// export const isShapeOptions = (obj: {}) => ('shape' in obj) && ('position' in obj) && ('x' in obj['position']) && ('y' in obj['position']);\n\nexport class PuppyShapeBase implements ShapeOptions {\n  shape: PuppyShape = 'circle';\n  position: {\n    x: number;\n    y: number;\n  };\n\n  constructor(x: number, y: number, options = {}) {\n    Object.assign(this, options);\n    this.position = { x, y };\n  }\n}\n\nexport class Circle extends PuppyShapeBase {\n  shape: PuppyShape = 'circle';\n}\n\nexport class Rectangle extends PuppyShapeBase {\n  shape: PuppyShape = 'rectangle';\n}\n\nexport class Polygon extends PuppyShapeBase {\n  shape: PuppyShape = 'polygon';\n}\n\nexport class Trapezoid extends PuppyShapeBase {\n  shape: PuppyShape = 'trapezoid';\n}\n\nexport class Label extends PuppyShapeBase {\n  shape: PuppyShape = 'label';\n}\n\nexport const shapeFuncMap: {\n  [key in PuppyShape]: (world: {}, options: ShapeOptions) => Matter.Body;\n} = {\n  circle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      radius: _options.width\n        ? _options.width / 2\n        : _options.height\n        ? _options.height / 2\n        : 25,\n      fillStyle: Common.choose(world['colorScheme']),\n      visible: true,\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    // width, height をセットしないと、texture が貼れない\n    if (!options.width) {\n      options.width = options.radius * 2;\n    }\n    if (!options.height) {\n      options.height = options.radius * 2;\n    }\n    return Bodies.circle(\n      options.position.x,\n      options.position.y,\n      options.radius,\n      options\n    );\n  },\n  rectangle(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'black'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n  polygon(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      sides: 5,\n      radius: 25,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend(\n      {},\n      defaultOptions,\n      { radius: _options.width ? _options.width / 2 : defaultOptions.radius },\n      _options\n    );\n    return Bodies.polygon(\n      options.position.x,\n      options.position.y,\n      options.sides,\n      options.radius,\n      options\n    );\n  },\n  trapezoid(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      slope: 0.5,\n      visible: true,\n      fillStyle: _options.isStatic\n        ? 'gray'\n        : Common.choose(world['colorScheme']),\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.trapezoid(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options.slope,\n      options\n    );\n  },\n  label(world: {}, _options: ShapeOptions) {\n    const defaultOptions = {\n      width: 100,\n      height: 100,\n      isSensor: true,\n      isStatic: true,\n      fillStyle: 'rgba(255, 255, 255, 0)',\n      fontColor: Common.choose(world['colorScheme']),\n      visible: true,\n      collisionFilter: {\n        category: 0x0001,\n        mask: 0x00000000,\n        group: 3,\n      },\n    };\n    const options = Common.extend({}, defaultOptions, _options);\n    return Bodies.rectangle(\n      options.position.x,\n      options.position.y,\n      options.width,\n      options.height,\n      options\n    );\n  },\n};\n","import * as Matter from 'matter-js';\n\nconst Common = Matter['Common'];\n\nconst PuppyColorScheme = {\n  pop: [\n    '#de9610',\n    '#c93a40',\n    '#fff001',\n    '#d06d8c',\n    '#65ace4',\n    '#a0c238',\n    '#56a764',\n    '#d16b16',\n    '#cc528b',\n    '#9460a0',\n    '#f2cf01',\n    '#0074bf',\n  ],\n  cute: [\n    '#e2b2c0',\n    '#fff353',\n    '#a5d1f4',\n    '#e4ad6d',\n    '#d685b0',\n    '#dbe159',\n    '#7fc2ef',\n    '#c4a6ca',\n    '#eabf4c',\n    '#f9e697',\n    '#b3d3ac',\n    '#eac7cd',\n  ],\n  dynamic: [\n    '#b80117',\n    '#222584',\n    '#00904a',\n    '#edc600',\n    '#261e1c',\n    '#6d1782',\n    '#8f253b',\n    '#a0c238',\n    '#d16b16',\n    '#0168b3',\n    '#b88b26',\n    '#c30068',\n  ],\n  gorgeous: [\n    '#7d0f80',\n    '#b08829',\n    '#a03c44',\n    '#018a9a',\n    '#ab045c',\n    '#391d2b',\n    '#d5a417',\n    '#546474',\n    '#0f5ca0',\n    '#d0b98d',\n    '#d4c91f',\n    '#c1541c',\n  ],\n  casual: [\n    '#7b9ad0',\n    '#f8e352',\n    '#c8d627',\n    '#d5848b',\n    '#e5ab47',\n    '#e1cea3',\n    '#51a1a2',\n    '#b1d7e4',\n    '#66b7ec',\n    '#c08e47',\n    '#ae8dbc',\n    '#c3cfa9',\n  ],\n  psychedelic: [\n    '#b7007c',\n    '#009b85',\n    '#382284',\n    '#e2c80f',\n    '#009dc6',\n    '#c4c829',\n    '#95007e',\n    '#d685b0',\n    '#eee800',\n    '#bf5116',\n    '#b80e3b',\n    '#0178bc',\n  ],\n  bright: [\n    '#fff001',\n    '#cb5393',\n    '#a0c238',\n    '#d78114',\n    '#00a5e7',\n    '#cd5638',\n    '#0168b3',\n    '#d685b0',\n    '#00984b',\n    '#f2cf01',\n    '#6bb6bb',\n    '#a563a0',\n  ],\n  fairytale: [\n    '#cca9ca',\n    '#9bcad0',\n    '#dd9dbf',\n    '#edef9c',\n    '#aabade',\n    '#f2dae8',\n    '#c7ddae',\n    '#a199c8',\n    '#faede5',\n    '#d5a87f',\n    '#f7f06e',\n    '#95bfe7',\n  ],\n  heavy: [\n    '#000000',\n    '#998c69',\n    '#5c002f',\n    '#244765',\n    '#814523',\n    '#5e2a58',\n    '#1a653c',\n    '#6a6a68',\n    '#bf7220',\n    '#5f556e',\n    '#84762f',\n    '#872226',\n  ],\n  impact: [\n    '#c60019',\n    '#fff001',\n    '#1d4293',\n    '#00984b',\n    '#019fe6',\n    '#c2007b',\n    '#261e1c',\n    '#7d0f80',\n    '#dc9610',\n    '#dbdf19',\n    '#d685b0',\n    '#a0c238',\n  ],\n  street: [\n    '#33476a',\n    '#211917',\n    '#6c7822',\n    '#c2007b',\n    '#44aeea',\n    '#5e3032',\n    '#d16b16',\n    '#c8d627',\n    '#9193a0',\n    '#816945',\n    '#c50030',\n    '#0080c9',\n  ],\n  cool: [\n    '#b0d7f4',\n    '#c0cbe9',\n    '#eef0b1',\n    '#44aeea',\n    '#85beab',\n    '#c4a6ca',\n    '#f7f06e',\n    '#c8d627',\n    '#bcccd9',\n    '#e4f0fc',\n    '#f2dae8',\n    '#6490cd',\n  ],\n  elegant: [\n    '#ae8dbc',\n    '#e3b3cd',\n    '#d6ddf0',\n    '#e5d57d',\n    '#82c0cd',\n    '#afc7a7',\n    '#834e62',\n    '#6a9176',\n    '#7f7eb8',\n    '#a04e90',\n    '#dbbc86',\n    '#c4c829',\n  ],\n  fresh: [\n    '#70b062',\n    '#c8d85b',\n    '#f8e133',\n    '#dbdf19',\n    '#e3ab30',\n    '#dd9dbf',\n    '#a979ad',\n    '#cd5638',\n    '#399548',\n    '#6bb6bb',\n    '#f7f39c',\n    '#9acce3',\n  ],\n  warm: [\n    '#c59f22',\n    '#dd9b9d',\n    '#ebcc00',\n    '#d6d11d',\n    '#8d4f42',\n    '#d8836e',\n    '#f8e469',\n    '#cbb586',\n    '#e4aa01',\n    '#eac287',\n    '#f2d8bf',\n    '#a6658d',\n  ],\n  soft: [\n    '#f8e469',\n    '#e7e0aa',\n    '#d9de84',\n    '#e4bd60',\n    '#9ac29f',\n    '#e3be87',\n    '#edef9c',\n    '#dd9b9d',\n    '#b2d6d4',\n    '#f5dfa6',\n    '#ebeddf',\n    '#e1d4e6',\n  ],\n  man: [\n    '#23466e',\n    '#4d639f',\n    '#dfe0d8',\n    '#1d695f',\n    '#9aadbe',\n    '#844f30',\n    '#934e61',\n    '#7e9895',\n    '#77aad7',\n    '#848a96',\n    '#a76535',\n    '#7e8639',\n  ],\n  woman: [\n    '#7b0050',\n    '#a8006d',\n    '#bea620',\n    '#a26c54',\n    '#949b34',\n    '#614983',\n    '#cba777',\n    '#de9610',\n    '#bd8683',\n    '#be87a6',\n    '#bf5346',\n    '#e1d0b4',\n  ],\n  boy: [\n    '#0168b3',\n    '#66b7ec',\n    '#afd0ef',\n    '#88b83e',\n    '#b8b2d6',\n    '#6bb6bb',\n    '#5e4694',\n    '#f2cf01',\n    '#c6e2f8',\n    '#d5dbcf',\n    '#7a8bc3',\n    '#e8e6f3',\n  ],\n  girl: [\n    '#d06da3',\n    '#c2d3ed',\n    '#be91bc',\n    '#c73576',\n    '#f8e352',\n    '#c8d627',\n    '#e3b3cd',\n    '#c6e0d5',\n    '#e4ab5a',\n    '#cb6c58',\n    '#845d9e',\n    '#82c0cd',\n  ],\n  smart: [\n    '#4d639f',\n    '#356c92',\n    '#c9ced1',\n    '#dfd4be',\n    '#92a1a6',\n    '#a67b2d',\n    '#bda5bb',\n    '#2c4b79',\n    '#d6d680',\n    '#babea5',\n    '#ebc175',\n    '#3a614f',\n  ],\n  light: [\n    '#44aeea',\n    '#b4cb32',\n    '#b2b6db',\n    '#b2d6d4',\n    '#ebe9ae',\n    '#0080c9',\n    '#71b174',\n    '#e4c4db',\n    '#7da8db',\n    '#eac39a',\n    '#dbe585',\n    '#6db5a9',\n  ],\n  stylish: [\n    '#58656e',\n    '#bac1c7',\n    '#487ca3',\n    '#dfd4be',\n    '#004679',\n    '#c0542d',\n    '#a44682',\n    '#9599b2',\n    '#d6d680',\n    '#8eb4d9',\n    '#6c5776',\n    '#499475',\n  ],\n  natural: [\n    '#ba9648',\n    '#87643e',\n    '#c2b5d1',\n    '#ba7d8c',\n    '#b8ac60',\n    '#797c85',\n    '#f9ebd1',\n    '#9cb1c2',\n    '#81a47a',\n    '#acb130',\n    '#8b342a',\n    '#acae98',\n  ],\n  spring: [\n    '#dd9cb4',\n    '#eeea55',\n    '#ebc061',\n    '#b2d6d4',\n    '#f2dae8',\n    '#c9d744',\n    '#b8b2d6',\n    '#afd0ef',\n    '#d7847e',\n    '#f8e352',\n    '#b3ce5b',\n    '#cbacbe',\n  ],\n  summer: [\n    '#174e9e',\n    '#68b8dd',\n    '#d16b16',\n    '#88b83e',\n    '#f2cf01',\n    '#019fe6',\n    '#c60019',\n    '#019c96',\n    '#b0d7f4',\n    '#fff001',\n    '#0074bf',\n    '#c83955',\n  ],\n  fall: [\n    '#ae3c22',\n    '#902342',\n    '#c59f22',\n    '#7e8639',\n    '#eabd00',\n    '#a49e2e',\n    '#ac5238',\n    '#9f832f',\n    '#ba7c6f',\n    '#875f3b',\n    '#bba929',\n    '#786b4b',\n  ],\n  winter: [\n    '#a5aad4',\n    '#6591b6',\n    '#623d82',\n    '#5f897b',\n    '#858aa0',\n    '#eff3f6',\n    '#c2d3dd',\n    '#4f616f',\n    '#7f7073',\n    '#42629f',\n    '#674c51',\n    '#b38da4',\n  ],\n  japan: [\n    '#c3003a',\n    '#3a546b',\n    '#d5a02e',\n    '#918d43',\n    '#787cac',\n    '#604439',\n    '#6f2757',\n    '#c1541c',\n    '#565d63',\n    '#afc9ca',\n    '#baaa52',\n    '#e2b2c0',\n  ],\n  euro: [\n    '#bf541c',\n    '#25a4b7',\n    '#e4aa01',\n    '#b2bfe1',\n    '#ad438e',\n    '#1d4293',\n    '#b71232',\n    '#e8e2be',\n    '#b0bf30',\n    '#6aa43e',\n    '#6276b5',\n    '#d7832d',\n  ],\n  nordic: [\n    '#149bdf',\n    '#dbdf19',\n    '#c97a2b',\n    '#945141',\n    '#9abca4',\n    '#a5a79a',\n    '#e6d9b9',\n    '#eabd00',\n    '#bf545e',\n    '#86b070',\n    '#665e51',\n    '#b59a4d',\n  ],\n  asian: [\n    '#946761',\n    '#b80040',\n    '#4eacb8',\n    '#7f1f69',\n    '#c8b568',\n    '#147472',\n    '#1d518b',\n    '#b1623b',\n    '#95a578',\n    '#b9b327',\n    '#af508a',\n    '#dab100',\n  ],\n};\n\nexport const chooseColorScheme = (key: string) => {\n  const cs =\n    key in PuppyColorScheme\n      ? PuppyColorScheme[key]\n      : PuppyColorScheme[\n          Common.choose([\n            'pop',\n            'cute',\n            'dynamic',\n            'gorgeous',\n            'casual',\n            'psychedelic',\n            'bright',\n            'fairytale',\n            'heavy',\n            'impact',\n            'street',\n            'cool',\n            'elegant',\n            'fresh',\n            'warm',\n            'soft',\n            'man',\n            'woman',\n            'boy',\n            'girl',\n            'smart',\n            'light',\n            'stylish',\n            'natural',\n            'spring',\n            'summer',\n            'fall',\n            'winter',\n            'japan',\n            'euro',\n            'nordic',\n            'asian',\n          ])\n        ];\n  const targets = <HTMLCollectionOf<HTMLElement>>(\n    document.getElementsByClassName('btn')\n  );\n  for (let i = 0; i < targets.length; i += 1) {\n    targets[i].style.backgroundColor = cs[i % cs.length];\n    targets[i].style.borderColor = cs[i % cs.length];\n  }\n  return cs;\n};\n","export class Lib {\n  private puppy: any;\n  private Body: any;\n  private Composite: any;\n  private Constraint: any;\n\n  public constructor(puppy: any, Matter: any) {\n    this.puppy = puppy;\n    this.Body = Matter['Body'];\n    this.Composite = Matter['Composite'];\n    this.Constraint = Matter['Constraint'];\n  }\n\n  /* python */\n\n  public int(x: any, radix?: number): number {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      const v = Number.parseInt(x, radix);\n      return Number.isNaN(v) ? 0 : v;\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public float(x: any): number {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      const v = Number.parseFloat(x);\n      return isNaN(v) ? 0.0 : v;\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public str(obj: any): string {\n    if (typeof obj === 'number' || typeof obj === 'string') {\n      return `${obj}`;\n    }\n    if (typeof obj === 'boolean') {\n      return obj ? 'True' : 'False';\n    }\n    if (Array.isArray(obj)) {\n      return '[' + obj.map(x => this.repr(x)).join(', ') + ']';\n    }\n    if (obj === undefined) {\n      return 'undefined';\n    }\n    if (obj.x && obj.y) {\n      return `(${obj.x}, ${obj.y})`;\n    }\n    if (obj.text) {\n      return obj.text;\n    }\n    return (\n      '{' +\n      Object.keys(obj)\n        .map(key => `${key}: ${this.repr(obj[key])}`)\n        .join(', ') +\n      '}'\n    );\n  }\n\n  public repr(obj: any): string {\n    if (typeof obj === 'string') {\n      if (obj.indexOf('\"') == -1) {\n        return `\"${obj}\"`;\n      }\n      return `'${obj}'`;\n    }\n    return this.str(obj);\n  }\n\n  /* operator */\n\n  public anyAdd(x: any, y: any) {\n    if (Array.isArray(x) && Array.isArray(y)) {\n      return x.concat(y);\n    }\n    return x + y;\n  }\n\n  public anyMul(x: any, y: any) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: any) {\n    return a.indexOf(x) >= 0;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public get(a: any, name: string, value?: any, ref?: any) {\n    const v = a[name];\n    if (v === undefined) {\n      return value;\n    }\n    return v;\n  }\n\n  public index(a: any, index: number, ref?: any) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number, ref?: any) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substring(x, y);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: any) {\n    if (typeof x === 'string' || Array.isArray(x.length)) {\n      return x.length;\n    }\n    return 0;\n  }\n\n  // public map(func: any, xs: number[]) {\n  //   return Array.from(xs, func); // funcがダメ\n  // }\n\n  /* vec */\n\n  public vec(x = 0, y = 0) {\n    return { x, y };\n  }\n\n  /* Matter.Body */\n\n  public setPosition(body: any, x: number, y: number) {\n    this.Body.setPosition(body, { x, y });\n  }\n\n  public translate(body: any, x: number, y: number) {\n    this.Body.translate(body, { x, y });\n  }\n\n  public applyForce(body: any, x: number, y: number, fx: number, fy: number) {\n    this.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: any, angle: number, _x?: number, _y?: number) {\n    this.Body.rotate(body, angle);\n  }\n\n  public scale(body: any, sx: number, sy: number, _x?: number, _y?: number) {\n    this.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: any, angle: number) {\n    this.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: any, x: number, y: number) {\n    this.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: any, velocity: number) {\n    this.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: any, density: number) {\n    this.Body.setDensity(body, density);\n  }\n\n  public setMass(body: any, mass: number) {\n    this.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: any, flag: boolean) {\n    this.Body.setStatic(body, flag);\n  }\n\n  public newComosite(options: {}) {\n    return this.Composite.create({ label: 'comosite' });\n  }\n\n  public addBody(parent: any, body: any) {\n    this.Composite.addBody(parent, body);\n  }\n\n  public addConstraint(parent: any, options: any) {\n    this.Composite.addConstraint(this.Constraint.create(options));\n  }\n}\n","import * as Matter from 'matter-js';\nimport { myRender } from './render';\nimport { initVars, Shape, PuppyConstructor } from './shape';\nimport {\n  getInputValue,\n  getDiffStartLineNumber,\n  setCodeHighlight,\n  resetCodeHighlight,\n  getIsLive,\n} from '../modules/operations';\nimport { chooseColorScheme } from './color';\nimport { Lib } from '../puppy-transpiler/puppy-lib';\nimport { Type } from '../puppy-transpiler/puppy';\n\n// const Bodies = Matter.Bodies;\nconst Engine = Matter.Engine;\nconst Runner = Matter.Runner;\nconst Render = myRender(Matter.Render);\nconst Constraint = Matter.Constraint;\nconst MouseConstraint = Matter.MouseConstraint;\nconst Mouse = Matter.Mouse;\nconst World = Matter.World;\nconst Bounds = Matter.Bounds;\nconst Vertices = Matter.Vertices;\nconst Detector = Matter['Detector'];\nconst Common = Matter['Common'];\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\n// export type ErrorShape = {\n//   type: 'error' | 'info' | 'warning' | 'hint';\n//   row: number;\n//   col: number;\n//   len: number;\n//   text: string;\n// };\n\nexport type ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n};\n\nexport type PuppySettings = {\n  canvas: string;\n  ftrace: (log: {}) => void;\n  eachUpdate?: (time: number) => void;\n};\n\ntype PuppyWorld = {\n  background: string;\n  width: number;\n  height: number;\n  viewWidth: number;\n  viewHeight: number;\n  view: { min: Matter.Vector; max: Matter.Vector };\n  colorScheme: [string];\n\n  opacity: number /* Default 1.0 */;\n\n  font: string;\n  gravity: Matter.Vector;\n  density: number /* Default: 0.001 */;\n  friction: number /* Default: 0.1 */;\n  airFriction: number /* Default: 0.01 */;\n  frictionStatic: number /* Default: 0.5 */;\n  motion: number /* Default: 0 */;\n  restitution: number /* 0 */;\n};\n\n// (Puppy, {}) -> (number, number, number) -> any\nexport class Puppy {\n  private settings: PuppySettings;\n  public code: any;\n  public world: PuppyWorld | null;\n\n  public interval: number;\n  public waitRestart: boolean;\n  public isExecuting: boolean;\n\n  private runner: Matter.Runner | null;\n  private engine: Matter.Engine | null;\n  private render: Matter.Render | null;\n  private canvas: HTMLCanvasElement | null;\n\n  // private debug_mode: boolean;\n\n  private vars: {};\n  private lib: Lib;\n\n  // new puppy\n  public constructor(settings: PuppySettings, code: any, waitStart = false) {\n    this.settings = settings;\n    this.code = code;\n    this.world = null;\n    this.interval = 500;\n    this.waitRestart = waitStart;\n    this.isExecuting = false;\n    this.runner = null;\n    this.engine = null;\n    this.render = null;\n    this.canvas = null;\n    this.vars = {};\n    this.lib = new Lib(this, {\n      Body: Matter.Body,\n      Composite: Matter.Composite,\n      Constraint: Matter.Constraint,\n    });\n  }\n\n  private initCode() {\n    const code = this.code;\n    const width = code.world['width'] || 1000;\n    const height = code.world['height'] || 1000;\n    const vwidth = code.world['viewWidth'] || width;\n    const vheight = code.world['viewHeight'] || height;\n    const pos: Matter.Vector = code.world['position'] || { x: 0, y: 0 };\n    this.code = code;\n    this.world = {\n      width,\n      height,\n      viewWidth: vwidth,\n      viewHeight: vheight,\n      background: code.world['background'] || 'white',\n      gravity: code.world['gravitiy'] || { x: 0.0, y: 1.0 },\n      colorScheme: chooseColorScheme(code.world['colorScheme'] || ''),\n      opacity: code.world['opacity'] || 1.0,\n      font: code.world['font'] || \"bold 60px 'Arial'\",\n      view: code.world['view'] || {\n        min: pos,\n        max: { x: pos.x + vwidth, y: pos.y + vheight },\n      },\n      density: code.world['density'] || 0.001,\n      friction: code.world['friction'] || 0.1,\n      airFriction: code.world['airFriction'] || 0.01,\n      frictionStatic: code.world['frictionStatic'] || 0.5,\n      motion: code.world['motion'] || 0,\n      restitution: code.world['restitution'] || 0,\n    };\n  }\n\n  private startCode() {\n    this.engine = Engine.create();\n\n    if (this.world!.gravity) {\n      const engine = this.engine;\n      window.addEventListener('deviceorientation', event => {\n        const orientation = window.orientation || 0;\n        const gravity = engine.world.gravity;\n        if (orientation === 0) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.beta!, -90, 90) / 90;\n        } else if (orientation === 180) {\n          gravity.x = Common.clamp(event.gamma!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.beta!, -90, 90) / 90;\n        } else if (orientation === 90) {\n          gravity.x = Common.clamp(event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(-event.gamma!, -90, 90) / 90;\n        } else if (orientation === -90) {\n          gravity.x = Common.clamp(-event.beta!, -90, 90) / 90;\n          gravity.y = Common.clamp(event.gamma!, -90, 90) / 90;\n        }\n      });\n    }\n    Matter.Events.on(this.engine, 'beforeUpdate', () => {\n      const time = this.engine!.timing.timestamp;\n      if (this.settings.eachUpdate) {\n        this.settings.eachUpdate(time);\n      }\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        const body: Matter.Body = bodies[i];\n        if (body['move']) {\n          body['move'](body, time);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionActive', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionActive']) {\n          pair.bodyA['collisionActive'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionActive']) {\n          pair.bodyB['collisionActive'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionStart', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionStart']) {\n          pair.bodyA['collisionStart'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionStart']) {\n          pair.bodyB['collisionStart'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    Matter.Events.on(this.engine, 'collisionEnd', event => {\n      const pairs = event.pairs;\n      for (let i = 0; i < pairs.length; i += 1) {\n        const pair = pairs[i];\n        if (pair.bodyA['collisionEnd']) {\n          pair.bodyA['collisionEnd'](pair.bodyA, pair.bodyB);\n        }\n        if (pair.bodyB['collisionEnd']) {\n          pair.bodyB['collisionEnd'](pair.bodyB, pair.bodyA);\n        }\n      }\n    });\n    this.runner = Runner.create({ isFixed: false });\n    // render\n    const canvas = document.getElementById(this.settings.canvas);\n    let render_width = canvas!.clientWidth;\n    let render_height =\n      (canvas!.clientWidth * this.world!.height) / this.world!.width;\n    if (render_height > canvas!.clientHeight) {\n      render_height = canvas!.clientHeight;\n      render_width =\n        (canvas!.clientHeight * this.world!.width) / this.world!.height;\n    }\n    const render = {\n      /* Matter.js の変な仕様 canvas に 描画領域が追加される */\n      // element: document.getElementById('canvas'),\n      element: canvas,\n      engine: this.engine,\n      options: {\n        /* オブジェクトが枠線のみになる */\n        width: render_width,\n        height: render_height,\n        background: this.world!.background,\n        font: this.world!.font,\n        wireframes: false,\n      },\n    };\n    this.render = Render.create(render);\n    this.canvas = this.render!.canvas;\n    /* 描画サイズを自動拡大/縮小を設定する */\n    Render['lookAt'](this.render, this.world!.view);\n    /* マウス */\n    const mouse = Mouse.create(this.render!.canvas);\n    const constraintOptions = {\n      pointA: { x: 0, y: 0 },\n      pointB: { x: 0, y: 0 },\n      stiffness: this.world!['mouseStiffness'] || 0.2 /* 剛性 */,\n    };\n    constraintOptions['render'] = {\n      visible: false,\n    };\n    const mouseConstraint = MouseConstraint.create(this.engine, {\n      mouse,\n      constraint: Constraint.create(constraintOptions),\n    });\n    World.add(this.engine.world, mouseConstraint);\n    this.render!['mouse'] = mouse;\n\n    // an example of using mouse events on a mouse\n    // const mouse = Mouse.create(this.element);\n    // this.element.addEventListener('click', () => {\n    //   const query = Query.point(Composite.allBodies(world), mouse.position)\n    //   console.log(mouse.position);\n    //   console.log(query);\n    // });\n    Matter.Events.on(mouseConstraint, 'mousedown', event => {\n      const mouse = event.mouse;\n      let body = event.sourcebody;\n      const bodies = Matter.Composite.allBodies(this.engine!.world);\n      for (let i = 0; i < bodies.length; i += 1) {\n        body = bodies[i];\n        if (\n          Bounds.contains(body.bounds, mouse.position) &&\n          Detector.canCollide(\n            body.collisionFilter,\n            mouseConstraint.collisionFilter\n          )\n        ) {\n          for (\n            let j = body.parts.length > 1 ? 1 : 0;\n            j < body.parts.length;\n            j += 1\n          ) {\n            const part = body.parts[j];\n            if (\n              part['clicked'] &&\n              Vertices.contains(part.vertices, mouse.position)\n            ) {\n              part['clicked'](part);\n              break;\n            }\n          }\n        }\n      }\n    });\n    //\n    this.vars = initVars({});\n    // this.main = code.main || (function* (Matter: any, puppy: Puppy) { });\n\n    Runner.run(this.runner, this.engine); /*物理エンジンを動かす */\n    Render.run(this.render); /* 描画開始 */\n    // this.runner.enabled = false; /*初期位置を描画したら一度止める */\n  }\n\n  public dispose() {\n    if (this.engine) {\n      World.clear(this.engine.world, false);\n      Engine.clear(this.engine);\n    }\n    /* engineのアクティブ、非アクティブの制御を行う */\n    if (this.runner) {\n      Runner.stop(this.runner);\n    }\n    if (this.render) {\n      Render.stop(this.render);\n      this.render.canvas.remove();\n      // this.render!.canvas = null;\n      // this.render!.context = null;\n      this.render.textures = {};\n    }\n  }\n\n  // private DefaultRenderOptions: () => Matter.IRenderDefinition;\n\n  public getCode() {\n    return this.code;\n  }\n\n  public getCanvas() {\n    return this.canvas;\n  }\n\n  public resize(width: number, height: number) {\n    // console.log(`'resize width ${width} ${this.canvas.clientWidth} height ${height} ${this.canvas.clientHeight}`);\n    let w = width;\n    let h = (width * this.world!.viewHeight) / this.world!.viewWidth;\n    if (h > height) {\n      h = height;\n      w = (height * this.world!.viewWidth) / this.world!.viewHeight;\n    }\n    this.canvas!.setAttribute('width', w.toString());\n    this.canvas!.setAttribute('height', h.toString());\n    // console.log('resize width {this.render.options.width} => {w} height {this.render.options.height} => {h}');\n    this.render!.options.width = w;\n    this.render!.options.height = h;\n  }\n\n  public async wait(msec) {\n    await new Promise(resolve => setTimeout(resolve, msec));\n  }\n\n  public async waitForRun(interval) {\n    while (this.waitRestart) {\n      await this.wait(interval);\n    }\n    this.runner!.enabled = true;\n  }\n\n  public async execute_main() {\n    const diffStartLineNumber = getDiffStartLineNumber();\n    this.isExecuting = true;\n    for await (const lineNumber of this.code.main(this)) {\n      if (lineNumber < diffStartLineNumber && getIsLive()) {\n        for (let i = 0; i < this.interval / this.runner!.delta; i += 1) {\n          this.engine = Engine.update(this.engine!, undefined, undefined);\n        }\n      } else {\n        setCodeHighlight(lineNumber, lineNumber);\n        await this.waitForRun(1000);\n        await this.wait(this.interval);\n      }\n    }\n    this.isExecuting = false;\n    resetCodeHighlight();\n    // editor に依存するためNG\n    // let prevline = 0;\n    // const lines: [string] = editor.getSession().getDocument().getAllLines();\n    // for await (const linenum of this.main(Matter, this)) {\n    //   if (prevline == 0 || prevline >= linenum || lines[prevline] == '') {\n    //     selectLine(linenum - 1, linenum);\n    //   }\n    //   else {\n    //     selectLine(prevline, linenum);\n    //   }\n    //   prevline = linenum;\n    //   if (this.isStep) {\n    //     this.runner.enabled = false;\n    //     this.isStep = false;\n    //   } else {\n    //     await this.wait(0.5);\n    //   }\n    //   await this.waitForRun(1);\n    // }\n    // removeLine();\n    // if (this.isStep) {\n    //   this.runner.enabled = true;\n    //   this.isStep = false;\n    // }\n  }\n\n  public isRunning() {\n    return this.runner && this.runner.enabled;\n  }\n\n  public runCode() {\n    this.initCode();\n    this.dispose();\n    this.startCode();\n    this.runner!.enabled = !this.waitRestart;\n    this.execute_main();\n  }\n\n  // public updateLiveCode(code: PuppyCode) {\n  //   this.code = code;\n  //   if (this.runner!.enabled) {\n  //     if (code.diff) {\n  //       this.initCode();\n  //       console.log(`live diff now ${code.diff}`);\n  //       code.diff(this);\n  //       return true;\n  //     }\n  //     if (code.lives && code.lives.length > 0) {\n  //       this.initCode();\n  //       const bodies = Matter.Composite.allBodies(this.engine!.world);\n  //       for (const body of bodies) {\n  //         for (const live of code.lives) {\n  //           if (body['oid'] === live[0]) {\n  //             console.log(body);\n  //             console.log(live);\n  //             const name = live[1];\n  //             console.log(`change ${name} ${body[name]} ${live[2]} ${live[3]}`);\n  //             // if (body[name] === live[3] || live[3] == null) {\n  //             setShapeProperty(this, body as Shape, name, live[2]);\n  //             // }\n  //           }\n  //         }\n  //       }\n  //       return true;\n  //     }\n  //   }\n  //   return false;\n  // }\n\n  public pause() {\n    this.waitRestart = true;\n    this.runner!.enabled = false;\n  }\n\n  public start() {\n    if (this.isExecuting) {\n      this.waitRestart = false;\n    } else {\n      this.runner!.enabled = true;\n    }\n  }\n\n  public getTimeStamp() {\n    return this.engine!.timing.timestamp;\n  }\n\n  // lives\n\n  public ln(n: number) {\n    return this.code.lines[n];\n  }\n\n  // Puppy APIs\n\n  public new_ = (\n    cons: PuppyConstructor,\n    x: number,\n    y: number,\n    options: Shape\n  ) => {\n    if (!options.position) {\n      options.position = { x, y };\n    }\n    const body: Matter.Body = cons(this, options);\n    World.add(this.engine!.world, [body]);\n    return body;\n  };\n\n  public Circle = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Circle'], x, y, options);\n  };\n\n  public Rectangle = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Rectangle'], x, y, options);\n  };\n\n  public Polygon = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Polygon'], x, y, options);\n  };\n\n  public Label = (x: number, y: number, options = {}) => {\n    return this.new_(this.vars['Label'], x, y, options);\n  };\n\n  public World = (x: number, y: number, options: Partial<PuppyWorld>) => {\n    if (this.engine && this.world) {\n      this.world.viewWidth = x;\n      this.world.viewHeight = y;\n      const pos = this.world.view.min;\n      this.world.view = {\n        min: pos,\n        max: { x: pos.x + x, y: pos.y + y },\n      };\n      this.resize(this.render!.options.width!, this.render!.options.height!);\n      Render['lookAt'](this.render, this.world!.view);\n      if (options) {\n        Object.keys(options).map((key: string) => {\n          if (this.world && key in this.world) {\n            if (key == 'background') {\n              this.render!.options['background'] = options['background'];\n            }\n            this.world[key] = options[key];\n          }\n          if (this.engine && key in this.engine.world) {\n            this.engine.world[key] = options[key];\n          }\n        });\n      }\n    }\n  };\n\n  public async input(msg?: string) {\n    this.runner!.enabled = false;\n    const x = await getInputValue(msg ? msg : '');\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    console.log(`input ${x}`);\n    return x;\n  }\n\n  public async input0(console?: string) {\n    this.runner!.enabled = false;\n    const awaitForClick = target => {\n      return new Promise(resolve => {\n        // 処理A\n        const listener = resolve; // 処理B\n        target.addEventListener('click', listener, { once: true }); // 処理C\n      });\n    };\n    const text = document.getElementById('inputtext') as HTMLInputElement;\n    const f = async () => {\n      const target = document.querySelector('#submitInput');\n      let Text = '';\n      document.getElementById('submitInput')!.onclick = () => {\n        document.getElementById('myOverlay')!.style.display = 'none';\n        Text = text.value;\n        text.value = '';\n      };\n      await awaitForClick(target);\n      return Text;\n    };\n\n    text.placeholder = console ? console : 'Input here';\n    document.getElementById('myOverlay')!.style.display = 'block';\n    const x = await f();\n    this.runner!.enabled = true;\n    this.waitForRun(500);\n    return x;\n  }\n\n  public print(text: string, options = {}) {\n    const width = this.world!.width;\n    const _options: Shape = Common.extend(\n      {\n        shape: 'label',\n        value: `${text}`,\n        created: this.getTimeStamp(),\n        move: (body, time: number) => {\n          const px = width - 100 * (time - body['created']) * 0.003;\n          Matter.Body.setPosition(body, { x: px, y: body.position.y });\n          if (px < -1) {\n            World.remove(this.engine!.world, body);\n          }\n        },\n      },\n      options\n    );\n    const x = this.world!.width;\n    const y = this.world!.height * (Math.random() * 0.9 + 0.05);\n    this.new_(this.vars['Label'], x, y, _options);\n  }\n\n  public trace(log: {}) {\n    console.log(log);\n    // this.settings.trace(log);\n  }\n\n  /* operator */\n\n  public listAdd(x: [], y: []) {\n    return x.concat(y);\n  }\n\n  public anyMul(x, y) {\n    if (typeof x === 'string') {\n      let s = '';\n      for (let i = 0; i < y; i += 1) {\n        s += x;\n      }\n      return s;\n    }\n    if (Array.isArray(x)) {\n      let a: any[] = [];\n      for (let i = 0; i < y; i += 1) {\n        a = a.concat(x);\n      }\n      return a;\n    }\n    return x * y;\n  }\n\n  public anyIn(x: any, a: [any]) {\n    return a.indexOf(x) >= 0;\n  }\n\n  /* built-in */\n\n  public int(x: any) {\n    if (typeof x === 'number') {\n      return x | 0;\n    }\n    if (typeof x === 'string') {\n      return Number.parseInt(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1 : 0;\n    }\n    return x | 0;\n  }\n\n  public float(x: any) {\n    if (typeof x === 'number') {\n      return x;\n    }\n    if (typeof x === 'string') {\n      return Number.parseFloat(x);\n    }\n    if (typeof x === 'boolean') {\n      return x ? 1.0 : 0.0;\n    }\n    return x;\n  }\n\n  public str(x: any) {\n    if (typeof x === 'boolean') {\n      return x ? 'True' : 'False';\n    }\n    if (Array.isArray(x)) {\n      return '[' + x.map(x => this.str(x)).join(', ') + ']';\n    }\n    return `${x}`;\n  }\n\n  public range(x: number, y?: number, z?: number) {\n    let start = 0;\n    let end = 0;\n    let step = 1;\n    if (y === undefined) {\n      end = x;\n    } else if (z !== undefined) {\n      start = x;\n      end = y;\n      step = z === 0 ? 1 : z;\n    } else {\n      start = x;\n      end = y;\n    }\n    const xs: number[] = [];\n    if (start <= end) {\n      if (step < 0) {\n        step = -step;\n      }\n      for (let i = start; i < end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    } else {\n      if (step > 0) {\n        step = -step;\n      }\n      for (let i = start; i > end; i += step) {\n        xs.push(i);\n        if (xs.length > 100000) {\n          // safety break\n          break;\n        }\n      }\n    }\n    return xs;\n  }\n\n  /* string/array (method) */\n\n  public getindex(a: any, index: number) {\n    if (typeof a === 'string') {\n      return a.charAt((index + a.length) % a.length);\n    }\n    if (Array.isArray(a)) {\n      return a[(index + a.length) % a.length];\n    }\n    return undefined;\n  }\n\n  public slice(a: any, x: number, y?: number) {\n    if (typeof a === 'string') {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.substr(x, y - x);\n    }\n    if (Array.isArray(a)) {\n      if (y == undefined) {\n        y = a.length;\n      }\n      return a.slice(x, y);\n    }\n    return undefined;\n  }\n  public find(s: string, sub: string) {\n    return s.indexOf(sub);\n  }\n\n  public join(s: string, list: [string]) {\n    return list.join(s);\n  }\n  /* list */\n\n  public append(xs: any[], x: any) {\n    xs.push(x);\n  }\n\n  public len(x: []) {\n    return x.length;\n  }\n\n  public map(func: any, lst: number[]) {\n    return Array.from(lst, func); // funcがダメ\n  }\n\n  /* Matter.Body */\n\n  public setPosition(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setPosition(body, { x, y });\n  }\n\n  public applyForce(\n    body: Matter.Body,\n    x: number,\n    y: number,\n    fx: number,\n    fy: number\n  ) {\n    Matter.Body.applyForce(body, { x, y }, { x: fx, y: fy });\n  }\n\n  public rotate(body: Matter.Body, angle: number, _x?: number, _y?: number) {\n    Matter.Body.rotate(body, angle);\n  }\n\n  public scale(\n    body: Matter.Body,\n    sx: number,\n    sy: number,\n    _x?: number,\n    _y?: number\n  ) {\n    Matter.Body.scale(body, sx, sy);\n  }\n\n  public setAngle(body: Matter.Body, angle: number) {\n    Matter.Body.setAngle(body, angle);\n  }\n\n  public setVelocity(body: Matter.Body, x: number, y: number) {\n    Matter.Body.setVelocity(body, { x, y });\n  }\n\n  public setAngularVelocity(body: Matter.Body, velocity: number) {\n    Matter.Body.setAngularVelocity(body, velocity);\n  }\n\n  public setDensity(body: Matter.Body, density: number) {\n    Matter.Body.setDensity(body, density);\n  }\n\n  public setMass(body: Matter.Body, mass: number) {\n    Matter.Body.setMass(body, mass);\n  }\n\n  public setStatic(body: Matter.Body, flag: boolean) {\n    Matter.Body.setStatic(body, flag);\n  }\n}\n\n/* puppy controller */\n\nlet puppy_settings = {\n  canvas: 'puppy-screen',\n  ftrace: (_log: {}) => {},\n};\n\nexport const initPuppy = (settings?: PuppySettings) => {\n  if (settings) {\n    puppy_settings = settings;\n  }\n};\n\nexport const runPuppy = (\n  puppy: Puppy | null,\n  code: PuppyCode,\n  alwaysRun: boolean,\n  waitStart = false\n) => {\n  if (puppy != null) {\n    if (!alwaysRun && code) {\n      // if (puppy.getCode().hash === code.hash) {\n      //   return puppy;\n      // }\n      if (puppy.isRunning()) {\n        // console.log(`lives ${code.lives}`);\n        // console.log(`diff ${code.diff}`);\n        // if (puppy.updateLiveCode(code)) {\n        //   return puppy;\n        // }\n      }\n    }\n  }\n  if (code) {\n    if (puppy != null) {\n      puppy.dispose();\n    }\n    const newpuppy = new Puppy(puppy_settings, code, waitStart);\n    newpuppy.runCode();\n    return newpuppy;\n  }\n  return null;\n};\n","// 使えそうな効果\n// punkな吹き出し\n\n// https://ja.stackoverflow.com/questions/4445/matter-jsという物理エンジンライブラリのオブジェクトの結合について\n\nimport { PATH_PREFIX } from '../env';\n\nexport const myRender = render => {\n  const _getTexture = (render, imagePath: string) => {\n    let image = render.textures[imagePath];\n    if (image) {\n      return image;\n    }\n    image = render.textures[imagePath] = new Image();\n    if (\n      imagePath.startsWith('http://') ||\n      imagePath.startsWith('https://') ||\n      imagePath.startsWith('data:') ||\n      imagePath.startsWith('/')\n    ) {\n      image.src = imagePath;\n    } else {\n      image.src = `${PATH_PREFIX}/image/${imagePath}`;\n    }\n    return image;\n  };\n\n  render['bodies'] = function(render, bodies, context) {\n    const c = context;\n    const options = render.options;\n    // const wireframes = options.wireframes;\n    const showInternalEdges = options.showInternalEdges || !options.wireframes;\n    const defaultFont = options.font || \"bold 60px 'Arial'\";\n    const defaultFontColor = options.fontColor || 'gray';\n\n    for (let i = 0; i < bodies.length; i += 1) {\n      const body = bodies[i];\n      if (!body.visible) {\n        continue;\n      }\n      // handle compound parts\n      for (\n        let k = body.parts.length > 1 ? 1 : 0;\n        k < body.parts.length;\n        k += 1\n      ) {\n        const part = body.parts[k];\n        if (!part.visible) {\n          continue;\n        }\n        if (part.opacity !== 1) {\n          c.globalAlpha = part.opacity;\n        }\n\n        if (part.image) {\n          const texture = _getTexture(render, part.image);\n          c.translate(part.position.x, part.position.y);\n          c.rotate(part.angle);\n          c.drawImage(\n            texture,\n            part.width * -0.5,\n            part.height * -0.5,\n            part.width,\n            part.height\n          );\n          c.rotate(-part.angle);\n          c.translate(-part.position.x, -part.position.y);\n        } else {\n          // part polygon\n          if (part.circleRadius) {\n            c.beginPath();\n            c.arc(\n              part.position.x,\n              part.position.y,\n              part.circleRadius,\n              0,\n              2 * Math.PI\n            );\n          } else {\n            c.beginPath();\n            c.moveTo(part.vertices[0].x, part.vertices[0].y);\n            for (let j = 1; j < part.vertices.length; j += 1) {\n              if (!part.vertices[j - 1].isInternal || showInternalEdges) {\n                c.lineTo(part.vertices[j].x, part.vertices[j].y);\n              } else {\n                c.moveTo(part.vertices[j].x, part.vertices[j].y);\n              }\n              if (part.vertices[j].isInternal && !showInternalEdges) {\n                c.moveTo(\n                  part.vertices[(j + 1) % part.vertices.length].x,\n                  part.vertices[(j + 1) % part.vertices.length].y\n                );\n              }\n            }\n            c.lineTo(part.vertices[0].x, part.vertices[0].y);\n            c.closePath();\n          }\n          if (!options.wireframes) {\n            c.fillStyle = part.fillStyle;\n            if (part.lineWidth) {\n              c.lineWidth = part.lineWidth;\n              c.strokeStyle = part.strokeStyle;\n              c.stroke();\n            }\n            c.fill();\n          } else {\n            c.lineWidth = 1;\n            c.strokeStyle = '#bbb';\n            c.stroke();\n          }\n        }\n\n        if (part.value !== undefined) {\n          // Make to show null and 0.\n          if (part.ref) {\n            part.value = part.ref();\n          }\n          c.save();\n          c.font = part.font || defaultFont;\n          c.fillStyle = part.fontColor || defaultFontColor;\n          c.textAlign = part.textAlign || 'center';\n          if (part.shadowColor) {\n            c.shadowColor = part.shadowColor; // 赤色の影を付ける\n            c.shadowBlur = c.shadowBlur || 0; // ぼかしを０にする\n            c.shadowOffsetX = c.shadowOffsetX || 2; // 横に3pxずらす\n            c.shadowOffsetY = c.shadowOffsetY || 2; // 縦に1pxずらす\n          }\n          c.fillText(`${part.value}`, part.position.x, part.position.y + 10);\n          c.restore();\n        }\n        c.globalAlpha = 1;\n      }\n    }\n  };\n  return render;\n};\n","import { Action } from 'redux';\n\nenum VersionActionTypes {\n  SET_VERSION_SHOW = 'SET_VERSION_SHOW',\n}\n\ninterface SetShowAction extends Action {\n  type: VersionActionTypes.SET_VERSION_SHOW;\n  payload: {\n    show: boolean;\n  };\n}\n\nexport const setShow = (show: boolean): SetShowAction => ({\n  type: VersionActionTypes.SET_VERSION_SHOW,\n  payload: {\n    show,\n  },\n});\n\nexport type VersionActions = SetShowAction;\n\nexport type VersionState = {\n  show: boolean;\n};\n\nconst initialState: VersionState = {\n  show: false,\n};\n\nconst VersionReducer = (state = initialState, action: VersionActions) => {\n  switch (action.type) {\n    case VersionActionTypes.SET_VERSION_SHOW:\n      return { ...state, show: action.payload.show };\n    default:\n      return state;\n  }\n};\n\nexport default VersionReducer;\n","import { Action, createStore, combineReducers } from 'redux';\nimport editor, { EditorState, EditorActions } from './modules/editor';\nimport course, { CourseState, CourseActions } from './modules/course';\nimport puppy, { PuppyState, PuppyActions } from './modules/puppy';\nimport input, { InputState, InputActions } from './modules/input';\nimport version, { VersionState, VersionActions } from './modules/version';\n\nconst allReducers = combineReducers({\n  editor,\n  course,\n  puppy,\n  input,\n  version,\n});\n\nexport const store = createStore(allReducers);\n\nexport type ReduxState = {\n  editor: EditorState;\n  course: CourseState;\n  puppy: PuppyState;\n  input: InputState;\n  version: VersionState;\n};\n\nexport type ReduxActions =\n  | PuppyActions\n  | EditorActions\n  | CourseActions\n  | InputActions\n  | VersionActions\n  | Action;\n\nexport default store;\n","export class ParseTree {\n  public tag: string;\n  public urn: any;\n  public inputs: string;\n  public spos: number;\n  public epos: number;\n  public nodes: [string, ParseTree][];\n\n  public constructor(tag: string, spos: number, epos: number, child: any) {\n    this.tag = tag;\n    this.urn = child;\n    this.inputs = '';\n    this.spos = spos;\n    this.epos = epos;\n    this.nodes = ParseTree.empties;\n  }\n\n  static empties: [string, ParseTree][] = [];\n\n  protected setup(urn: string, inputs: string) {\n    if (this.urn !== null) {\n      const nodes: [string, ParseTree][] = [];\n      var entry: Merge = this.urn;\n      while (entry !== null) {\n        nodes.push([entry.edge, entry.child.setup(urn, inputs)]);\n        entry = entry.prev;\n      }\n      this.nodes = nodes.reverse();\n    }\n    this.urn = urn;\n    this.inputs = inputs;\n    var t: any = this;\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      t[i] = this.nodes[i][1];\n      if (this.nodes[i][0] !== '') {\n        t[this.nodes[i][0]] = this.nodes[i][1];\n      }\n    }\n    return this;\n  }\n\n  public is(tag: string) {\n    return this.tag === tag;\n  }\n\n  public isError() {\n    return this.tag === 'err';\n  }\n\n  public subs() {\n    const subs: ParseTree[] = [];\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      subs.push(this.nodes[i][1]);\n    }\n    return subs;\n  }\n\n  public size() {\n    return this.nodes.length;\n  }\n\n  public contains(edge: string) {\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      if (this.nodes[i][0] === edge) return true;\n    }\n    return false;\n  }\n\n  public get(index: any) {\n    return (this as any)[index];\n  }\n\n  public tokenize(index?: any, defstr?: string) {\n    if (index === undefined) {\n      return this.inputs.substring(this.spos, this.epos);\n    }\n    const child = (this as any)[index];\n    if (child === undefined) {\n      return defstr || '';\n    }\n    return child.tokenize();\n  }\n\n  private pos(pos: number) {\n    const s = this.inputs;\n    pos = Math.min(pos, s.length);\n    var row = 0;\n    var col = 0;\n    for (var i = 0; i <= pos; i += 1) {\n      if (s.charCodeAt(i) == 10) {\n        row += 1;\n        col = 0;\n      } else {\n        col += 1;\n      }\n    }\n    return [pos, row, col];\n  }\n\n  public begin() {\n    return this.pos(this.spos);\n  }\n\n  public end() {\n    return this.pos(this.spos);\n  }\n\n  public length() {\n    return this.epos - this.spos;\n  }\n\n  public toString() {\n    const sb: string[] = [];\n    this.strOut(sb);\n    return sb.join('');\n  }\n\n  protected strOut(sb: string[]) {\n    sb.push('[#');\n    sb.push(this.tag);\n    for (const node of this.nodes) {\n      sb.push(node[0] === '' ? ' ' : ` ${node[0]}=`);\n      node[1].strOut(sb);\n    }\n    if (this.nodes.length == 0) {\n      const s = this.inputs.substring(this.spos, this.epos);\n      sb.push(\" '\");\n      sb.push(s);\n      sb.push(\"'\");\n    }\n    sb.push(']');\n  }\n}\n\nclass Merge {\n  public prev: any;\n  public edge: string;\n  public child: ParseTree;\n\n  public constructor(prev: any, edge: string, child: ParseTree) {\n    this.prev = prev;\n    this.edge = edge;\n    this.child = child;\n  }\n}\n\nclass ParserContext {\n  public urn: string;\n  public inputs: String;\n  public pos: number;\n  public epos: number;\n  public head_pos: number;\n  public ast: any;\n  public state: State | null;\n  public memos: Memo[];\n  public constructor(urn: string, inputs: string, pos: number, epos: number) {\n    this.urn = urn;\n    this.inputs = inputs;\n    this.pos = pos;\n    this.epos = epos;\n    this.head_pos = pos;\n    this.ast = null;\n    this.state = null;\n    this.memos = [];\n    for (var i = 0; i < 1789; i++) {\n      this.memos.push(new Memo());\n    }\n  }\n}\n\nconst EMPTY = (px: ParserContext) => {\n  return true;\n};\n\nconst pEmpty = () => {\n  return EMPTY;\n};\n\nconst ANY = (px: ParserContext) => {\n  if (px.pos < px.epos) {\n    px.pos += 1;\n    return true;\n  }\n  return false;\n};\n\nconst pAny = () => {\n  return ANY;\n};\n\nconst pChar = (text: string) => {\n  const text_length = text.length;\n\n  return (px: ParserContext) => {\n    if (px.inputs.startsWith(text, px.pos)) {\n      px.pos += text_length;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst find_codemax = (chars: string, ranges: string[]) => {\n  var code = 0;\n  for (var i = 0; i < chars.length; i += 1) {\n    code = Math.max(chars.charCodeAt(i), code);\n  }\n  for (const range of ranges) {\n    code = Math.max(range.charCodeAt(0), code);\n    code = Math.max(range.charCodeAt(1), code);\n  }\n  return code;\n};\n\nconst set_bitmap = (bitmap: Uint8Array, c: number) => {\n  const n = (c / 8) | 0;\n  const mask = 1 << (c % 8 | 0);\n  //console.log(n);\n  //console.log(bitmap[n])\n  bitmap[n] |= mask;\n  //console.log(bitmap);\n};\n\nconst pRange = (chars: string, ranges: string[]) => {\n  const codemax = find_codemax(chars, ranges) + 1;\n  const bitmap = new Uint8Array(((codemax / 8) | 0) + 1);\n  bitmap[0] = 2;\n  for (var i = 0; i < chars.length; i += 1) {\n    set_bitmap(bitmap, chars.charCodeAt(i));\n  }\n  for (const range of ranges) {\n    for (var c = range.charCodeAt(0); c <= range.charCodeAt(1); c += 1) {\n      set_bitmap(bitmap, c);\n    }\n  }\n  //console.log(`bitmap ${ bitmap.length } `)\n  return (px: ParserContext) => {\n    if (px.pos < px.epos) {\n      const c = px.inputs.charCodeAt(px.pos);\n      const n = (c / 8) | 0;\n      const mask = 1 << (c % 8 | 0);\n      if (n < bitmap.length && (bitmap[n] & mask) === mask) {\n        px.pos += 1;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pMany = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    var pos = px.pos;\n    var ast = px.ast;\n    while (match(px) && px.pos > pos) {\n      pos = px.pos;\n      ast = px.ast;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return true;\n  };\n};\n\nconst pMany1 = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    if (match(px)) {\n      var pos = px.pos;\n      var ast = px.ast;\n      while (match(px) && px.pos > pos) {\n        pos = px.pos;\n        ast = px.ast;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAnd = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pNot = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n      return false;\n    }\n    return true;\n  };\n};\n\nconst pOption = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (!match(px)) {\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return true;\n  };\n};\n\nconst pSeq = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    for (const match of matches) {\n      if (!match(px)) {\n        return false;\n      }\n    }\n    return true;\n  };\n};\n\nconst pSeq2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px);\n  };\n};\n\nconst pSeq3 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean,\n  match3: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    return match(px) && match2(px) && match3(px);\n  };\n};\n\nconst pOre = (...matches: ((px: ParserContext) => boolean)[]) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    for (const match of matches) {\n      if (match(px)) {\n        return true;\n      }\n      px.head_pos = Math.max(px.pos, px.head_pos);\n      px.pos = pos;\n      px.ast = ast;\n    }\n    return false;\n  };\n};\n\nconst pOre2 = (\n  match: (px: ParserContext) => boolean,\n  match2: (px: ParserContext) => boolean\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    const ast = px.ast;\n    if (match(px)) {\n      return true;\n    }\n    px.head_pos = Math.max(px.pos, px.head_pos);\n    px.pos = pos;\n    px.ast = ast;\n    return match2(px);\n  };\n};\n\nconst pRef = (peg: any, name: string) => {\n  if (peg[name]) {\n    return peg[name];\n  }\n  return (px: ParserContext) => {\n    return peg[name](px);\n  };\n};\n\nclass Memo {\n  public key: number;\n  public constructor() {\n    this.key = -1;\n  }\n}\n\nconst pNode = (\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = null;\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\n//def Merge(prev, edge, child):\n//return (prev, edge, child)\n\nconst pEdge = (edge: string, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = new Merge(ast, edge, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pFold = (\n  edge: string,\n  match: (px: ParserContext) => boolean,\n  tag: string,\n  shift: number\n) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    px.ast = new Merge(null, edge, px.ast);\n    if (match(px)) {\n      px.ast = new ParseTree(tag, pos + shift, px.pos, px.ast);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pAbs = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const ast = px.ast;\n    if (match(px)) {\n      px.ast = ast;\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pSkipErr = () => {\n  return (px: ParserContext) => {\n    px.pos = Math.min(px.head_pos, px.epos);\n    return true;\n  };\n};\n\nclass State {\n  public sid: number;\n  public value: any;\n  public prev: State | null;\n  public constructor(sid: number, value: any, prev: State | null) {\n    this.sid = sid;\n    this.value = value;\n    this.prev = prev;\n  }\n}\n\nconst getstate = (state: State | null, sid: number) => {\n  while (state !== null) {\n    if (state.sid === sid) {\n      return state;\n    }\n    state = state.prev;\n  }\n  return null;\n};\n\nconst pSymbol = (sid: number, match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const pos = px.pos;\n    if (match(px)) {\n      px.state = new State(sid, px.inputs.substring(pos, px.pos), px.state);\n      return true;\n    }\n    return false;\n  };\n};\n\nconst pExists = (sid: number) => {\n  return (px: ParserContext) => {\n    return getstate(px.state, sid) !== null;\n  };\n};\n\nconst pMatch = (sid: number) => {\n  return (px: ParserContext) => {\n    const state = getstate(px.state, sid);\n    if (state !== null) {\n      if (px.inputs.startsWith(state.value, px.pos)) {\n        px.pos += (state.value as string).length;\n        return true;\n      }\n    }\n    return false;\n  };\n};\n\nconst pScope = (match: (px: ParserContext) => boolean) => {\n  return (px: ParserContext) => {\n    const state = px.state;\n    const res = match(px);\n    px.state = state;\n    return res;\n  };\n};\n\nexport const generate = (start: string) => {\n  const match = grammar(start);\n  if (match === undefined) {\n    console.log(`undefined ${start}`);\n    console.log(peg);\n  }\n  return (inputs: string, options?: any) => {\n    const op = options === undefined ? {} : options;\n    const pos = 0;\n    const px = new ParserContext(\n      op['urn'] || '(unknown source)',\n      inputs,\n      0,\n      inputs.length\n    );\n    if (match(px)) {\n      if (px.ast === null) {\n        px.ast = new ParseTree('', pos, px.pos, null);\n      }\n    } else {\n      px.ast = new ParseTree('err', px.head_pos, px.head_pos + 1, null);\n    }\n    return px.ast.setup(px.urn, inputs);\n  };\n};\n\nlet peg: any = null;\n\nconst grammar = (start: string) => {\n  if (peg === null) {\n    peg = {};\n    peg['Source'] = pSeq3(\n      pOption(pRef(peg, 'EOL')),\n      pNode(\n        pMany(\n          pSeq(\n            pEdge('', pRef(peg, 'Statement')),\n            pMany(pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))),\n            pOption(pRef(peg, '\";\"')),\n            pRef(peg, 'EOL')\n          )\n        ),\n        'Source',\n        0\n      ),\n      pRef(peg, 'EOF')\n    );\n    peg['Block'] = pNode(\n      pScope(\n        pSeq3(\n          pSymbol(0, pRef(peg, 'INDENT')),\n          pOre2(\n            pSeq3(\n              pEdge('', pRef(peg, 'Statement')),\n              pMany(pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))),\n              pOption(pRef(peg, '\";\"'))\n            ),\n            pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n          ),\n          pMany(\n            pSeq2(\n              pMatch(0),\n              pOre2(\n                pSeq3(\n                  pEdge('', pRef(peg, 'Statement')),\n                  pMany(\n                    pSeq2(pRef(peg, '\";\"'), pEdge('', pRef(peg, 'Statement')))\n                  ),\n                  pOption(pRef(peg, '\";\"'))\n                ),\n                pSeq2(pRef(peg, '_'), pAnd(pRef(peg, 'EOL')))\n              )\n            )\n          )\n        )\n      ),\n      'Block',\n      0\n    );\n    peg['Statement'] = pOre(\n      pRef(peg, 'ClassDecl'),\n      pRef(peg, 'ImportDecl'),\n      pRef(peg, 'FuncDecl'),\n      pRef(peg, 'IfStmt'),\n      pRef(peg, 'ForStmt'),\n      pRef(peg, 'WhileStmt'),\n      pRef(peg, 'Return'),\n      pRef(peg, 'Yield'),\n      pRef(peg, 'Break'),\n      pRef(peg, 'Continue'),\n      pRef(peg, 'VarDecl'),\n      pRef(peg, 'Expression')\n    );\n    peg['ImportDecl'] = pOre2(\n      pNode(\n        pSeq3(\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pOption(\n            pSeq2(\n              pSeq2(pChar('as'), pRef(peg, 'S')),\n              pEdge('alias', pRef(peg, 'Name'))\n            )\n          )\n        ),\n        'ImportDecl',\n        0\n      ),\n      pNode(\n        pSeq(\n          pSeq2(pChar('from'), pRef(peg, 'S')),\n          pEdge('name', pRef(peg, 'Name')),\n          pSeq2(pChar('import'), pRef(peg, 'S')),\n          pEdge(\n            'names',\n            pOre2(\n              pNode(\n                pSeq2(\n                  pEdge('', pRef(peg, 'Name')),\n                  pMany(\n                    pSeq3(\n                      pChar(','),\n                      pRef(peg, '_'),\n                      pEdge('', pRef(peg, 'Name'))\n                    )\n                  )\n                ),\n                '',\n                0\n              ),\n              pNode(pSeq2(pChar('*'), pRef(peg, '_')), '', 0)\n            )\n          )\n        ),\n        'FromDecl',\n        0\n      )\n    );\n    peg['ClassDecl'] = pNode(\n      pSeq(\n        pChar('class'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq(\n            pChar('('),\n            pRef(peg, '_'),\n            pEdge('extends', pRef(peg, 'Name')),\n            pChar(')'),\n            pRef(peg, '_')\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pOre2(pEdge('', pRef(peg, 'Block')), pEdge('', pRef(peg, 'Statement')))\n      ),\n      'ClassDecl',\n      0\n    );\n    peg['FuncDecl'] = pNode(\n      pSeq(\n        pChar('def'),\n        pRef(peg, 'S'),\n        pRef(peg, '_'),\n        pEdge('name', pRef(peg, 'Name')),\n        pEdge('params', pRef(peg, 'FuncParams')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncDecl',\n      0\n    );\n    peg['FuncParams'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pOption(pEdge('', pRef(peg, 'FuncParam'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'FuncParam')))),\n        pRef(peg, '\")\"')\n      ),\n      'FuncParam',\n      0\n    );\n    peg['FuncParam'] = pNode(\n      pSeq2(\n        pEdge('name', pRef(peg, 'Name')),\n        pOption(\n          pSeq3(pChar(':'), pRef(peg, '_'), pEdge('type', pRef(peg, 'Name')))\n        )\n      ),\n      'Param',\n      0\n    );\n    peg['Lambda'] = pNode(\n      pSeq(\n        pChar('lambda'),\n        pOption(\n          pSeq3(\n            pRef(peg, 'S'),\n            pRef(peg, '_'),\n            pEdge('params', pRef(peg, 'LambdaParams'))\n          )\n        ),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'FuncExpr',\n      0\n    );\n    peg['LambdaParams'] = pNode(\n      pSeq2(\n        pOption(pEdge('', pRef(peg, 'Name'))),\n        pMany(pSeq2(pRef(peg, '\",\"'), pEdge('', pRef(peg, 'Name'))))\n      ),\n      'Param',\n      0\n    );\n    peg['Return'] = pNode(\n      pSeq2(\n        pChar('return'),\n        pOption(\n          pSeq3(\n            pNot(pRef(peg, 'W')),\n            pRef(peg, '_'),\n            pEdge('expr', pRef(peg, 'Expression'))\n          )\n        )\n      ),\n      'Return',\n      0\n    );\n    peg['Yield'] = pNode(pSeq2(pChar('yield'), pRef(peg, '_')), 'Yield', 0);\n    peg['Pass'] = pNode(pSeq2(pChar('pass'), pRef(peg, '_')), 'Pass', 0);\n    peg['Break'] = pNode(pSeq2(pChar('break'), pRef(peg, '_')), 'Break', 0);\n    peg['Continue'] = pNode(\n      pSeq2(pChar('continue'), pRef(peg, '_')),\n      'Continue',\n      0\n    );\n    peg['IfStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('if'), pNot(pRef(peg, 'W'))),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement'))),\n        pOption(pEdge('elif', pRef(peg, 'ElifBlock'))),\n        pOption(\n          pSeq(\n            pOre2(pMatch(0), pRef(peg, 'NL')),\n            pChar('else'),\n            pNot(pRef(peg, 'W')),\n            pRef(peg, '_'),\n            pChar(':'),\n            pRef(peg, '_'),\n            pEdge('else', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n          )\n        )\n      ),\n      'IfStmt',\n      0\n    );\n    peg['ElifBlock'] = pNode(pMany1(pEdge('', pRef(peg, 'ElifStmt'))), '', 0);\n    peg['ElifStmt'] = pNode(\n      pSeq(\n        pOre2(pMatch(0), pRef(peg, 'NL')),\n        pSeq2(pChar('elif'), pNot(pRef(peg, 'W'))),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('then', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ElifStmt',\n      0\n    );\n    peg['ForStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('for'), pNot(pRef(peg, 'W'))),\n        pRef(peg, '_'),\n        pEdge('each', pRef(peg, 'Name')),\n        pSeq2(pChar('in'), pNot(pRef(peg, 'W'))),\n        pRef(peg, '_'),\n        pEdge('list', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'ForStmt',\n      0\n    );\n    peg['WhileStmt'] = pNode(\n      pSeq(\n        pSeq2(pChar('while'), pNot(pRef(peg, 'W'))),\n        pRef(peg, '_'),\n        pEdge('cond', pRef(peg, 'Expression')),\n        pChar(':'),\n        pRef(peg, '_'),\n        pEdge('body', pOre2(pRef(peg, 'Block'), pRef(peg, 'Statement')))\n      ),\n      'WhileStmt',\n      0\n    );\n    peg['VarDecl'] = pOre2(\n      pNode(\n        pSeq(\n          pEdge('left', pRef(peg, 'LeftHand')),\n          pChar('='),\n          pRef(peg, '_'),\n          pEdge('right', pRef(peg, 'Expression'))\n        ),\n        'VarDecl',\n        0\n      ),\n      pRef(peg, 'SelfAssign')\n    );\n    peg['LeftHand'] = pSeq2(\n      pRef(peg, 'Name'),\n      pMany(\n        pOre2(\n          pFold(\n            'recv',\n            pSeq3(pChar('.'), pRef(peg, '_'), pEdge('name', pRef(peg, 'Name'))),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['SelfAssign'] = pNode(\n      pSeq3(\n        pEdge('left', pRef(peg, 'LeftHand')),\n        pEdge('name', pRef(peg, 'SelfAssignOp')),\n        pEdge('right', pRef(peg, 'Expression'))\n      ),\n      'SelfAssign',\n      0\n    );\n    peg['SelfAssignOp'] = pSeq2(\n      pNode(\n        pSeq2(\n          pOre(\n            pChar('<<'),\n            pChar('>>'),\n            pChar('**'),\n            pChar('//'),\n            pRange('+=*@/%&|^', [])\n          ),\n          pChar('=')\n        ),\n        '',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['Expression'] = pSeq2(\n      pRef(peg, 'Operator'),\n      pOption(\n        pFold(\n          'then',\n          pSeq(\n            pChar('if'),\n            pNot(pRef(peg, 'W')),\n            pRef(peg, '_'),\n            pEdge('cond', pRef(peg, 'Expression')),\n            pChar('else'),\n            pNot(pRef(peg, 'W')),\n            pRef(peg, '_'),\n            pEdge('else', pRef(peg, 'Expression'))\n          ),\n          'IfExpr',\n          0\n        )\n      )\n    );\n    peg['Operator'] = pSeq2(\n      pRef(peg, 'AndExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'OR'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'AndExpr'))\n          ),\n          'Or',\n          0\n        )\n      )\n    );\n    peg['OR'] = pOre2(pSeq2(pChar('or'), pNot(pRef(peg, 'W'))), pChar('||'));\n    peg['AndExpr'] = pSeq2(\n      pRef(peg, 'NotExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pRef(peg, 'AND'),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'NotExpr'))\n          ),\n          'And',\n          0\n        )\n      )\n    );\n    peg['AND'] = pOre2(pSeq2(pChar('and'), pNot(pRef(peg, 'W'))), pChar('&&'));\n    peg['NotExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pRef(peg, 'NOT'),\n          pRef(peg, '_'),\n          pEdge('', pRef(peg, 'NotExpr'))\n        ),\n        'Not',\n        0\n      ),\n      pRef(peg, 'EqExpr')\n    );\n    peg['NOT'] = pOre2(\n      pSeq3(pChar('not'), pNot(pRef(peg, 'W')), pRef(peg, '_')),\n      pChar('!')\n    );\n    peg['EqExpr'] = pSeq2(\n      pRef(peg, 'SumExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'EQ'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'SumExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['EQ'] = pOre(\n      pSeq2(pChar('=='), pNot(pChar('='))),\n      pSeq2(pChar('!='), pNot(pChar('='))),\n      pSeq2(pChar('<='), pNot(pChar('='))),\n      pSeq2(pChar('>='), pNot(pChar('='))),\n      pSeq2(pChar('<'), pNot(pChar('<'))),\n      pSeq2(pChar('>'), pNot(pChar('>'))),\n      pSeq2(pChar('in'), pRef(peg, 'S')),\n      pSeq2(pChar('is'), pRef(peg, 'S')),\n      pSeq2(pChar('is not'), pRef(peg, 'S'))\n    );\n    peg['SumExpr'] = pSeq2(\n      pRef(peg, 'ProdExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'SUM'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'ProdExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['SUM'] = pRange('+-|＋ー', []);\n    peg['ProdExpr'] = pSeq2(\n      pRef(peg, 'PowExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pRef(peg, 'PROD'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'PowExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['PROD'] = pOre(\n      pChar('//'),\n      pChar('<<'),\n      pChar('>>'),\n      pRange('*/%^&×÷', [])\n    );\n    peg['PowExpr'] = pSeq2(\n      pRef(peg, 'UnaryExpr'),\n      pMany(\n        pFold(\n          'left',\n          pSeq3(\n            pEdge('name', pNode(pChar('**'), 'Name', 0)),\n            pRef(peg, '_'),\n            pEdge('right', pRef(peg, 'UnaryExpr'))\n          ),\n          'Infix',\n          0\n        )\n      )\n    );\n    peg['UnaryExpr'] = pOre2(\n      pNode(\n        pSeq3(\n          pEdge('name', pNode(pRef(peg, 'PRE'), 'Name', 0)),\n          pRef(peg, '_'),\n          pEdge('expr', pRef(peg, 'UnaryExpr'))\n        ),\n        'Unary',\n        0\n      ),\n      pRef(peg, 'SuffixExpr')\n    );\n    peg['PRE'] = pRange('+-~', []);\n    peg['SuffixExpr'] = pSeq2(\n      pRef(peg, 'Primary'),\n      pMany(\n        pOre(\n          pFold(\n            'recv',\n            pSeq(\n              pChar('.'),\n              pRef(peg, '_'),\n              pEdge('name', pRef(peg, 'Name')),\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'MethodExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(pChar('.'), pRef(peg, '_'), pEdge('name', pRef(peg, 'Name'))),\n            'GetExpr',\n            0\n          ),\n          pFold(\n            'name',\n            pSeq(\n              pRef(peg, '\"(\"'),\n              pEdge('params', pRef(peg, 'Arguments')),\n              pRef(peg, '__'),\n              pRef(peg, '\")\"')\n            ),\n            'ApplyExpr',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq(\n              pRef(peg, '\"[\"'),\n              pOption(pEdge('left', pRef(peg, 'Expression'))),\n              pChar(':'),\n              pRef(peg, '_'),\n              pOption(pEdge('right', pRef(peg, 'Expression'))),\n              pRef(peg, '\"]\"')\n            ),\n            'Slice',\n            0\n          ),\n          pFold(\n            'recv',\n            pSeq3(\n              pRef(peg, '\"[\"'),\n              pEdge('index', pRef(peg, 'Expression')),\n              pRef(peg, '\"]\"')\n            ),\n            'IndexExpr',\n            0\n          )\n        )\n      )\n    );\n    peg['Arguments'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pEdge('', pRef(peg, 'Expression')), pNot(pChar('=')))),\n        pMany(\n          pSeq(\n            pChar(','),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'Expression')),\n            pNot(pChar('='))\n          )\n        ),\n        pOption(pEdge('', pRef(peg, 'KeywordArgument')))\n      ),\n      'Arguments',\n      0\n    );\n    peg['KeywordArgument'] = pNode(\n      pSeq3(\n        pOption(pSeq2(pChar(','), pRef(peg, '__'))),\n        pEdge('', pRef(peg, 'Argument')),\n        pMany(\n          pSeq3(pChar(','), pRef(peg, '__'), pEdge('', pRef(peg, 'Argument')))\n        )\n      ),\n      'Data',\n      0\n    );\n    peg['Argument'] = pNode(\n      pSeq(\n        pEdge('name', pRef(peg, 'Name')),\n        pChar('='),\n        pRef(peg, '_'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Primary'] = pOre(\n      pRef(peg, 'GroupExpr'),\n      pRef(peg, 'ListExpr'),\n      pRef(peg, 'DataExpr'),\n      pRef(peg, 'Lambda'),\n      pRef(peg, 'Constant'),\n      pRef(peg, 'Name')\n    );\n    peg['GroupExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"(\"'),\n        pEdge('', pRef(peg, 'Expression')),\n        pMany(\n          pSeq3(\n            pRef(peg, '\",\"'),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'Expression'))\n          )\n        ),\n        pRef(peg, '__'),\n        pRef(peg, '\")\"')\n      ),\n      'Tuple',\n      0\n    );\n    peg['ListExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"[\"'),\n        pOption(\n          pSeq2(\n            pEdge('', pRef(peg, 'Expression')),\n            pMany(\n              pSeq3(\n                pRef(peg, '\",\"'),\n                pRef(peg, '__'),\n                pEdge('', pRef(peg, 'Expression'))\n              )\n            )\n          )\n        ),\n        pOption(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"]\"')\n      ),\n      'List',\n      0\n    );\n    peg['DataExpr'] = pNode(\n      pSeq(\n        pRef(peg, '\"{\"'),\n        pEdge('', pRef(peg, 'KeyValue')),\n        pMany(\n          pSeq3(\n            pRef(peg, '\",\"'),\n            pRef(peg, '__'),\n            pEdge('', pRef(peg, 'KeyValue'))\n          )\n        ),\n        pOption(pRef(peg, '\",\"')),\n        pRef(peg, '__'),\n        pRef(peg, '\"}\"')\n      ),\n      'Data',\n      0\n    );\n    peg['KeyValue'] = pNode(\n      pSeq3(\n        pEdge(\n          'name',\n          pOre(\n            pRef(peg, 'Name'),\n            pRef(peg, 'StringExpr'),\n            pRef(peg, 'CharExpr')\n          )\n        ),\n        pRef(peg, '\":\"'),\n        pEdge('value', pRef(peg, 'Expression'))\n      ),\n      'KeyValue',\n      0\n    );\n    peg['Name'] = pOre2(pRef(peg, 'Identifier'), pRef(peg, 'NLPSymbol'));\n    peg['Identifier'] = pSeq2(\n      pNode(pSeq2(pRange('', ['AZ', 'az']), pMany(pRef(peg, 'W'))), 'Name', 0),\n      pRef(peg, '_')\n    );\n    peg['NLPSymbol'] = pSeq2(\n      pNode(\n        pMany1(pOre(pRef(peg, 'HIRA'), pRef(peg, 'KATA'), pRef(peg, 'KANJI'))),\n        'NLPSymbol',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['W'] = pRange('_', ['AZ', 'az', '09']);\n    peg['Constant'] = pOre(\n      pRef(peg, 'FormatString'),\n      pRef(peg, 'LongString'),\n      pRef(peg, 'StringExpr'),\n      pRef(peg, 'CharExpr'),\n      pRef(peg, 'Number'),\n      pRef(peg, 'TrueExpr'),\n      pRef(peg, 'FalseExpr'),\n      pRef(peg, 'NullExpr')\n    );\n    peg['FormatString'] = pSeq3(\n      pRange('Ff', []),\n      pOre(\n        pSeq3(\n          pChar(\"'''\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3'))), 'Format', 0),\n          pChar(\"'''\")\n        ),\n        pSeq3(\n          pChar(\"'\"),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1'))), 'Format', 0),\n          pChar(\"'\")\n        ),\n        pSeq3(\n          pChar('\"\"\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent3D'))), 'Format', 0),\n          pChar('\"\"\"')\n        ),\n        pSeq3(\n          pChar('\"'),\n          pNode(pMany(pEdge('', pRef(peg, 'FormatContent1D'))), 'Format', 0),\n          pChar('\"')\n        )\n      ),\n      pRef(peg, '_')\n    );\n    peg['FormatContent3'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'''\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar(\"'\")), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent3D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"\"\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['FormatContent1D'] = pOre2(\n      pSeq3(pChar('{'), pRef(peg, 'Expression'), pChar('}')),\n      pNode(\n        pMany(pSeq3(pNot(pChar('\"')), pNot(pChar('{')), pAny())),\n        'StringPart',\n        0\n      )\n    );\n    peg['LongString'] = pOre2(\n      pSeq(\n        pChar(\"''\"),\n        pNode(\n          pSeq3(\n            pChar(\"'\"),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange(\"\\\\'\", [])), pAny()),\n                pSeq2(pNot(pChar(\"'''\")), pChar(\"'\"))\n              )\n            ),\n            pChar(\"'\")\n          ),\n          'MultiString',\n          0\n        ),\n        pChar(\"''\"),\n        pRef(peg, '_')\n      ),\n      pSeq(\n        pChar('\"\"'),\n        pNode(\n          pSeq3(\n            pChar('\"'),\n            pMany(\n              pOre(\n                pRef(peg, 'ESCAPE'),\n                pSeq2(pNot(pRange('\\\\\"', [])), pAny()),\n                pSeq2(pNot(pChar('\"\"\"')), pChar('\"'))\n              )\n            ),\n            pChar('\"')\n          ),\n          'MultiString',\n          0\n        ),\n        pChar('\"\"'),\n        pRef(peg, '_')\n      )\n    );\n    peg['StringExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar('\"'), pMany(pRef(peg, 'STRING_CONTENT')), pChar('\"')),\n        'String',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['CharExpr'] = pSeq2(\n      pNode(\n        pSeq3(pChar(\"'\"), pMany(pRef(peg, 'CHAR_CONTENT')), pChar(\"'\")),\n        'Char',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['STRING_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange('\"\\n\\\\', [])), pAny())\n    );\n    peg['CHAR_CONTENT'] = pOre2(\n      pRef(peg, 'ESCAPE'),\n      pSeq2(pNot(pRange(\"'\\n\\\\\", [])), pAny())\n    );\n    peg['ESCAPE'] = pOre(\n      pSeq2(pChar('\\\\'), pRange('\\'\"\\\\bfnrt', [])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('', ['03']),\n        pRange('', ['07']),\n        pRange('', ['07'])\n      ),\n      pSeq3(pChar('\\\\'), pRange('', ['07']), pRange('', ['07'])),\n      pSeq2(pChar('\\\\'), pRange('', ['07'])),\n      pSeq(\n        pChar('\\\\'),\n        pRange('uU', []),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX'),\n        pRef(peg, 'HEX')\n      )\n    );\n    peg['IntExpr'] = pSeq2(\n      pNode(\n        pOre(\n          pRef(peg, 'DECIMAL'),\n          pRef(peg, 'HEXADECIMAL'),\n          pRef(peg, 'BINARY'),\n          pRef(peg, 'OCTAL')\n        ),\n        'Int',\n        0\n      ),\n      pRef(peg, '_')\n    );\n    peg['DECIMAL'] = pOre2(\n      pSeq2(pChar('0'), pNot(pRange('bBxX_', ['09']))),\n      pSeq2(\n        pRange('', ['19']),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      )\n    );\n    peg['HEXADECIMAL'] = pSeq(\n      pChar('0'),\n      pRange('xX', []),\n      pRef(peg, 'HEX'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'HEX')))\n    );\n    peg['BINARY'] = pSeq(\n      pChar('0'),\n      pRange('bB', []),\n      pRange('01', []),\n      pMany(pSeq2(pMany(pChar('_')), pRange('01', [])))\n    );\n    peg['OCTAL'] = pSeq2(\n      pChar('0'),\n      pMany(pSeq2(pMany(pChar('_')), pRange('', ['07'])))\n    );\n    peg['DIGIT'] = pRange('', ['09']);\n    peg['HEX'] = pRange('', ['af', 'AF', '09']);\n    peg['LONG_SUFFIX'] = pRange('lL', []);\n    peg['FloatExpr'] = pSeq2(\n      pNode(pRef(peg, 'FLOAT'), 'Double', 0),\n      pRef(peg, '_')\n    );\n    peg['FLOAT'] = pOre2(\n      pSeq2(pRef(peg, 'FRACTION'), pOption(pRef(peg, 'EXPONENT'))),\n      pSeq2(pMany1(pRef(peg, 'DIGIT')), pRef(peg, 'EXPONENT'))\n    );\n    peg['FRACTION'] = pOre2(\n      pSeq(\n        pNot(pChar('_')),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n      ),\n      pSeq(\n        pRef(peg, 'DIGIT'),\n        pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT'))),\n        pChar('.'),\n        pNot(pChar('.'))\n      )\n    );\n    peg['EXPONENT'] = pSeq(\n      pRange('eE', []),\n      pOption(pRange('+-', [])),\n      pRef(peg, 'DIGIT'),\n      pMany(pSeq2(pMany(pChar('_')), pRef(peg, 'DIGIT')))\n    );\n    peg['Number'] = pOre2(pRef(peg, 'FloatExpr'), pRef(peg, 'IntExpr'));\n    peg['TrueExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Tt', []), pChar('rue')), 'TrueExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['FalseExpr'] = pSeq2(\n      pNode(pSeq2(pRange('Ff', []), pChar('alse')), 'FalseExpr', 0),\n      pRef(peg, '_')\n    );\n    peg['NullExpr'] = pSeq2(\n      pNode(pOre2(pChar('None'), pChar('null')), 'Null', 0),\n      pRef(peg, '_')\n    );\n    peg['EOF'] = pNot(pAny());\n    peg['NL'] = pOre2(pChar('\\n'), pRef(peg, 'EOF'));\n    peg['S'] = pRange(' \\t\\u200b\\x0b\\r\\u3000', []);\n    peg['_'] = pMany(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['__'] = pMany(\n      pOre(\n        pRef(peg, 'S'),\n        pChar('\\n'),\n        pRef(peg, 'BLOCKCOMMENT'),\n        pRef(peg, 'LINECOMMENT')\n      )\n    );\n    peg['SPC'] = pMany1(\n      pOre(pRef(peg, 'S'), pRef(peg, 'BLOCKCOMMENT'), pRef(peg, 'LINECOMMENT'))\n    );\n    peg['BLOCKCOMMENT'] = pOre2(\n      pSeq3(pChar('/*'), pMany(pSeq2(pNot(pChar('*/')), pAny())), pChar('*/')),\n      pSeq3(pChar('(*'), pMany(pSeq2(pNot(pChar('*)')), pAny())), pChar('*)'))\n    );\n    peg['LINECOMMENT'] = pSeq2(\n      pChar('#'),\n      pMany(pSeq2(pNot(pRef(peg, 'NL')), pAny()))\n    );\n    peg['EOL'] = pSeq3(\n      pRef(peg, '_'),\n      pRef(peg, 'NL'),\n      pMany(pSeq2(pRef(peg, '_'), pRef(peg, 'NL')))\n    );\n    peg['INDENT'] = pSeq2(pChar('\\n'), pMany1(pRange(' \\t', [])));\n    peg['C'] = pOre(\n      pRef(peg, 'HIRA'),\n      pRef(peg, 'KATA'),\n      pRef(peg, 'KANJI'),\n      pRef(peg, 'MARK'),\n      pRange('', ['ａｚ', 'ＡＺ', '０９'])\n    );\n    peg['HIRA'] = pRange('', ['ぁん']);\n    peg['KATA'] = pRange('', ['ァヶ']);\n    peg['KANJI'] = pRange('々〇〻ー', ['㐀䶵', '一龠']);\n    peg['MARK'] = pChar('ー');\n    peg['\"{\"'] = pSeq2(pRange('{｛', []), pRef(peg, '__'));\n    peg['\"}\"'] = pSeq2(pRange('}｝', []), pRef(peg, '_'));\n    peg['\"[\"'] = pSeq2(pRange('[［【', []), pRef(peg, '__'));\n    peg['\"]\"'] = pSeq2(pRange(']］】', []), pRef(peg, '_'));\n    peg['\"(\"'] = pSeq2(pRange('(（', []), pRef(peg, '__'));\n    peg['\")\"'] = pSeq2(pRange(')）', []), pRef(peg, '_'));\n    peg['\"=\"'] = pSeq3(\n      pRange('=＝', []),\n      pNot(pRange('=＝', [])),\n      pRef(peg, '_')\n    );\n    peg['\".\"'] = pSeq2(pRange('.．。', []), pRef(peg, '_'));\n    peg['\",\"'] = pSeq2(pRange(',、', []), pRef(peg, '_'));\n    peg['\";\"'] = pMany1(pSeq2(pRange(';；', []), pRef(peg, '_')));\n    peg['\":\"'] = pSeq2(pRange(':：', []), pRef(peg, '_'));\n  }\n  return peg[start];\n};\n\nconst example = (start: string, sample?: string) => {\n  const parser = generate(start);\n  const t = parser(sample || 'abc');\n  console.log(`${start} ${sample}`);\n  console.log(t.toString());\n};\n\n// pegpy nezcc -g math.tpeg parser.ts > math.ts\n// npx ts-node math.ts\n","import { generate, ParseTree } from './puppy-parser';\n\nconst INDENT = '\\t';\nconst MUST = '';\n\n/* Type System */\n\nexport class Type {\n  protected code: string;\n  public constructor(code: string) {\n    this.code = code;\n  }\n\n  public isOptional() {\n    return this.code !== MUST;\n  }\n\n  public getValue() {\n    return this.code;\n  }\n\n  public toString() {\n    return '?';\n  }\n\n  public rtype(): Type {\n    return this;\n  }\n  public psize() {\n    return 0;\n  }\n  public ptype(index: number): Type {\n    return this;\n  }\n\n  // public equals(ty: Type, update: boolean): boolean {\n  //   return false;\n  // }\n\n  public accept(ty: Type, update: boolean): boolean {\n    return false;\n  }\n\n  public realType(): Type {\n    return this;\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any): Type {\n    return this;\n  }\n}\n\nclass BaseType extends Type {\n  private name: string;\n\n  constructor(name: string, code: string) {\n    super(code);\n    this.name = name;\n  }\n\n  public toString() {\n    return this.name;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof BaseType) {\n      return this.name === v.name;\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public hasAlpha(): boolean {\n    return this.name === 'a' || this.name === 'b';\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ty = map[this.name];\n      if (ty === undefined) {\n        map[this.name] = new VarType(map.env, map.t);\n      }\n      return map[this.name];\n    }\n    return this;\n  }\n}\n\nclass VoidType extends BaseType {\n  constructor() {\n    super('void', MUST);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VarType) {\n      v.must(this, update);\n    }\n    return true;\n  }\n}\n\nclass AnyType extends BaseType {\n  constructor(code: string) {\n    super('any', code);\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof VoidType) {\n      return false;\n    }\n    return true;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha() {\n    return true;\n  }\n\n  public toVarType(map: any) {\n    return new VarType(map.env, map.t);\n  }\n}\n\nclass FuncType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(MUST);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss = ['('];\n    for (var i = 1; i < this.types.length; i += 1) {\n      if (i > 1) {\n        ss.push(',');\n      }\n      ss.push(this.types[i].toString());\n    }\n    ss.push(')->');\n    ss.push(this.types[0].toString());\n    return ss.join('');\n  }\n\n  public rtype() {\n    return this.types[0];\n  }\n  public psize() {\n    return this.types.length - 1;\n  }\n  public ptype(index: number) {\n    return this.types[index + 1];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof FuncType && this.psize() == v.psize()) {\n      for (var i = 0; i < this.types.length; i += 1) {\n        if (!this.types[i].accept(v.types[i], update)) {\n          return false;\n        }\n        return true;\n      }\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    for (const ty of this.types) {\n      if (ty.isPattern()) return true;\n    }\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) return true;\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const v: Type[] = [];\n      for (const ty of this.types) {\n        v.push(ty.toVarType(map));\n      }\n      return new FuncType(...v);\n    }\n    return this;\n  }\n}\n\nclass ListType extends Type {\n  private param: Type;\n  constructor(param: Type, code = MUST) {\n    super(code);\n    this.param = param;\n  }\n\n  public toString() {\n    return `List[${this.param.toString()}]`;\n  }\n\n  public psize() {\n    return 1;\n  }\n  public ptype(index: number) {\n    return this.param;\n  }\n\n  public realType(): Type {\n    const p = this.param.realType();\n    if (p !== this.param) {\n      return new ListType(p, this.code);\n    }\n    return this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    const v = ty.realType();\n    if (v instanceof ListType) {\n      if (this.param == tAny) {\n        return true;\n      }\n      return this.param.accept(v.param, update);\n    }\n    if (v instanceof VarType) {\n      return v.must(this, update);\n    }\n    return false;\n  }\n\n  public isPattern() {\n    return this.param.isPattern();\n  }\n\n  public hasAlpha(): boolean {\n    return this.param.hasAlpha();\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      return new ListType(this.param.toVarType(map));\n    }\n    return this;\n  }\n}\n\nclass UnionType extends Type {\n  private types: Type[];\n  constructor(...types: Type[]) {\n    super(MUST);\n    this.types = types;\n  }\n\n  public toString() {\n    const ss: string[] = [];\n    for (var i = 0; i < this.types.length; i += 1) {\n      if (i > 0) {\n        ss.push('|');\n      }\n      ss.push(this.types[i].toString());\n    }\n    return ss.join('');\n  }\n  public psize() {\n    return this.types.length;\n  }\n\n  public ptype(index: number) {\n    return this.types[index];\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    for (const ty0 of this.types) {\n      if (ty0.accept(ty, false)) {\n        return true;\n      }\n    }\n    console.log(`FAIL ${ty} ${this.toString()}`);\n    return false;\n  }\n\n  public isPattern() {\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    for (const ty of this.types) {\n      if (ty.hasAlpha()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  public toVarType(map: any) {\n    if (this.hasAlpha()) {\n      const ts: Type[] = [];\n      for (const ty of this.types) {\n        ts.push(ty.toVarType(map));\n      }\n      return new UnionType(...ts);\n    }\n    return this;\n  }\n}\n\nconst union = (...types: Type[]) => {\n  if (types.length === 1) {\n    return types[0];\n  }\n  return new UnionType(...types);\n};\n\nconst tAny = new AnyType(MUST);\nconst tVoid = new VoidType();\nconst tBool = new BaseType('bool', MUST);\nconst tInt = new BaseType('number', MUST);\nconst tInt_ = new BaseType('number', 'undefined');\nconst tFloat = tInt;\nconst tInt0 = new BaseType('number', '0');\nconst tInt1 = new BaseType('number', '1');\nconst tFloat0 = new BaseType('number', '0.0');\nconst tString = new BaseType('string', MUST);\nconst tString_ = new BaseType('string', \"''\");\nconst tA = new BaseType('a', MUST);\nconst tListA = new ListType(tA, MUST);\nconst tListInt = new ListType(tInt, MUST);\nconst tListAny = new ListType(tAny, MUST);\nconst tStringOrList = union(tListAny, tString);\nconst tMatter = new BaseType('Object', MUST);\nconst tObject = tMatter;\nconst tVec = new BaseType('Vec', MUST);\nconst tVec0 = new BaseType('Vec', 'lib.vec(0,0)');\n\n//const tUndefined = new BaseType('undefined');\n\nconst EmptyNumberSet: number[] = [];\n\nconst unionSet = (a: number[], b: number[], c?: number[]) => {\n  const A: number[] = [];\n  for (const id of a) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  for (const id of b) {\n    if (A.indexOf(id) === -1) {\n      A.push(id);\n    }\n  }\n  if (c !== undefined) {\n    for (const id of c) {\n      if (A.indexOf(id) === -1) {\n        A.push(id);\n      }\n    }\n  }\n  return A;\n};\n\nclass VarType extends Type {\n  private varMap: (Type | number[])[];\n  private varid: number;\n  private ref: ParseTree | null;\n\n  constructor(env: Env, ref: ParseTree) {\n    super(MUST);\n    this.varMap = env.getroot('@varmap');\n    this.varid = this.varMap.length;\n    this.varMap.push(EmptyNumberSet);\n    this.ref = ref;\n  }\n\n  public toString() {\n    const v = this.varMap[this.varid];\n    if (v instanceof Type) {\n      return v.toString();\n    }\n    return 'any';\n  }\n\n  public realType(): Type {\n    const v = this.varMap[this.varid];\n    return v instanceof Type ? v : this;\n  }\n\n  public accept(ty: Type, update: boolean): boolean {\n    var v = this.varMap[this.varid];\n    if (v instanceof Type && v !== this) {\n      return v.accept(ty, update);\n    }\n    return this.must(ty.realType(), update);\n  }\n\n  public must(ty: Type, update: boolean): boolean {\n    const v1 = ty.realType();\n    if (update) {\n      if (v1 instanceof VarType) {\n        if (v1.varid === this.varid) {\n          return true;\n        }\n        const u = unionSet(\n          this.varMap[this.varid] as number[],\n          this.varMap[v1.varid] as number[],\n          [v1.varid, this.varid]\n        );\n        for (const id of u) {\n          this.varMap[id] = u;\n        }\n        return true;\n      }\n      if (!v1.isPattern()) {\n        const u = this.varMap[this.varid] as number[];\n        for (const id of u) {\n          this.varMap[id] = v1;\n        }\n        this.varMap[this.varid] = v1;\n      }\n    }\n    return true;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n}\n\nclass OptionType extends Type {\n  public options: any;\n  constructor(options: any) {\n    super(JSON.stringify(options));\n    this.options = options;\n  }\n\n  public toString() {\n    return this.code;\n  }\n\n  public accept(ty: Type): boolean {\n    const v = ty.realType();\n    if (v instanceof OptionType) {\n      return true;\n    }\n    return false;\n  }\n\n  public equals(ty: Type, update: boolean): boolean {\n    return this.accept(ty);\n  }\n\n  public isPattern() {\n    return false;\n  }\n\n  public hasAlpha(): boolean {\n    return false;\n  }\n\n  public toVarType(map: any) {\n    return this;\n  }\n}\n\nclass Symbol {\n  public code: string;\n  public ty: Type;\n  public isMatter: boolean = false;\n  public isMutable: boolean = false;\n  public constructor(code: string, ty: Type, options?: any) {\n    this.code = code;\n    this.ty = ty.realType();\n    if (options !== undefined) {\n      this.isMatter = options.isMatter === undefined ? false : options.isMatter;\n      this.isMutable =\n        options.isMutable == undefined ? false : options.isMutable;\n    }\n  }\n  public isGlobal() {\n    return this.code.indexOf('vars[') == 0;\n  }\n}\n\nconst tColor = new UnionType(tString, tInt);\nconst tOption = new OptionType({});\nconst tFuncFloatFloat = new FuncType(tFloat, tFloat);\nconst tFuncFloatFloatFloat = new FuncType(tFloat, tFloat, tFloat);\nconst tFuncShape = new FuncType(tMatter, tInt, tInt, tOption);\n\nconst import_math = {\n  pi: new Symbol('3.14159', tFloat),\n  sin: new Symbol('Math.sin', tFuncFloatFloat),\n  cos: new Symbol('Math.cos', tFuncFloatFloat),\n  tan: new Symbol('Math.tan', tFuncFloatFloat),\n  sqrt: new Symbol('Math.sqrt', tFuncFloatFloat),\n  log: new Symbol('Math.log', tFuncFloatFloat),\n  log10: new Symbol('Math.log10', tFuncFloatFloat),\n\n  pow: new Symbol('Math.pow', tFuncFloatFloatFloat),\n  hypot: new Symbol('Math.hypot', tFuncFloatFloatFloat),\n  gcd: new Symbol('puppy.gcd', tFuncFloatFloatFloat),\n};\n\nconst import_python = {\n  // 'math.': IMPORT_MATH,\n  // 'random.': IMPORT_RANDOM,\n  input: new Symbol('await puppy.input', new FuncType(tString, tString_)),\n  print: new Symbol('puppy.print', new FuncType(tVoid, tAny, tOption), {\n    isMatter: true,\n  }),\n\n  //# 返値, 引数..None はなんでもいい\n  len: new Symbol('lib.len', new FuncType(tInt, union(tString, tListA))),\n  //可変長引数\n  range: new Symbol('lib.range', new FuncType(tListInt, tInt, tInt_, tInt_)),\n  //append\n  '.append': new Symbol('lib.append', new FuncType(tVoid, tListA, tA)),\n\n  // 変換\n  int: new Symbol('lib.int', new FuncType(tInt, union(tBool, tString, tInt))),\n  float: new Symbol(\n    'lib.float',\n    new FuncType(tFloat, union(tBool, tString, tInt))\n  ),\n  str: new Symbol('lib.str', new FuncType(tString, tAny)),\n  //'random': new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_random = {\n  random: new Symbol('Math.random', new FuncType(tInt)),\n};\n\nconst import_matterjs = {\n  // # クラス\n  World: new Symbol('puppy.World', tFuncShape, { isMatter: true }),\n  Circle: new Symbol('puppy.Circle', tFuncShape, { isMatter: true }),\n  Rectangle: new Symbol('puppy.Rectangle', tFuncShape, { isMatter: true }),\n  Polygon: new Symbol('puppy.Polygon', tFuncShape, { isMatter: true }),\n  Label: new Symbol('puppy.Label', tFuncShape, { isMatter: true }),\n  // 'Ball': new Symbol('puppy.Circle', tFuncShape),\n  // 'Block': new Symbol('puppy.Ball', tFuncShape),\n\n  // # 物体メソッド\n  '.setPosition': new Symbol(\n    'lib.setPosition',\n    new FuncType(tVoid, tMatter, tInt, tInt)\n  ),\n  '.applyForce': new Symbol(\n    'lib.applyForce',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt, tInt)\n  ),\n  '.rotate': new Symbol(\n    'lib.rotate',\n    new FuncType(tVoid, tMatter, tInt, tInt_, tInt_)\n  ),\n  '.scale': new Symbol(\n    'lib.scale',\n    new FuncType(tVoid, tMatter, tInt, tInt, tInt_, tInt_)\n  ),\n  '.setAngle': new Symbol('lib.setAngle', new FuncType(tVoid, tMatter, tInt)),\n  '.setAngularVelocity': new Symbol(\n    'lib.setAngularVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setDensity': new Symbol(\n    'lib.setDensity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n  '.setMass': new Symbol('lib.setMass', new FuncType(tVoid, tMatter, tInt)),\n  '.setStatic': new Symbol(\n    'lib.setStatic',\n    new FuncType(tVoid, tMatter, tBool)\n  ),\n  '.setVelocity': new Symbol(\n    'lib.setVelocity',\n    new FuncType(tVoid, tMatter, tInt)\n  ),\n};\n\nconst modules: any = {\n  math: import_math,\n  random: import_random,\n  matterjs: import_matterjs,\n};\n\nconst symbolPackageMap: any = {};\n\nconst checkSymbolNames = () => {\n  for (const pkgname of Object.keys(modules)) {\n    for (const name of Object.keys(modules[pkgname])) {\n      symbolPackageMap[name] = pkgname;\n    }\n  }\n};\ncheckSymbolNames();\n\nconst KEYTYPES: any = {\n  width: tInt0,\n  height: tInt0,\n  x: tInt0,\n  y: tInt0,\n  image: tString_,\n  lineWidth: tInt,\n  strokeStyle: tString,\n  fillStyle: tString,\n  restitution: tFloat0,\n  angle: tFloat0,\n  position: tVec0,\n  mass: tInt0,\n  density: tInt0,\n  area: tInt0,\n  friction: tFloat0,\n  frictionStatic: tFloat0,\n  airFriction: tFloat0,\n  torque: tFloat0,\n  stiffness: tFloat0,\n  isSensor: tBool,\n  isStatic: tBool,\n  damping: tFloat0,\n  in: new FuncType(tVoid, tMatter, tMatter),\n  out: new FuncType(tVoid, tMatter, tMatter),\n  over: new FuncType(tVoid, tMatter, tMatter),\n  clicked: new FuncType(tVoid, tMatter),\n  font: tString_,\n  fontColor: tString,\n  textAlign: tString,\n  value: tInt,\n  text: tString,\n};\n\nconst valueOfType = (ty: Type) => {\n  if (ty.isOptional()) {\n    return ty.getValue();\n  }\n  if (ty instanceof ListType) {\n    return '[]';\n  }\n  if (ty instanceof BaseType) {\n    const name = ty.toString();\n    if (name === tString.toString()) {\n      return \"''\";\n    }\n    if (name === tBool.toString()) {\n      return 'false';\n    }\n    if (name === tVec.toString()) {\n      return 'lib.vec(0,0)';\n    }\n    return '0';\n  }\n  return 'undefined';\n};\n\n//const ty1 = this.check(tleft(op), env, t['left'], out1);\n//const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n//return tbinary(env, t, ty1, out1.join(''), ty2, out1.join(''), out);\nconst tCompr = union(tInt, tString);\n\nconst opset: any = {\n  and: '&&',\n  or: '||',\n  not: '!',\n  '+=': '+',\n  '-=': '-',\n  '*=': '*',\n  '//=': '//',\n  '/=': '/',\n  '<<=': '<<',\n  '>>=': '>>',\n  '|=': '|',\n  '&=': '&',\n  '^=': '^',\n};\n\nconst operator = (op: string) => {\n  const op2 = opset[op];\n  if (op2 !== undefined) {\n    return op2;\n  }\n  return op;\n};\n\nconst tleftMap = {\n  '+': union(tInt, tString, tListAny),\n  '-': tInt,\n  '**': tInt,\n  '*': union(tInt, tString, tListAny),\n  '/': tInt,\n  '//': tInt,\n  '%': tInt,\n  '==': tAny,\n  '!=': tAny,\n  in: tAny,\n  '<': tCompr,\n  '<=': tCompr,\n  '>': tCompr,\n  '>=': tCompr,\n  '^': tInt,\n  '|': tInt,\n  '&': tInt,\n  '<<': tInt,\n  '>>': tInt,\n};\n\nconst tleft = (op: string) => {\n  const ty = (tleftMap as any)[op];\n  if (ty === undefined) {\n    console.log(`FIXME undefined '${op}'`);\n    return tAny;\n  }\n  return ty;\n};\n\nconst tright = (op: string, ty: Type) => {\n  if (op == 'in') {\n    return union(new ListType(ty, MUST), tString);\n  }\n  const ty2 = (tleftMap as any)[op];\n  if (ty2 === tAny || ty2 === tInt || op === '*') {\n    return ty2;\n  }\n  return ty; // 左と同じ型\n};\n\nexport type ErrorLog = {\n  type?: string;\n  key: string;\n  pos?: number;\n  row?: number;\n  col?: number;\n  len?: number;\n  subject?: string;\n  code?: string;\n  request?: Type;\n  given?: Type;\n  fix?: string;\n};\n\nconst setpos = (s: string, pos: number, elog: ErrorLog) => {\n  const max = Math.min(pos + 1, s.length);\n  var r = 1;\n  var c = 0;\n  for (var i = 0; i < max; i += 1) {\n    if (s.charCodeAt(i) == 10) {\n      r += 1;\n      c = 0;\n    }\n    c += 1;\n  }\n  elog.pos = pos;\n  elog.row = r;\n  elog.col = c;\n  return elog;\n};\n\nclass Env {\n  private root: Env;\n  private parent: Env | null;\n  private vars: any;\n\n  public constructor(env?: Env) {\n    this.vars = {};\n    if (env === undefined) {\n      this.root = this;\n      this.parent = null;\n      this.vars['@varmap'] = [];\n      this.vars['@logs'] = [];\n      this.vars['@trace'] = [];\n      this.vars['@indent'] = INDENT;\n    } else {\n      this.root = env.root;\n      this.parent = env;\n    }\n  }\n\n  public get(key: string, value?: any) {\n    var e: Env | null = this;\n    while (e !== null) {\n      const v = e.vars[key];\n      if (v !== undefined) {\n        return v;\n      }\n      e = e.parent;\n    }\n    return value;\n  }\n\n  public has(key: string) {\n    return this.get(key) !== undefined;\n  }\n\n  public set(key: string, value: any) {\n    this.vars[key] = value;\n    return value;\n  }\n\n  public getroot(key: string, value?: any) {\n    return this.root.vars[key] || value;\n  }\n\n  public setroot(key: string, value: any) {\n    this.root.vars[key] = value;\n    return value;\n  }\n\n  public from_import(pkg: any, list?: string[]) {\n    for (const name of Object.keys(pkg)) {\n      //console.log(name);\n      if (list === undefined || list.indexOf(name) !== -1) {\n        this.vars[name] = pkg[name];\n      }\n    }\n  }\n\n  public setModule(name: string, options: any) {\n    this.set(name, new Symbol('undefined', new OptionType(options)));\n  }\n\n  public isModule(name: string) {\n    const s = this.get(name) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  public getModule(pkgname: string, name: string) {\n    const s = this.get(pkgname) as Symbol;\n    if (\n      s !== undefined &&\n      s.code === 'undefined' &&\n      s.ty instanceof OptionType\n    ) {\n      const options = (s.ty as OptionType).options;\n      return options[name];\n    }\n    return undefined;\n  }\n\n  public inferSymbolType(name: string) {\n    var ty = KEYTYPES[name];\n    if (ty === undefined) {\n      const symbol = this.get(name);\n      if (symbol === undefined) {\n        return undefined;\n      }\n    }\n    return ty;\n  }\n\n  public perror(t: ParseTree, elog: ErrorLog) {\n    const logs = this.root.vars['@logs'];\n    if (elog.type === undefined) {\n      elog.type = 'error';\n    }\n    if (elog.pos === undefined) {\n      const pos = t.begin();\n      elog.pos = pos[0];\n      elog.row = pos[1];\n      elog.col = pos[2];\n    }\n    if (elog.len === undefined) {\n      elog.len = t.epos - t.spos;\n    }\n    logs.push(elog);\n  }\n\n  public trace(t: ParseTree) {\n    const trace: number[][] = this.getroot('@trace');\n    const id = trace.length;\n    const pos = t.begin();\n    trace.push([pos[0], pos[1], pos[2], t.epos - t.spos]);\n    return `,${id}`;\n  }\n\n  public setInLoop() {\n    this.set('@inloop', true);\n    return true;\n  }\n\n  public inLoop() {\n    return this.get('@inloop') === true;\n  }\n\n  public setFunc(data: any) {\n    this.set('@func', data);\n    return data;\n  }\n\n  public inFunc() {\n    return this.get('@func') !== undefined;\n  }\n\n  public foundFunc(t: ParseTree, symbol: Symbol) {\n    if (symbol.isMatter) {\n      const data = this.get('@func');\n      if (data !== undefined) {\n        data['isMatter'] = true;\n      } else {\n        const pos = setpos(t.inputs, t.spos, { type: '', key: '' });\n        this.setroot('@yeild', pos.row);\n      }\n    }\n  }\n\n  private isUtf8Name(s: string) {\n    for (var i = 0; i < s.length; i += 1) {\n      if (s.charCodeAt(i) > 128) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private local(s: string): string {\n    if (this.isUtf8Name(s)) {\n      const map = this.getroot('@utf8map');\n      if (map === undefined) {\n        this.setroot('@utf8map', {});\n        return this.local(s);\n      }\n      var vname = map[name];\n      if (vname === undefined) {\n        const id = Object.keys(map).length;\n        vname = `_v${id}`;\n        map[name] = vname;\n      }\n      return vname as string;\n    }\n    return s;\n  }\n\n  public declVar(name: string, ty: Type) {\n    var code =\n      this.inFunc() || this.inLoop() ? this.local(name) : `vars['${name}']`;\n    const symbol = new Symbol(code, ty);\n    symbol.isMutable = true;\n    return this.set(name, symbol) as Symbol;\n  }\n\n  public emitAutoYield(out: string[]) {\n    const yieldparam = this.getroot('@yeild');\n    if (yieldparam !== undefined && !this.inFunc()) {\n      out.push(`; yield ${yieldparam};\\n`);\n      this.setroot('@yeild', undefined);\n    } else {\n      out.push('\\n');\n    }\n  }\n}\n\nclass PuppyError {\n  public constructor() {}\n}\n\nconst FIXME_subs = (t: any): any[] => {\n  return t instanceof ParseTree ? t.subs() : [];\n};\n\nclass Transpiler {\n  public constructor() {}\n\n  public conv(env: Env, t: ParseTree, out: string[]) {\n    //console.log(t.toString());\n    try {\n      return (this as any)[t.tag](env, t, out);\n    } catch (e) {\n      if (e instanceof PuppyError) {\n        throw e;\n      }\n      if ((this as any)[t.tag] === undefined) {\n        //console.log(e);\n        env.perror(t, {\n          type: 'error',\n          key: 'UndefinedParseTree',\n          subject: t.toString(),\n        });\n        return this.skip(env, t, out);\n      }\n      throw e;\n    }\n  }\n\n  public skip(env: Env, t: ParseTree, out: string[]): Type {\n    throw new PuppyError();\n    // out.push('undefined');\n    // return tAny;\n  }\n\n  public check(\n    req: Type,\n    env: Env,\n    t: ParseTree,\n    out: string[],\n    elog?: ErrorLog\n  ) {\n    const ty = this.conv(env, t, out);\n    if (req !== undefined) {\n      if (req.accept(ty, true)) {\n        return ty;\n      }\n      if (elog === undefined) {\n        elog = {\n          key: 'TypeError',\n          subject: req.toString(),\n        };\n      }\n      elog.request = req;\n      elog.given = ty;\n      env.perror(t, elog);\n      return this.skip(env, t, out);\n    }\n    return ty;\n  }\n\n  private checkBinary(\n    env: Env,\n    t: any,\n    op: string,\n    ty1: Type,\n    left: string,\n    ty2: Type,\n    right: string,\n    out: string[]\n  ) {\n    if (op === '==' || op === '!=') {\n      out.push(`${left} ${op}= ${right}`);\n      return tBool;\n    }\n    ty1 = ty1.realType();\n    ty2 = ty2.realType();\n    if (op === '+') {\n      if (tInt.accept(ty1, false) && tInt.accept(ty2, false)) {\n        out.push(`(${left} + ${right})`);\n        return tInt;\n      }\n      if (ty1.accept(ty2, true)) {\n        out.push(`lib.anyAdd(${left},${right})`);\n        return ty1;\n      }\n      env.perror(t, {\n        key: 'BinaryTypeError',\n        subject: op,\n        request: ty1,\n        given: ty2,\n      });\n      return this.skip(env, t, out);\n    }\n    if (op === '*') {\n      if (tInt.accept(ty1, false) && tInt.accept(ty2, false)) {\n        out.push(`(${left} * ${right})`);\n        return tInt;\n      }\n      out.push(`lib.anyMul(${left},${right})`);\n      if (ty1 === tInt || tListAny.accept(ty2, false)) return ty2;\n      if (ty2 === tInt || tListAny.accept(ty1, false)) return ty1;\n      return ty1;\n    }\n    if (op === '//') {\n      out.push(`((${left}/${right})|0)`);\n      return tInt;\n    }\n    if (op === '**') {\n      out.push(`Math.pow(${left},${right})`);\n      return tInt;\n    }\n    if (ty1.accept(ty2, true)) {\n      out.push(`(${left} ${op} ${right})`);\n      if ((tleftMap as any)[op] === tCompr) {\n        return tBool;\n      }\n      return ty1;\n    }\n    env.perror(t, {\n      key: 'BinaryTypeError',\n      subject: op,\n      request: ty1,\n      given: ty2,\n    });\n    return this.skip(env, t, out);\n  }\n\n  public err(env: Env, t: ParseTree, out: string[]) {\n    env.perror(t, {\n      type: 'error',\n      key: 'SyntaxError',\n    });\n    return tVoid;\n  }\n\n  public FromDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'warning',\n        key: 'UnknownPackageName',\n      });\n      return tVoid;\n    }\n    env.from_import(pkg); // FIXME\n    return tVoid;\n  }\n\n  public ImportDecl(env: Env, t: ParseTree, out: string[]) {\n    const name = t.tokenize('name');\n    const alias = t.tokenize('alias', name);\n    const pkg = modules[name];\n    if (pkg === undefined) {\n      env.perror(t.get('name'), {\n        type: 'warning',\n        key: 'UnknownPackageName',\n      });\n      return tVoid;\n    }\n    env.setModule(alias, pkg);\n    return tVoid;\n  }\n\n  public Source(env: Env, t: ParseTree, out: string[]) {\n    for (const subtree of FIXME_subs(t)) {\n      try {\n        const out2: string[] = [];\n        out2.push(env.get('@indent'));\n        this.conv(env, subtree, out2);\n        env.emitAutoYield(out2);\n        out.push(out2.join(''));\n      } catch (e) {\n        if (!(e instanceof PuppyError)) {\n          throw e;\n        }\n      }\n    }\n    return tVoid;\n  }\n\n  public Block(penv: Env, t: ParseTree, out: string[]) {\n    const indent = penv.get('@indent');\n    const nested = INDENT + indent;\n    const env = new Env(penv);\n    env.set('@indent', nested);\n    out.push('{\\n');\n    for (const subtree of FIXME_subs(t)) {\n      out.push(env.get('@indent'));\n      this.conv(env, subtree, out);\n      env.emitAutoYield(out);\n    }\n    out.push(indent + '}');\n    return tVoid;\n  }\n\n  public IfExpr(env: Env, t: any, out: string[]) {\n    out.push('((');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ? (');\n    const ty = this.conv(env, t['then'], out);\n    out.push(') : (');\n    this.check(ty, env, t['else'], out);\n    out.push('))');\n    return ty;\n  }\n\n  public IfStmt(env: Env, t: any, out: string[]) {\n    out.push('if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    if (t['elif'] !== undefined) {\n      for (const stmt of FIXME_subs(t['elif'])) {\n        this.conv(env, stmt, out);\n      }\n    }\n    if (t['else'] !== undefined) {\n      out.push('else ');\n      this.conv(env, t['else'], out);\n    }\n    return tVoid;\n  }\n\n  public ElifStmt(env: Env, t: any, out: string[]) {\n    out.push('else if (');\n    this.check(tBool, env, t['cond'], out);\n    out.push(') ');\n    this.conv(env, t['then'], out);\n    return tVoid;\n  }\n\n  public ForStmt(env: Env, t: any, out: string[]) {\n    // if (t['each'].tag !== 'Name') {\n    //   env.perror(t['each'], {\n    //     type: 'error', key: 'RequiredIdentifier',\n    //   });\n    //   return tVoid;\n    // }\n    const name = t['each'].tokenize();\n    const ty = new VarType(env, t['each']);\n    out.push(`for (let ${name} of `);\n    this.check(new ListType(ty), env, t['list'], out);\n    out.push(')');\n    const lenv = new Env(env);\n    lenv.setInLoop();\n    lenv.declVar(name, ty);\n    this.conv(lenv, t['body'], out);\n    return tVoid;\n  }\n\n  public FuncDecl(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    const types = [new VarType(env, t['name'])];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      name: name,\n      return: types[0],\n      hasReturn: false,\n      isMatter: false,\n    });\n    for (const p of FIXME_subs(t['params'])) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    const symbol = env.declVar(name, funcType);\n    const defun = symbol.isGlobal() ? '' : 'var ';\n    out.push(`${defun}${symbol.code} = (${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    symbol.isMatter = funcData['isMatter'];\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    console.log(`DEFINED ${name} :: ${funcType}`);\n    return tVoid;\n  }\n\n  public FuncExpr(env: Env, t: any, out: string[]) {\n    const types = [new VarType(env, t)];\n    const names: string[] = [];\n    const lenv = new Env(env);\n    const funcData = lenv.setFunc({\n      return: types[0],\n      hasReturn: false,\n    });\n    for (const p of FIXME_subs(t['params'])) {\n      const pname = p.tokenize('name');\n      const ptype = new VarType(env, p['name']);\n      const symbol = lenv.declVar(pname, ptype);\n      names.push(symbol.code);\n      types.push(ptype);\n    }\n    const funcType = new FuncType(...types);\n    out.push(`(${names.join(', ')}) => `);\n    this.conv(lenv, t['body'], out);\n    if (!funcData['hasReturn']) {\n      types[0].accept(tVoid, true);\n    }\n    return funcType;\n  }\n\n  public Return(env: Env, t: any, out: string[]) {\n    if (!env.inFunc()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInFunction',\n        subject: 'return',\n      });\n      return tVoid;\n    }\n    const funcData = env.get('@func');\n    funcData['hasReturn'] = true;\n    if (t['expr'] !== undefined) {\n      out.push('return ');\n      this.check(funcData['return'], env, t['expr'], out);\n    } else {\n      out.push('return');\n    }\n    return tVoid;\n  }\n\n  public Continue(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'continue',\n      });\n      return tVoid;\n    }\n    out.push('continue');\n    return tVoid;\n  }\n\n  public Break(env: Env, t: any, out: string[]) {\n    if (!env.inLoop()) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'OnlyInLoop',\n        subject: 'break',\n      });\n      return tVoid;\n    }\n    out.push('break');\n    return tVoid;\n  }\n\n  public Pass(env: Env, t: any, out: string[]) {\n    return tVoid;\n  }\n\n  public VarDecl(env: Env, t: any, out: string[]) {\n    const left = t['left'] as ParseTree;\n    if (left.tag === 'Name') {\n      const name = left.tokenize();\n      var symbol = env.get(name) as Symbol;\n      if (symbol === undefined || (env.inFunc() && symbol.isGlobal())) {\n        const ty = new VarType(env, left);\n        const out1: string[] = [];\n        this.check(ty, env, t['right'], out1);\n        symbol = env.declVar(name, ty);\n        const qual = symbol.isGlobal() ? '' : 'var ';\n        out.push(`${qual}${symbol.code} = ${out1.join('')}`);\n        return tVoid;\n      }\n    }\n    t['left'].tag = `Set${t['left'].tag}`;\n    const ty = this.conv(env, t['left'], out);\n    out.push(' = ');\n    this.check(ty, env, t['right'], out);\n    return tVoid;\n  }\n\n  public Name(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public SetName(env: Env, t: any, out: string[]) {\n    const name = t.tokenize();\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      env.perror(t, {\n        type: 'error',\n        key: 'UndefinedName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    if (!symbol.isMutable) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    return symbol.ty;\n  }\n\n  public And(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' && ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Or(env: Env, t: any, out: string[]) {\n    this.check(tBool, env, t['left'], out);\n    out.push(' || ');\n    this.check(tBool, env, t['right'], out);\n    return tBool;\n  }\n\n  public Not(env: Env, t: any, out: string[]) {\n    out.push('!(');\n    this.check(tBool, env, t[0], out);\n    out.push(')');\n    return tBool;\n  }\n\n  public Infix(env: Env, t: any, out: string[]) {\n    const op = operator(t.tokenize('name'));\n    const out1: string[] = [];\n    const out2: string[] = [];\n    const ty1 = this.check(tleft(op), env, t['left'], out1);\n    const ty2 = this.check(tright(op, ty1), env, t['right'], out2);\n    return this.checkBinary(\n      env,\n      t,\n      op,\n      ty1,\n      out1.join(''),\n      ty2,\n      out2.join(''),\n      out\n    );\n  }\n\n  public Unary(env: Env, t: any, out: string[]) {\n    const op = t.tokenize('name');\n    if (op === '!' || op === 'not') {\n      out.push(`${op}(`);\n      this.check(tBool, env, t['expr'], out);\n      out.push(')');\n      return tBool;\n    } else {\n      out.push(`${op}(`);\n      this.check(tInt, env, t['expr'], out);\n      out.push(')');\n      return tInt;\n    }\n  }\n\n  public ApplyExpr(env: Env, t: any, out: string[]): Type {\n    const name = t.tokenize('name');\n    const symbol = env.get(name) as Symbol;\n    if (symbol === undefined) {\n      const pkgname = symbolPackageMap[name];\n      if (pkgname !== undefined) {\n        console.log(`importing ${pkgname} ...`);\n        env.from_import(modules[pkgname]);\n        env.perror(t['name'], {\n          type: 'info',\n          key: 'InferredPackage',\n          subject: pkgname,\n          code: `from ${pkgname} import *`,\n        });\n        return this.ApplySymbolExpr(\n          env,\n          t,\n          env.get(name) as Symbol,\n          undefined,\n          out\n        ); // Again\n      }\n    }\n    return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n  }\n\n  private ApplySymbolExpr(\n    env: Env,\n    t: any,\n    symbol: Symbol,\n    recv: ParseTree | undefined,\n    out: string[]\n  ): Type {\n    if (symbol === undefined) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'UnknownName',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    out.push(symbol.code);\n    out.push('(');\n    const args = t['params'].subs();\n    if (recv !== undefined) {\n      args.unshift(recv);\n    }\n    var funcType = symbol.ty;\n    if (!(funcType instanceof FuncType)) {\n      env.perror(t['name'], {\n        type: 'error',\n        key: 'NotFunction',\n        subject: t['name'].tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    if (funcType.hasAlpha()) {\n      funcType = funcType.toVarType({ env, ref: t });\n      //console.log(funcType.toString());\n    }\n    for (var i = 0; i < args.length; i += 1) {\n      if (!(i < funcType.psize())) {\n        env.perror(args[i], {\n          type: 'warning',\n          key: 'TooManyArguments',\n          subject: args[i],\n        });\n        break;\n      }\n      if (i > 0) {\n        out.push(',');\n      }\n      const ty = funcType.ptype(i);\n      this.check(ty, env, args[i], out);\n    }\n    if (args.length < funcType.psize()) {\n      if (!funcType.ptype(args.length)) {\n        env.perror(\n          t['name'],\n          setpos(t.inputs, t['params'].epos, {\n            type: 'error',\n            key: 'RequiredArguments',\n          })\n        );\n      }\n    }\n    out.push(')');\n    env.foundFunc(t, symbol);\n    return funcType.rtype();\n  }\n\n  public MethodExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      return this.ApplySymbolExpr(env, t, symbol, undefined, out);\n    }\n    const methodname = `.${t.tokenize('name')}`;\n    const symbol = env.get(methodname);\n    return this.ApplySymbolExpr(env, t, symbol, t['recv'], out);\n  }\n\n  //\"[#SelfAssign left=[#Name 'a'] name=[# '+='] right=[#Int '1']]\"\n  public SelfAssign(env: Env, t: any, out: string[]) {\n    const tag = t['left'].tag;\n    t['left'].tag = `Set${tag}`;\n    this.conv(env, t['left'], out);\n    out.push(' = ');\n    t['left'].tag = tag;\n    this.Infix(env, t, out);\n    return tVoid;\n  }\n\n  public GetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      const symbol = env.getModule(recv, t.tokenize('name'));\n      out.push(symbol.code);\n      return symbol.ty;\n    }\n    out.push('lib.get(');\n    this.check(tMatter, env, t['recv'], out);\n    const name = t.tokenize('name');\n    const ty = env.inferSymbolType(name);\n    if (ty === undefined) {\n      env.perror(t['name'], {\n        key: 'UnknownName',\n        subject: name,\n      });\n      return this.skip(env, t, out);\n    }\n    const code = valueOfType(ty);\n    out.push(`,'${name}',${code}${env.trace(t['name'])})`);\n    return ty;\n  }\n\n  public SetGetExpr(env: Env, t: any, out: string[]) {\n    const recv = t.tokenize('recv');\n    if (env.isModule(recv)) {\n      env.perror(t, {\n        type: 'error',\n        key: 'Immutable',\n        subject: t.tokenize(),\n      });\n      return this.skip(env, t, out);\n    }\n    const name = t.tokenize('name');\n    this.check(tMatter, env, t['recv'], out);\n    out.push(`.${name}`);\n    const ty = (KEYTYPES as any)[name] || new VarType(env, t['name']);\n    return ty instanceof UnionType ? ty.ptype(0) : ty;\n  }\n\n  public IndexExpr(env: Env, t: any, out: string[]) {\n    out.push('lib.index(');\n    const ty = this.check(\n      union(new ListType(new VarType(env, t)), tString),\n      env,\n      t['recv'],\n      out\n    );\n    out.push(',');\n    this.check(tInt, env, t['index'], out);\n    out.push(`${env.trace(t['index'])})`);\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public SetIndexExpr(env: Env, t: any, out: string[]) {\n    const ty = this.check(tListAny, env, t['recv'], out);\n    out.push('[');\n    this.check(tInt, env, t['index'], out);\n    out.push(']');\n    return ty instanceof ListType ? ty.ptype(0) : ty;\n  }\n\n  public Slice(env: Env, t: any, out: string[]) {\n    out.push('lib.slice(');\n    const ty = this.check(tStringOrList, env, t['recv'], out);\n    out.push(',');\n    const left = t['left'];\n    if (left === undefined) {\n      out.push('0');\n    } else {\n      this.check(tInt, env, left, out);\n    }\n    out.push(',');\n    const right = t['right'];\n    if (right === undefined) {\n      out.push('undefined');\n    } else {\n      this.check(tInt, env, right, out);\n    }\n    out.push(`${env.trace(t)})`);\n    return ty;\n  }\n\n  public Data(env: Env, t: ParseTree, out: string[]) {\n    out.push('{');\n    for (const sub of FIXME_subs(t)) {\n      this.conv(env, sub, out);\n      out.push(',');\n    }\n    out.push('}');\n    return tOption;\n  }\n\n  public KeyValue(env: Env, t: any, out: string[]) {\n    const name = t.tokenize('name');\n    if (t['name'].tag === 'Name') {\n      out.push(`'${name}': `);\n      const ty = env.inferSymbolType(name);\n      if (ty === undefined) {\n        env.perror(t['name'], {\n          type: 'warning',\n          key: 'UnknownName',\n          subject: name,\n          fix: 'EncloseQuote',\n        });\n      }\n      this.check(ty, env, t['value'], out);\n      return ty;\n    } else {\n      out.push(`${name}: `);\n      this.conv(env, t['value'], out);\n    }\n    return tVoid;\n  }\n\n  public Tuple(env: Env, t: ParseTree, out: string[]) {\n    const subs = FIXME_subs(t);\n    if (subs.length > 2) {\n      env.perror(t, {\n        type: 'warning',\n        key: 'SyntaxError',\n        fix: 'EncloseBrace', // [ ]で囲みましょう\n      });\n      return this.List(env, t, out);\n    }\n    if (subs.length == 1) {\n      out.push('(');\n      const ty = this.conv(env, subs[0], out);\n      out.push(')');\n      return ty;\n    }\n    out.push('lib.vec(');\n    this.check(tInt, env, subs[0], out);\n    out.push(',');\n    this.check(tInt, env, subs[1], out);\n    out.push(')');\n    return tVec;\n  }\n\n  public List(env: Env, t: ParseTree, out: string[]) {\n    var ty = new VarType(env, t);\n    out.push('[');\n    for (const sub of FIXME_subs(t)) {\n      ty = this.check(ty, env, sub, out, {\n        type: 'error',\n        key: 'AllTypeAsSame', //全ての要素を同じ型に揃えてください\n      });\n      out.push(',');\n    }\n    out.push(']');\n    return new ListType(ty);\n  }\n\n  public Format(env: Env, t: ParseTree, out: string[]) {\n    var c = 0;\n    out.push('(');\n    for (const e of FIXME_subs(t)) {\n      if (c > 0) {\n        out.push('+');\n      }\n      if (e.tag === 'StringPart') {\n        out.push(`'${e.tokenize()}'`);\n      } else {\n        const out2: string[] = [];\n        const ty = this.conv(env, e, out2);\n        if (ty === tString) {\n          out.push(out2.join(''));\n        } else {\n          out.push(`lib.str(${out2.join('')})`);\n        }\n      }\n      c++;\n    }\n    out.push(')');\n    return tString;\n  }\n\n  public TrueExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('true');\n    return tBool;\n  }\n\n  public FalseExpr(env: Env, t: ParseTree, out: string[]) {\n    out.push('false');\n    return tBool;\n  }\n\n  public Int(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tInt;\n  }\n\n  public Float(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public Double(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize());\n    return tFloat;\n  }\n\n  public String(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public Char(env: Env, t: ParseTree, out: string[]) {\n    out.push(t.tokenize()); // FIXME\n    return tString;\n  }\n\n  public MultiString(env: Env, t: ParseTree, out: string[]) {\n    out.push(JSON.stringify(JSON.parse(t.tokenize())));\n    return tString;\n  }\n}\n\nconst parser = generate('Source');\n\nconst transpile = (s: string) => {\n  const t = parser(s);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  //console.log('DEBUG: ERROR LOGS')\n  //console.log(JSON.stringify(env.get('@logs')));\n  console.log(env.get('@logs'));\n  return out.join('');\n};\n\nexport type Source = {\n  source: string;\n  lang?: string;\n};\n\nexport type PuppyCode = {\n  world: any;\n  main: (puppy: any) => IterableIterator<number>;\n  errors: ErrorLog[];\n  code: string;\n};\n\nexport const compile = (s: Source): PuppyCode => {\n  //const start = performance.now();\n  const t = parser(s.source);\n  const env = new Env();\n  env.from_import(import_python);\n  const ts = new Transpiler();\n  const out: string[] = [];\n  ts.conv(env, t, out);\n  const jscode = out.join('');\n  const main = `\nreturn {\n  main: async function*(puppy) {\n\\tconst lib = puppy.lib;\n\\tconst vars = puppy.vars;\n${jscode}\n  },\n}`;\n  var code: any = {};\n  try {\n    code = new Function(main)();\n  } catch (e) {\n    env.perror(t, {\n      type: 'error',\n      key: 'CompileError',\n      subject: e.toString(),\n    });\n  }\n  //const end = performance.now();\n  code['world'] = {};\n  code['tree'] = t; //\n  code['code'] = jscode;\n  code['errors'] = env.get('@logs');\n  //code['time'] = end - start;\n  return code as PuppyCode;\n};\n\nexport const puppy_version = () => '1.0.0 (alpha)';\n\nexport const utest = (s: string) => {\n  const src = { source: s };\n  const code = compile(src);\n  if (code.errors.length > 0) {\n    return code.errors[0].key;\n  }\n  const ss = code.code.split('\\n');\n  if (ss.length > 1) {\n    const s = ss[ss.length - 2].trim();\n    return s === '}' ? ss[ss.length - 3].trim() : s;\n  }\n  return '';\n};\n\n// console.log(transpile(`\n// '''\n// This is a apple.\n// I'm from Chiba.\n// '''\n// `));\n\nconsole.log(\n  transpile(`\nfrom matterjs import *\nWorld(1600, 900, background=\"white\")\n\nRectangle(800, 900, width=1600, height=100, isStatic=true)\nfor x in range(100, 701, 100):\n  Rectangle(x*1.5, 100, width=40, height=300)\n\nRectangle(100, 200, width=200, height=200)\n`)\n);\n\n// console.log(transpile(`\n// World(1600, 900, background=\"white\");\n//\n// Rectangle(800, 900, width=1600, height=100, isStatic=true)\n//\n// for x in range(100, 701, 100):\n//     Rectangle(x*1.5, 100, width=40, height=300)\n//\n// Rectangle(100, 200, width=200, height=200)\n// `));\n\n// console.log(transpile(`\n// for x in range(1,2):\n//   for y in range(x,2):\n//     x+y\n// `));\n\n// console.log(transpile(`\n// def f(x,y):\n//   return x*y;\n// `));\n\nconsole.log(\n  transpile(`\n{\n  'hoge': 1,\n  hogo: 2\n}\n`)\n);\n\nconsole.log(\n  transpile(`\nv = (1,2)\n`)\n);\n","import { setTheme, setCode, setMarker, setDecoration } from './editor';\nimport { CourseShape, setCourse, setContent, setCources } from './course';\nimport { setPuppy } from './puppy';\nimport { setPlaceholder, setShow } from './input';\nimport { PuppyCode, Puppy, runPuppy, ErrorLog } from '../vm/vm';\nimport store, { ReduxActions } from '../store';\nimport { compile } from '../puppy-transpiler/puppy';\n\nimport { Range } from 'monaco-editor';\n\nimport { PATH_PREFIX } from '../env';\n\nconst checkError = (\n  dispatch: (action: ReduxActions) => void,\n  code: PuppyCode\n) => {\n  let error_count = 0;\n  const annos: ErrorLog[] = [];\n  // editor.getSession().clearAnnotations();\n  for (const e of code.errors) {\n    if (e.type === 'error') {\n      error_count += 1;\n    }\n    // ignore info\n    if (e.type === 'info') {\n      continue;\n    }\n    annos.push(e);\n    // editor.getSession().setAnnotations(annos);\n  }\n  dispatch(setMarker(annos));\n  if (error_count === 0) {\n    dispatch(setTheme('vs'));\n    return false;\n  }\n  dispatch(setTheme('error'));\n  // editorPanel.style.backgroundColor = 'rgba(254,244,244,0.7)';\n  return true;\n};\n\nlet new_puppy: Puppy | null = null;\n\nexport const trancepile = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  source: string,\n  alwaysRun: boolean,\n  waitStart = false,\n  _isLive = false\n): Puppy | null => {\n  const code = compile({ source }) as PuppyCode; // Eval javascript code\n  console.log(code);\n  if (!checkError(dispatch, code)) {\n    // if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n    //   return puppy;\n    // }\n    if (new_puppy) {\n      new_puppy.dispose();\n    }\n    new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n    dispatch(setPuppy(new_puppy));\n  }\n  return new_puppy;\n};\n\n// export const trancepile = (dispatch: (action: ReduxActions) => void) => (\n//   puppy: Puppy | null,\n//   source: string,\n//   alwaysRun: boolean,\n//   waitStart = false,\n//   isLive = false\n// ): Promise<Puppy | null> =>\n//   fetch('/api/compile', {\n//     method: 'POST',\n//     headers: {\n//       'Content-Type': 'application/text; charset=utf-8',\n//     },\n//     body: source,\n//   })\n//     .then((res: Response) => {\n//       if (res.ok) {\n//         return res.text();\n//       }\n//       throw new Error(res.statusText);\n//     })\n//     .then((js: string) => {\n//       try {\n//         const code = Function(js)(); // Eval javascript code\n//         if (!checkError(dispatch, code)) {\n//           if (isLive && puppy && puppy!.getCode().hash === code.hash) {\n//             return puppy;\n//           }\n//           if (new_puppy) {\n//             new_puppy.dispose();\n//           }\n//           new_puppy = runPuppy(puppy!, code, alwaysRun, waitStart);\n//           dispatch(setPuppy(new_puppy));\n//         }\n//         return new_puppy;\n//       } catch (e) {\n//         // alert(`トランスパイルにしっぱいしています ${e}`);\n//         // editorPanel.style.backgroundColor = 'rgba(244,244,254,0.7)';\n//         console.log(js);\n//         console.log(`FAIL TO TRANSCOMPILE ${e}`);\n//         console.log(e);\n//         return null;\n//       }\n//     })\n//     .catch((msg: string) => {\n//       alert(`Puppy is down!! ${msg}`);\n//       return null;\n//     });\n\nconst loadFile: (path: string) => Promise<string> = path => {\n  return fetch(path, {\n    method: 'GET',\n  })\n    .then((res: Response) => {\n      if (res.ok) {\n        return res.text();\n      }\n      throw new Error(res.statusText);\n    })\n    .then((sample: string) => {\n      return sample;\n    });\n};\n\nexport const fetchSetting = (dispatch: (action: ReduxActions) => void) => (\n  path: string\n): Promise<void> =>\n  loadFile(`${PATH_PREFIX}/course/${path}/setting.json`)\n    .then((s: string) => {\n      return JSON.parse(s);\n    })\n    .then((course: CourseShape) => {\n      dispatch(setCourse(course));\n    })\n    .catch((msg: string) => {\n      console.log(`ERR ${msg}`);\n    });\n\nexport const fetchContent = (dispatch: (action: ReduxActions) => void) => (\n  coursePath: string,\n  path: string\n): Promise<void> =>\n  loadFile(`${PATH_PREFIX}/course/${coursePath}/${path}/index.md`).then(\n    (content: string) => dispatch(setContent(content))\n  );\n\nexport const fetchSample = (dispatch: (action: ReduxActions) => void) => (\n  puppy: Puppy | null,\n  coursePath: string,\n  page: number,\n  path: string\n): void => {\n  const sample = window.sessionStorage.getItem(\n    `${PATH_PREFIX}/course/${coursePath}/${path}/sample.py`\n  );\n  if (sample) {\n    dispatch(setCode(sample));\n    trancepile(dispatch)(puppy, sample, false);\n  } else {\n    loadFile(`${PATH_PREFIX}/course/${coursePath}/${path}/sample.py`).then(\n      (sample: string) => {\n        dispatch(setCode(sample));\n        trancepile(dispatch)(puppy, sample, false);\n      }\n    );\n  }\n};\n\nexport const getInputValue = async (msg: string) => {\n  const awaitForClick = target => {\n    return new Promise(resolve => {\n      target.addEventListener('submit', resolve, { once: true });\n    });\n  };\n  store.dispatch(setShow(true));\n  store.dispatch(setPlaceholder(msg));\n  await awaitForClick(document.getElementById('puppy-input-form'));\n  return store.getState().input.value;\n};\n\nexport const getIsLive = () => store.getState().puppy.isLive;\n\nexport const getDiffStartLineNumber = () => {\n  const num = store.getState().editor.diffStartLineNumber;\n  return num === null ? 0 : num;\n};\n\nexport const setCodeHighlight = (startLineNum: number, endLineNum: number) => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(\n    setDecoration(\n      codeEditor.deltaDecorations(decoration, [\n        {\n          range: new Range(startLineNum, 1, endLineNum, 1),\n          options: { isWholeLine: true, className: 'code-highlight' },\n        },\n      ])\n    )\n  );\n};\n\nexport const resetCodeHighlight = () => {\n  const codeEditor = store.getState().editor.codeEditor!;\n  const decoration = store.getState().editor.decoration;\n  store.dispatch(setDecoration(codeEditor.deltaDecorations(decoration, [])));\n};\n\nexport const fetchCourses = (\n  dispatch: (action: ReduxActions) => void\n) => (): void => {\n  const courses: { [path: string]: CourseShape } = {};\n  const get_course: Promise<void>[] = [];\n  ['Puppy', 'PuppyCourse', 'LIVE2019'].forEach(path => {\n    get_course.push(\n      loadFile(`${PATH_PREFIX}/course/${path}/setting.json`)\n        .then((s: string) => {\n          return JSON.parse(s);\n        })\n        .then((course: CourseShape) => {\n          courses[path] = course;\n        })\n    );\n  });\n  Promise.all(get_course).then(() => dispatch(setCources(courses)));\n  // fetch('/api/courses')\n  //   .then((res: Response) => {\n  //     if (res.ok) {\n  //       return res.json();\n  //     }\n  //     throw new Error(res.statusText);\n  //   })\n  //   .then((json: { [path: string]: CourseShape }) => {\n  //     dispatch(setCources(json));\n  //   });\n};\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Header from '../components/Header/Header';\nimport { fetchCourses } from '../modules/operations';\nimport { setShow } from '../modules/version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  course: state.course.course,\n  courses: state.course.courses,\n});\n\nconst mapDispatchToProps = (dispathch: (action: ReduxActions) => void) => ({\n  fetchCourses: fetchCourses(dispathch),\n  setShow: (show: boolean) => dispathch(setShow(show)),\n});\n\nconst HeaderContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Header);\n\nexport default HeaderContainer;\n","import React, { useEffect } from 'react';\nimport MonacoEditor from 'react-monaco-editor';\nimport * as monacoEditor from 'monaco-editor';\nimport './Editor.css';\nimport { Puppy } from '../../vm/vm';\n\nimport { Button, Spinner } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlus, faMinus, faPlay } from '@fortawesome/free-solid-svg-icons';\n\nimport { CodeEditor } from '../../modules/editor';\n\nmonacoEditor.editor.defineTheme('error', {\n  base: 'vs',\n  inherit: true,\n  rules: [],\n  colors: {\n    'editor.background': '#ffEEEE',\n  },\n});\n\n// monacoEditor.languages.registerCodeActionProvider('python', {\n//   provideCodeActions: (\n//     model: monacoEditor.editor.ITextModel,\n//     range: monacoEditor.Range,\n//     context: monacoEditor.languages.CodeActionContext,\n//     token: monacoEditor.CancellationToken\n//   ) => {\n//     console.log(context);\n//     const workSpaceEdit: monacoEditor.languages.WorkspaceEdit = {\n//       edits: [\n//         {\n//           edits: [\n//             {\n//               range,\n//               text: 'test',\n//             },\n//           ],\n//           resource: model.uri,\n//         },\n//       ],\n//     };\n//     const codeActions: monacoEditor.languages.CodeAction[] = [\n//       {\n//         title: 'Test',\n//         edit: workSpaceEdit,\n//         command: { id: '001', title: 'test' },\n//         diagnostics: [],\n//         kind: 'quickfix',\n//         isPreferred: true,\n//       },\n//     ];\n//     console.log(codeActions);\n//     return codeActions;\n//   },\n// });\n\nmonacoEditor.languages.registerCompletionItemProvider('python', {\n  provideCompletionItems: (\n    model: monacoEditor.editor.ITextModel,\n    position: monacoEditor.Position,\n    context: monacoEditor.languages.CompletionContext,\n    _token\n  ) => {\n    const wordInfo = model.getWordUntilPosition(position);\n    const range = new monacoEditor.Range(\n      position.lineNumber,\n      wordInfo.startColumn,\n      position.lineNumber,\n      wordInfo.endColumn\n    );\n    const math = [\n      'pi',\n      'sin',\n      'cos',\n      'tan',\n      'sqrt',\n      'log',\n      'log10',\n      'pow',\n      'hypot',\n      'gcd',\n    ];\n    const python = ['input', 'print', 'len', 'range', 'int', 'float', 'str'];\n    const random = ['random'];\n    const matter = ['World', 'Circle', 'Rectangle', 'Polygon', 'Label'];\n    const parameters = [\n      'width',\n      'height',\n      'isStatic',\n      'restitution',\n      'fillStyle',\n      'image',\n      'strokeStyle',\n      'lineWidth',\n    ];\n\n    const suggestions: monacoEditor.languages.CompletionItem[] = [];\n\n    math.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    python.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    random.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Function,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    matter.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Constructor,\n        insertText: `${label}(\\${1})`,\n        insertTextRules:\n          monacoEditor.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n        range,\n      });\n    });\n\n    parameters.map(label => {\n      suggestions.push({\n        label,\n        kind: monacoEditor.languages.CompletionItemKind.Property,\n        insertText: `${label}=`,\n        range,\n      });\n    });\n    return { suggestions: suggestions };\n  },\n});\n\nconst zenkaku =\n  '[！　”＃＄％＆’（）＊＋，－．／：；＜＝＞？＠［＼￥］＾＿‘｛｜｝～￣' +\n  'ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ' +\n  'ａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚ' +\n  '１２３４５６７８９０' +\n  '｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾉﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ]';\n\ntype EditorFooterProps = {\n  setFontSize: (fontSize: number) => void;\n  fontSize: number;\n  setIsLive: (isLive: boolean) => void;\n  isLive: boolean;\n};\n\nconst EditorFooter: React.FC<EditorFooterProps> = (\n  props: EditorFooterProps\n) => {\n  const fontPlus = () => {\n    props.setFontSize(props.fontSize + 3);\n  };\n  const fontMinus = () => {\n    props.setFontSize(Math.max(12, props.fontSize - 3));\n  };\n  return (\n    <div id=\"editor-footer\">\n      <Button onClick={() => props.setIsLive(!props.isLive)}>\n        {props.isLive ? (\n          <Spinner animation=\"grow\" variant=\"light\" size=\"sm\" />\n        ) : (\n          <FontAwesomeIcon icon={faPlay} />\n        )}\n        {' LIVE'}\n      </Button>\n      <Button onClick={fontPlus}>\n        <FontAwesomeIcon icon={faPlus} />\n      </Button>\n      <Button onClick={fontMinus}>\n        <FontAwesomeIcon icon={faMinus} />\n      </Button>\n    </div>\n  );\n};\n\nexport type EditorProps = {\n  width: number;\n  height: number;\n  codeEditor: CodeEditor | null;\n  decoration: string[];\n  fontSize: number;\n  theme: string;\n  code: string;\n  diffStartLineNumber: number | null;\n  puppy: Puppy | null;\n  isLive: boolean;\n  coursePath: string;\n  page: number;\n  setCode: (code: string) => void;\n  setSize: (width: number, height: number) => void;\n  setCodeEditor: (codeEditor: CodeEditor | null) => void;\n  setDecoration: (decoration: string[]) => void;\n  setFontSize: (fontSize: number) => void;\n  setDiffStartLineNumber: (startLineNumber: number | null) => void;\n  setIsLive: (isLive: boolean) => void;\n  trancepile: (\n    puppy: Puppy | null,\n    code: string,\n    alwaysRun: boolean,\n    waitStart?: boolean,\n    isLive?: boolean\n  ) => Puppy | null;\n};\n\nlet resizeTimer: NodeJS.Timeout;\nlet trancepileTimer: NodeJS.Timeout | null;\nlet startTimer: NodeJS.Timeout | null;\n\nconst Editor: React.FC<EditorProps> = (props: EditorProps) => {\n  const editorOptions = {\n    selectOnLineNumbers: true,\n    fontSize: props.fontSize,\n    wordWrap: 'on' as 'on',\n    lightbulb: { enabled: true },\n  };\n\n  addEventListener('resize', () => {\n    clearTimeout(resizeTimer!);\n    resizeTimer = setTimeout(function() {\n      props.setSize(\n        document.getElementById('right-col')!.clientWidth,\n        document.getElementById('right-col')!.clientHeight\n      );\n    }, 300);\n  });\n\n  useEffect(() => {\n    props.setSize(\n      document.getElementById('right-col')!.clientWidth,\n      document.getElementById('right-col')!.clientHeight\n    );\n  }, []);\n\n  const checkZenkaku = (codeEditor: CodeEditor) => {\n    const zenkakuRanges = codeEditor\n      .getModel()!\n      .findMatches(zenkaku, true, true, false, null, false);\n    const decos: monacoEditor.editor.IModelDeltaDecoration[] = zenkakuRanges.map(\n      (match: monacoEditor.editor.FindMatch) => ({\n        range: match.range,\n        options: { inlineClassName: 'zenkakuClass' },\n      })\n    );\n    props.setDecoration(codeEditor.deltaDecorations(props.decoration, decos));\n  };\n\n  const codeOnChange = (\n    new_code: string,\n    event: monacoEditor.editor.IModelContentChangedEvent\n  ) => {\n    let startNumber = props.diffStartLineNumber;\n    event.changes.map(change => {\n      startNumber =\n        startNumber === null\n          ? change.range.startLineNumber\n          : Math.min(startNumber, change.range.startLineNumber);\n    });\n    if (startNumber !== null) {\n      props.setDiffStartLineNumber(startNumber);\n    }\n    props.setCode(new_code);\n    if (props.codeEditor) {\n      checkZenkaku(props.codeEditor);\n    }\n    if (props.isLive) {\n      if (trancepileTimer) {\n        clearTimeout(trancepileTimer);\n        trancepileTimer = null;\n      }\n      // trancepileTimer = setTimeout(() => {\n      //   props.trancepile(props.puppy, new_code, false);\n      //   window.sessionStorage.setItem(\n      //     `/api/sample/${props.coursePath}/${props.page}`,\n      //     new_code\n      //   );\n      // }, 1500);\n      trancepileTimer = setTimeout(() => {\n        (puppy => {\n          if (startTimer) {\n            clearTimeout(startTimer);\n            startTimer = null;\n          }\n          startTimer = setTimeout(() => {\n            if (puppy) {\n              puppy.start();\n            }\n            props.setDiffStartLineNumber(null);\n          }, 1500);\n        })(props.trancepile(props.puppy, new_code, false, true, true));\n        window.sessionStorage.setItem(\n          `/api/sample/${props.coursePath}/${props.page}`,\n          new_code\n        );\n      }, 100);\n    }\n  };\n  const hoge: string = 'piyo';\n\n  hoge.startsWith('hoge');\n\n  const editorDidMount = (editor: CodeEditor) => {\n    props.setCodeEditor(editor);\n  };\n\n  return (\n    <div id=\"puppy-editor\">\n      <MonacoEditor\n        width={props.width}\n        height={props.height}\n        language=\"python\"\n        theme={props.theme}\n        value={props.code}\n        options={editorOptions}\n        onChange={codeOnChange}\n        editorDidMount={editorDidMount}\n      />\n      <EditorFooter\n        setFontSize={props.setFontSize}\n        fontSize={props.fontSize}\n        setIsLive={props.setIsLive}\n        isLive={props.isLive}\n      />\n    </div>\n  );\n};\n\nexport default Editor;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Editor from '../components/Editor/Editor';\nimport { trancepile } from '../modules/operations';\nimport {\n  setCode,\n  setSize,\n  setCodeEditor,\n  setDecoration,\n  setFontSize,\n  setDiffStartLineNumber,\n  CodeEditor,\n} from '../modules/editor';\nimport { setIsLive } from '../modules/puppy';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  width: state.editor.width,\n  height: state.editor.height,\n  codeEditor: state.editor.codeEditor,\n  decoration: state.editor.decoration,\n  theme: state.editor.theme,\n  fontSize: state.editor.fontSize,\n  code: state.editor.code,\n  diffStartLineNumber: state.editor.diffStartLineNumber,\n  puppy: state.puppy.puppy,\n  isLive: state.puppy.isLive,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setCode: (code: string) => dispatch(setCode(code)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  setCodeEditor: (codeEditor: CodeEditor | null) =>\n    dispatch(setCodeEditor(codeEditor)),\n  setDecoration: (decoration: string[]) => dispatch(setDecoration(decoration)),\n  setFontSize: (fontSize: number) => dispatch(setFontSize(fontSize)),\n  setDiffStartLineNumber: (LineNumber: number | null) =>\n    dispatch(setDiffStartLineNumber(LineNumber)),\n  setIsLive: (isLive: boolean) => dispatch(setIsLive(isLive)),\n  trancepile: trancepile(dispatch),\n});\n\nexport const EditorContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Editor);\n\nexport default EditorContainer;\n","import React from 'react';\nimport { Puppy } from '../../vm/vm';\nimport { Button } from 'react-bootstrap';\nimport './PuppyScreen.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faPlay,\n  faExpand,\n  faBookOpen,\n  faBook,\n} from '@fortawesome/free-solid-svg-icons';\n\ntype PuppyFooterProps = {\n  isCourseVisible: boolean;\n  setIsCourseVisible: (visible: boolean) => void;\n  code: string;\n  puppy: Puppy | null;\n  trancepile: (puppy: Puppy | null, code: string, alwaysRun: boolean) => void;\n};\n\nconst PuppyFooter: React.FC<PuppyFooterProps> = (props: PuppyFooterProps) => {\n  const fullscreen = () => {\n    if (props.puppy != null) {\n      const canvas = props.puppy.getCanvas();\n      if (canvas) {\n        // FIXME\n        if (canvas['webkitRequestFullscreen']) {\n          canvas['webkitRequestFullscreen'](); // Chrome15+, Safari5.1+, Opera15+\n        } else if (canvas['mozRequestFullScreen']) {\n          canvas['mozRequestFullScreen'](); // FF10+\n        } else if (canvas['msRequestFullscreen']) {\n          canvas['msRequestFullscreen'](); // IE11+\n        } else if (canvas['requestFullscreen']) {\n          canvas['requestFullscreen'](); // HTML5 Fullscreen API仕様\n        } else {\n          // alert('ご利用のブラウザはフルスクリーン操作に対応していません');\n          return;\n        }\n      }\n    }\n  };\n  return (\n    <div id=\"puppy-footer\">\n      <Button onClick={() => props.trancepile(props.puppy, props.code, true)}>\n        <FontAwesomeIcon icon={faPlay} />\n        {' Play'}\n      </Button>\n      <Button onClick={fullscreen}>\n        <FontAwesomeIcon icon={faExpand} />\n      </Button>\n      <Button onClick={() => props.setIsCourseVisible(!props.isCourseVisible)}>\n        <FontAwesomeIcon icon={props.isCourseVisible ? faBookOpen : faBook} />\n      </Button>\n    </div>\n  );\n};\n\nexport type PuppyScreenProps = PuppyFooterProps & {\n  setSize: (width: number, height: number) => void;\n};\n\nlet timer: NodeJS.Timeout | null = null;\n\nconst PuppyScreen: React.FC<PuppyScreenProps> = (props: PuppyScreenProps) => {\n  addEventListener('resize', () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    timer = setTimeout(function() {\n      const w = document.getElementById('puppy-screen')!.clientWidth;\n      const h = document.getElementById('puppy-screen')!.clientHeight;\n      props.setSize(w, h);\n    }, 300);\n  });\n\n  return (\n    <>\n      <div id=\"puppy-screen\"></div>\n      <PuppyFooter\n        isCourseVisible={props.isCourseVisible}\n        setIsCourseVisible={props.setIsCourseVisible}\n        code={props.code}\n        puppy={props.puppy}\n        trancepile={props.trancepile}\n      />\n    </>\n  );\n};\n\nexport default PuppyScreen;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setVisible } from '../modules/course';\nimport { setSize } from '../modules/puppy';\nimport { trancepile } from '../modules/operations';\nimport PuppyScreen from '../components/PuppyScreen/PuppyScreen';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  isCourseVisible: state.course.visible,\n  code: state.editor.code,\n  puppy: state.puppy.puppy,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setIsCourseVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  setSize: (width: number, height: number) => dispatch(setSize(width, height)),\n  trancepile: trancepile(dispatch),\n});\n\nconst PuppyScreenContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(PuppyScreen);\n\nexport default PuppyScreenContainer;\n","import React, { useEffect } from 'react';\nimport * as marked from 'marked';\nimport { Card, Col, Row } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChevronRight,\n  faChevronLeft,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons';\n\nimport { Puppy } from '../../vm/vm';\n\nimport { CourseShape } from '../../modules/course';\n\nimport './Course.css';\nimport './github-markdown.css';\n\ntype CourseProps = {\n  course: CourseShape;\n  coursePath: string;\n  puppy: Puppy | null;\n  page: number;\n  content: string;\n  visible: boolean;\n  setVisible: (visible: boolean) => void;\n  setCode: (code: string) => void;\n  setContent: (content: string) => void;\n  setCourse: (course: CourseShape) => void;\n  fetchContent: (coursePath: string, path: string) => void;\n  fetchSample: (\n    puppy: Puppy | null,\n    coursePath: string,\n    page: number,\n    path: string\n  ) => void;\n  fetchSetting: (coursePath: string) => void;\n};\n\nconst Course: React.FC<CourseProps> = (props: CourseProps) => {\n  useEffect(() => {\n    if (props.course.list.length !== 0) {\n      props.fetchContent(props.coursePath, props.course.list[props.page].path);\n      props.fetchSample(\n        props.puppy,\n        props.coursePath,\n        props.page,\n        props.course.list[props.page].path\n      );\n    }\n  }, [props.page, props.coursePath, props.course]);\n\n  useEffect(() => {\n    props.fetchSetting(props.coursePath);\n  }, [props.coursePath]);\n\n  return (\n    <div\n      id=\"puppy-course\"\n      style={{ visibility: props.visible ? 'visible' : 'hidden' }}\n    >\n      <Card className=\"course-all\">\n        <Card.Header className=\"course-header\">\n          <Row>\n            <button\n              className=\"close-button\"\n              onClick={() => props.setVisible(false)}\n            >\n              <FontAwesomeIcon icon={faTimes} />\n            </button>\n          </Row>\n          <Row>\n            <Col className=\"card-header-left\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== 0 ? (\n                <a href={`#${props.page - 1}`}>\n                  <FontAwesomeIcon icon={faChevronLeft} />\n                  {` ${props.course.list[props.page - 1].title}`}\n                </a>\n              ) : null}\n            </Col>\n            <Col className=\"card-header-right\" xs={6}>\n              {props.course.list &&\n              props.course.list.length !== 0 &&\n              props.page !== props.course.list.length - 1 ? (\n                <a href={`#${props.page + 1}`}>\n                  {`${props.course.list[props.page + 1].title} `}\n                  <FontAwesomeIcon icon={faChevronRight} />\n                </a>\n              ) : null}\n            </Col>\n          </Row>\n        </Card.Header>\n        <Card.Body className=\"course-body\">\n          <div\n            className=\"markdown-body\"\n            dangerouslySetInnerHTML={{\n              __html: marked(props.content),\n            }}\n          ></div>\n        </Card.Body>\n      </Card>\n    </div>\n  );\n};\n\nexport default Course;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport Course from '../components/Course/Course';\nimport {\n  setContent,\n  setCourse,\n  CourseShape,\n  setVisible,\n} from '../modules/course';\nimport { setCode } from '../modules/editor';\nimport { fetchContent, fetchSample, fetchSetting } from '../modules/operations';\n\nconst mapStateToProps = (\n  state: ReduxState,\n  ownProps: { coursePath: string; page: number }\n) => ({\n  course: state.course.course,\n  puppy: state.puppy.puppy,\n  coursePath: ownProps.coursePath,\n  page: ownProps.page,\n  content: state.course.content,\n  visible: state.course.visible,\n});\n\nconst mapDispathToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setContent: (content: string) => dispatch(setContent(content)),\n  setCourse: (course: CourseShape) => dispatch(setCourse(course)),\n  setCode: (code: string) => dispatch(setCode(code)),\n  setVisible: (visible: boolean) => dispatch(setVisible(visible)),\n  fetchContent: fetchContent(dispatch),\n  fetchSample: fetchSample(dispatch),\n  fetchSetting: fetchSetting(dispatch),\n});\n\nconst CourseContainer = connect(\n  mapStateToProps,\n  mapDispathToProps\n)(Course);\n\nexport default CourseContainer;\n","import React from 'react';\nimport { Modal, Button, InputGroup, FormControl, Form } from 'react-bootstrap';\n\nexport type InputState = {\n  show: boolean;\n  value: string;\n  placeholder: string;\n};\n\nexport type InputHandler = {\n  setShow: (show: boolean) => void;\n  setValue: (value: string) => void;\n};\n\nexport type InputProps = InputState & InputHandler;\n\nconst Input: React.FC<InputProps> = (props: InputProps) => {\n  return (\n    <Modal size=\"lg\" show={props.show} centered>\n      <Modal.Body>\n        <Form id=\"puppy-input-form\" onSubmit={() => props.setShow(false)}>\n          <InputGroup className=\"mb-3\">\n            <FormControl\n              placeholder={props.placeholder}\n              value={props.value}\n              onChange={e => props.setValue(e.target.value)}\n            />\n            <InputGroup.Append>\n              <Button type=\"submit\">送信する</Button>\n            </InputGroup.Append>\n          </InputGroup>\n        </Form>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Input;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow, setValue } from '../modules/input';\nimport Input, { InputState, InputHandler } from '../components/Input/Input';\n\nconst mapStateToProps = (state: ReduxState): InputState => ({\n  show: state.input.show,\n  value: state.input.value,\n  placeholder: state.input.placeholder,\n});\n\nconst mapDispatchToProps = (\n  dispatch: (action: ReduxActions) => void\n): InputHandler => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n  setValue: (value: string) => dispatch(setValue(value)),\n});\n\nconst InputContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Input);\n\nexport default InputContainer;\n","import React from 'react';\nimport { Modal, Button } from 'react-bootstrap';\n\ntype VersionProps = {\n  show: boolean;\n  setShow: (show: boolean) => void;\n};\n\nconst Version: React.FC<VersionProps> = (props: VersionProps) => {\n  return (\n    <>\n      <Modal show={props.show} onHide={() => props.setShow(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Modal heading</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {\"Woohoo, you're reading this text in a modal!\"}\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={() => props.setShow(false)}>\n            Close\n          </Button>\n          <Button variant=\"primary\" onClick={() => props.setShow(false)}>\n            Save Changes\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </>\n  );\n};\n\n// render(<Example />);\n\nexport default Version;\n","import { connect } from 'react-redux';\nimport { ReduxState, ReduxActions } from '../store';\nimport { setShow } from '../modules/version';\nimport Version from '../components/Version/Version';\n\nconst mapStateToProps = (state: ReduxState) => ({\n  show: state.version.show,\n});\n\nconst mapDispatchToProps = (dispatch: (action: ReduxActions) => void) => ({\n  setShow: (show: boolean) => dispatch(setShow(show)),\n});\n\nconst VersionContainer = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Version);\n\nexport default VersionContainer;\n","import React from 'react';\nimport './App.css';\nimport { Container, Row, Col } from 'react-bootstrap';\nimport Header from './containers/Header';\nimport Editor from './containers/Editor';\nimport PuppyScreen from './containers/PuppyScreen';\nimport Course from './containers/Course';\nimport Input from './containers/Input';\nimport Version from './containers/Version';\nimport { QueryParams } from './index';\n\ntype AppProps = { qs: QueryParams; hash: string };\n\nconst App: React.FC<AppProps> = (props: AppProps) => {\n  const coursePath = props.qs.course ? props.qs.course : 'LIVE2019';\n  const page = props.hash !== '' ? parseInt(props.hash.substr(1)) : 0;\n  return (\n    <div className=\"App\">\n      <Container className=\"container\">\n        <Header />\n        <Input />\n        <Version />\n        <Row id=\"main-row\">\n          <Col id=\"left-col\" xs={6}>\n            <Course coursePath={coursePath} page={page} />\n            <PuppyScreen />\n          </Col>\n          <Col id=\"right-col\" xs={6}>\n            <Editor coursePath={coursePath} page={page} />\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport './index.css';\nimport App from './App';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport { store } from './store';\n\nexport type QueryParams = {\n  course?: string;\n};\n\nconst queryParser = (query: string) =>\n  query\n    .substr(1)\n    .split('&')\n    .reduce((obj, v) => {\n      const pair = v.split('=');\n      obj[pair[0]] = pair[1];\n      return obj;\n    }, {});\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <Route\n        render={props => (\n          <App\n            qs={queryParser(props.location.search)}\n            hash={props.location.hash}\n          />\n        )}\n      />\n    </Router>\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}